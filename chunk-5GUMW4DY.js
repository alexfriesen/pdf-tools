import{a as zi,b as Gi}from"./chunk-Q6X77DJN.js";import{$ as bi,$a as Fi,Ab as Ui,Ac as es,B as pi,Ba as ne,C as me,Ca as Se,Cb as Hi,F as fi,Fa as Ot,Ga as Nt,Ha as Ee,Ia as re,Ib as Wi,J as Ge,Ja as Ci,K as _e,Ka as Ti,L as be,La as xi,M as te,Ma as Ri,Na as Di,Oa as Tt,P as ee,Pa as Dt,Pb as oe,Q as ve,Qa as Bt,R as Ft,Ra as we,Rb as xe,S as Wt,Sa as ki,T as xt,Tb as le,U as Lt,Ua as qe,V as ye,Va as $t,W as Ve,Xb as Ke,Y as gi,Yb as Vi,Z as mi,Za as Mi,_ as _i,_a as Ii,_b as Ut,a as Qt,aa as Xe,b as ge,ba as vi,c as We,cb as Li,da as yi,db as Oi,e as It,ec as Xi,f as zs,fa as Ai,fc as qi,g as ht,ga as ie,gb as $e,ha as Ct,hb as jt,ic as Ze,ka as Si,kc as $i,l as qt,la as Ei,lb as Ni,m as ze,ma as Rt,n as gt,na as ft,o as hi,ob as Bi,pc as Yi,q as di,qb as Ye,qc as Ki,rb as ae,sb as Pe,ta as Ae,tb as Ce,uc as Zi,va as wi,vb as ji,w as ui,wa as Pi,wc as Ji,xa as se,xb as Te,xc as Qi,zc as ts}from"./chunk-PUFZMCK6.js";var Ne=It(()=>{"use strict"});var Fs=It((or,Is)=>{"use strict";var cn="bold|bolder|lighter|[1-9]00",hn="italic|oblique",dn="small-caps",un="ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded",pn="px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q",Ms=`'([^']+)'|"([^"]+)"|[\\w\\s-]+`,fn=new RegExp(`(${cn}) +`,"i"),gn=new RegExp(`(${hn}) +`,"i"),mn=new RegExp(`(${dn}) +`,"i"),_n=new RegExp(`(${un}) +`,"i"),bn=new RegExp(`([\\d\\.]+)(${pn}) *((?:${Ms})( *, *(?:${Ms}))*)`),oi={},vn=16;Is.exports=A=>{if(oi[A])return oi[A];let t=bn.exec(A);if(!t)return;let o={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(t[1]),unit:t[2],family:t[3].replace(/["']/g,"").replace(/ *, */g,",")},e,i,u,_,C=A.substring(0,t.index);switch((e=fn.exec(C))&&(o.weight=e[1]),(i=gn.exec(C))&&(o.style=i[1]),(u=mn.exec(C))&&(o.variant=u[1]),(_=_n.exec(C))&&(o.stretch=_[1]),o.unit){case"pt":o.size/=.75;break;case"pc":o.size*=16;break;case"in":o.size*=96;break;case"cm":o.size*=96/2.54;break;case"mm":o.size*=96/25.4;break;case"%":break;case"em":case"rem":o.size*=vn/.75;break;case"q":o.size*=96/25.4/4;break}return oi[A]=o}});var Ls=It(de=>{"use strict";var yn=Fs();de.parseFont=yn;de.createCanvas=function(A,t){return Object.assign(document.createElement("canvas"),{width:A,height:t})};de.createImageData=function(A,t,o){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(A);case 2:return new ImageData(A,t);default:return new ImageData(A,t,o)}};de.loadImage=function(A,t){return new Promise(function(o,e){let i=Object.assign(document.createElement("img"),t);function u(){i.onload=null,i.onerror=null}i.onload=function(){u(),o(i)},i.onerror=function(){u(),e(new Error('Failed to load the image "'+A+'"'))},i.src=A})}});var Os=It(()=>{"use strict"});var li=It(()=>{"use strict"});var ci=It(()=>{"use strict"});var Ns=It(()=>{"use strict"});var Bs=It((exports,module)=>{"use strict";(function(t,o){typeof exports=="object"&&typeof module=="object"?module.exports=t.pdfjsLib=o():typeof define=="function"&&define.amd?define("pdfjs-dist/build/pdf",[],()=>t.pdfjsLib=o()):typeof exports=="object"?exports["pdfjs-dist/build/pdf"]=t.pdfjsLib=o():t["pdfjs-dist/build/pdf"]=t.pdfjsLib=o()})(globalThis,()=>(()=>{"use strict";var __webpack_modules__=[,(A,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VerbosityLevel=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.RenderingIntentFlag=t.PromiseCapability=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.PageActionEventType=t.OPS=t.MissingPDFException=t.MAX_IMAGE_SIZE_TO_CACHE=t.LINE_FACTOR=t.LINE_DESCENT_FACTOR=t.InvalidPDFException=t.ImageKind=t.IDENTITY_MATRIX=t.FormatError=t.FeatureTest=t.FONT_IDENTITY_MATRIX=t.DocumentActionEventType=t.CMapCompressionType=t.BaseException=t.BASELINE_FACTOR=t.AnnotationType=t.AnnotationReplyType=t.AnnotationPrefix=t.AnnotationMode=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationEditorType=t.AnnotationEditorPrefix=t.AnnotationEditorParamsType=t.AnnotationBorderStyleType=t.AnnotationActionEventType=t.AbortException=void 0,t.assert=f,t.bytesToString=j,t.createValidAbsoluteUrl=E,t.getModificationDate=vt,t.getUuid=Hs,t.getVerbosityLevel=nt,t.info=Z,t.isArrayBuffer=pt,t.isArrayEqual=Et,t.isNodeJS=void 0,t.normalizeUnicode=Be,t.objectFromMap=q,t.objectSize=st,t.setVerbosityLevel=J,t.shadow=I,t.string32=X,t.stringToBytes=H,t.stringToPDFString=lt,t.stringToUTF8String=ct,t.unreachable=S,t.utf8StringToString=dt,t.warn=L;let o=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");t.isNodeJS=o;let e=[1,0,0,1,0,0];t.IDENTITY_MATRIX=e;let i=[.001,0,0,.001,0,0];t.FONT_IDENTITY_MATRIX=i;let u=1e7;t.MAX_IMAGE_SIZE_TO_CACHE=u;let _=1.35;t.LINE_FACTOR=_;let C=.35;t.LINE_DESCENT_FACTOR=C;let x=C/_;t.BASELINE_FACTOR=x;let h={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};t.RenderingIntentFlag=h;let n={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};t.AnnotationMode=n;let s="pdfjs_internal_editor_";t.AnnotationEditorPrefix=s;let r={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};t.AnnotationEditorType=r;let d={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};t.AnnotationEditorParamsType=d;let c={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};t.PermissionFlag=c;let a={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};t.TextRenderingMode=a;let p={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};t.ImageKind=p;let m={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};t.AnnotationType=m;let v={GROUP:"Group",REPLY:"R"};t.AnnotationReplyType=v;let k={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};t.AnnotationFlag=k;let T={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};t.AnnotationFieldFlag=T;let b={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};t.AnnotationBorderStyleType=b;let w={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};t.AnnotationActionEventType=w;let B={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};t.DocumentActionEventType=B;let U={O:"PageOpen",C:"PageClose"};t.PageActionEventType=U;let O={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=O;let z={NONE:0,BINARY:1};t.CMapCompressionType=z;let V={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};t.OPS=V;let it={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};t.PasswordResponses=it;let Q=O.WARNINGS;function J(et){Number.isInteger(et)&&(Q=et)}function nt(){return Q}function Z(et){Q>=O.INFOS&&console.log(`Info: ${et}`)}function L(et){Q>=O.WARNINGS&&console.log(`Warning: ${et}`)}function S(et){throw new Error(et)}function f(et,G){et||S(G)}function g(et){switch(et?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function E(et,G=null,W=null){if(!et)return null;try{if(W&&typeof et=="string"&&(W.addDefaultProtocol&&et.startsWith("www.")&&et.match(/\./g)?.length>=2&&(et=`http://${et}`),W.tryConvertEncoding))try{et=ct(et)}catch{}let at=G?new URL(et,G):new URL(et);if(g(at))return at}catch{}return null}function I(et,G,W,at=!1){return Object.defineProperty(et,G,{value:W,enumerable:!at,configurable:!0,writable:!1}),W}let F=function(){function G(W,at){this.constructor===G&&S("Cannot initialize BaseException."),this.message=W,this.name=at}return G.prototype=new Error,G.constructor=G,G}();t.BaseException=F;class N extends F{constructor(G,W){super(G,"PasswordException"),this.code=W}}t.PasswordException=N;class R extends F{constructor(G,W){super(G,"UnknownErrorException"),this.details=W}}t.UnknownErrorException=R;class l extends F{constructor(G){super(G,"InvalidPDFException")}}t.InvalidPDFException=l;class y extends F{constructor(G){super(G,"MissingPDFException")}}t.MissingPDFException=y;class P extends F{constructor(G,W){super(G,"UnexpectedResponseException"),this.status=W}}t.UnexpectedResponseException=P;class D extends F{constructor(G){super(G,"FormatError")}}t.FormatError=D;class M extends F{constructor(G){super(G,"AbortException")}}t.AbortException=M;function j(et){(typeof et!="object"||et?.length===void 0)&&S("Invalid argument for bytesToString");let G=et.length,W=8192;if(G<W)return String.fromCharCode.apply(null,et);let at=[];for(let ut=0;ut<G;ut+=W){let _t=Math.min(ut+W,G),bt=et.subarray(ut,_t);at.push(String.fromCharCode.apply(null,bt))}return at.join("")}function H(et){typeof et!="string"&&S("Invalid argument for stringToBytes");let G=et.length,W=new Uint8Array(G);for(let at=0;at<G;++at)W[at]=et.charCodeAt(at)&255;return W}function X(et){return String.fromCharCode(et>>24&255,et>>16&255,et>>8&255,et&255)}function st(et){return Object.keys(et).length}function q(et){let G=Object.create(null);for(let[W,at]of et)G[W]=at;return G}function $(){let et=new Uint8Array(4);return et[0]=1,new Uint32Array(et.buffer,0,1)[0]===1}function Y(){try{return new Function(""),!0}catch{return!1}}class K{static get isLittleEndian(){return I(this,"isLittleEndian",$())}static get isEvalSupported(){return I(this,"isEvalSupported",Y())}static get isOffscreenCanvasSupported(){return I(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?I(this,"platform",{isWin:!1,isMac:!1}):I(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){return I(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}t.FeatureTest=K;let tt=[...Array(256).keys()].map(et=>et.toString(16).padStart(2,"0"));class rt{static makeHexColor(G,W,at){return`#${tt[G]}${tt[W]}${tt[at]}`}static scaleMinMax(G,W){let at;G[0]?(G[0]<0&&(at=W[0],W[0]=W[1],W[1]=at),W[0]*=G[0],W[1]*=G[0],G[3]<0&&(at=W[2],W[2]=W[3],W[3]=at),W[2]*=G[3],W[3]*=G[3]):(at=W[0],W[0]=W[2],W[2]=at,at=W[1],W[1]=W[3],W[3]=at,G[1]<0&&(at=W[2],W[2]=W[3],W[3]=at),W[2]*=G[1],W[3]*=G[1],G[2]<0&&(at=W[0],W[0]=W[1],W[1]=at),W[0]*=G[2],W[1]*=G[2]),W[0]+=G[4],W[1]+=G[4],W[2]+=G[5],W[3]+=G[5]}static transform(G,W){return[G[0]*W[0]+G[2]*W[1],G[1]*W[0]+G[3]*W[1],G[0]*W[2]+G[2]*W[3],G[1]*W[2]+G[3]*W[3],G[0]*W[4]+G[2]*W[5]+G[4],G[1]*W[4]+G[3]*W[5]+G[5]]}static applyTransform(G,W){let at=G[0]*W[0]+G[1]*W[2]+W[4],ut=G[0]*W[1]+G[1]*W[3]+W[5];return[at,ut]}static applyInverseTransform(G,W){let at=W[0]*W[3]-W[1]*W[2],ut=(G[0]*W[3]-G[1]*W[2]+W[2]*W[5]-W[4]*W[3])/at,_t=(-G[0]*W[1]+G[1]*W[0]+W[4]*W[1]-W[5]*W[0])/at;return[ut,_t]}static getAxialAlignedBoundingBox(G,W){let at=this.applyTransform(G,W),ut=this.applyTransform(G.slice(2,4),W),_t=this.applyTransform([G[0],G[3]],W),bt=this.applyTransform([G[2],G[1]],W);return[Math.min(at[0],ut[0],_t[0],bt[0]),Math.min(at[1],ut[1],_t[1],bt[1]),Math.max(at[0],ut[0],_t[0],bt[0]),Math.max(at[1],ut[1],_t[1],bt[1])]}static inverseTransform(G){let W=G[0]*G[3]-G[1]*G[2];return[G[3]/W,-G[1]/W,-G[2]/W,G[0]/W,(G[2]*G[5]-G[4]*G[3])/W,(G[4]*G[1]-G[5]*G[0])/W]}static singularValueDecompose2dScale(G){let W=[G[0],G[2],G[1],G[3]],at=G[0]*W[0]+G[1]*W[2],ut=G[0]*W[1]+G[1]*W[3],_t=G[2]*W[0]+G[3]*W[2],bt=G[2]*W[1]+G[3]*W[3],Gt=(at+bt)/2,Vt=Math.sqrt((at+bt)**2-4*(at*bt-_t*ut))/2,Ht=Gt+Vt||1,St=Gt-Vt||1;return[Math.sqrt(Ht),Math.sqrt(St)]}static normalizeRect(G){let W=G.slice(0);return G[0]>G[2]&&(W[0]=G[2],W[2]=G[0]),G[1]>G[3]&&(W[1]=G[3],W[3]=G[1]),W}static intersect(G,W){let at=Math.max(Math.min(G[0],G[2]),Math.min(W[0],W[2])),ut=Math.min(Math.max(G[0],G[2]),Math.max(W[0],W[2]));if(at>ut)return null;let _t=Math.max(Math.min(G[1],G[3]),Math.min(W[1],W[3])),bt=Math.min(Math.max(G[1],G[3]),Math.max(W[1],W[3]));return _t>bt?null:[at,_t,ut,bt]}static bezierBoundingBox(G,W,at,ut,_t,bt,Gt,Vt){let Ht=[],St=[[],[]],Xt,Mt,ue,mt,pe,fe,je,Ue;for(let He=0;He<2;++He){if(He===0?(Mt=6*G-12*at+6*_t,Xt=-3*G+9*at-9*_t+3*Gt,ue=3*at-3*G):(Mt=6*W-12*ut+6*bt,Xt=-3*W+9*ut-9*bt+3*Vt,ue=3*ut-3*W),Math.abs(Xt)<1e-12){if(Math.abs(Mt)<1e-12)continue;mt=-ue/Mt,0<mt&&mt<1&&Ht.push(mt);continue}je=Mt*Mt-4*ue*Xt,Ue=Math.sqrt(je),!(je<0)&&(pe=(-Mt+Ue)/(2*Xt),0<pe&&pe<1&&Ht.push(pe),fe=(-Mt-Ue)/(2*Xt),0<fe&&fe<1&&Ht.push(fe))}let Zt=Ht.length,wt,Jt=Zt;for(;Zt--;)mt=Ht[Zt],wt=1-mt,St[0][Zt]=wt*wt*wt*G+3*wt*wt*mt*at+3*wt*mt*mt*_t+mt*mt*mt*Gt,St[1][Zt]=wt*wt*wt*W+3*wt*wt*mt*ut+3*wt*mt*mt*bt+mt*mt*mt*Vt;return St[0][Jt]=G,St[1][Jt]=W,St[0][Jt+1]=Gt,St[1][Jt+1]=Vt,St[0].length=St[1].length=Jt+2,[Math.min(...St[0]),Math.min(...St[1]),Math.max(...St[0]),Math.max(...St[1])]}}t.Util=rt;let ot=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function lt(et){if(et[0]>="\xEF"){let W;if(et[0]==="\xFE"&&et[1]==="\xFF"?W="utf-16be":et[0]==="\xFF"&&et[1]==="\xFE"?W="utf-16le":et[0]==="\xEF"&&et[1]==="\xBB"&&et[2]==="\xBF"&&(W="utf-8"),W)try{let at=new TextDecoder(W,{fatal:!0}),ut=H(et);return at.decode(ut)}catch(at){L(`stringToPDFString: "${at}".`)}}let G=[];for(let W=0,at=et.length;W<at;W++){let ut=ot[et.charCodeAt(W)];G.push(ut?String.fromCharCode(ut):et.charAt(W))}return G.join("")}function ct(et){return decodeURIComponent(escape(et))}function dt(et){return unescape(encodeURIComponent(et))}function pt(et){return typeof et=="object"&&et?.byteLength!==void 0}function Et(et,G){if(et.length!==G.length)return!1;for(let W=0,at=et.length;W<at;W++)if(et[W]!==G[W])return!1;return!0}function vt(et=new Date){return[et.getUTCFullYear().toString(),(et.getUTCMonth()+1).toString().padStart(2,"0"),et.getUTCDate().toString().padStart(2,"0"),et.getUTCHours().toString().padStart(2,"0"),et.getUTCMinutes().toString().padStart(2,"0"),et.getUTCSeconds().toString().padStart(2,"0")].join("")}class zt{#t=!1;constructor(){this.promise=new Promise((G,W)=>{this.resolve=at=>{this.#t=!0,G(at)},this.reject=at=>{this.#t=!0,W(at)}})}get settled(){return this.#t}}t.PromiseCapability=zt;let yt=null,kt=null;function Be(et){return yt||(yt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,kt=new Map([["\uFB05","\u017Ft"]])),et.replaceAll(yt,(G,W,at)=>W?W.normalize("NFKC"):kt.get(at))}function Hs(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();let et=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(et);else for(let G=0;G<32;G++)et[G]=Math.floor(Math.random()*255);return j(et)}let Ws="pdfjs_internal_id_";t.AnnotationPrefix=Ws},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);let DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(A){if(typeof A=="string"||A instanceof URL?A={url:A}:(0,_util.isArrayBuffer)(A)&&(A={data:A}),typeof A!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!A.url&&!A.data&&!A.range)throw new Error("Invalid parameter object: need either .data, .range or .url");let t=new PDFDocumentLoadingTask,{docId:o}=t,e=A.url?getUrlProp(A.url):null,i=A.data?getDataProp(A.data):null,u=A.httpHeaders||null,_=A.withCredentials===!0,C=A.password??null,x=A.range instanceof PDFDataRangeTransport?A.range:null,h=Number.isInteger(A.rangeChunkSize)&&A.rangeChunkSize>0?A.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE,n=A.worker instanceof PDFWorker?A.worker:null,s=A.verbosity,r=typeof A.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(A.docBaseUrl)?A.docBaseUrl:null,d=typeof A.cMapUrl=="string"?A.cMapUrl:null,c=A.cMapPacked!==!1,a=A.CMapReaderFactory||DefaultCMapReaderFactory,p=typeof A.standardFontDataUrl=="string"?A.standardFontDataUrl:null,m=A.StandardFontDataFactory||DefaultStandardFontDataFactory,v=A.stopAtErrors!==!0,k=Number.isInteger(A.maxImageSize)&&A.maxImageSize>-1?A.maxImageSize:-1,T=A.isEvalSupported!==!1,b=typeof A.isOffscreenCanvasSupported=="boolean"?A.isOffscreenCanvasSupported:!_util.isNodeJS,w=Number.isInteger(A.canvasMaxAreaInBytes)?A.canvasMaxAreaInBytes:-1,B=typeof A.disableFontFace=="boolean"?A.disableFontFace:_util.isNodeJS,U=A.fontExtraProperties===!0,O=A.enableXfa===!0,z=A.ownerDocument||globalThis.document,V=A.disableRange===!0,it=A.disableStream===!0,Q=A.disableAutoFetch===!0,J=A.pdfBug===!0,nt=x?x.length:A.length??NaN,Z=typeof A.useSystemFonts=="boolean"?A.useSystemFonts:!_util.isNodeJS&&!B,L=typeof A.useWorkerFetch=="boolean"?A.useWorkerFetch:a===_display_utils.DOMCMapReaderFactory&&m===_display_utils.DOMStandardFontDataFactory&&d&&p&&(0,_display_utils.isValidFetchUrl)(d,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(p,document.baseURI),S=A.canvasFactory||new DefaultCanvasFactory({ownerDocument:z}),f=A.filterFactory||new DefaultFilterFactory({docId:o,ownerDocument:z}),g=null;(0,_util.setVerbosityLevel)(s);let E={canvasFactory:S,filterFactory:f};if(L||(E.cMapReaderFactory=new a({baseUrl:d,isCompressed:c}),E.standardFontDataFactory=new m({baseUrl:p})),!n){let N={verbosity:s,port:_worker_options.GlobalWorkerOptions.workerPort};n=N.port?PDFWorker.fromPort(N):new PDFWorker(N),t._worker=n}let I={docId:o,apiVersion:"3.11.174",data:i,password:C,disableAutoFetch:Q,rangeChunkSize:h,length:nt,docBaseUrl:r,enableXfa:O,evaluatorOptions:{maxImageSize:k,disableFontFace:B,ignoreErrors:v,isEvalSupported:T,isOffscreenCanvasSupported:b,canvasMaxAreaInBytes:w,fontExtraProperties:U,useSystemFonts:Z,cMapUrl:L?d:null,standardFontDataUrl:L?p:null}},F={ignoreErrors:v,isEvalSupported:T,disableFontFace:B,fontExtraProperties:U,enableXfa:O,ownerDocument:z,disableAutoFetch:Q,pdfBug:J,styleElement:g};return n.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");let N=_fetchDocument(n,I),R=new Promise(function(l){let y;x?y=new _transport_stream.PDFDataTransportStream({length:nt,initialData:x.initialData,progressiveDone:x.progressiveDone,contentDispositionFilename:x.contentDispositionFilename,disableRange:V,disableStream:it},x):i||(y=(D=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(D):(0,_display_utils.isValidFetchUrl)(D.url)?new _displayFetch_stream.PDFFetchStream(D):new _displayNetwork.PDFNetworkStream(D))({url:e,length:nt,httpHeaders:u,withCredentials:_,rangeChunkSize:h,disableRange:V,disableStream:it})),l(y)});return Promise.all([N,R]).then(function([l,y]){if(t.destroyed)throw new Error("Loading aborted");let P=new _message_handler.MessageHandler(o,l,n.port),D=new WorkerTransport(P,t,y,F,E);t._transport=D,P.send("Ready",null)})}).catch(t._capability.reject),t}function _fetchDocument(A,t){return ht(this,null,function*(){if(A.destroyed)throw new Error("Worker was destroyed");let o=yield A.messageHandler.sendWithPromise("GetDocRequest",t,t.data?[t.data.buffer]:null);if(A.destroyed)throw new Error("Worker was destroyed");return o})}function getUrlProp(A){if(A instanceof URL)return A.href;try{return new URL(A,window.location).href}catch{if(_util.isNodeJS&&typeof A=="string")return A}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(A){if(_util.isNodeJS&&typeof Buffer<"u"&&A instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(A instanceof Uint8Array&&A.byteLength===A.buffer.byteLength)return A;if(typeof A=="string")return(0,_util.stringToBytes)(A);if(typeof A=="object"&&!isNaN(A?.length)||(0,_util.isArrayBuffer)(A))return new Uint8Array(A);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#t=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}destroy(){return ht(this,null,function*(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),yield this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)})}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(t,o,e=!1,i=null){this.length=t,this.initialData=o,this.progressiveDone=e,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,o){for(let e of this._rangeListeners)e(t,o)}onDataProgress(t,o){this._readyCapability.promise.then(()=>{for(let e of this._progressListeners)e(t,o)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(let o of this._progressiveReadListeners)o(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(let t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,o){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(t,o){this._pdfInfo=t,this._transport=o,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(e=>{if(!e)return e;let i=[];for(let u in e)i.push(...e[u]);return i}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#t=null;#e=!1;constructor(t,o,e,i=!1){this._pageIndex=t,this._pageInfo=o,this._transport=e,this._stats=i?new _display_utils.StatTimer:null,this._pdfBug=i,this.commonObjs=e.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:o=this.rotate,offsetX:e=0,offsetY:i=0,dontFlip:u=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:t,rotation:o,offsetX:e,offsetY:i,dontFlip:u})}getAnnotations({intent:t="display"}={}){let o=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,o.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}getXfa(){return ht(this,null,function*(){return this._transport._htmlForXfa?.children[this._pageIndex]||null})}render({canvasContext:t,viewport:o,intent:e="display",annotationMode:i=_util.AnnotationMode.ENABLE,transform:u=null,background:_=null,optionalContentConfigPromise:C=null,annotationCanvasMap:x=null,pageColors:h=null,printAnnotationStorage:n=null}){this._stats?.time("Overall");let s=this._transport.getRenderingIntent(e,i,n);this.#e=!1,this.#s(),C||(C=this._transport.getOptionalContentConfig());let r=this._intentStates.get(s.cacheKey);r||(r=Object.create(null),this._intentStates.set(s.cacheKey,r)),r.streamReaderCancelTimeout&&(clearTimeout(r.streamReaderCancelTimeout),r.streamReaderCancelTimeout=null);let d=!!(s.renderingIntent&_util.RenderingIntentFlag.PRINT);r.displayReadyCapability||(r.displayReadyCapability=new _util.PromiseCapability,r.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(s));let c=m=>{r.renderTasks.delete(a),(this._maybeCleanupAfterRender||d)&&(this.#e=!0),this.#i(!d),m?(a.capability.reject(m),this._abortOperatorList({intentState:r,reason:m instanceof Error?m:new Error(m)})):a.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},a=new InternalRenderTask({callback:c,params:{canvasContext:t,viewport:o,transform:u,background:_},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:x,operatorList:r.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!d,pdfBug:this._pdfBug,pageColors:h});(r.renderTasks||=new Set).add(a);let p=a.task;return Promise.all([r.displayReadyCapability.promise,C]).then(([m,v])=>{if(this.destroyed){c();return}this._stats?.time("Rendering"),a.initializeGraphics({transparency:m,optionalContentConfig:v}),a.operatorListChanged()}).catch(c),p}getOperatorList({intent:t="display",annotationMode:o=_util.AnnotationMode.ENABLE,printAnnotationStorage:e=null}={}){function i(){_.operatorList.lastChunk&&(_.opListReadCapability.resolve(_.operatorList),_.renderTasks.delete(C))}let u=this._transport.getRenderingIntent(t,o,e,!0),_=this._intentStates.get(u.cacheKey);_||(_=Object.create(null),this._intentStates.set(u.cacheKey,_));let C;return _.opListReadCapability||(C=Object.create(null),C.operatorListChanged=i,_.opListReadCapability=new _util.PromiseCapability,(_.renderTasks||=new Set).add(C),_.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(u)),_.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:o=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:o===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(e=>_xfa_text.XfaText.textContent(e));let o=this.streamTextContent(t);return new Promise(function(e,i){function u(){_.read().then(function({value:x,done:h}){if(h){e(C);return}Object.assign(C.styles,x.styles),C.items.push(...x.items),u()},i)}let _=o.getReader(),C={items:[],styles:Object.create(null)};u()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;let t=[];for(let o of this._intentStates.values())if(this._abortOperatorList({intentState:o,reason:new Error("Page was destroyed."),force:!0}),!o.opListReadCapability)for(let e of o.renderTasks)t.push(e.completed),e.cancel();return this.objs.clear(),this.#e=!1,this.#s(),Promise.all(t)}cleanup(t=!1){this.#e=!0;let o=this.#i(!1);return t&&o&&(this._stats&&=new _display_utils.StatTimer),o}#i(t=!1){if(this.#s(),!this.#e||this.destroyed)return!1;if(t)return this.#t=setTimeout(()=>{this.#t=null,this.#i(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(let{renderTasks:o,operatorList:e}of this._intentStates.values())if(o.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#s(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(t,o){let e=this._intentStates.get(o);e&&(this._stats?.timeEnd("Page Request"),e.displayReadyCapability?.resolve(t))}_renderPageChunk(t,o){for(let e=0,i=t.length;e<i;e++)o.operatorList.fnArray.push(t.fnArray[e]),o.operatorList.argsArray.push(t.argsArray[e]);o.operatorList.lastChunk=t.lastChunk,o.operatorList.separateAnnots=t.separateAnnots;for(let e of o.renderTasks)e.operatorListChanged();t.lastChunk&&this.#i(!0)}_pumpOperatorList({renderingIntent:t,cacheKey:o,annotationStorageSerializable:e}){let{map:i,transfers:u}=e,C=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:o,annotationStorage:i},u).getReader(),x=this._intentStates.get(o);x.streamReader=C;let h=()=>{C.read().then(({value:n,done:s})=>{if(s){x.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(n,x),h())},n=>{if(x.streamReader=null,!this._transport.destroyed){if(x.operatorList){x.operatorList.lastChunk=!0;for(let s of x.renderTasks)s.operatorListChanged();this.#i(!0)}if(x.displayReadyCapability)x.displayReadyCapability.reject(n);else if(x.opListReadCapability)x.opListReadCapability.reject(n);else throw n}})};h()}_abortOperatorList({intentState:t,reason:o,force:e=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!e){if(t.renderTasks.size>0)return;if(o instanceof _display_utils.RenderingCancelledException){let i=RENDERING_CANCELLED_TIMEOUT;o.extraDelay>0&&o.extraDelay<1e3&&(i+=o.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:o,force:!0})},i);return}}if(t.streamReader.cancel(new _util.AbortException(o.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(let[i,u]of this._intentStates)if(u===t){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#t=new Set;#e=Promise.resolve();postMessage(t,o){let e={data:structuredClone(t,o?{transfer:o}:null)};this.#e.then(()=>{for(let i of this.#t)i.call(this,e)})}addEventListener(t,o){this.#t.add(o)}removeEventListener(t,o){this.#t.delete(o)}terminate(){this.#t.clear()}}exports.LoopbackPort=LoopbackPort;let PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof We=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){let A=document?.currentScript?.src;A&&(PDFWorkerUtil.fallbackWorkerSrc=A.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(A,t){let o;try{if(o=new URL(A),!o.origin||o.origin==="null")return!1}catch{return!1}let e=new URL(t,o);return o.origin===e.origin},PDFWorkerUtil.createCDNWrapper=function(A){let t=`importScripts("${A}");`;return URL.createObjectURL(new Blob([t]))}}class PDFWorker{static#workerPorts;constructor({name:A=null,port:t=null,verbosity:o=(0,_util.getVerbosityLevel)()}={}){if(this.name=A,this.destroyed=!1,this.verbosity=o,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,t){if(PDFWorker.#workerPorts?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(PDFWorker.#workerPorts||=new WeakMap).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(A){this._port=A,this._messageHandler=new _message_handler.MessageHandler("main","worker",A),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:A}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,A)||(A=PDFWorkerUtil.createCDNWrapper(new URL(A,window.location).href));let t=new Worker(A),o=new _message_handler.MessageHandler("main","worker",t),e=()=>{t.removeEventListener("error",i),o.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=()=>{this._webWorker||e()};t.addEventListener("error",i),o.on("test",_=>{if(t.removeEventListener("error",i),this.destroyed){e();return}_?(this._messageHandler=o,this._port=t,this._webWorker=t,this._readyCapability.resolve(),o.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),o.destroy(),t.terminate())}),o.on("ready",_=>{if(t.removeEventListener("error",i),this.destroyed){e();return}try{u()}catch{this._setupFakeWorker()}});let u=()=>{let _=new Uint8Array;o.send("test",_,[_.buffer])};u();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(A=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}let t=new LoopbackPort;this._port=t;let o=`fake${PDFWorkerUtil.fakeWorkerId++}`,e=new _message_handler.MessageHandler(o+"_worker",o,t);A.setup(e,t);let i=new _message_handler.MessageHandler(o,o+"_worker",t);this._messageHandler=i,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})}).catch(A=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${A.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(A){if(!A?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");let t=this.#workerPorts?.get(A.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new PDFWorker(A)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){let loader=()=>ht(this,null,function*(){let mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof We=="function"){let worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return yield(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler});return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker;class WorkerTransport{#t=new Map;#e=new Map;#i=new Map;#s=null;constructor(t,o,e,i,u){this.messageHandler=t,this.loadingTask=o,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this._params=i,this.canvasFactory=u.canvasFactory,this.filterFactory=u.filterFactory,this.cMapReaderFactory=u.cMapReaderFactory,this.standardFontDataFactory=u.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=e,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#o(t,o=null){let e=this.#t.get(t);if(e)return e;let i=this.messageHandler.sendWithPromise(t,o);return this.#t.set(t,i),i}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(t,o=_util.AnnotationMode.ENABLE,e=null,i=!1){let u=_util.RenderingIntentFlag.DISPLAY,_=_annotation_storage.SerializableEmpty;switch(t){case"any":u=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":u=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${t}`)}switch(o){case _util.AnnotationMode.DISABLE:u+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:u+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:u+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,_=(u&_util.RenderingIntentFlag.PRINT&&e instanceof _annotation_storage.PrintAnnotationStorage?e:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${o}`)}return i&&(u+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:u,cacheKey:`${u}_${_.hash}`,annotationStorageSerializable:_}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));let t=[];for(let e of this.#e.values())t.push(e._destroy());this.#e.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();let o=this.messageHandler.sendWithPromise("Terminate",null);return t.push(o),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){let{messageHandler:t,loadingTask:o}=this;t.on("GetReader",(e,i)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=u=>{this._lastProgress={loaded:u.loaded,total:u.total}},i.onPull=()=>{this._fullReader.read().then(function({value:u,done:_}){if(_){i.close();return}(0,_util.assert)(u instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(u),1,[u])}).catch(u=>{i.error(u)})},i.onCancel=u=>{this._fullReader.cancel(u),i.ready.catch(_=>{if(!this.destroyed)throw _})}}),t.on("ReaderHeadersReady",e=>{let i=new _util.PromiseCapability,u=this._fullReader;return u.headersReady.then(()=>{(!u.isStreamingSupported||!u.isRangeSupported)&&(this._lastProgress&&o.onProgress?.(this._lastProgress),u.onProgress=_=>{o.onProgress?.({loaded:_.loaded,total:_.total})}),i.resolve({isStreamingSupported:u.isStreamingSupported,isRangeSupported:u.isRangeSupported,contentLength:u.contentLength})},i.reject),i.promise}),t.on("GetRangeReader",(e,i)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");let u=this._networkStream.getRangeReader(e.begin,e.end);if(!u){i.close();return}i.onPull=()=>{u.read().then(function({value:_,done:C}){if(C){i.close();return}(0,_util.assert)(_ instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(_),1,[_])}).catch(_=>{i.error(_)})},i.onCancel=_=>{u.cancel(_),i.ready.catch(C=>{if(!this.destroyed)throw C})}}),t.on("GetDoc",({pdfInfo:e})=>{this._numPages=e.numPages,this._htmlForXfa=e.htmlForXfa,delete e.htmlForXfa,o._capability.resolve(new PDFDocumentProxy(e,this))}),t.on("DocException",function(e){let i;switch(e.name){case"PasswordException":i=new _util.PasswordException(e.message,e.code);break;case"InvalidPDFException":i=new _util.InvalidPDFException(e.message);break;case"MissingPDFException":i=new _util.MissingPDFException(e.message);break;case"UnexpectedResponseException":i=new _util.UnexpectedResponseException(e.message,e.status);break;case"UnknownErrorException":i=new _util.UnknownErrorException(e.message,e.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}o._capability.reject(i)}),t.on("PasswordRequest",e=>{if(this.#s=new _util.PromiseCapability,o.onPassword){let i=u=>{u instanceof Error?this.#s.reject(u):this.#s.resolve({password:u})};try{o.onPassword(i,e.code)}catch(u){this.#s.reject(u)}}else this.#s.reject(new _util.PasswordException(e.message,e.code));return this.#s.promise}),t.on("DataLoaded",e=>{o.onProgress?.({loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),t.on("StartRenderPage",e=>{if(this.destroyed)return;this.#e.get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)}),t.on("commonobj",([e,i,u])=>{if(!this.destroyed&&!this.commonObjs.has(e))switch(i){case"Font":let _=this._params;if("error"in u){let h=u.error;(0,_util.warn)(`Error during font loading: ${h}`),this.commonObjs.resolve(e,h);break}let C=_.pdfBug&&globalThis.FontInspector?.enabled?(h,n)=>globalThis.FontInspector.fontAdded(h,n):null,x=new _font_loader.FontFaceObject(u,{isEvalSupported:_.isEvalSupported,disableFontFace:_.disableFontFace,ignoreErrors:_.ignoreErrors,inspectFont:C});this.fontLoader.bind(x).catch(h=>t.sendWithPromise("FontFallback",{id:e})).finally(()=>{!_.fontExtraProperties&&x.data&&(x.data=null),this.commonObjs.resolve(e,x)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(e,u);break;default:throw new Error(`Got unknown common object type ${i}`)}}),t.on("obj",([e,i,u,_])=>{if(this.destroyed)return;let C=this.#e.get(i);if(!C.objs.has(e))switch(u){case"Image":if(C.objs.resolve(e,_),_){let x;if(_.bitmap){let{width:h,height:n}=_;x=h*n*4}else x=_.data?.length||0;x>_util.MAX_IMAGE_SIZE_TO_CACHE&&(C._maybeCleanupAfterRender=!0)}break;case"Pattern":C.objs.resolve(e,_);break;default:throw new Error(`Got unknown object type ${u}`)}}),t.on("DocProgress",e=>{this.destroyed||o.onProgress?.({loaded:e.loaded,total:e.total})}),t.on("FetchBuiltInCMap",e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(e):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(e):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");let{map:t,transfers:o}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},o).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));let o=t-1,e=this.#i.get(o);if(e)return e;let i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:o}).then(u=>{if(this.destroyed)throw new Error("Transport destroyed");let _=new PDFPageProxy(o,u,this,this._params.pdfBug);return this.#e.set(o,_),_});return this.#i.set(o,i),i}getPageIndex(t){return typeof t!="object"||t===null||!Number.isInteger(t.num)||t.num<0||!Number.isInteger(t.gen)||t.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen})}getAnnotations(t,o){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:o})}getFieldObjects(){return this.#o("GetFieldObjects")}hasJSActions(){return this.#o("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#o("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(t=>new _optional_content_config.OptionalContentConfig(t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){let t="GetMetadata",o=this.#t.get(t);if(o)return o;let e=this.messageHandler.sendWithPromise(t,null).then(i=>({info:i[0],metadata:i[1]?new _metadata.Metadata(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,e),e}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}startCleanup(t=!1){return ht(this,null,function*(){if(!this.destroyed){yield this.messageHandler.sendWithPromise("Cleanup",null);for(let o of this.#e.values())if(!o.cleanup())throw new Error(`startCleanup: Page ${o.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0)}})}get loadingParams(){let{disableAutoFetch:t,enableXfa:o}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:t,enableXfa:o})}}class PDFObjects{#t=Object.create(null);#e(t){return this.#t[t]||={capability:new _util.PromiseCapability,data:null}}get(t,o=null){if(o){let i=this.#e(t);return i.capability.promise.then(()=>o(i.data)),null}let e=this.#t[t];if(!e?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return e.data}has(t){return this.#t[t]?.capability.settled||!1}resolve(t,o=null){let e=this.#e(t);e.data=o,e.capability.resolve()}clear(){for(let t in this.#t){let{data:o}=this.#t[t];o?.bitmap?.close()}this.#t=Object.create(null)}}class RenderTask{#t=null;constructor(t){this.#t=t,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){let{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;let{annotationCanvasMap:o}=this.#t;return t.form||t.canvas&&o?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#t=new WeakSet;constructor({callback:t,params:o,objs:e,commonObjs:i,annotationCanvasMap:u,operatorList:_,pageIndex:C,canvasFactory:x,filterFactory:h,useRequestAnimationFrame:n=!1,pdfBug:s=!1,pageColors:r=null}){this.callback=t,this.params=o,this.objs=e,this.commonObjs=i,this.annotationCanvasMap=u,this.operatorListIdx=null,this.operatorList=_,this._pageIndex=C,this.canvasFactory=x,this.filterFactory=h,this._pdfBug=s,this.pageColors=r,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=n===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=o.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:o}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());let{canvasContext:e,viewport:i,transform:u,background:_}=this.params;this.gfx=new _canvas.CanvasGraphics(e,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:o},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:u,viewport:i,transparency:t,background:_}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,o=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),InternalRenderTask.#t.delete(this._canvas),this.callback(t||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,o))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}_next(){return ht(this,null,function*(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),InternalRenderTask.#t.delete(this._canvas),this.callback())))})}}let version="3.11.174";exports.version=version;let build="ce8716743";exports.build=build},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SerializableEmpty=t.PrintAnnotationStorage=t.AnnotationStorage=void 0;var e=o(1),i=o(4),u=o(8);let _=Object.freeze({map:null,hash:"",transfers:void 0});t.SerializableEmpty=_;class C{#t=!1;#e=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(n,s){let r=this.#e.get(n);return r===void 0?s:Object.assign(s,r)}getRawValue(n){return this.#e.get(n)}remove(n){if(this.#e.delete(n),this.#e.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(let s of this.#e.values())if(s instanceof i.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(n,s){let r=this.#e.get(n),d=!1;if(r!==void 0)for(let[c,a]of Object.entries(s))r[c]!==a&&(d=!0,r[c]=a);else d=!0,this.#e.set(n,s);d&&this.#i(),s instanceof i.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(s.constructor._type)}has(n){return this.#e.has(n)}getAll(){return this.#e.size>0?(0,e.objectFromMap)(this.#e):null}setAll(n){for(let[s,r]of Object.entries(n))this.setValue(s,r)}get size(){return this.#e.size}#i(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new x(this)}get serializable(){if(this.#e.size===0)return _;let n=new Map,s=new u.MurmurHash3_64,r=[],d=Object.create(null),c=!1;for(let[a,p]of this.#e){let m=p instanceof i.AnnotationEditor?p.serialize(!1,d):p;m&&(n.set(a,m),s.update(`${a}:${JSON.stringify(m)}`),c||=!!m.bitmap)}if(c)for(let a of n.values())a.bitmap&&r.push(a.bitmap);return n.size>0?{map:n,hash:s.hexdigest(),transfers:r}:_}}t.AnnotationStorage=C;class x extends C{#t;constructor(n){super();let{map:s,hash:r,transfers:d}=n.serializable,c=structuredClone(s,d?{transfer:d}:null);this.#t={map:c,hash:r,transfers:d}}get print(){(0,e.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}}t.PrintAnnotationStorage=x},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditor=void 0;var e=o(5),i=o(1),u=o(6);class _{#t="";#e=!1;#i=null;#s=null;#o=null;#a=!1;#r=null;#l=this.focusin.bind(this);#c=this.focusout.bind(this);#n=!1;#p=!1;#d=!1;_initialOptions=Object.create(null);_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#u=!1;#f=_._zIndex++;static _borderLineWidth=-1;static _colorManager=new e.ColorManager;static _zIndex=1;static SMALL_EDITOR_SIZE=0;constructor(h){this.constructor===_&&(0,i.unreachable)("Cannot initialize AnnotationEditor."),this.parent=h.parent,this.id=h.id,this.width=this.height=null,this.pageIndex=h.parent.pageIndex,this.name=h.name,this.div=null,this._uiManager=h.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=h.isCentered,this._structTreeParentId=null;let{rotation:n,rawDims:{pageWidth:s,pageHeight:r,pageX:d,pageY:c}}=this.parent.viewport;this.rotation=n,this.pageRotation=(360+n-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,r],this.pageTranslation=[d,c];let[a,p]=this.parentDimensions;this.x=h.x/a,this.y=h.y/p,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,i.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(h){let n=new C({id:h.parent.getNextId(),parent:h.parent,uiManager:h._uiManager});n.annotationElementId=h.annotationElementId,n.deleted=!0,n._uiManager.addToAnnotationStorage(n)}static initialize(h,n=null){if(_._l10nPromise||=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(r=>[r,h.get(r)])),n?.strings)for(let r of n.strings)_._l10nPromise.set(r,h.get(r));if(_._borderLineWidth!==-1)return;let s=getComputedStyle(document.documentElement);_._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(h,n){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(h){return!1}static paste(h,n){(0,i.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#u}set _isDraggable(h){this.#u=h,this.div?.classList.toggle("draggable",h)}center(){let[h,n]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*n/(h*2),this.y+=this.width*h/(n*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*n/(h*2),this.y-=this.width*h/(n*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(h){this._uiManager.addCommands(h)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#f}setParent(h){h!==null&&(this.pageIndex=h.pageIndex,this.pageDimensions=h.pageDimensions),this.parent=h}focusin(h){this._focusEventsAllowed&&(this.#n?this.#n=!1:this.parent.setSelected(this))}focusout(h){!this._focusEventsAllowed||!this.isAttachedToDOM||h.relatedTarget?.closest(`#${this.id}`)||(h.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(h,n,s,r){let[d,c]=this.parentDimensions;[s,r]=this.screenToPageTranslation(s,r),this.x=(h+s)/d,this.y=(n+r)/c,this.fixAndSetPosition()}#_([h,n],s,r){[s,r]=this.screenToPageTranslation(s,r),this.x+=s/h,this.y+=r/n,this.fixAndSetPosition()}translate(h,n){this.#_(this.parentDimensions,h,n)}translateInPage(h,n){this.#_(this.pageDimensions,h,n),this.div.scrollIntoView({block:"nearest"})}drag(h,n){let[s,r]=this.parentDimensions;if(this.x+=h/s,this.y+=n/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){let{x:m,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:d,y:c}=this,[a,p]=this.#m();d+=a,c+=p,this.div.style.left=`${(100*d).toFixed(2)}%`,this.div.style.top=`${(100*c).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}#m(){let[h,n]=this.parentDimensions,{_borderLineWidth:s}=_,r=s/h,d=s/n;switch(this.rotation){case 90:return[-r,d];case 180:return[r,d];case 270:return[r,-d];default:return[-r,-d]}}fixAndSetPosition(){let[h,n]=this.pageDimensions,{x:s,y:r,width:d,height:c}=this;switch(d*=h,c*=n,s*=h,r*=n,this.rotation){case 0:s=Math.max(0,Math.min(h-d,s)),r=Math.max(0,Math.min(n-c,r));break;case 90:s=Math.max(0,Math.min(h-c,s)),r=Math.min(n,Math.max(d,r));break;case 180:s=Math.min(h,Math.max(d,s)),r=Math.min(n,Math.max(c,r));break;case 270:s=Math.min(h,Math.max(c,s)),r=Math.max(0,Math.min(n-d,r));break}this.x=s/=h,this.y=r/=n;let[a,p]=this.#m();s+=a,r+=p;let{style:m}=this.div;m.left=`${(100*s).toFixed(2)}%`,m.top=`${(100*r).toFixed(2)}%`,this.moveInDOM()}static#g(h,n,s){switch(s){case 90:return[n,-h];case 180:return[-h,-n];case 270:return[-n,h];default:return[h,n]}}screenToPageTranslation(h,n){return _.#g(h,n,this.parentRotation)}pageTranslationToScreen(h,n){return _.#g(h,n,360-this.parentRotation)}#h(h){switch(h){case 90:{let[n,s]=this.pageDimensions;return[0,-n/s,s/n,0]}case 180:return[-1,0,0,-1];case 270:{let[n,s]=this.pageDimensions;return[0,n/s,-s/n,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){let{parentScale:h,pageDimensions:[n,s]}=this,r=n*h,d=s*h;return i.FeatureTest.isCSSRoundSupported?[Math.round(r),Math.round(d)]:[r,d]}setDims(h,n){let[s,r]=this.parentDimensions;this.div.style.width=`${(100*h/s).toFixed(2)}%`,this.#a||(this.div.style.height=`${(100*n/r).toFixed(2)}%`),this.#i?.classList.toggle("small",h<_.SMALL_EDITOR_SIZE||n<_.SMALL_EDITOR_SIZE)}fixDims(){let{style:h}=this.div,{height:n,width:s}=h,r=s.endsWith("%"),d=!this.#a&&n.endsWith("%");if(r&&d)return;let[c,a]=this.parentDimensions;r||(h.width=`${(100*parseFloat(s)/c).toFixed(2)}%`),!this.#a&&!d&&(h.height=`${(100*parseFloat(n)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#b(){if(this.#r)return;this.#r=document.createElement("div"),this.#r.classList.add("resizers");let h=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||h.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(let n of h){let s=document.createElement("div");this.#r.append(s),s.classList.add("resizer",n),s.addEventListener("pointerdown",this.#E.bind(this,n)),s.addEventListener("contextmenu",u.noContextMenu)}this.div.prepend(this.#r)}#E(h,n){n.preventDefault();let{isMac:s}=i.FeatureTest.platform;if(n.button!==0||n.ctrlKey&&s)return;let r=this.#S.bind(this,h),d=this._isDraggable;this._isDraggable=!1;let c={passive:!0,capture:!0};window.addEventListener("pointermove",r,c);let a=this.x,p=this.y,m=this.width,v=this.height,k=this.parent.div.style.cursor,T=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(n.target).cursor;let b=()=>{this._isDraggable=d,window.removeEventListener("pointerup",b),window.removeEventListener("blur",b),window.removeEventListener("pointermove",r,c),this.parent.div.style.cursor=k,this.div.style.cursor=T;let w=this.x,B=this.y,U=this.width,O=this.height;w===a&&B===p&&U===m&&O===v||this.addCommands({cmd:()=>{this.width=U,this.height=O,this.x=w,this.y=B;let[z,V]=this.parentDimensions;this.setDims(z*U,V*O),this.fixAndSetPosition()},undo:()=>{this.width=m,this.height=v,this.x=a,this.y=p;let[z,V]=this.parentDimensions;this.setDims(z*m,V*v),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",b),window.addEventListener("blur",b)}#S(h,n){let[s,r]=this.parentDimensions,d=this.x,c=this.y,a=this.width,p=this.height,m=_.MIN_SIZE/s,v=_.MIN_SIZE/r,k=R=>Math.round(R*1e4)/1e4,T=this.#h(this.rotation),b=(R,l)=>[T[0]*R+T[2]*l,T[1]*R+T[3]*l],w=this.#h(360-this.rotation),B=(R,l)=>[w[0]*R+w[2]*l,w[1]*R+w[3]*l],U,O,z=!1,V=!1;switch(h){case"topLeft":z=!0,U=(R,l)=>[0,0],O=(R,l)=>[R,l];break;case"topMiddle":U=(R,l)=>[R/2,0],O=(R,l)=>[R/2,l];break;case"topRight":z=!0,U=(R,l)=>[R,0],O=(R,l)=>[0,l];break;case"middleRight":V=!0,U=(R,l)=>[R,l/2],O=(R,l)=>[0,l/2];break;case"bottomRight":z=!0,U=(R,l)=>[R,l],O=(R,l)=>[0,0];break;case"bottomMiddle":U=(R,l)=>[R/2,l],O=(R,l)=>[R/2,0];break;case"bottomLeft":z=!0,U=(R,l)=>[0,l],O=(R,l)=>[R,0];break;case"middleLeft":V=!0,U=(R,l)=>[0,l/2],O=(R,l)=>[R,l/2];break}let it=U(a,p),Q=O(a,p),J=b(...Q),nt=k(d+J[0]),Z=k(c+J[1]),L=1,S=1,[f,g]=this.screenToPageTranslation(n.movementX,n.movementY);if([f,g]=B(f/s,g/r),z){let R=Math.hypot(a,p);L=S=Math.max(Math.min(Math.hypot(Q[0]-it[0]-f,Q[1]-it[1]-g)/R,1/a,1/p),m/a,v/p)}else V?L=Math.max(m,Math.min(1,Math.abs(Q[0]-it[0]-f)))/a:S=Math.max(v,Math.min(1,Math.abs(Q[1]-it[1]-g)))/p;let E=k(a*L),I=k(p*S);J=b(...O(E,I));let F=nt-J[0],N=Z-J[1];this.width=E,this.height=I,this.x=F,this.y=N,this.setDims(s*E,r*I),this.fixAndSetPosition()}addAltTextButton(){return ht(this,null,function*(){if(this.#i)return;let h=this.#i=document.createElement("button");h.className="altText";let n=yield _._l10nPromise.get("editor_alt_text_button_label");h.textContent=n,h.setAttribute("aria-label",n),h.tabIndex="0",h.addEventListener("contextmenu",u.noContextMenu),h.addEventListener("pointerdown",s=>s.stopPropagation()),h.addEventListener("click",s=>{s.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),h.addEventListener("keydown",s=>{s.target===h&&s.key==="Enter"&&(s.preventDefault(),this._uiManager.editAltText(this))}),this.#C(),this.div.append(h),_.SMALL_EDITOR_SIZE||(_.SMALL_EDITOR_SIZE=Math.min(128,Math.round(h.getBoundingClientRect().width*1.4)))})}#C(){return ht(this,null,function*(){let h=this.#i;if(!h)return;if(!this.#t&&!this.#e){h.classList.remove("done"),this.#s?.remove();return}_._l10nPromise.get("editor_alt_text_edit_button_label").then(s=>{h.setAttribute("aria-label",s)});let n=this.#s;if(!n){this.#s=n=document.createElement("span"),n.className="tooltip",n.setAttribute("role","tooltip");let s=n.id=`alt-text-tooltip-${this.id}`;h.setAttribute("aria-describedby",s);let r=100;h.addEventListener("mouseenter",()=>{this.#o=setTimeout(()=>{this.#o=null,this.#s.classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},r)}),h.addEventListener("mouseleave",()=>{clearTimeout(this.#o),this.#o=null,this.#s?.classList.remove("show")})}h.classList.add("done"),n.innerText=this.#e?yield _._l10nPromise.get("editor_alt_text_decorative_tooltip"):this.#t,n.parentNode||h.append(n)})}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:this.#t,decorative:this.#e}}set altTextData({altText:h,decorative:n}){this.#t===h&&this.#e===n||(this.#t=h,this.#e=n,this.#C())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#l),this.div.addEventListener("focusout",this.#c);let[h,n]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*n/h).toFixed(2)}%`,this.div.style.maxHeight=`${(100*h/n).toFixed(2)}%`);let[s,r]=this.getInitialTranslation();return this.translate(s,r),(0,e.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(h){let{isMac:n}=i.FeatureTest.platform;if(h.button!==0||h.ctrlKey&&n){h.preventDefault();return}this.#n=!0,this.#x(h)}#x(h){if(!this._isDraggable)return;let n=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let s,r;n&&(s={passive:!0,capture:!0},r=c=>{let[a,p]=this.screenToPageTranslation(c.movementX,c.movementY);this._uiManager.dragSelectedEditors(a,p)},window.addEventListener("pointermove",r,s));let d=()=>{if(window.removeEventListener("pointerup",d),window.removeEventListener("blur",d),n&&window.removeEventListener("pointermove",r,s),this.#n=!1,!this._uiManager.endDragSession()){let{isMac:c}=i.FeatureTest.platform;h.ctrlKey&&!c||h.shiftKey||h.metaKey&&c?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",d),window.addEventListener("blur",d)}moveInDOM(){this.parent?.moveEditorInDOM(this)}_setParentAndPosition(h,n,s){h.changeParent(this),this.x=n,this.y=s,this.fixAndSetPosition()}getRect(h,n){let s=this.parentScale,[r,d]=this.pageDimensions,[c,a]=this.pageTranslation,p=h/s,m=n/s,v=this.x*r,k=this.y*d,T=this.width*r,b=this.height*d;switch(this.rotation){case 0:return[v+p+c,d-k-m-b+a,v+p+T+c,d-k-m+a];case 90:return[v+m+c,d-k+p+a,v+m+b+c,d-k+p+T+a];case 180:return[v-p-T+c,d-k+m+a,v-p+c,d-k+m+b+a];case 270:return[v-m-b+c,d-k-p-T+a,v-m+c,d-k-p+a];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(h,n){let[s,r,d,c]=h,a=d-s,p=c-r;switch(this.rotation){case 0:return[s,n-c,a,p];case 90:return[s,n-r,p,a];case 180:return[d,n-r,a,p];case 270:return[d,n-c,p,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#d=!0}disableEditMode(){this.#d=!1}isInEditMode(){return this.#d}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#l),this.div?.addEventListener("focusout",this.#c)}serialize(h=!1,n=null){(0,i.unreachable)("An editor must be serializable")}static deserialize(h,n,s){let r=new this.prototype.constructor({parent:n,id:n.getNextId(),uiManager:s});r.rotation=h.rotation;let[d,c]=r.pageDimensions,[a,p,m,v]=r.getRectInCurrentCoords(h.rect,c);return r.x=a/d,r.y=p/c,r.width=m/d,r.height=v/c,r}remove(){this.div.removeEventListener("focusin",this.#l),this.div.removeEventListener("focusout",this.#c),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#i?.remove(),this.#i=null,this.#s=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#b(),this.#r.classList.remove("hidden"))}select(){this.makeResizable(),this.div?.classList.add("selectedEditor")}unselect(){this.#r?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(h,n){}disableEditing(){this.#i&&(this.#i.hidden=!0)}enableEditing(){this.#i&&(this.#i.hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(h){this.#p=h,this.parent&&(h?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(h,n){this.#a=!0;let s=h/n,{style:r}=this.div;r.aspectRatio=s,r.height="auto"}static get MIN_SIZE(){return 16}}t.AnnotationEditor=_;class C extends _{constructor(h){super(h),this.annotationElementId=h.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardManager=t.CommandManager=t.ColorManager=t.AnnotationEditorUIManager=void 0,t.bindEvents=u,t.opacityToHex=_;var e=o(1),i=o(6);function u(d,c,a){for(let p of a)c.addEventListener(p,d[p].bind(d))}function _(d){return Math.round(Math.min(255,Math.max(1,255*d))).toString(16).padStart(2,"0")}class C{#t=0;getId(){return`${e.AnnotationEditorPrefix}${this.#t++}`}}class x{#t=(0,e.getUuid)();#e=0;#i=null;static get _isSVGFittingCanvas(){let c='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',p=new OffscreenCanvas(1,3).getContext("2d"),m=new Image;m.src=c;let v=m.decode().then(()=>(p.drawImage(m,0,0,1,1,0,0,1,3),new Uint32Array(p.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,e.shadow)(this,"_isSVGFittingCanvas",v)}#s(c,a){return ht(this,null,function*(){this.#i||=new Map;let p=this.#i.get(c);if(p===null)return null;if(p?.bitmap)return p.refCounter+=1,p;try{p||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let m;if(typeof a=="string"){p.url=a;let v=yield fetch(a);if(!v.ok)throw new Error(v.statusText);m=yield v.blob()}else m=p.file=a;if(m.type==="image/svg+xml"){let v=x._isSVGFittingCanvas,k=new FileReader,T=new Image,b=new Promise((w,B)=>{T.onload=()=>{p.bitmap=T,p.isSvg=!0,w()},k.onload=()=>ht(this,null,function*(){let U=p.svgUrl=k.result;T.src=(yield v)?`${U}#svgView(preserveAspectRatio(none))`:U}),T.onerror=k.onerror=B});k.readAsDataURL(m),yield b}else p.bitmap=yield createImageBitmap(m);p.refCounter=1}catch(m){console.error(m),p=null}return this.#i.set(c,p),p&&this.#i.set(p.id,p),p})}getFromFile(c){return ht(this,null,function*(){let{lastModified:a,name:p,size:m,type:v}=c;return this.#s(`${a}_${p}_${m}_${v}`,c)})}getFromUrl(c){return ht(this,null,function*(){return this.#s(c,c)})}getFromId(c){return ht(this,null,function*(){this.#i||=new Map;let a=this.#i.get(c);return a?a.bitmap?(a.refCounter+=1,a):a.file?this.getFromFile(a.file):this.getFromUrl(a.url):null})}getSvgUrl(c){let a=this.#i.get(c);return a?.isSvg?a.svgUrl:null}deleteId(c){this.#i||=new Map;let a=this.#i.get(c);a&&(a.refCounter-=1,a.refCounter===0&&(a.bitmap=null))}isValidId(c){return c.startsWith(`image_${this.#t}_`)}}class h{#t=[];#e=!1;#i;#s=-1;constructor(c=128){this.#i=c}add({cmd:c,undo:a,mustExec:p,type:m=NaN,overwriteIfSameType:v=!1,keepUndo:k=!1}){if(p&&c(),this.#e)return;let T={cmd:c,undo:a,type:m};if(this.#s===-1){this.#t.length>0&&(this.#t.length=0),this.#s=0,this.#t.push(T);return}if(v&&this.#t[this.#s].type===m){k&&(T.undo=this.#t[this.#s].undo),this.#t[this.#s]=T;return}let b=this.#s+1;b===this.#i?this.#t.splice(0,1):(this.#s=b,b<this.#t.length&&this.#t.splice(b)),this.#t.push(T)}undo(){this.#s!==-1&&(this.#e=!0,this.#t[this.#s].undo(),this.#e=!1,this.#s-=1)}redo(){this.#s<this.#t.length-1&&(this.#s+=1,this.#e=!0,this.#t[this.#s].cmd(),this.#e=!1)}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#t.length-1}destroy(){this.#t=null}}t.CommandManager=h;class n{constructor(c){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;let{isMac:a}=e.FeatureTest.platform;for(let[p,m,v={}]of c)for(let k of p){let T=k.startsWith("mac+");a&&T?(this.callbacks.set(k.slice(4),{callback:m,options:v}),this.allKeys.add(k.split("+").at(-1))):!a&&!T&&(this.callbacks.set(k,{callback:m,options:v}),this.allKeys.add(k.split("+").at(-1)))}}#t(c){c.altKey&&this.buffer.push("alt"),c.ctrlKey&&this.buffer.push("ctrl"),c.metaKey&&this.buffer.push("meta"),c.shiftKey&&this.buffer.push("shift"),this.buffer.push(c.key);let a=this.buffer.join("+");return this.buffer.length=0,a}exec(c,a){if(!this.allKeys.has(a.key))return;let p=this.callbacks.get(this.#t(a));if(!p)return;let{callback:m,options:{bubbles:v=!1,args:k=[],checker:T=null}}=p;T&&!T(c,a)||(m.bind(c,...k)(),v||(a.stopPropagation(),a.preventDefault()))}}t.KeyboardManager=n;class s{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){let c=new Map([["CanvasText",null],["Canvas",null]]);return(0,i.getColorValues)(c),(0,e.shadow)(this,"_colors",c)}convert(c){let a=(0,i.getRGB)(c);if(!window.matchMedia("(forced-colors: active)").matches)return a;for(let[p,m]of this._colors)if(m.every((v,k)=>v===a[k]))return s._colorsMapping.get(p);return a}getHexCode(c){let a=this._colors.get(c);return a?e.Util.makeHexColor(...a):c}}t.ColorManager=s;let r=(()=>{class d{#t=null;#e=new Map;#i=new Map;#s=null;#o=null;#a=new h;#r=0;#l=new Set;#c=null;#n=null;#p=new Set;#d=null;#u=new C;#f=!1;#_=!1;#m=null;#g=e.AnnotationEditorType.NONE;#h=new Set;#b=null;#E=this.blur.bind(this);#S=this.focus.bind(this);#C=this.copy.bind(this);#x=this.cut.bind(this);#F=this.paste.bind(this);#L=this.keydown.bind(this);#O=this.onEditingAction.bind(this);#v=this.onPageChanging.bind(this);#I=this.onScaleChanging.bind(this);#R=this.onRotationChanging.bind(this);#D={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#y=[0,0];#T=null;#w=null;#N=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){let a=d.prototype,p=k=>{let{activeElement:T}=document;return T&&k.#w.contains(T)&&k.hasSomethingToControl()},m=this.TRANSLATE_SMALL,v=this.TRANSLATE_BIG;return(0,e.shadow)(this,"_keyboardManager",new n([[["ctrl+a","mac+meta+a"],a.selectAll],[["ctrl+z","mac+meta+z"],a.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],a.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],a.delete],[["Escape","mac+Escape"],a.unselectAll],[["ArrowLeft","mac+ArrowLeft"],a.translateSelectedEditors,{args:[-m,0],checker:p}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],a.translateSelectedEditors,{args:[-v,0],checker:p}],[["ArrowRight","mac+ArrowRight"],a.translateSelectedEditors,{args:[m,0],checker:p}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],a.translateSelectedEditors,{args:[v,0],checker:p}],[["ArrowUp","mac+ArrowUp"],a.translateSelectedEditors,{args:[0,-m],checker:p}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],a.translateSelectedEditors,{args:[0,-v],checker:p}],[["ArrowDown","mac+ArrowDown"],a.translateSelectedEditors,{args:[0,m],checker:p}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],a.translateSelectedEditors,{args:[0,v],checker:p}]]))}constructor(a,p,m,v,k,T){this.#w=a,this.#N=p,this.#s=m,this._eventBus=v,this._eventBus._on("editingaction",this.#O),this._eventBus._on("pagechanging",this.#v),this._eventBus._on("scalechanging",this.#I),this._eventBus._on("rotationchanging",this.#R),this.#o=k.annotationStorage,this.#d=k.filterFactory,this.#b=T,this.viewParameters={realScale:i.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#k(),this.#j(),this._eventBus._off("editingaction",this.#O),this._eventBus._off("pagechanging",this.#v),this._eventBus._off("scalechanging",this.#I),this._eventBus._off("rotationchanging",this.#R);for(let a of this.#i.values())a.destroy();this.#i.clear(),this.#e.clear(),this.#p.clear(),this.#t=null,this.#h.clear(),this.#a.destroy(),this.#s.destroy()}get hcmFilter(){return(0,e.shadow)(this,"hcmFilter",this.#b?this.#d.addHCMFilter(this.#b.foreground,this.#b.background):"none")}get direction(){return(0,e.shadow)(this,"direction",getComputedStyle(this.#w).direction)}editAltText(a){this.#s?.editAltText(this,a)}onPageChanging({pageNumber:a}){this.#r=a-1}focusMainContainer(){this.#w.focus()}findParent(a,p){for(let m of this.#i.values()){let{x:v,y:k,width:T,height:b}=m.div.getBoundingClientRect();if(a>=v&&a<=v+T&&p>=k&&p<=k+b)return m}return null}disableUserSelect(a=!1){this.#N.classList.toggle("noUserSelect",a)}addShouldRescale(a){this.#p.add(a)}removeShouldRescale(a){this.#p.delete(a)}onScaleChanging({scale:a}){this.commitOrRemove(),this.viewParameters.realScale=a*i.PixelsPerInch.PDF_TO_CSS_UNITS;for(let p of this.#p)p.onScaleChanging()}onRotationChanging({pagesRotation:a}){this.commitOrRemove(),this.viewParameters.rotation=a}addToAnnotationStorage(a){!a.isEmpty()&&this.#o&&!this.#o.has(a.id)&&this.#o.setValue(a.id,a)}#B(){window.addEventListener("focus",this.#S),window.addEventListener("blur",this.#E)}#j(){window.removeEventListener("focus",this.#S),window.removeEventListener("blur",this.#E)}blur(){if(!this.hasSelection)return;let{activeElement:a}=document;for(let p of this.#h)if(p.div.contains(a)){this.#m=[p,a],p._focusEventsAllowed=!1;break}}focus(){if(!this.#m)return;let[a,p]=this.#m;this.#m=null,p.addEventListener("focusin",()=>{a._focusEventsAllowed=!0},{once:!0}),p.focus()}#U(){window.addEventListener("keydown",this.#L,{capture:!0})}#k(){window.removeEventListener("keydown",this.#L,{capture:!0})}#M(){document.addEventListener("copy",this.#C),document.addEventListener("cut",this.#x),document.addEventListener("paste",this.#F)}#P(){document.removeEventListener("copy",this.#C),document.removeEventListener("cut",this.#x),document.removeEventListener("paste",this.#F)}addEditListeners(){this.#U(),this.#M()}removeEditListeners(){this.#k(),this.#P()}copy(a){if(a.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;let p=[];for(let m of this.#h){let v=m.serialize(!0);v&&p.push(v)}p.length!==0&&a.clipboardData.setData("application/pdfjs",JSON.stringify(p))}cut(a){this.copy(a),this.delete()}paste(a){a.preventDefault();let{clipboardData:p}=a;for(let k of p.items)for(let T of this.#n)if(T.isHandlingMimeForPasting(k.type)){T.paste(k,this.currentLayer);return}let m=p.getData("application/pdfjs");if(!m)return;try{m=JSON.parse(m)}catch(k){(0,e.warn)(`paste: "${k.message}".`);return}if(!Array.isArray(m))return;this.unselectAll();let v=this.currentLayer;try{let k=[];for(let w of m){let B=v.deserialize(w);if(!B)return;k.push(B)}let T=()=>{for(let w of k)this.#z(w);this.#G(k)},b=()=>{for(let w of k)w.remove()};this.addCommands({cmd:T,undo:b,mustExec:!0})}catch(k){(0,e.warn)(`paste: "${k.message}".`)}}keydown(a){this.getActive()?.shouldGetKeyboardEvents()||d._keyboardManager.exec(this,a)}onEditingAction(a){["undo","redo","delete","selectAll"].includes(a.name)&&this[a.name]()}#A(a){Object.entries(a).some(([m,v])=>this.#D[m]!==v)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#D,a)})}#H(a){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:a})}setEditingState(a){a?(this.#B(),this.#U(),this.#M(),this.#A({isEditing:this.#g!==e.AnnotationEditorType.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:this.#a.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#j(),this.#k(),this.#P(),this.#A({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(a){if(!this.#n){this.#n=a;for(let p of this.#n)this.#H(p.defaultPropertiesToUpdate)}}getId(){return this.#u.getId()}get currentLayer(){return this.#i.get(this.#r)}getLayer(a){return this.#i.get(a)}get currentPageIndex(){return this.#r}addLayer(a){this.#i.set(a.pageIndex,a),this.#f?a.enable():a.disable()}removeLayer(a){this.#i.delete(a.pageIndex)}updateMode(a,p=null){if(this.#g!==a){if(this.#g=a,a===e.AnnotationEditorType.NONE){this.setEditingState(!1),this.#X();return}this.setEditingState(!0),this.#V(),this.unselectAll();for(let m of this.#i.values())m.updateMode(a);if(p){for(let m of this.#e.values())if(m.annotationElementId===p){this.setSelected(m),m.enterInEditMode();break}}}}updateToolbar(a){a!==this.#g&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:a})}updateParams(a,p){if(this.#n){if(a===e.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(a);return}for(let m of this.#h)m.updateParams(a,p);for(let m of this.#n)m.updateDefaultParams(a,p)}}enableWaiting(a=!1){if(this.#_!==a){this.#_=a;for(let p of this.#i.values())a?p.disableClick():p.enableClick(),p.div.classList.toggle("waiting",a)}}#V(){if(!this.#f){this.#f=!0;for(let a of this.#i.values())a.enable()}}#X(){if(this.unselectAll(),this.#f){this.#f=!1;for(let a of this.#i.values())a.disable()}}getEditors(a){let p=[];for(let m of this.#e.values())m.pageIndex===a&&p.push(m);return p}getEditor(a){return this.#e.get(a)}addEditor(a){this.#e.set(a.id,a)}removeEditor(a){this.#e.delete(a.id),this.unselect(a),(!a.annotationElementId||!this.#l.has(a.annotationElementId))&&this.#o?.remove(a.id)}addDeletedAnnotationElement(a){this.#l.add(a.annotationElementId),a.deleted=!0}isDeletedAnnotationElement(a){return this.#l.has(a)}removeDeletedAnnotationElement(a){this.#l.delete(a.annotationElementId),a.deleted=!1}#z(a){let p=this.#i.get(a.pageIndex);p?p.addOrRebuild(a):this.addEditor(a)}setActiveEditor(a){this.#t!==a&&(this.#t=a,a&&this.#H(a.propertiesToUpdate))}toggleSelected(a){if(this.#h.has(a)){this.#h.delete(a),a.unselect(),this.#A({hasSelectedEditor:this.hasSelection});return}this.#h.add(a),a.select(),this.#H(a.propertiesToUpdate),this.#A({hasSelectedEditor:!0})}setSelected(a){for(let p of this.#h)p!==a&&p.unselect();this.#h.clear(),this.#h.add(a),a.select(),this.#H(a.propertiesToUpdate),this.#A({hasSelectedEditor:!0})}isSelected(a){return this.#h.has(a)}unselect(a){a.unselect(),this.#h.delete(a),this.#A({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#h.size!==0}undo(){this.#a.undo(),this.#A({hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()})}redo(){this.#a.redo(),this.#A({hasSomethingToUndo:!0,hasSomethingToRedo:this.#a.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(a){this.#a.add(a),this.#A({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}#W(){if(this.#e.size===0)return!0;if(this.#e.size===1)for(let a of this.#e.values())return a.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;let a=[...this.#h],p=()=>{for(let v of a)v.remove()},m=()=>{for(let v of a)this.#z(v)};this.addCommands({cmd:p,undo:m,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#G(a){this.#h.clear();for(let p of a)p.isEmpty()||(this.#h.add(p),p.select());this.#A({hasSelectedEditor:!0})}selectAll(){for(let a of this.#h)a.commit();this.#G(this.#e.values())}unselectAll(){if(this.#t){this.#t.commitOrRemove();return}if(this.hasSelection){for(let a of this.#h)a.unselect();this.#h.clear(),this.#A({hasSelectedEditor:!1})}}translateSelectedEditors(a,p,m=!1){if(m||this.commitOrRemove(),!this.hasSelection)return;this.#y[0]+=a,this.#y[1]+=p;let[v,k]=this.#y,T=[...this.#h],b=1e3;this.#T&&clearTimeout(this.#T),this.#T=setTimeout(()=>{this.#T=null,this.#y[0]=this.#y[1]=0,this.addCommands({cmd:()=>{for(let w of T)this.#e.has(w.id)&&w.translateInPage(v,k)},undo:()=>{for(let w of T)this.#e.has(w.id)&&w.translateInPage(-v,-k)},mustExec:!1})},b);for(let w of T)w.translateInPage(a,p)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#c=new Map;for(let a of this.#h)this.#c.set(a,{savedX:a.x,savedY:a.y,savedPageIndex:a.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#c)return!1;this.disableUserSelect(!1);let a=this.#c;this.#c=null;let p=!1;for(let[{x:v,y:k,pageIndex:T},b]of a)b.newX=v,b.newY=k,b.newPageIndex=T,p||=v!==b.savedX||k!==b.savedY||T!==b.savedPageIndex;if(!p)return!1;let m=(v,k,T,b)=>{if(this.#e.has(v.id)){let w=this.#i.get(b);w?v._setParentAndPosition(w,k,T):(v.pageIndex=b,v.x=k,v.y=T)}};return this.addCommands({cmd:()=>{for(let[v,{newX:k,newY:T,newPageIndex:b}]of a)m(v,k,T,b)},undo:()=>{for(let[v,{savedX:k,savedY:T,savedPageIndex:b}]of a)m(v,k,T,b)},mustExec:!0}),!0}dragSelectedEditors(a,p){if(this.#c)for(let m of this.#c.keys())m.drag(a,p)}rebuild(a){if(a.parent===null){let p=this.getLayer(a.pageIndex);p?(p.changeParent(a),p.addOrRebuild(a)):(this.addEditor(a),this.addToAnnotationStorage(a),a.rebuild())}else a.parent.addOrRebuild(a)}isActive(a){return this.#t===a}getActive(){return this.#t}getMode(){return this.#g}get imageManager(){return(0,e.shadow)(this,"imageManager",new x)}}return d})();t.AnnotationEditorUIManager=r},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StatTimer=t.RenderingCancelledException=t.PixelsPerInch=t.PageViewport=t.PDFDateString=t.DOMStandardFontDataFactory=t.DOMSVGFactory=t.DOMFilterFactory=t.DOMCanvasFactory=t.DOMCMapReaderFactory=void 0,t.deprecated=B,t.getColorValues=it,t.getCurrentTransform=Q,t.getCurrentTransformInverse=J,t.getFilenameFromUrl=m,t.getPdfFilenameFromUrl=v,t.getRGB=V,t.getXfaPageViewport=z,t.isDataScheme=a,t.isPdfFile=p,t.isValidFetchUrl=T,t.loadScript=w,t.noContextMenu=b,t.setLayerDimensions=nt;var e=o(7),i=o(1);let u="http://www.w3.org/2000/svg";class _{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}t.PixelsPerInch=_;class C extends e.BaseFilterFactory{#t;#e;#i;#s;#o;#a;#r;#l;#c;#n;#p=0;constructor({docId:L,ownerDocument:S=globalThis.document}={}){super(),this.#i=L,this.#s=S}get#d(){return this.#t||=new Map}get#u(){if(!this.#e){let L=this.#s.createElement("div"),{style:S}=L;S.visibility="hidden",S.contain="strict",S.width=S.height=0,S.position="absolute",S.top=S.left=0,S.zIndex=-1;let f=this.#s.createElementNS(u,"svg");f.setAttribute("width",0),f.setAttribute("height",0),this.#e=this.#s.createElementNS(u,"defs"),L.append(f),f.append(this.#e),this.#s.body.append(L)}return this.#e}addFilter(L){if(!L)return"none";let S=this.#d.get(L);if(S)return S;let f,g,E,I;if(L.length===1){let l=L[0],y=new Array(256);for(let P=0;P<256;P++)y[P]=l[P]/255;I=f=g=E=y.join(",")}else{let[l,y,P]=L,D=new Array(256),M=new Array(256),j=new Array(256);for(let H=0;H<256;H++)D[H]=l[H]/255,M[H]=y[H]/255,j[H]=P[H]/255;f=D.join(","),g=M.join(","),E=j.join(","),I=`${f}${g}${E}`}if(S=this.#d.get(I),S)return this.#d.set(L,S),S;let F=`g_${this.#i}_transfer_map_${this.#p++}`,N=`url(#${F})`;this.#d.set(L,N),this.#d.set(I,N);let R=this.#_(F);return this.#g(f,g,E,R),N}addHCMFilter(L,S){let f=`${L}-${S}`;if(this.#a===f)return this.#r;if(this.#a=f,this.#r="none",this.#o?.remove(),!L||!S)return this.#r;let g=this.#h(L);L=i.Util.makeHexColor(...g);let E=this.#h(S);if(S=i.Util.makeHexColor(...E),this.#u.style.color="",L==="#000000"&&S==="#ffffff"||L===S)return this.#r;let I=new Array(256);for(let y=0;y<=255;y++){let P=y/255;I[y]=P<=.03928?P/12.92:((P+.055)/1.055)**2.4}let F=I.join(","),N=`g_${this.#i}_hcm_filter`,R=this.#l=this.#_(N);this.#g(F,F,F,R),this.#f(R);let l=(y,P)=>{let D=g[y]/255,M=E[y]/255,j=new Array(P+1);for(let H=0;H<=P;H++)j[H]=D+H/P*(M-D);return j.join(",")};return this.#g(l(0,5),l(1,5),l(2,5),R),this.#r=`url(#${N})`,this.#r}addHighlightHCMFilter(L,S,f,g){let E=`${L}-${S}-${f}-${g}`;if(this.#c===E)return this.#n;if(this.#c=E,this.#n="none",this.#l?.remove(),!L||!S)return this.#n;let[I,F]=[L,S].map(this.#h.bind(this)),N=Math.round(.2126*I[0]+.7152*I[1]+.0722*I[2]),R=Math.round(.2126*F[0]+.7152*F[1]+.0722*F[2]),[l,y]=[f,g].map(this.#h.bind(this));R<N&&([N,R,l,y]=[R,N,y,l]),this.#u.style.color="";let P=(j,H,X)=>{let st=new Array(256),q=(R-N)/X,$=j/255,Y=(H-j)/(255*X),K=0;for(let tt=0;tt<=X;tt++){let rt=Math.round(N+tt*q),ot=$+tt*Y;for(let lt=K;lt<=rt;lt++)st[lt]=ot;K=rt+1}for(let tt=K;tt<256;tt++)st[tt]=st[K-1];return st.join(",")},D=`g_${this.#i}_hcm_highlight_filter`,M=this.#l=this.#_(D);return this.#f(M),this.#g(P(l[0],y[0],5),P(l[1],y[1],5),P(l[2],y[2],5),M),this.#n=`url(#${D})`,this.#n}destroy(L=!1){L&&(this.#r||this.#n)||(this.#e&&(this.#e.parentNode.parentNode.remove(),this.#e=null),this.#t&&(this.#t.clear(),this.#t=null),this.#p=0)}#f(L){let S=this.#s.createElementNS(u,"feColorMatrix");S.setAttribute("type","matrix"),S.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),L.append(S)}#_(L){let S=this.#s.createElementNS(u,"filter");return S.setAttribute("color-interpolation-filters","sRGB"),S.setAttribute("id",L),this.#u.append(S),S}#m(L,S,f){let g=this.#s.createElementNS(u,S);g.setAttribute("type","discrete"),g.setAttribute("tableValues",f),L.append(g)}#g(L,S,f,g){let E=this.#s.createElementNS(u,"feComponentTransfer");g.append(E),this.#m(E,"feFuncR",L),this.#m(E,"feFuncG",S),this.#m(E,"feFuncB",f)}#h(L){return this.#u.style.color=L,V(getComputedStyle(this.#u).getPropertyValue("color"))}}t.DOMFilterFactory=C;class x extends e.BaseCanvasFactory{constructor({ownerDocument:L=globalThis.document}={}){super(),this._document=L}_createCanvas(L,S){let f=this._document.createElement("canvas");return f.width=L,f.height=S,f}}t.DOMCanvasFactory=x;function h(Z,L=!1){return ht(this,null,function*(){if(T(Z,document.baseURI)){let S=yield fetch(Z);if(!S.ok)throw new Error(S.statusText);return L?new Uint8Array(yield S.arrayBuffer()):(0,i.stringToBytes)(yield S.text())}return new Promise((S,f)=>{let g=new XMLHttpRequest;g.open("GET",Z,!0),L&&(g.responseType="arraybuffer"),g.onreadystatechange=()=>{if(g.readyState===XMLHttpRequest.DONE){if(g.status===200||g.status===0){let E;if(L&&g.response?E=new Uint8Array(g.response):!L&&g.responseText&&(E=(0,i.stringToBytes)(g.responseText)),E){S(E);return}}f(new Error(g.statusText))}},g.send(null)})})}class n extends e.BaseCMapReaderFactory{_fetchData(L,S){return h(L,this.isCompressed).then(f=>({cMapData:f,compressionType:S}))}}t.DOMCMapReaderFactory=n;class s extends e.BaseStandardFontDataFactory{_fetchData(L){return h(L,!0)}}t.DOMStandardFontDataFactory=s;class r extends e.BaseSVGFactory{_createSVG(L){return document.createElementNS(u,L)}}t.DOMSVGFactory=r;class d{constructor({viewBox:L,scale:S,rotation:f,offsetX:g=0,offsetY:E=0,dontFlip:I=!1}){this.viewBox=L,this.scale=S,this.rotation=f,this.offsetX=g,this.offsetY=E;let F=(L[2]+L[0])/2,N=(L[3]+L[1])/2,R,l,y,P;switch(f%=360,f<0&&(f+=360),f){case 180:R=-1,l=0,y=0,P=1;break;case 90:R=0,l=1,y=1,P=0;break;case 270:R=0,l=-1,y=-1,P=0;break;case 0:R=1,l=0,y=0,P=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}I&&(y=-y,P=-P);let D,M,j,H;R===0?(D=Math.abs(N-L[1])*S+g,M=Math.abs(F-L[0])*S+E,j=(L[3]-L[1])*S,H=(L[2]-L[0])*S):(D=Math.abs(F-L[0])*S+g,M=Math.abs(N-L[1])*S+E,j=(L[2]-L[0])*S,H=(L[3]-L[1])*S),this.transform=[R*S,l*S,y*S,P*S,D-R*S*F-y*S*N,M-l*S*F-P*S*N],this.width=j,this.height=H}get rawDims(){let{viewBox:L}=this;return(0,i.shadow)(this,"rawDims",{pageWidth:L[2]-L[0],pageHeight:L[3]-L[1],pageX:L[0],pageY:L[1]})}clone({scale:L=this.scale,rotation:S=this.rotation,offsetX:f=this.offsetX,offsetY:g=this.offsetY,dontFlip:E=!1}={}){return new d({viewBox:this.viewBox.slice(),scale:L,rotation:S,offsetX:f,offsetY:g,dontFlip:E})}convertToViewportPoint(L,S){return i.Util.applyTransform([L,S],this.transform)}convertToViewportRectangle(L){let S=i.Util.applyTransform([L[0],L[1]],this.transform),f=i.Util.applyTransform([L[2],L[3]],this.transform);return[S[0],S[1],f[0],f[1]]}convertToPdfPoint(L,S){return i.Util.applyInverseTransform([L,S],this.transform)}}t.PageViewport=d;class c extends i.BaseException{constructor(L,S=0){super(L,"RenderingCancelledException"),this.extraDelay=S}}t.RenderingCancelledException=c;function a(Z){let L=Z.length,S=0;for(;S<L&&Z[S].trim()==="";)S++;return Z.substring(S,S+5).toLowerCase()==="data:"}function p(Z){return typeof Z=="string"&&/\.pdf$/i.test(Z)}function m(Z,L=!1){return L||([Z]=Z.split(/[#?]/,1)),Z.substring(Z.lastIndexOf("/")+1)}function v(Z,L="document.pdf"){if(typeof Z!="string")return L;if(a(Z))return(0,i.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),L;let S=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,f=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,g=S.exec(Z),E=f.exec(g[1])||f.exec(g[2])||f.exec(g[3]);if(E&&(E=E[0],E.includes("%")))try{E=f.exec(decodeURIComponent(E))[0]}catch{}return E||L}class k{started=Object.create(null);times=[];time(L){L in this.started&&(0,i.warn)(`Timer is already running for ${L}`),this.started[L]=Date.now()}timeEnd(L){L in this.started||(0,i.warn)(`Timer has not been started for ${L}`),this.times.push({name:L,start:this.started[L],end:Date.now()}),delete this.started[L]}toString(){let L=[],S=0;for(let{name:f}of this.times)S=Math.max(f.length,S);for(let{name:f,start:g,end:E}of this.times)L.push(`${f.padEnd(S)} ${E-g}ms
`);return L.join("")}}t.StatTimer=k;function T(Z,L){try{let{protocol:S}=L?new URL(Z,L):new URL(Z);return S==="http:"||S==="https:"}catch{return!1}}function b(Z){Z.preventDefault()}function w(Z,L=!1){return new Promise((S,f)=>{let g=document.createElement("script");g.src=Z,g.onload=function(E){L&&g.remove(),S(E)},g.onerror=function(){f(new Error(`Cannot load script at: ${g.src}`))},(document.head||document.documentElement).append(g)})}function B(Z){console.log("Deprecated API usage: "+Z)}let U;class O{static toDateObject(L){if(!L||typeof L!="string")return null;U||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");let S=U.exec(L);if(!S)return null;let f=parseInt(S[1],10),g=parseInt(S[2],10);g=g>=1&&g<=12?g-1:0;let E=parseInt(S[3],10);E=E>=1&&E<=31?E:1;let I=parseInt(S[4],10);I=I>=0&&I<=23?I:0;let F=parseInt(S[5],10);F=F>=0&&F<=59?F:0;let N=parseInt(S[6],10);N=N>=0&&N<=59?N:0;let R=S[7]||"Z",l=parseInt(S[8],10);l=l>=0&&l<=23?l:0;let y=parseInt(S[9],10)||0;return y=y>=0&&y<=59?y:0,R==="-"?(I+=l,F+=y):R==="+"&&(I-=l,F-=y),new Date(Date.UTC(f,g,E,I,F,N))}}t.PDFDateString=O;function z(Z,{scale:L=1,rotation:S=0}){let{width:f,height:g}=Z.attributes.style,E=[0,0,parseInt(f),parseInt(g)];return new d({viewBox:E,scale:L,rotation:S})}function V(Z){if(Z.startsWith("#")){let L=parseInt(Z.slice(1),16);return[(L&16711680)>>16,(L&65280)>>8,L&255]}return Z.startsWith("rgb(")?Z.slice(4,-1).split(",").map(L=>parseInt(L)):Z.startsWith("rgba(")?Z.slice(5,-1).split(",").map(L=>parseInt(L)).slice(0,3):((0,i.warn)(`Not a valid color format: "${Z}"`),[0,0,0])}function it(Z){let L=document.createElement("span");L.style.visibility="hidden",document.body.append(L);for(let S of Z.keys()){L.style.color=S;let f=window.getComputedStyle(L).color;Z.set(S,V(f))}L.remove()}function Q(Z){let{a:L,b:S,c:f,d:g,e:E,f:I}=Z.getTransform();return[L,S,f,g,E,I]}function J(Z){let{a:L,b:S,c:f,d:g,e:E,f:I}=Z.getTransform().invertSelf();return[L,S,f,g,E,I]}function nt(Z,L,S=!1,f=!0){if(L instanceof d){let{pageWidth:g,pageHeight:E}=L.rawDims,{style:I}=Z,F=i.FeatureTest.isCSSRoundSupported,N=`var(--scale-factor) * ${g}px`,R=`var(--scale-factor) * ${E}px`,l=F?`round(${N}, 1px)`:`calc(${N})`,y=F?`round(${R}, 1px)`:`calc(${R})`;!S||L.rotation%180===0?(I.width=l,I.height=y):(I.width=y,I.height=l)}f&&Z.setAttribute("data-main-rotation",L.rotation)}},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStandardFontDataFactory=t.BaseSVGFactory=t.BaseFilterFactory=t.BaseCanvasFactory=t.BaseCMapReaderFactory=void 0;var e=o(1);class i{constructor(){this.constructor===i&&(0,e.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(n){return"none"}addHCMFilter(n,s){return"none"}addHighlightHCMFilter(n,s,r,d){return"none"}destroy(n=!1){}}t.BaseFilterFactory=i;class u{constructor(){this.constructor===u&&(0,e.unreachable)("Cannot initialize BaseCanvasFactory.")}create(n,s){if(n<=0||s<=0)throw new Error("Invalid canvas size");let r=this._createCanvas(n,s);return{canvas:r,context:r.getContext("2d")}}reset(n,s,r){if(!n.canvas)throw new Error("Canvas is not specified");if(s<=0||r<=0)throw new Error("Invalid canvas size");n.canvas.width=s,n.canvas.height=r}destroy(n){if(!n.canvas)throw new Error("Canvas is not specified");n.canvas.width=0,n.canvas.height=0,n.canvas=null,n.context=null}_createCanvas(n,s){(0,e.unreachable)("Abstract method `_createCanvas` called.")}}t.BaseCanvasFactory=u;class _{constructor({baseUrl:n=null,isCompressed:s=!0}){this.constructor===_&&(0,e.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=n,this.isCompressed=s}fetch(s){return ht(this,arguments,function*({name:n}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!n)throw new Error("CMap name must be specified.");let r=this.baseUrl+n+(this.isCompressed?".bcmap":""),d=this.isCompressed?e.CMapCompressionType.BINARY:e.CMapCompressionType.NONE;return this._fetchData(r,d).catch(c=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${r}`)})})}_fetchData(n,s){(0,e.unreachable)("Abstract method `_fetchData` called.")}}t.BaseCMapReaderFactory=_;class C{constructor({baseUrl:n=null}){this.constructor===C&&(0,e.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=n}fetch(s){return ht(this,arguments,function*({filename:n}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!n)throw new Error("Font filename must be specified.");let r=`${this.baseUrl}${n}`;return this._fetchData(r).catch(d=>{throw new Error(`Unable to load font data at: ${r}`)})})}_fetchData(n){(0,e.unreachable)("Abstract method `_fetchData` called.")}}t.BaseStandardFontDataFactory=C;class x{constructor(){this.constructor===x&&(0,e.unreachable)("Cannot initialize BaseSVGFactory.")}create(n,s,r=!1){if(n<=0||s<=0)throw new Error("Invalid SVG dimensions");let d=this._createSVG("svg:svg");return d.setAttribute("version","1.1"),r||(d.setAttribute("width",`${n}px`),d.setAttribute("height",`${s}px`)),d.setAttribute("preserveAspectRatio","none"),d.setAttribute("viewBox",`0 0 ${n} ${s}`),d}createElement(n){if(typeof n!="string")throw new Error("Invalid SVG element type");return this._createSVG(n)}_createSVG(n){(0,e.unreachable)("Abstract method `_createSVG` called.")}}t.BaseSVGFactory=x},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MurmurHash3_64=void 0;var e=o(1);let i=3285377520,u=4294901760,_=65535;class C{constructor(h){this.h1=h?h&4294967295:i,this.h2=h?h&4294967295:i}update(h){let n,s;if(typeof h=="string"){n=new Uint8Array(h.length*2),s=0;for(let B=0,U=h.length;B<U;B++){let O=h.charCodeAt(B);O<=255?n[s++]=O:(n[s++]=O>>>8,n[s++]=O&255)}}else if((0,e.isArrayBuffer)(h))n=h.slice(),s=n.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");let r=s>>2,d=s-r*4,c=new Uint32Array(n.buffer,0,r),a=0,p=0,m=this.h1,v=this.h2,k=3432918353,T=461845907,b=k&_,w=T&_;for(let B=0;B<r;B++)B&1?(a=c[B],a=a*k&u|a*b&_,a=a<<15|a>>>17,a=a*T&u|a*w&_,m^=a,m=m<<13|m>>>19,m=m*5+3864292196):(p=c[B],p=p*k&u|p*b&_,p=p<<15|p>>>17,p=p*T&u|p*w&_,v^=p,v=v<<13|v>>>19,v=v*5+3864292196);switch(a=0,d){case 3:a^=n[r*4+2]<<16;case 2:a^=n[r*4+1]<<8;case 1:a^=n[r*4],a=a*k&u|a*b&_,a=a<<15|a>>>17,a=a*T&u|a*w&_,r&1?m^=a:v^=a}this.h1=m,this.h2=v}hexdigest(){let h=this.h1,n=this.h2;return h^=n>>>1,h=h*3981806797&u|h*36045&_,n=n*4283543511&u|((n<<16|h>>>16)*2950163797&u)>>>16,h^=n>>>1,h=h*444984403&u|h*60499&_,n=n*3301882366&u|((n<<16|h>>>16)*3120437893&u)>>>16,h^=n>>>1,(h>>>0).toString(16).padStart(8,"0")+(n>>>0).toString(16).padStart(8,"0")}}t.MurmurHash3_64=C},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var e=o(1);class i{#t=new Set;constructor({ownerDocument:C=globalThis.document,styleElement:x=null}){this._document=C,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(C){this.nativeFontFaces.add(C),this._document.fonts.add(C)}removeNativeFontFace(C){this.nativeFontFaces.delete(C),this._document.fonts.delete(C)}insertRule(C){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));let x=this.styleElement.sheet;x.insertRule(C,x.cssRules.length)}clear(){for(let C of this.nativeFontFaces)this._document.fonts.delete(C);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}loadSystemFont(C){return ht(this,null,function*(){if(!(!C||this.#t.has(C.loadedName))){if((0,e.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){let{loadedName:x,src:h,style:n}=C,s=new FontFace(x,h,n);this.addNativeFontFace(s);try{yield s.load(),this.#t.add(x)}catch{(0,e.warn)(`Cannot load system font: ${C.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(s)}return}(0,e.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}})}bind(C){return ht(this,null,function*(){if(C.attached||C.missingFile&&!C.systemFontInfo)return;if(C.attached=!0,C.systemFontInfo){yield this.loadSystemFont(C.systemFontInfo);return}if(this.isFontLoadingAPISupported){let h=C.createNativeFontFace();if(h){this.addNativeFontFace(h);try{yield h.loaded}catch(n){throw(0,e.warn)(`Failed to load font '${h.family}': '${n}'.`),C.disableFontFace=!0,n}}return}let x=C.createFontFaceRule();if(x){if(this.insertRule(x),this.isSyncFontLoadingSupported)return;yield new Promise(h=>{let n=this._queueLoadingCallback(h);this._prepareFontLoadEvent(C,n)})}})}get isFontLoadingAPISupported(){let C=!!this._document?.fonts;return(0,e.shadow)(this,"isFontLoadingAPISupported",C)}get isSyncFontLoadingSupported(){let C=!1;return(e.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(C=!0),(0,e.shadow)(this,"isSyncFontLoadingSupported",C)}_queueLoadingCallback(C){function x(){for((0,e.assert)(!n.done,"completeRequest() cannot be called twice."),n.done=!0;h.length>0&&h[0].done;){let s=h.shift();setTimeout(s.callback,0)}}let{loadingRequests:h}=this,n={done:!1,complete:x,callback:C};return h.push(n),n}get _loadTestFont(){let C=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,e.shadow)(this,"_loadTestFont",C)}_prepareFontLoadEvent(C,x){function h(z,V){return z.charCodeAt(V)<<24|z.charCodeAt(V+1)<<16|z.charCodeAt(V+2)<<8|z.charCodeAt(V+3)&255}function n(z,V,it,Q){let J=z.substring(0,V),nt=z.substring(V+it);return J+Q+nt}let s,r,d=this._document.createElement("canvas");d.width=1,d.height=1;let c=d.getContext("2d"),a=0;function p(z,V){if(++a>30){(0,e.warn)("Load test font never loaded."),V();return}if(c.font="30px "+z,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){V();return}setTimeout(p.bind(null,z,V))}let m=`lt${Date.now()}${this.loadTestFontId++}`,v=this._loadTestFont;v=n(v,976,m.length,m);let T=16,b=1482184792,w=h(v,T);for(s=0,r=m.length-3;s<r;s+=4)w=w-b+h(m,s)|0;s<m.length&&(w=w-b+h(m+"XXX",s)|0),v=n(v,T,4,(0,e.string32)(w));let B=`url(data:font/opentype;base64,${btoa(v)});`,U=`@font-face {font-family:"${m}";src:${B}}`;this.insertRule(U);let O=this._document.createElement("div");O.style.visibility="hidden",O.style.width=O.style.height="10px",O.style.position="absolute",O.style.top=O.style.left="0px";for(let z of[C.loadedName,m]){let V=this._document.createElement("span");V.textContent="Hi",V.style.fontFamily=z,O.append(V)}this._document.body.append(O),p(m,()=>{O.remove(),x.complete()})}}t.FontLoader=i;class u{constructor(C,{isEvalSupported:x=!0,disableFontFace:h=!1,ignoreErrors:n=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(let r in C)this[r]=C[r];this.isEvalSupported=x!==!1,this.disableFontFace=h===!0,this.ignoreErrors=n===!0,this._inspectFont=s}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let C;if(!this.cssFontInfo)C=new FontFace(this.loadedName,this.data,{});else{let x={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(x.style=`oblique ${this.cssFontInfo.italicAngle}deg`),C=new FontFace(this.cssFontInfo.fontFamily,this.data,x)}return this._inspectFont?.(this),C}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;let C=(0,e.bytesToString)(this.data),x=`url(data:${this.mimetype};base64,${btoa(C)});`,h;if(!this.cssFontInfo)h=`@font-face {font-family:"${this.loadedName}";src:${x}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),h=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${x}}`}return this._inspectFont?.(this,x),h}getPathGenerator(C,x){if(this.compiledGlyphs[x]!==void 0)return this.compiledGlyphs[x];let h;try{h=C.get(this.loadedName+"_path_"+x)}catch(n){if(!this.ignoreErrors)throw n;return(0,e.warn)(`getPathGenerator - ignoring character: "${n}".`),this.compiledGlyphs[x]=function(s,r){}}if(this.isEvalSupported&&e.FeatureTest.isEvalSupported){let n=[];for(let s of h){let r=s.args!==void 0?s.args.join(","):"";n.push("c.",s.cmd,"(",r,`);
`)}return this.compiledGlyphs[x]=new Function("c","size",n.join(""))}return this.compiledGlyphs[x]=function(n,s){for(let r of h)r.cmd==="scale"&&(r.args=[s,-s]),n[r.cmd].apply(n,r.args)}}}t.FontFaceObject=u},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeStandardFontDataFactory=t.NodeFilterFactory=t.NodeCanvasFactory=t.NodeCMapReaderFactory=void 0;var e=o(7),i=o(1);let u=function(n){return new Promise((s,r)=>{Ne().readFile(n,(c,a)=>{if(c||!a){r(new Error(c));return}s(new Uint8Array(a))})})};class _ extends e.BaseFilterFactory{}t.NodeFilterFactory=_;class C extends e.BaseCanvasFactory{_createCanvas(s,r){return Ls().createCanvas(s,r)}}t.NodeCanvasFactory=C;class x extends e.BaseCMapReaderFactory{_fetchData(s,r){return u(s).then(d=>({cMapData:d,compressionType:r}))}}t.NodeCMapReaderFactory=x;class h extends e.BaseStandardFontDataFactory{_fetchData(s){return u(s)}}t.NodeStandardFontDataFactory=h},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var e=o(1),i=o(6),u=o(12),_=o(13);let C=16,x=100,h=4096,n=15,s=10,r=1e3,d=16;function c(S,f){if(S._removeMirroring)throw new Error("Context is already forwarding operations.");S.__originalSave=S.save,S.__originalRestore=S.restore,S.__originalRotate=S.rotate,S.__originalScale=S.scale,S.__originalTranslate=S.translate,S.__originalTransform=S.transform,S.__originalSetTransform=S.setTransform,S.__originalResetTransform=S.resetTransform,S.__originalClip=S.clip,S.__originalMoveTo=S.moveTo,S.__originalLineTo=S.lineTo,S.__originalBezierCurveTo=S.bezierCurveTo,S.__originalRect=S.rect,S.__originalClosePath=S.closePath,S.__originalBeginPath=S.beginPath,S._removeMirroring=()=>{S.save=S.__originalSave,S.restore=S.__originalRestore,S.rotate=S.__originalRotate,S.scale=S.__originalScale,S.translate=S.__originalTranslate,S.transform=S.__originalTransform,S.setTransform=S.__originalSetTransform,S.resetTransform=S.__originalResetTransform,S.clip=S.__originalClip,S.moveTo=S.__originalMoveTo,S.lineTo=S.__originalLineTo,S.bezierCurveTo=S.__originalBezierCurveTo,S.rect=S.__originalRect,S.closePath=S.__originalClosePath,S.beginPath=S.__originalBeginPath,delete S._removeMirroring},S.save=function(){f.save(),this.__originalSave()},S.restore=function(){f.restore(),this.__originalRestore()},S.translate=function(E,I){f.translate(E,I),this.__originalTranslate(E,I)},S.scale=function(E,I){f.scale(E,I),this.__originalScale(E,I)},S.transform=function(E,I,F,N,R,l){f.transform(E,I,F,N,R,l),this.__originalTransform(E,I,F,N,R,l)},S.setTransform=function(E,I,F,N,R,l){f.setTransform(E,I,F,N,R,l),this.__originalSetTransform(E,I,F,N,R,l)},S.resetTransform=function(){f.resetTransform(),this.__originalResetTransform()},S.rotate=function(E){f.rotate(E),this.__originalRotate(E)},S.clip=function(E){f.clip(E),this.__originalClip(E)},S.moveTo=function(g,E){f.moveTo(g,E),this.__originalMoveTo(g,E)},S.lineTo=function(g,E){f.lineTo(g,E),this.__originalLineTo(g,E)},S.bezierCurveTo=function(g,E,I,F,N,R){f.bezierCurveTo(g,E,I,F,N,R),this.__originalBezierCurveTo(g,E,I,F,N,R)},S.rect=function(g,E,I,F){f.rect(g,E,I,F),this.__originalRect(g,E,I,F)},S.closePath=function(){f.closePath(),this.__originalClosePath()},S.beginPath=function(){f.beginPath(),this.__originalBeginPath()}}class a{constructor(f){this.canvasFactory=f,this.cache=Object.create(null)}getCanvas(f,g,E){let I;return this.cache[f]!==void 0?(I=this.cache[f],this.canvasFactory.reset(I,g,E)):(I=this.canvasFactory.create(g,E),this.cache[f]=I),I}delete(f){delete this.cache[f]}clear(){for(let f in this.cache){let g=this.cache[f];this.canvasFactory.destroy(g),delete this.cache[f]}}}function p(S,f,g,E,I,F,N,R,l,y){let[P,D,M,j,H,X]=(0,i.getCurrentTransform)(S);if(D===0&&M===0){let $=N*P+H,Y=Math.round($),K=R*j+X,tt=Math.round(K),rt=(N+l)*P+H,ot=Math.abs(Math.round(rt)-Y)||1,lt=(R+y)*j+X,ct=Math.abs(Math.round(lt)-tt)||1;return S.setTransform(Math.sign(P),0,0,Math.sign(j),Y,tt),S.drawImage(f,g,E,I,F,0,0,ot,ct),S.setTransform(P,D,M,j,H,X),[ot,ct]}if(P===0&&j===0){let $=R*M+H,Y=Math.round($),K=N*D+X,tt=Math.round(K),rt=(R+y)*M+H,ot=Math.abs(Math.round(rt)-Y)||1,lt=(N+l)*D+X,ct=Math.abs(Math.round(lt)-tt)||1;return S.setTransform(0,Math.sign(D),Math.sign(M),0,Y,tt),S.drawImage(f,g,E,I,F,0,0,ct,ot),S.setTransform(P,D,M,j,H,X),[ct,ot]}S.drawImage(f,g,E,I,F,N,R,l,y);let st=Math.hypot(P,D),q=Math.hypot(M,j);return[st*l,q*y]}function m(S){let{width:f,height:g}=S;if(f>r||g>r)return null;let E=1e3,I=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),F=f+1,N=new Uint8Array(F*(g+1)),R,l,y,P=f+7&-8,D=new Uint8Array(P*g),M=0;for(let q of S.data){let $=128;for(;$>0;)D[M++]=q&$?0:255,$>>=1}let j=0;for(M=0,D[M]!==0&&(N[0]=1,++j),l=1;l<f;l++)D[M]!==D[M+1]&&(N[l]=D[M]?2:1,++j),M++;for(D[M]!==0&&(N[l]=2,++j),R=1;R<g;R++){M=R*P,y=R*F,D[M-P]!==D[M]&&(N[y]=D[M]?1:8,++j);let q=(D[M]?4:0)+(D[M-P]?8:0);for(l=1;l<f;l++)q=(q>>2)+(D[M+1]?4:0)+(D[M-P+1]?8:0),I[q]&&(N[y+l]=I[q],++j),M++;if(D[M-P]!==D[M]&&(N[y+l]=D[M]?2:4,++j),j>E)return null}for(M=P*(g-1),y=R*F,D[M]!==0&&(N[y]=8,++j),l=1;l<f;l++)D[M]!==D[M+1]&&(N[y+l]=D[M]?4:8,++j),M++;if(D[M]!==0&&(N[y+l]=4,++j),j>E)return null;let H=new Int32Array([0,F,-1,0,-F,0,0,0,1]),X=new Path2D;for(R=0;j&&R<=g;R++){let q=R*F,$=q+f;for(;q<$&&!N[q];)q++;if(q===$)continue;X.moveTo(q%F,R);let Y=q,K=N[q];do{let tt=H[K];do q+=tt;while(!N[q]);let rt=N[q];rt!==5&&rt!==10?(K=rt,N[q]=0):(K=rt&51*K>>4,N[q]&=K>>2|K<<2),X.lineTo(q%F,q/F|0),N[q]||--j}while(Y!==q);--R}return D=null,N=null,function(q){q.save(),q.scale(1/f,-1/g),q.translate(0,-g),q.fill(X),q.beginPath(),q.restore()}}class v{constructor(f,g){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=e.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=e.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=e.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,f,g])}clone(){let f=Object.create(this);return f.clipBox=this.clipBox.slice(),f}setCurrentPoint(f,g){this.x=f,this.y=g}updatePathMinMax(f,g,E){[g,E]=e.Util.applyTransform([g,E],f),this.minX=Math.min(this.minX,g),this.minY=Math.min(this.minY,E),this.maxX=Math.max(this.maxX,g),this.maxY=Math.max(this.maxY,E)}updateRectMinMax(f,g){let E=e.Util.applyTransform(g,f),I=e.Util.applyTransform(g.slice(2),f);this.minX=Math.min(this.minX,E[0],I[0]),this.minY=Math.min(this.minY,E[1],I[1]),this.maxX=Math.max(this.maxX,E[0],I[0]),this.maxY=Math.max(this.maxY,E[1],I[1])}updateScalingPathMinMax(f,g){e.Util.scaleMinMax(f,g),this.minX=Math.min(this.minX,g[0]),this.maxX=Math.max(this.maxX,g[1]),this.minY=Math.min(this.minY,g[2]),this.maxY=Math.max(this.maxY,g[3])}updateCurvePathMinMax(f,g,E,I,F,N,R,l,y,P){let D=e.Util.bezierBoundingBox(g,E,I,F,N,R,l,y);if(P){P[0]=Math.min(P[0],D[0],D[2]),P[1]=Math.max(P[1],D[0],D[2]),P[2]=Math.min(P[2],D[1],D[3]),P[3]=Math.max(P[3],D[1],D[3]);return}this.updateRectMinMax(f,D)}getPathBoundingBox(f=u.PathType.FILL,g=null){let E=[this.minX,this.minY,this.maxX,this.maxY];if(f===u.PathType.STROKE){g||(0,e.unreachable)("Stroke bounding box must include transform.");let I=e.Util.singularValueDecompose2dScale(g),F=I[0]*this.lineWidth/2,N=I[1]*this.lineWidth/2;E[0]-=F,E[1]-=N,E[2]+=F,E[3]+=N}return E}updateClipFromPath(){let f=e.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(f||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(f){this.clipBox=f,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(f=u.PathType.FILL,g=null){return e.Util.intersect(this.clipBox,this.getPathBoundingBox(f,g))}}function k(S,f){if(typeof ImageData<"u"&&f instanceof ImageData){S.putImageData(f,0,0);return}let g=f.height,E=f.width,I=g%d,F=(g-I)/d,N=I===0?F:F+1,R=S.createImageData(E,d),l=0,y,P=f.data,D=R.data,M,j,H,X;if(f.kind===e.ImageKind.GRAYSCALE_1BPP){let st=P.byteLength,q=new Uint32Array(D.buffer,0,D.byteLength>>2),$=q.length,Y=E+7>>3,K=4294967295,tt=e.FeatureTest.isLittleEndian?4278190080:255;for(M=0;M<N;M++){for(H=M<F?d:I,y=0,j=0;j<H;j++){let rt=st-l,ot=0,lt=rt>Y?E:rt*8-7,ct=lt&-8,dt=0,pt=0;for(;ot<ct;ot+=8)pt=P[l++],q[y++]=pt&128?K:tt,q[y++]=pt&64?K:tt,q[y++]=pt&32?K:tt,q[y++]=pt&16?K:tt,q[y++]=pt&8?K:tt,q[y++]=pt&4?K:tt,q[y++]=pt&2?K:tt,q[y++]=pt&1?K:tt;for(;ot<lt;ot++)dt===0&&(pt=P[l++],dt=128),q[y++]=pt&dt?K:tt,dt>>=1}for(;y<$;)q[y++]=0;S.putImageData(R,0,M*d)}}else if(f.kind===e.ImageKind.RGBA_32BPP){for(j=0,X=E*d*4,M=0;M<F;M++)D.set(P.subarray(l,l+X)),l+=X,S.putImageData(R,0,j),j+=d;M<N&&(X=E*I*4,D.set(P.subarray(l,l+X)),S.putImageData(R,0,j))}else if(f.kind===e.ImageKind.RGB_24BPP)for(H=d,X=E*H,M=0;M<N;M++){for(M>=F&&(H=I,X=E*H),y=0,j=X;j--;)D[y++]=P[l++],D[y++]=P[l++],D[y++]=P[l++],D[y++]=255;S.putImageData(R,0,M*d)}else throw new Error(`bad image kind: ${f.kind}`)}function T(S,f){if(f.bitmap){S.drawImage(f.bitmap,0,0);return}let g=f.height,E=f.width,I=g%d,F=(g-I)/d,N=I===0?F:F+1,R=S.createImageData(E,d),l=0,y=f.data,P=R.data;for(let D=0;D<N;D++){let M=D<F?d:I;({srcPos:l}=(0,_.convertBlackAndWhiteToRGBA)({src:y,srcPos:l,dest:P,width:E,height:M,nonBlackColor:0})),S.putImageData(R,0,D*d)}}function b(S,f){let g=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(let E of g)S[E]!==void 0&&(f[E]=S[E]);S.setLineDash!==void 0&&(f.setLineDash(S.getLineDash()),f.lineDashOffset=S.lineDashOffset)}function w(S){if(S.strokeStyle=S.fillStyle="#000000",S.fillRule="nonzero",S.globalAlpha=1,S.lineWidth=1,S.lineCap="butt",S.lineJoin="miter",S.miterLimit=10,S.globalCompositeOperation="source-over",S.font="10px sans-serif",S.setLineDash!==void 0&&(S.setLineDash([]),S.lineDashOffset=0),!e.isNodeJS){let{filter:f}=S;f!=="none"&&f!==""&&(S.filter="none")}}function B(S,f,g,E){let I=S.length;for(let F=3;F<I;F+=4){let N=S[F];if(N===0)S[F-3]=f,S[F-2]=g,S[F-1]=E;else if(N<255){let R=255-N;S[F-3]=S[F-3]*N+f*R>>8,S[F-2]=S[F-2]*N+g*R>>8,S[F-1]=S[F-1]*N+E*R>>8}}}function U(S,f,g){let E=S.length,I=1/255;for(let F=3;F<E;F+=4){let N=g?g[S[F]]:S[F];f[F]=f[F]*N*I|0}}function O(S,f,g){let E=S.length;for(let I=3;I<E;I+=4){let F=S[I-3]*77+S[I-2]*152+S[I-1]*28;f[I]=g?f[I]*g[F>>8]>>8:f[I]*F>>16}}function z(S,f,g,E,I,F,N,R,l,y,P){let D=!!F,M=D?F[0]:0,j=D?F[1]:0,H=D?F[2]:0,X=I==="Luminosity"?O:U,q=Math.min(E,Math.ceil(1048576/g));for(let $=0;$<E;$+=q){let Y=Math.min(q,E-$),K=S.getImageData(R-y,$+(l-P),g,Y),tt=f.getImageData(R,$+l,g,Y);D&&B(K.data,M,j,H),X(K.data,tt.data,N),f.putImageData(tt,R,$+l)}}function V(S,f,g,E){let I=E[0],F=E[1],N=E[2]-I,R=E[3]-F;N===0||R===0||(z(f.context,g,N,R,f.subtype,f.backdrop,f.transferMap,I,F,f.offsetX,f.offsetY),S.save(),S.globalAlpha=1,S.globalCompositeOperation="source-over",S.setTransform(1,0,0,1,0,0),S.drawImage(g.canvas,0,0),S.restore())}function it(S,f){let g=e.Util.singularValueDecompose2dScale(S);g[0]=Math.fround(g[0]),g[1]=Math.fround(g[1]);let E=Math.fround((globalThis.devicePixelRatio||1)*i.PixelsPerInch.PDF_TO_CSS_UNITS);return f!==void 0?f:g[0]<=E||g[1]<=E}let Q=["butt","round","square"],J=["miter","round","bevel"],nt={},Z={};class L{constructor(f,g,E,I,F,{optionalContentConfig:N,markedContentStack:R=null},l,y){this.ctx=f,this.current=new v(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=g,this.objs=E,this.canvasFactory=I,this.filterFactory=F,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=R||[],this.optionalContentConfig=N,this.cachedCanvases=new a(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=y,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(f,g=null){return typeof f=="string"?f.startsWith("g_")?this.commonObjs.get(f):this.objs.get(f):g}beginDrawing({transform:f,viewport:g,transparency:E=!1,background:I=null}){let F=this.ctx.canvas.width,N=this.ctx.canvas.height,R=this.ctx.fillStyle;if(this.ctx.fillStyle=I||"#ffffff",this.ctx.fillRect(0,0,F,N),this.ctx.fillStyle=R,E){let l=this.cachedCanvases.getCanvas("transparent",F,N);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...(0,i.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),w(this.ctx),f&&(this.ctx.transform(...f),this.outputScaleX=f[0],this.outputScaleY=f[0]),this.ctx.transform(...g.transform),this.viewportScale=g.scale,this.baseTransform=(0,i.getCurrentTransform)(this.ctx)}executeOperatorList(f,g,E,I){let F=f.argsArray,N=f.fnArray,R=g||0,l=F.length;if(l===R)return R;let y=l-R>s&&typeof E=="function",P=y?Date.now()+n:0,D=0,M=this.commonObjs,j=this.objs,H;for(;;){if(I!==void 0&&R===I.nextBreakPoint)return I.breakIt(R,E),R;if(H=N[R],H!==e.OPS.dependency)this[H].apply(this,F[R]);else for(let X of F[R]){let st=X.startsWith("g_")?M:j;if(!st.has(X))return st.get(X,E),R}if(R++,R===l)return R;if(y&&++D>s){if(Date.now()>P)return E(),R;D=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(let f of this._cachedBitmapsMap.values()){for(let g of f.values())typeof HTMLCanvasElement<"u"&&g instanceof HTMLCanvasElement&&(g.width=g.height=0);f.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){let f=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(f!=="none"){let g=this.ctx.filter;this.ctx.filter=f,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=g}}}_scaleImage(f,g){let E=f.width,I=f.height,F=Math.max(Math.hypot(g[0],g[1]),1),N=Math.max(Math.hypot(g[2],g[3]),1),R=E,l=I,y="prescale1",P,D;for(;F>2&&R>1||N>2&&l>1;){let M=R,j=l;F>2&&R>1&&(M=R>=16384?Math.floor(R/2)-1||1:Math.ceil(R/2),F/=R/M),N>2&&l>1&&(j=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,N/=l/j),P=this.cachedCanvases.getCanvas(y,M,j),D=P.context,D.clearRect(0,0,M,j),D.drawImage(f,0,0,R,l,0,0,M,j),f=P.canvas,R=M,l=j,y=y==="prescale1"?"prescale2":"prescale1"}return{img:f,paintWidth:R,paintHeight:l}}_createMaskCanvas(f){let g=this.ctx,{width:E,height:I}=f,F=this.current.fillColor,N=this.current.patternFill,R=(0,i.getCurrentTransform)(g),l,y,P,D;if((f.bitmap||f.data)&&f.count>1){let ot=f.bitmap||f.data.buffer;y=JSON.stringify(N?R:[R.slice(0,4),F]),l=this._cachedBitmapsMap.get(ot),l||(l=new Map,this._cachedBitmapsMap.set(ot,l));let lt=l.get(y);if(lt&&!N){let ct=Math.round(Math.min(R[0],R[2])+R[4]),dt=Math.round(Math.min(R[1],R[3])+R[5]);return{canvas:lt,offsetX:ct,offsetY:dt}}P=lt}P||(D=this.cachedCanvases.getCanvas("maskCanvas",E,I),T(D.context,f));let M=e.Util.transform(R,[1/E,0,0,-1/I,0,0]);M=e.Util.transform(M,[1,0,0,1,0,-I]);let j=e.Util.applyTransform([0,0],M),H=e.Util.applyTransform([E,I],M),X=e.Util.normalizeRect([j[0],j[1],H[0],H[1]]),st=Math.round(X[2]-X[0])||1,q=Math.round(X[3]-X[1])||1,$=this.cachedCanvases.getCanvas("fillCanvas",st,q),Y=$.context,K=Math.min(j[0],H[0]),tt=Math.min(j[1],H[1]);Y.translate(-K,-tt),Y.transform(...M),P||(P=this._scaleImage(D.canvas,(0,i.getCurrentTransformInverse)(Y)),P=P.img,l&&N&&l.set(y,P)),Y.imageSmoothingEnabled=it((0,i.getCurrentTransform)(Y),f.interpolate),p(Y,P,0,0,P.width,P.height,0,0,E,I),Y.globalCompositeOperation="source-in";let rt=e.Util.transform((0,i.getCurrentTransformInverse)(Y),[1,0,0,1,-K,-tt]);return Y.fillStyle=N?F.getPattern(g,this,rt,u.PathType.FILL):F,Y.fillRect(0,0,E,I),l&&!N&&(this.cachedCanvases.delete("fillCanvas"),l.set(y,$.canvas)),{canvas:$.canvas,offsetX:Math.round(K),offsetY:Math.round(tt)}}setLineWidth(f){f!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=f,this.ctx.lineWidth=f}setLineCap(f){this.ctx.lineCap=Q[f]}setLineJoin(f){this.ctx.lineJoin=J[f]}setMiterLimit(f){this.ctx.miterLimit=f}setDash(f,g){let E=this.ctx;E.setLineDash!==void 0&&(E.setLineDash(f),E.lineDashOffset=g)}setRenderingIntent(f){}setFlatness(f){}setGState(f){for(let[g,E]of f)switch(g){case"LW":this.setLineWidth(E);break;case"LC":this.setLineCap(E);break;case"LJ":this.setLineJoin(E);break;case"ML":this.setMiterLimit(E);break;case"D":this.setDash(E[0],E[1]);break;case"RI":this.setRenderingIntent(E);break;case"FL":this.setFlatness(E);break;case"Font":this.setFont(E[0],E[1]);break;case"CA":this.current.strokeAlpha=E;break;case"ca":this.current.fillAlpha=E,this.ctx.globalAlpha=E;break;case"BM":this.ctx.globalCompositeOperation=E;break;case"SMask":this.current.activeSMask=E?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(E);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){let f=this.inSMaskMode;this.current.activeSMask&&!f?this.beginSMaskMode():!this.current.activeSMask&&f&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");let f=this.ctx.canvas.width,g=this.ctx.canvas.height,E="smaskGroupAt"+this.groupLevel,I=this.cachedCanvases.getCanvas(E,f,g);this.suspendedCtx=this.ctx,this.ctx=I.context;let F=this.ctx;F.setTransform(...(0,i.getCurrentTransform)(this.suspendedCtx)),b(this.suspendedCtx,F),c(F,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),b(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(f){if(!this.current.activeSMask)return;f?(f[0]=Math.floor(f[0]),f[1]=Math.floor(f[1]),f[2]=Math.ceil(f[2]),f[3]=Math.ceil(f[3])):f=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];let g=this.current.activeSMask,E=this.suspendedCtx;V(E,g,this.ctx,f),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(b(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();let f=this.current;this.stateStack.push(f),this.current=f.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),b(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(f,g,E,I,F,N){this.ctx.transform(f,g,E,I,F,N),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(f,g,E){let I=this.ctx,F=this.current,N=F.x,R=F.y,l,y,P=(0,i.getCurrentTransform)(I),D=P[0]===0&&P[3]===0||P[1]===0&&P[2]===0,M=D?E.slice(0):null;for(let j=0,H=0,X=f.length;j<X;j++)switch(f[j]|0){case e.OPS.rectangle:N=g[H++],R=g[H++];let st=g[H++],q=g[H++],$=N+st,Y=R+q;I.moveTo(N,R),st===0||q===0?I.lineTo($,Y):(I.lineTo($,R),I.lineTo($,Y),I.lineTo(N,Y)),D||F.updateRectMinMax(P,[N,R,$,Y]),I.closePath();break;case e.OPS.moveTo:N=g[H++],R=g[H++],I.moveTo(N,R),D||F.updatePathMinMax(P,N,R);break;case e.OPS.lineTo:N=g[H++],R=g[H++],I.lineTo(N,R),D||F.updatePathMinMax(P,N,R);break;case e.OPS.curveTo:l=N,y=R,N=g[H+4],R=g[H+5],I.bezierCurveTo(g[H],g[H+1],g[H+2],g[H+3],N,R),F.updateCurvePathMinMax(P,l,y,g[H],g[H+1],g[H+2],g[H+3],N,R,M),H+=6;break;case e.OPS.curveTo2:l=N,y=R,I.bezierCurveTo(N,R,g[H],g[H+1],g[H+2],g[H+3]),F.updateCurvePathMinMax(P,l,y,N,R,g[H],g[H+1],g[H+2],g[H+3],M),N=g[H+2],R=g[H+3],H+=4;break;case e.OPS.curveTo3:l=N,y=R,N=g[H+2],R=g[H+3],I.bezierCurveTo(g[H],g[H+1],N,R,N,R),F.updateCurvePathMinMax(P,l,y,g[H],g[H+1],N,R,N,R,M),H+=4;break;case e.OPS.closePath:I.closePath();break}D&&F.updateScalingPathMinMax(P,M),F.setCurrentPoint(N,R)}closePath(){this.ctx.closePath()}stroke(f=!0){let g=this.ctx,E=this.current.strokeColor;g.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof E=="object"&&E?.getPattern?(g.save(),g.strokeStyle=E.getPattern(g,this,(0,i.getCurrentTransformInverse)(g),u.PathType.STROKE),this.rescaleAndStroke(!1),g.restore()):this.rescaleAndStroke(!0)),f&&this.consumePath(this.current.getClippedPathBoundingBox()),g.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(f=!0){let g=this.ctx,E=this.current.fillColor,I=this.current.patternFill,F=!1;I&&(g.save(),g.fillStyle=E.getPattern(g,this,(0,i.getCurrentTransformInverse)(g),u.PathType.FILL),F=!0);let N=this.current.getClippedPathBoundingBox();this.contentVisible&&N!==null&&(this.pendingEOFill?(g.fill("evenodd"),this.pendingEOFill=!1):g.fill()),F&&g.restore(),f&&this.consumePath(N)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=nt}eoClip(){this.pendingClip=Z}beginText(){this.current.textMatrix=e.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){let f=this.pendingTextPaths,g=this.ctx;if(f===void 0){g.beginPath();return}g.save(),g.beginPath();for(let E of f)g.setTransform(...E.transform),g.translate(E.x,E.y),E.addToPath(g,E.fontSize);g.restore(),g.clip(),g.beginPath(),delete this.pendingTextPaths}setCharSpacing(f){this.current.charSpacing=f}setWordSpacing(f){this.current.wordSpacing=f}setHScale(f){this.current.textHScale=f/100}setLeading(f){this.current.leading=-f}setFont(f,g){let E=this.commonObjs.get(f),I=this.current;if(!E)throw new Error(`Can't find font for ${f}`);if(I.fontMatrix=E.fontMatrix||e.FONT_IDENTITY_MATRIX,(I.fontMatrix[0]===0||I.fontMatrix[3]===0)&&(0,e.warn)("Invalid font matrix for font "+f),g<0?(g=-g,I.fontDirection=-1):I.fontDirection=1,this.current.font=E,this.current.fontSize=g,E.isType3Font)return;let F=E.loadedName||"sans-serif",N=E.systemFontInfo?.css||`"${F}", ${E.fallbackName}`,R="normal";E.black?R="900":E.bold&&(R="bold");let l=E.italic?"italic":"normal",y=g;g<C?y=C:g>x&&(y=x),this.current.fontSizeScale=g/y,this.ctx.font=`${l} ${R} ${y}px ${N}`}setTextRenderingMode(f){this.current.textRenderingMode=f}setTextRise(f){this.current.textRise=f}moveText(f,g){this.current.x=this.current.lineX+=f,this.current.y=this.current.lineY+=g}setLeadingMoveText(f,g){this.setLeading(-g),this.moveText(f,g)}setTextMatrix(f,g,E,I,F,N){this.current.textMatrix=[f,g,E,I,F,N],this.current.textMatrixScale=Math.hypot(f,g),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(f,g,E,I){let F=this.ctx,N=this.current,R=N.font,l=N.textRenderingMode,y=N.fontSize/N.fontSizeScale,P=l&e.TextRenderingMode.FILL_STROKE_MASK,D=!!(l&e.TextRenderingMode.ADD_TO_PATH_FLAG),M=N.patternFill&&!R.missingFile,j;(R.disableFontFace||D||M)&&(j=R.getPathGenerator(this.commonObjs,f)),R.disableFontFace||M?(F.save(),F.translate(g,E),F.beginPath(),j(F,y),I&&F.setTransform(...I),(P===e.TextRenderingMode.FILL||P===e.TextRenderingMode.FILL_STROKE)&&F.fill(),(P===e.TextRenderingMode.STROKE||P===e.TextRenderingMode.FILL_STROKE)&&F.stroke(),F.restore()):((P===e.TextRenderingMode.FILL||P===e.TextRenderingMode.FILL_STROKE)&&F.fillText(f,g,E),(P===e.TextRenderingMode.STROKE||P===e.TextRenderingMode.FILL_STROKE)&&F.strokeText(f,g,E)),D&&(this.pendingTextPaths||=[]).push({transform:(0,i.getCurrentTransform)(F),x:g,y:E,fontSize:y,addToPath:j})}get isFontSubpixelAAEnabled(){let{context:f}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);f.scale(1.5,1),f.fillText("I",0,10);let g=f.getImageData(0,0,10,10).data,E=!1;for(let I=3;I<g.length;I+=4)if(g[I]>0&&g[I]<255){E=!0;break}return(0,e.shadow)(this,"isFontSubpixelAAEnabled",E)}showText(f){let g=this.current,E=g.font;if(E.isType3Font)return this.showType3Text(f);let I=g.fontSize;if(I===0)return;let F=this.ctx,N=g.fontSizeScale,R=g.charSpacing,l=g.wordSpacing,y=g.fontDirection,P=g.textHScale*y,D=f.length,M=E.vertical,j=M?1:-1,H=E.defaultVMetrics,X=I*g.fontMatrix[0],st=g.textRenderingMode===e.TextRenderingMode.FILL&&!E.disableFontFace&&!g.patternFill;F.save(),F.transform(...g.textMatrix),F.translate(g.x,g.y+g.textRise),y>0?F.scale(P,-1):F.scale(P,1);let q;if(g.patternFill){F.save();let rt=g.fillColor.getPattern(F,this,(0,i.getCurrentTransformInverse)(F),u.PathType.FILL);q=(0,i.getCurrentTransform)(F),F.restore(),F.fillStyle=rt}let $=g.lineWidth,Y=g.textMatrixScale;if(Y===0||$===0){let rt=g.textRenderingMode&e.TextRenderingMode.FILL_STROKE_MASK;(rt===e.TextRenderingMode.STROKE||rt===e.TextRenderingMode.FILL_STROKE)&&($=this.getSinglePixelWidth())}else $/=Y;if(N!==1&&(F.scale(N,N),$/=N),F.lineWidth=$,E.isInvalidPDFjsFont){let rt=[],ot=0;for(let lt of f)rt.push(lt.unicode),ot+=lt.width;F.fillText(rt.join(""),0,0),g.x+=ot*X*P,F.restore(),this.compose();return}let K=0,tt;for(tt=0;tt<D;++tt){let rt=f[tt];if(typeof rt=="number"){K+=j*rt*I/1e3;continue}let ot=!1,lt=(rt.isSpace?l:0)+R,ct=rt.fontChar,dt=rt.accent,pt,Et,vt=rt.width;if(M){let yt=rt.vmetric||H,kt=-(rt.vmetric?yt[1]:vt*.5)*X,Be=yt[2]*X;vt=yt?-yt[0]:vt,pt=kt/N,Et=(K+Be)/N}else pt=K/N,Et=0;if(E.remeasure&&vt>0){let yt=F.measureText(ct).width*1e3/I*N;if(vt<yt&&this.isFontSubpixelAAEnabled){let kt=vt/yt;ot=!0,F.save(),F.scale(kt,1),pt/=kt}else vt!==yt&&(pt+=(vt-yt)/2e3*I/N)}if(this.contentVisible&&(rt.isInFont||E.missingFile)){if(st&&!dt)F.fillText(ct,pt,Et);else if(this.paintChar(ct,pt,Et,q),dt){let yt=pt+I*dt.offset.x/N,kt=Et-I*dt.offset.y/N;this.paintChar(dt.fontChar,yt,kt,q)}}let zt=M?vt*X-lt*y:vt*X+lt*y;K+=zt,ot&&F.restore()}M?g.y-=K:g.x+=K*P,F.restore(),this.compose()}showType3Text(f){let g=this.ctx,E=this.current,I=E.font,F=E.fontSize,N=E.fontDirection,R=I.vertical?1:-1,l=E.charSpacing,y=E.wordSpacing,P=E.textHScale*N,D=E.fontMatrix||e.FONT_IDENTITY_MATRIX,M=f.length,j=E.textRenderingMode===e.TextRenderingMode.INVISIBLE,H,X,st,q;if(!(j||F===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,g.save(),g.transform(...E.textMatrix),g.translate(E.x,E.y),g.scale(P,N),H=0;H<M;++H){if(X=f[H],typeof X=="number"){q=R*X*F/1e3,this.ctx.translate(q,0),E.x+=q*P;continue}let $=(X.isSpace?y:0)+l,Y=I.charProcOperatorList[X.operatorListId];if(!Y){(0,e.warn)(`Type3 character "${X.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=X,this.save(),g.scale(F,F),g.transform(...D),this.executeOperatorList(Y),this.restore()),st=e.Util.applyTransform([X.width,0],D)[0]*F+$,g.translate(st,0),E.x+=st*P}g.restore(),this.processingType3=null}}setCharWidth(f,g){}setCharWidthAndBounds(f,g,E,I,F,N){this.ctx.rect(E,I,F-E,N-I),this.ctx.clip(),this.endPath()}getColorN_Pattern(f){let g;if(f[0]==="TilingPattern"){let E=f[1],I=this.baseTransform||(0,i.getCurrentTransform)(this.ctx),F={createCanvasGraphics:N=>new L(N,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};g=new u.TilingPattern(f,E,this.ctx,F,I)}else g=this._getPattern(f[1],f[2]);return g}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(f,g,E){let I=e.Util.makeHexColor(f,g,E);this.ctx.strokeStyle=I,this.current.strokeColor=I}setFillRGBColor(f,g,E){let I=e.Util.makeHexColor(f,g,E);this.ctx.fillStyle=I,this.current.fillColor=I,this.current.patternFill=!1}_getPattern(f,g=null){let E;return this.cachedPatterns.has(f)?E=this.cachedPatterns.get(f):(E=(0,u.getShadingPattern)(this.getObject(f)),this.cachedPatterns.set(f,E)),g&&(E.matrix=g),E}shadingFill(f){if(!this.contentVisible)return;let g=this.ctx;this.save();let E=this._getPattern(f);g.fillStyle=E.getPattern(g,this,(0,i.getCurrentTransformInverse)(g),u.PathType.SHADING);let I=(0,i.getCurrentTransformInverse)(g);if(I){let{width:F,height:N}=g.canvas,[R,l,y,P]=e.Util.getAxialAlignedBoundingBox([0,0,F,N],I);this.ctx.fillRect(R,l,y-R,P-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,e.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,e.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(f,g){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(f)&&f.length===6&&this.transform(...f),this.baseTransform=(0,i.getCurrentTransform)(this.ctx),g)){let E=g[2]-g[0],I=g[3]-g[1];this.ctx.rect(g[0],g[1],E,I),this.current.updateRectMinMax((0,i.getCurrentTransform)(this.ctx),g),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(f){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);let g=this.ctx;f.isolated||(0,e.info)("TODO: Support non-isolated groups."),f.knockout&&(0,e.warn)("Knockout groups not supported.");let E=(0,i.getCurrentTransform)(g);if(f.matrix&&g.transform(...f.matrix),!f.bbox)throw new Error("Bounding box is required.");let I=e.Util.getAxialAlignedBoundingBox(f.bbox,(0,i.getCurrentTransform)(g)),F=[0,0,g.canvas.width,g.canvas.height];I=e.Util.intersect(I,F)||[0,0,0,0];let N=Math.floor(I[0]),R=Math.floor(I[1]),l=Math.max(Math.ceil(I[2])-N,1),y=Math.max(Math.ceil(I[3])-R,1),P=1,D=1;l>h&&(P=l/h,l=h),y>h&&(D=y/h,y=h),this.current.startNewPathAndClipBox([0,0,l,y]);let M="groupAt"+this.groupLevel;f.smask&&(M+="_smask_"+this.smaskCounter++%2);let j=this.cachedCanvases.getCanvas(M,l,y),H=j.context;H.scale(1/P,1/D),H.translate(-N,-R),H.transform(...E),f.smask?this.smaskStack.push({canvas:j.canvas,context:H,offsetX:N,offsetY:R,scaleX:P,scaleY:D,subtype:f.smask.subtype,backdrop:f.smask.backdrop,transferMap:f.smask.transferMap||null,startTransformInverse:null}):(g.setTransform(1,0,0,1,0,0),g.translate(N,R),g.scale(P,D),g.save()),b(g,H),this.ctx=H,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(g),this.groupLevel++}endGroup(f){if(!this.contentVisible)return;this.groupLevel--;let g=this.ctx,E=this.groupStack.pop();if(this.ctx=E,this.ctx.imageSmoothingEnabled=!1,f.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();let I=(0,i.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...I);let F=e.Util.getAxialAlignedBoundingBox([0,0,g.canvas.width,g.canvas.height],I);this.ctx.drawImage(g.canvas,0,0),this.ctx.restore(),this.compose(F)}}beginAnnotation(f,g,E,I,F){if(this.#t(),w(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(g)&&g.length===4){let N=g[2]-g[0],R=g[3]-g[1];if(F&&this.annotationCanvasMap){E=E.slice(),E[4]-=g[0],E[5]-=g[1],g=g.slice(),g[0]=g[1]=0,g[2]=N,g[3]=R;let[l,y]=e.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(this.ctx)),{viewportScale:P}=this,D=Math.ceil(N*this.outputScaleX*P),M=Math.ceil(R*this.outputScaleY*P);this.annotationCanvas=this.canvasFactory.create(D,M);let{canvas:j,context:H}=this.annotationCanvas;this.annotationCanvasMap.set(f,j),this.annotationCanvas.savedCtx=this.ctx,this.ctx=H,this.ctx.save(),this.ctx.setTransform(l,0,0,-y,0,R*y),w(this.ctx)}else w(this.ctx),this.ctx.rect(g[0],g[1],N,R),this.ctx.clip(),this.endPath()}this.current=new v(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...E),this.transform(...I)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(f){if(!this.contentVisible)return;let g=f.count;f=this.getObject(f.data,f),f.count=g;let E=this.ctx,I=this.processingType3;if(I&&(I.compiled===void 0&&(I.compiled=m(f)),I.compiled)){I.compiled(E);return}let F=this._createMaskCanvas(f),N=F.canvas;E.save(),E.setTransform(1,0,0,1,0,0),E.drawImage(N,F.offsetX,F.offsetY),E.restore(),this.compose()}paintImageMaskXObjectRepeat(f,g,E=0,I=0,F,N){if(!this.contentVisible)return;f=this.getObject(f.data,f);let R=this.ctx;R.save();let l=(0,i.getCurrentTransform)(R);R.transform(g,E,I,F,0,0);let y=this._createMaskCanvas(f);R.setTransform(1,0,0,1,y.offsetX-l[4],y.offsetY-l[5]);for(let P=0,D=N.length;P<D;P+=2){let M=e.Util.transform(l,[g,E,I,F,N[P],N[P+1]]),[j,H]=e.Util.applyTransform([0,0],M);R.drawImage(y.canvas,j,H)}R.restore(),this.compose()}paintImageMaskXObjectGroup(f){if(!this.contentVisible)return;let g=this.ctx,E=this.current.fillColor,I=this.current.patternFill;for(let F of f){let{data:N,width:R,height:l,transform:y}=F,P=this.cachedCanvases.getCanvas("maskCanvas",R,l),D=P.context;D.save();let M=this.getObject(N,F);T(D,M),D.globalCompositeOperation="source-in",D.fillStyle=I?E.getPattern(D,this,(0,i.getCurrentTransformInverse)(g),u.PathType.FILL):E,D.fillRect(0,0,R,l),D.restore(),g.save(),g.transform(...y),g.scale(1,-1),p(g,P.canvas,0,0,R,l,0,-1,1,1),g.restore()}this.compose()}paintImageXObject(f){if(!this.contentVisible)return;let g=this.getObject(f);if(!g){(0,e.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(g)}paintImageXObjectRepeat(f,g,E,I){if(!this.contentVisible)return;let F=this.getObject(f);if(!F){(0,e.warn)("Dependent image isn't ready yet");return}let N=F.width,R=F.height,l=[];for(let y=0,P=I.length;y<P;y+=2)l.push({transform:[g,0,0,E,I[y],I[y+1]],x:0,y:0,w:N,h:R});this.paintInlineImageXObjectGroup(F,l)}applyTransferMapsToCanvas(f){return this.current.transferMaps!=="none"&&(f.filter=this.current.transferMaps,f.drawImage(f.canvas,0,0),f.filter="none"),f.canvas}applyTransferMapsToBitmap(f){if(this.current.transferMaps==="none")return f.bitmap;let{bitmap:g,width:E,height:I}=f,F=this.cachedCanvases.getCanvas("inlineImage",E,I),N=F.context;return N.filter=this.current.transferMaps,N.drawImage(g,0,0),N.filter="none",F.canvas}paintInlineImageXObject(f){if(!this.contentVisible)return;let g=f.width,E=f.height,I=this.ctx;if(this.save(),!e.isNodeJS){let{filter:R}=I;R!=="none"&&R!==""&&(I.filter="none")}I.scale(1/g,-1/E);let F;if(f.bitmap)F=this.applyTransferMapsToBitmap(f);else if(typeof HTMLElement=="function"&&f instanceof HTMLElement||!f.data)F=f;else{let l=this.cachedCanvases.getCanvas("inlineImage",g,E).context;k(l,f),F=this.applyTransferMapsToCanvas(l)}let N=this._scaleImage(F,(0,i.getCurrentTransformInverse)(I));I.imageSmoothingEnabled=it((0,i.getCurrentTransform)(I),f.interpolate),p(I,N.img,0,0,N.paintWidth,N.paintHeight,0,-E,g,E),this.compose(),this.restore()}paintInlineImageXObjectGroup(f,g){if(!this.contentVisible)return;let E=this.ctx,I;if(f.bitmap)I=f.bitmap;else{let F=f.width,N=f.height,l=this.cachedCanvases.getCanvas("inlineImage",F,N).context;k(l,f),I=this.applyTransferMapsToCanvas(l)}for(let F of g)E.save(),E.transform(...F.transform),E.scale(1,-1),p(E,I,F.x,F.y,F.w,F.h,0,-1,1,1),E.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(f){}markPointProps(f,g){}beginMarkedContent(f){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(f,g){f==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(g)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(f){let g=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(f);let E=this.ctx;this.pendingClip&&(g||(this.pendingClip===Z?E.clip("evenodd"):E.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),E.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){let f=(0,i.getCurrentTransform)(this.ctx);if(f[1]===0&&f[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(f[0]),Math.abs(f[3]));else{let g=Math.abs(f[0]*f[3]-f[2]*f[1]),E=Math.hypot(f[0],f[2]),I=Math.hypot(f[1],f[3]);this._cachedGetSinglePixelWidth=Math.max(E,I)/g}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){let{lineWidth:f}=this.current,{a:g,b:E,c:I,d:F}=this.ctx.getTransform(),N,R;if(E===0&&I===0){let l=Math.abs(g),y=Math.abs(F);if(l===y)if(f===0)N=R=1/l;else{let P=l*f;N=R=P<1?1/P:1}else if(f===0)N=1/l,R=1/y;else{let P=l*f,D=y*f;N=P<1?1/P:1,R=D<1?1/D:1}}else{let l=Math.abs(g*F-E*I),y=Math.hypot(g,E),P=Math.hypot(I,F);if(f===0)N=P/l,R=y/l;else{let D=f*l;N=P>D?P/D:1,R=y>D?y/D:1}}this._cachedScaleForStroking[0]=N,this._cachedScaleForStroking[1]=R}return this._cachedScaleForStroking}rescaleAndStroke(f){let{ctx:g}=this,{lineWidth:E}=this.current,[I,F]=this.getScaleForStroking();if(g.lineWidth=E||1,I===1&&F===1){g.stroke();return}let N=g.getLineDash();if(f&&g.save(),g.scale(I,F),N.length>0){let R=Math.max(I,F);g.setLineDash(N.map(l=>l/R)),g.lineDashOffset/=R}g.stroke(),f&&g.restore()}isContentVisible(){for(let f=this.markedContentStack.length-1;f>=0;f--)if(!this.markedContentStack[f].visible)return!1;return!0}}t.CanvasGraphics=L;for(let S in e.OPS)L.prototype[S]!==void 0&&(L.prototype[e.OPS[S]]=L.prototype[S])},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TilingPattern=t.PathType=void 0,t.getShadingPattern=d;var e=o(1),i=o(6);let u={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};t.PathType=u;function _(p,m){if(!m)return;let v=m[2]-m[0],k=m[3]-m[1],T=new Path2D;T.rect(m[0],m[1],v,k),p.clip(T)}class C{constructor(){this.constructor===C&&(0,e.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,e.unreachable)("Abstract method `getPattern` called.")}}class x extends C{constructor(m){super(),this._type=m[1],this._bbox=m[2],this._colorStops=m[3],this._p0=m[4],this._p1=m[5],this._r0=m[6],this._r1=m[7],this.matrix=null}_createGradient(m){let v;this._type==="axial"?v=m.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(v=m.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(let k of this._colorStops)v.addColorStop(k[0],k[1]);return v}getPattern(m,v,k,T){let b;if(T===u.STROKE||T===u.FILL){let w=v.current.getClippedPathBoundingBox(T,(0,i.getCurrentTransform)(m))||[0,0,0,0],B=Math.ceil(w[2]-w[0])||1,U=Math.ceil(w[3]-w[1])||1,O=v.cachedCanvases.getCanvas("pattern",B,U,!0),z=O.context;z.clearRect(0,0,z.canvas.width,z.canvas.height),z.beginPath(),z.rect(0,0,z.canvas.width,z.canvas.height),z.translate(-w[0],-w[1]),k=e.Util.transform(k,[1,0,0,1,w[0],w[1]]),z.transform(...v.baseTransform),this.matrix&&z.transform(...this.matrix),_(z,this._bbox),z.fillStyle=this._createGradient(z),z.fill(),b=m.createPattern(O.canvas,"no-repeat");let V=new DOMMatrix(k);b.setTransform(V)}else _(m,this._bbox),b=this._createGradient(m);return b}}function h(p,m,v,k,T,b,w,B){let U=m.coords,O=m.colors,z=p.data,V=p.width*4,it;U[v+1]>U[k+1]&&(it=v,v=k,k=it,it=b,b=w,w=it),U[k+1]>U[T+1]&&(it=k,k=T,T=it,it=w,w=B,B=it),U[v+1]>U[k+1]&&(it=v,v=k,k=it,it=b,b=w,w=it);let Q=(U[v]+m.offsetX)*m.scaleX,J=(U[v+1]+m.offsetY)*m.scaleY,nt=(U[k]+m.offsetX)*m.scaleX,Z=(U[k+1]+m.offsetY)*m.scaleY,L=(U[T]+m.offsetX)*m.scaleX,S=(U[T+1]+m.offsetY)*m.scaleY;if(J>=S)return;let f=O[b],g=O[b+1],E=O[b+2],I=O[w],F=O[w+1],N=O[w+2],R=O[B],l=O[B+1],y=O[B+2],P=Math.round(J),D=Math.round(S),M,j,H,X,st,q,$,Y;for(let K=P;K<=D;K++){if(K<Z){let ct=K<J?0:(J-K)/(J-Z);M=Q-(Q-nt)*ct,j=f-(f-I)*ct,H=g-(g-F)*ct,X=E-(E-N)*ct}else{let ct;K>S?ct=1:Z===S?ct=0:ct=(Z-K)/(Z-S),M=nt-(nt-L)*ct,j=I-(I-R)*ct,H=F-(F-l)*ct,X=N-(N-y)*ct}let tt;K<J?tt=0:K>S?tt=1:tt=(J-K)/(J-S),st=Q-(Q-L)*tt,q=f-(f-R)*tt,$=g-(g-l)*tt,Y=E-(E-y)*tt;let rt=Math.round(Math.min(M,st)),ot=Math.round(Math.max(M,st)),lt=V*K+rt*4;for(let ct=rt;ct<=ot;ct++)tt=(M-ct)/(M-st),tt<0?tt=0:tt>1&&(tt=1),z[lt++]=j-(j-q)*tt|0,z[lt++]=H-(H-$)*tt|0,z[lt++]=X-(X-Y)*tt|0,z[lt++]=255}}function n(p,m,v){let k=m.coords,T=m.colors,b,w;switch(m.type){case"lattice":let B=m.verticesPerRow,U=Math.floor(k.length/B)-1,O=B-1;for(b=0;b<U;b++){let z=b*B;for(let V=0;V<O;V++,z++)h(p,v,k[z],k[z+1],k[z+B],T[z],T[z+1],T[z+B]),h(p,v,k[z+B+1],k[z+1],k[z+B],T[z+B+1],T[z+1],T[z+B])}break;case"triangles":for(b=0,w=k.length;b<w;b+=3)h(p,v,k[b],k[b+1],k[b+2],T[b],T[b+1],T[b+2]);break;default:throw new Error("illegal figure")}}class s extends C{constructor(m){super(),this._coords=m[2],this._colors=m[3],this._figures=m[4],this._bounds=m[5],this._bbox=m[7],this._background=m[8],this.matrix=null}_createMeshCanvas(m,v,k){let B=Math.floor(this._bounds[0]),U=Math.floor(this._bounds[1]),O=Math.ceil(this._bounds[2])-B,z=Math.ceil(this._bounds[3])-U,V=Math.min(Math.ceil(Math.abs(O*m[0]*1.1)),3e3),it=Math.min(Math.ceil(Math.abs(z*m[1]*1.1)),3e3),Q=O/V,J=z/it,nt={coords:this._coords,colors:this._colors,offsetX:-B,offsetY:-U,scaleX:1/Q,scaleY:1/J},Z=V+2*2,L=it+2*2,S=k.getCanvas("mesh",Z,L,!1),f=S.context,g=f.createImageData(V,it);if(v){let I=g.data;for(let F=0,N=I.length;F<N;F+=4)I[F]=v[0],I[F+1]=v[1],I[F+2]=v[2],I[F+3]=255}for(let I of this._figures)n(g,I,nt);return f.putImageData(g,2,2),{canvas:S.canvas,offsetX:B-2*Q,offsetY:U-2*J,scaleX:Q,scaleY:J}}getPattern(m,v,k,T){_(m,this._bbox);let b;if(T===u.SHADING)b=e.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(m));else if(b=e.Util.singularValueDecompose2dScale(v.baseTransform),this.matrix){let B=e.Util.singularValueDecompose2dScale(this.matrix);b=[b[0]*B[0],b[1]*B[1]]}let w=this._createMeshCanvas(b,T===u.SHADING?null:this._background,v.cachedCanvases);return T!==u.SHADING&&(m.setTransform(...v.baseTransform),this.matrix&&m.transform(...this.matrix)),m.translate(w.offsetX,w.offsetY),m.scale(w.scaleX,w.scaleY),m.createPattern(w.canvas,"no-repeat")}}class r extends C{getPattern(){return"hotpink"}}function d(p){switch(p[0]){case"RadialAxial":return new x(p);case"Mesh":return new s(p);case"Dummy":return new r}throw new Error(`Unknown IR type: ${p[0]}`)}let c={COLORED:1,UNCOLORED:2},a=(()=>{class p{static MAX_PATTERN_SIZE=3e3;constructor(v,k,T,b,w){this.operatorList=v[2],this.matrix=v[3]||[1,0,0,1,0,0],this.bbox=v[4],this.xstep=v[5],this.ystep=v[6],this.paintType=v[7],this.tilingType=v[8],this.color=k,this.ctx=T,this.canvasGraphicsFactory=b,this.baseTransform=w}createPatternCanvas(v){let k=this.operatorList,T=this.bbox,b=this.xstep,w=this.ystep,B=this.paintType,U=this.tilingType,O=this.color,z=this.canvasGraphicsFactory;(0,e.info)("TilingType: "+U);let V=T[0],it=T[1],Q=T[2],J=T[3],nt=e.Util.singularValueDecompose2dScale(this.matrix),Z=e.Util.singularValueDecompose2dScale(this.baseTransform),L=[nt[0]*Z[0],nt[1]*Z[1]],S=this.getSizeAndScale(b,this.ctx.canvas.width,L[0]),f=this.getSizeAndScale(w,this.ctx.canvas.height,L[1]),g=v.cachedCanvases.getCanvas("pattern",S.size,f.size,!0),E=g.context,I=z.createCanvasGraphics(E);I.groupLevel=v.groupLevel,this.setFillAndStrokeStyleToContext(I,B,O);let F=V,N=it,R=Q,l=J;return V<0&&(F=0,R+=Math.abs(V)),it<0&&(N=0,l+=Math.abs(it)),E.translate(-(S.scale*F),-(f.scale*N)),I.transform(S.scale,0,0,f.scale,0,0),E.save(),this.clipBbox(I,F,N,R,l),I.baseTransform=(0,i.getCurrentTransform)(I.ctx),I.executeOperatorList(k),I.endDrawing(),{canvas:g.canvas,scaleX:S.scale,scaleY:f.scale,offsetX:F,offsetY:N}}getSizeAndScale(v,k,T){v=Math.abs(v);let b=Math.max(p.MAX_PATTERN_SIZE,k),w=Math.ceil(v*T);return w>=b?w=b:T=w/v,{scale:T,size:w}}clipBbox(v,k,T,b,w){let B=b-k,U=w-T;v.ctx.rect(k,T,B,U),v.current.updateRectMinMax((0,i.getCurrentTransform)(v.ctx),[k,T,b,w]),v.clip(),v.endPath()}setFillAndStrokeStyleToContext(v,k,T){let b=v.ctx,w=v.current;switch(k){case c.COLORED:let B=this.ctx;b.fillStyle=B.fillStyle,b.strokeStyle=B.strokeStyle,w.fillColor=B.fillStyle,w.strokeColor=B.strokeStyle;break;case c.UNCOLORED:let U=e.Util.makeHexColor(T[0],T[1],T[2]);b.fillStyle=U,b.strokeStyle=U,w.fillColor=U,w.strokeColor=U;break;default:throw new e.FormatError(`Unsupported paint type: ${k}`)}}getPattern(v,k,T,b){let w=T;b!==u.SHADING&&(w=e.Util.transform(w,k.baseTransform),this.matrix&&(w=e.Util.transform(w,this.matrix)));let B=this.createPatternCanvas(k),U=new DOMMatrix(w);U=U.translate(B.offsetX,B.offsetY),U=U.scale(1/B.scaleX,1/B.scaleY);let O=v.createPattern(B.canvas,"repeat");return O.setTransform(U),O}}return p})();t.TilingPattern=a},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertBlackAndWhiteToRGBA=u,t.convertToRGBA=i,t.grayToRGBA=C;var e=o(1);function i(x){switch(x.kind){case e.ImageKind.GRAYSCALE_1BPP:return u(x);case e.ImageKind.RGB_24BPP:return _(x)}return null}function u({src:x,srcPos:h=0,dest:n,width:s,height:r,nonBlackColor:d=4294967295,inverseDecode:c=!1}){let a=e.FeatureTest.isLittleEndian?4278190080:255,[p,m]=c?[d,a]:[a,d],v=s>>3,k=s&7,T=x.length;n=new Uint32Array(n.buffer);let b=0;for(let w=0;w<r;w++){for(let U=h+v;h<U;h++){let O=h<T?x[h]:255;n[b++]=O&128?m:p,n[b++]=O&64?m:p,n[b++]=O&32?m:p,n[b++]=O&16?m:p,n[b++]=O&8?m:p,n[b++]=O&4?m:p,n[b++]=O&2?m:p,n[b++]=O&1?m:p}if(k===0)continue;let B=h<T?x[h++]:255;for(let U=0;U<k;U++)n[b++]=B&1<<7-U?m:p}return{srcPos:h,destPos:b}}function _({src:x,srcPos:h=0,dest:n,destPos:s=0,width:r,height:d}){let c=0,a=x.length>>2,p=new Uint32Array(x.buffer,h,a);if(e.FeatureTest.isLittleEndian){for(;c<a-2;c+=3,s+=4){let m=p[c],v=p[c+1],k=p[c+2];n[s]=m|4278190080,n[s+1]=m>>>24|v<<8|4278190080,n[s+2]=v>>>16|k<<16|4278190080,n[s+3]=k>>>8|4278190080}for(let m=c*4,v=x.length;m<v;m+=3)n[s++]=x[m]|x[m+1]<<8|x[m+2]<<16|4278190080}else{for(;c<a-2;c+=3,s+=4){let m=p[c],v=p[c+1],k=p[c+2];n[s]=m|255,n[s+1]=m<<24|v>>>8|255,n[s+2]=v<<16|k>>>16|255,n[s+3]=k<<8|255}for(let m=c*4,v=x.length;m<v;m+=3)n[s++]=x[m]<<24|x[m+1]<<16|x[m+2]<<8|255}return{srcPos:h,destPos:s}}function C(x,h){if(e.FeatureTest.isLittleEndian)for(let n=0,s=x.length;n<s;n++)h[n]=x[n]*65793|4278190080;else for(let n=0,s=x.length;n<s;n++)h[n]=x[n]*16843008|255}},(A,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;let o=Object.create(null);t.GlobalWorkerOptions=o,o.workerPort=null,o.workerSrc=""},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var e=o(1);let i={UNKNOWN:0,DATA:1,ERROR:2},u={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function _(x){switch(x instanceof Error||typeof x=="object"&&x!==null||(0,e.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),x.name){case"AbortException":return new e.AbortException(x.message);case"MissingPDFException":return new e.MissingPDFException(x.message);case"PasswordException":return new e.PasswordException(x.message,x.code);case"UnexpectedResponseException":return new e.UnexpectedResponseException(x.message,x.status);case"UnknownErrorException":return new e.UnknownErrorException(x.message,x.details);default:return new e.UnknownErrorException(x.message,x.toString())}}class C{constructor(h,n,s){this.sourceName=h,this.targetName=n,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=r=>{let d=r.data;if(d.targetName!==this.sourceName)return;if(d.stream){this.#e(d);return}if(d.callback){let a=d.callbackId,p=this.callbackCapabilities[a];if(!p)throw new Error(`Cannot resolve callback ${a}`);if(delete this.callbackCapabilities[a],d.callback===i.DATA)p.resolve(d.data);else if(d.callback===i.ERROR)p.reject(_(d.reason));else throw new Error("Unexpected callback case");return}let c=this.actionHandler[d.action];if(!c)throw new Error(`Unknown action from worker: ${d.action}`);if(d.callbackId){let a=this.sourceName,p=d.sourceName;new Promise(function(m){m(c(d.data))}).then(function(m){s.postMessage({sourceName:a,targetName:p,callback:i.DATA,callbackId:d.callbackId,data:m})},function(m){s.postMessage({sourceName:a,targetName:p,callback:i.ERROR,callbackId:d.callbackId,reason:_(m)})});return}if(d.streamId){this.#t(d);return}c(d.data)},s.addEventListener("message",this._onComObjOnMessage)}on(h,n){let s=this.actionHandler;if(s[h])throw new Error(`There is already an actionName called "${h}"`);s[h]=n}send(h,n,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,data:n},s)}sendWithPromise(h,n,s){let r=this.callbackId++,d=new e.PromiseCapability;this.callbackCapabilities[r]=d;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,callbackId:r,data:n},s)}catch(c){d.reject(c)}return d.promise}sendWithStream(h,n,s,r){let d=this.streamId++,c=this.sourceName,a=this.targetName,p=this.comObj;return new ReadableStream({start:m=>{let v=new e.PromiseCapability;return this.streamControllers[d]={controller:m,startCall:v,pullCall:null,cancelCall:null,isClosed:!1},p.postMessage({sourceName:c,targetName:a,action:h,streamId:d,data:n,desiredSize:m.desiredSize},r),v.promise},pull:m=>{let v=new e.PromiseCapability;return this.streamControllers[d].pullCall=v,p.postMessage({sourceName:c,targetName:a,stream:u.PULL,streamId:d,desiredSize:m.desiredSize}),v.promise},cancel:m=>{(0,e.assert)(m instanceof Error,"cancel must have a valid reason");let v=new e.PromiseCapability;return this.streamControllers[d].cancelCall=v,this.streamControllers[d].isClosed=!0,p.postMessage({sourceName:c,targetName:a,stream:u.CANCEL,streamId:d,reason:_(m)}),v.promise}},s)}#t(h){let n=h.streamId,s=this.sourceName,r=h.sourceName,d=this.comObj,c=this,a=this.actionHandler[h.action],p={enqueue(m,v=1,k){if(this.isCancelled)return;let T=this.desiredSize;this.desiredSize-=v,T>0&&this.desiredSize<=0&&(this.sinkCapability=new e.PromiseCapability,this.ready=this.sinkCapability.promise),d.postMessage({sourceName:s,targetName:r,stream:u.ENQUEUE,streamId:n,chunk:m},k)},close(){this.isCancelled||(this.isCancelled=!0,d.postMessage({sourceName:s,targetName:r,stream:u.CLOSE,streamId:n}),delete c.streamSinks[n])},error(m){(0,e.assert)(m instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,d.postMessage({sourceName:s,targetName:r,stream:u.ERROR,streamId:n,reason:_(m)}))},sinkCapability:new e.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:h.desiredSize,ready:null};p.sinkCapability.resolve(),p.ready=p.sinkCapability.promise,this.streamSinks[n]=p,new Promise(function(m){m(a(h.data,p))}).then(function(){d.postMessage({sourceName:s,targetName:r,stream:u.START_COMPLETE,streamId:n,success:!0})},function(m){d.postMessage({sourceName:s,targetName:r,stream:u.START_COMPLETE,streamId:n,reason:_(m)})})}#e(h){let n=h.streamId,s=this.sourceName,r=h.sourceName,d=this.comObj,c=this.streamControllers[n],a=this.streamSinks[n];switch(h.stream){case u.START_COMPLETE:h.success?c.startCall.resolve():c.startCall.reject(_(h.reason));break;case u.PULL_COMPLETE:h.success?c.pullCall.resolve():c.pullCall.reject(_(h.reason));break;case u.PULL:if(!a){d.postMessage({sourceName:s,targetName:r,stream:u.PULL_COMPLETE,streamId:n,success:!0});break}a.desiredSize<=0&&h.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=h.desiredSize,new Promise(function(p){p(a.onPull?.())}).then(function(){d.postMessage({sourceName:s,targetName:r,stream:u.PULL_COMPLETE,streamId:n,success:!0})},function(p){d.postMessage({sourceName:s,targetName:r,stream:u.PULL_COMPLETE,streamId:n,reason:_(p)})});break;case u.ENQUEUE:if((0,e.assert)(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(h.chunk);break;case u.CLOSE:if((0,e.assert)(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#i(c,n);break;case u.ERROR:(0,e.assert)(c,"error should have stream controller"),c.controller.error(_(h.reason)),this.#i(c,n);break;case u.CANCEL_COMPLETE:h.success?c.cancelCall.resolve():c.cancelCall.reject(_(h.reason)),this.#i(c,n);break;case u.CANCEL:if(!a)break;new Promise(function(p){p(a.onCancel?.(_(h.reason)))}).then(function(){d.postMessage({sourceName:s,targetName:r,stream:u.CANCEL_COMPLETE,streamId:n,success:!0})},function(p){d.postMessage({sourceName:s,targetName:r,stream:u.CANCEL_COMPLETE,streamId:n,reason:_(p)})}),a.sinkCapability.reject(_(h.reason)),a.isCancelled=!0,delete this.streamSinks[n];break;default:throw new Error("Unexpected stream case")}}#i(h,n){return ht(this,null,function*(){yield Promise.allSettled([h.startCall?.promise,h.pullCall?.promise,h.cancelCall?.promise]),delete this.streamControllers[n]})}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}t.MessageHandler=C},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var e=o(1);class i{#t;#e;constructor({parsedData:_,rawData:C}){this.#t=_,this.#e=C}getRaw(){return this.#e}get(_){return this.#t.get(_)??null}getAll(){return(0,e.objectFromMap)(this.#t)}has(_){return this.#t.has(_)}}t.Metadata=i},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionalContentConfig=void 0;var e=o(1),i=o(8);let u=Symbol("INTERNAL");class _{#t=!0;constructor(h,n){this.name=h,this.intent=n}get visible(){return this.#t}_setVisible(h,n){h!==u&&(0,e.unreachable)("Internal method `_setVisible` called."),this.#t=n}}class C{#t=null;#e=new Map;#i=null;#s=null;constructor(h){if(this.name=null,this.creator=null,h!==null){this.name=h.name,this.creator=h.creator,this.#s=h.order;for(let n of h.groups)this.#e.set(n.id,new _(n.name,n.intent));if(h.baseState==="OFF")for(let n of this.#e.values())n._setVisible(u,!1);for(let n of h.on)this.#e.get(n)._setVisible(u,!0);for(let n of h.off)this.#e.get(n)._setVisible(u,!1);this.#i=this.getHash()}}#o(h){let n=h.length;if(n<2)return!0;let s=h[0];for(let r=1;r<n;r++){let d=h[r],c;if(Array.isArray(d))c=this.#o(d);else if(this.#e.has(d))c=this.#e.get(d).visible;else return(0,e.warn)(`Optional content group not found: ${d}`),!0;switch(s){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return s==="And"}isVisible(h){if(this.#e.size===0)return!0;if(!h)return(0,e.warn)("Optional content group not defined."),!0;if(h.type==="OCG")return this.#e.has(h.id)?this.#e.get(h.id).visible:((0,e.warn)(`Optional content group not found: ${h.id}`),!0);if(h.type==="OCMD"){if(h.expression)return this.#o(h.expression);if(!h.policy||h.policy==="AnyOn"){for(let n of h.ids){if(!this.#e.has(n))return(0,e.warn)(`Optional content group not found: ${n}`),!0;if(this.#e.get(n).visible)return!0}return!1}else if(h.policy==="AllOn"){for(let n of h.ids){if(!this.#e.has(n))return(0,e.warn)(`Optional content group not found: ${n}`),!0;if(!this.#e.get(n).visible)return!1}return!0}else if(h.policy==="AnyOff"){for(let n of h.ids){if(!this.#e.has(n))return(0,e.warn)(`Optional content group not found: ${n}`),!0;if(!this.#e.get(n).visible)return!0}return!1}else if(h.policy==="AllOff"){for(let n of h.ids){if(!this.#e.has(n))return(0,e.warn)(`Optional content group not found: ${n}`),!0;if(this.#e.get(n).visible)return!1}return!0}return(0,e.warn)(`Unknown optional content policy ${h.policy}.`),!0}return(0,e.warn)(`Unknown group type ${h.type}.`),!0}setVisibility(h,n=!0){if(!this.#e.has(h)){(0,e.warn)(`Optional content group not found: ${h}`);return}this.#e.get(h)._setVisible(u,!!n),this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#s?this.#s.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?(0,e.objectFromMap)(this.#e):null}getGroup(h){return this.#e.get(h)||null}getHash(){if(this.#t!==null)return this.#t;let h=new i.MurmurHash3_64;for(let[n,s]of this.#e)h.update(`${n}:${s.visible}`);return this.#t=h.hexdigest()}}t.OptionalContentConfig=C},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var e=o(1),i=o(6);class u{constructor({length:h,initialData:n,progressiveDone:s=!1,contentDispositionFilename:r=null,disableRange:d=!1,disableStream:c=!1},a){if((0,e.assert)(a,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=s,this._contentDispositionFilename=r,n?.length>0){let p=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;this._queuedChunks.push(p)}this._pdfDataRangeTransport=a,this._isStreamingSupported=!c,this._isRangeSupported=!d,this._contentLength=h,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((p,m)=>{this._onReceiveData({begin:p,chunk:m})}),this._pdfDataRangeTransport.addProgressListener((p,m)=>{this._onProgress({loaded:p,total:m})}),this._pdfDataRangeTransport.addProgressiveReadListener(p=>{this._onReceiveData({chunk:p})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:h,chunk:n}){let s=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;if(h===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{let r=this._rangeReaders.some(function(d){return d._begin!==h?!1:(d._enqueue(s),!0)});(0,e.assert)(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(h){h.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:h.loaded}):this._fullRequestReader?.onProgress?.({loaded:h.loaded,total:h.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(h){let n=this._rangeReaders.indexOf(h);n>=0&&this._rangeReaders.splice(n,1)}getFullReader(){(0,e.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");let h=this._queuedChunks;return this._queuedChunks=null,new _(this,h,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(h,n){if(n<=this._progressiveDataLength)return null;let s=new C(this,h,n);return this._pdfDataRangeTransport.requestDataRange(h,n),this._rangeReaders.push(s),s}cancelAllRequests(h){this._fullRequestReader?.cancel(h);for(let n of this._rangeReaders.slice(0))n.cancel(h);this._pdfDataRangeTransport.abort()}}t.PDFDataTransportStream=u;class _{constructor(h,n,s=!1,r=null){this._stream=h,this._done=s||!1,this._filename=(0,i.isPdfFile)(r)?r:null,this._queuedChunks=n||[],this._loaded=0;for(let d of this._queuedChunks)this._loaded+=d.byteLength;this._requests=[],this._headersReady=Promise.resolve(),h._fullRequestReader=this,this.onProgress=null}_enqueue(h){this._done||(this._requests.length>0?this._requests.shift().resolve({value:h,done:!1}):this._queuedChunks.push(h),this._loaded+=h.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}read(){return ht(this,null,function*(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let h=new e.PromiseCapability;return this._requests.push(h),h.promise})}cancel(h){this._done=!0;for(let n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class C{constructor(h,n,s){this._stream=h,this._begin=n,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(h){if(!this._done){if(this._requests.length===0)this._queuedChunk=h;else{this._requests.shift().resolve({value:h,done:!1});for(let s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}read(){return ht(this,null,function*(){if(this._queuedChunk){let n=this._queuedChunk;return this._queuedChunk=null,{value:n,done:!1}}if(this._done)return{value:void 0,done:!0};let h=new e.PromiseCapability;return this._requests.push(h),h.promise})}cancel(h){this._done=!0;for(let n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var e=o(1),i=o(20);function u(s,r,d){return{method:"GET",headers:s,signal:d.signal,mode:"cors",credentials:r?"include":"same-origin",redirect:"follow"}}function _(s){let r=new Headers;for(let d in s){let c=s[d];c!==void 0&&r.append(d,c)}return r}function C(s){return s instanceof Uint8Array?s.buffer:s instanceof ArrayBuffer?s:((0,e.warn)(`getArrayBuffer - unexpected data format: ${s}`),new Uint8Array(s).buffer)}class x{constructor(r){this.source=r,this.isHttp=/^https?:/i.test(r.url),this.httpHeaders=this.isHttp&&r.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new h(this),this._fullRequestReader}getRangeReader(r,d){if(d<=this._progressiveDataLength)return null;let c=new n(this,r,d);return this._rangeRequestReaders.push(c),c}cancelAllRequests(r){this._fullRequestReader?.cancel(r);for(let d of this._rangeRequestReaders.slice(0))d.cancel(r)}}t.PDFFetchStream=x;class h{constructor(r){this._stream=r,this._reader=null,this._loaded=0,this._filename=null;let d=r.source;this._withCredentials=d.withCredentials||!1,this._contentLength=d.length,this._headersCapability=new e.PromiseCapability,this._disableRange=d.disableRange||!1,this._rangeChunkSize=d.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!d.disableStream,this._isRangeSupported=!d.disableRange,this._headers=_(this._stream.httpHeaders);let c=d.url;fetch(c,u(this._headers,this._withCredentials,this._abortController)).then(a=>{if(!(0,i.validateResponseStatus)(a.status))throw(0,i.createResponseStatusError)(a.status,c);this._reader=a.body.getReader(),this._headersCapability.resolve();let p=k=>a.headers.get(k),{allowRangeRequests:m,suggestedLength:v}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:p,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=m,this._contentLength=v||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(p),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new e.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return ht(this,null,function*(){yield this._headersCapability.promise;let{value:r,done:d}=yield this._reader.read();return d?{value:r,done:d}:(this._loaded+=r.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:C(r),done:!1})})}cancel(r){this._reader?.cancel(r),this._abortController.abort()}}class n{constructor(r,d,c){this._stream=r,this._reader=null,this._loaded=0;let a=r.source;this._withCredentials=a.withCredentials||!1,this._readCapability=new e.PromiseCapability,this._isStreamingSupported=!a.disableStream,this._abortController=new AbortController,this._headers=_(this._stream.httpHeaders),this._headers.append("Range",`bytes=${d}-${c-1}`);let p=a.url;fetch(p,u(this._headers,this._withCredentials,this._abortController)).then(m=>{if(!(0,i.validateResponseStatus)(m.status))throw(0,i.createResponseStatusError)(m.status,p);this._readCapability.resolve(),this._reader=m.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}read(){return ht(this,null,function*(){yield this._readCapability.promise;let{value:r,done:d}=yield this._reader.read();return d?{value:r,done:d}:(this._loaded+=r.byteLength,this.onProgress?.({loaded:this._loaded}),{value:C(r),done:!1})})}cancel(r){this._reader?.cancel(r),this._abortController.abort()}}},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=x,t.extractFilenameFromHeader=C,t.validateRangeRequestCapabilities=_,t.validateResponseStatus=h;var e=o(1),i=o(21),u=o(6);function _({getResponseHeader:n,isHttp:s,rangeChunkSize:r,disableRange:d}){let c={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(n("Content-Length"),10);return!Number.isInteger(a)||(c.suggestedLength=a,a<=2*r)||d||!s||n("Accept-Ranges")!=="bytes"||(n("Content-Encoding")||"identity")!=="identity"||(c.allowRangeRequests=!0),c}function C(n){let s=n("Content-Disposition");if(s){let r=(0,i.getFilenameFromContentDispositionHeader)(s);if(r.includes("%"))try{r=decodeURIComponent(r)}catch{}if((0,u.isPdfFile)(r))return r}return null}function x(n,s){return n===404||n===0&&s.startsWith("file:")?new e.MissingPDFException('Missing PDF "'+s+'".'):new e.UnexpectedResponseException(`Unexpected server response (${n}) while retrieving PDF "${s}".`,n)}function h(n){return n===200||n===206}},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=i;var e=o(1);function i(u){let _=!0,C=x("filename\\*","i").exec(u);if(C){C=C[1];let a=r(C);return a=unescape(a),a=d(a),a=c(a),n(a)}if(C=s(u),C){let a=c(C);return n(a)}if(C=x("filename","i").exec(u),C){C=C[1];let a=r(C);return a=c(a),n(a)}function x(a,p){return new RegExp("(?:^|;)\\s*"+a+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function h(a,p){if(a){if(!/^[\x00-\xFF]+$/.test(p))return p;try{let m=new TextDecoder(a,{fatal:!0}),v=(0,e.stringToBytes)(p);p=m.decode(v),_=!1}catch{}}return p}function n(a){return _&&/[\x80-\xff]/.test(a)&&(a=h("utf-8",a),_&&(a=h("iso-8859-1",a))),a}function s(a){let p=[],m,v=x("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=v.exec(a))!==null;){let[,T,b,w]=m;if(T=parseInt(T,10),T in p){if(T===0)break;continue}p[T]=[b,w]}let k=[];for(let T=0;T<p.length&&T in p;++T){let[b,w]=p[T];w=r(w),b&&(w=unescape(w),T===0&&(w=d(w))),k.push(w)}return k.join("")}function r(a){if(a.startsWith('"')){let p=a.slice(1).split('\\"');for(let m=0;m<p.length;++m){let v=p[m].indexOf('"');v!==-1&&(p[m]=p[m].slice(0,v),p.length=m+1),p[m]=p[m].replaceAll(/\\(.)/g,"$1")}a=p.join('"')}return a}function d(a){let p=a.indexOf("'");if(p===-1)return a;let m=a.slice(0,p),k=a.slice(p+1).replace(/^[^']*'/,"");return h(m,k)}function c(a){return!a.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(a)?a:a.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,m,v,k){if(v==="q"||v==="Q")return k=k.replaceAll("_"," "),k=k.replaceAll(/=([0-9a-fA-F]{2})/g,function(T,b){return String.fromCharCode(parseInt(b,16))}),h(m,k);try{k=atob(k)}catch{}return h(m,k)})}return""}},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var e=o(1),i=o(20);let u=200,_=206;function C(r){let d=r.response;return typeof d!="string"?d:(0,e.stringToBytes)(d).buffer}class x{constructor(d,c={}){this.url=d,this.isHttp=/^https?:/i.test(d),this.httpHeaders=this.isHttp&&c.httpHeaders||Object.create(null),this.withCredentials=c.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(d,c,a){let p={begin:d,end:c};for(let m in a)p[m]=a[m];return this.request(p)}requestFull(d){return this.request(d)}request(d){let c=new XMLHttpRequest,a=this.currXhrId++,p=this.pendingRequests[a]={xhr:c};c.open("GET",this.url),c.withCredentials=this.withCredentials;for(let m in this.httpHeaders){let v=this.httpHeaders[m];v!==void 0&&c.setRequestHeader(m,v)}return this.isHttp&&"begin"in d&&"end"in d?(c.setRequestHeader("Range",`bytes=${d.begin}-${d.end-1}`),p.expectedStatus=_):p.expectedStatus=u,c.responseType="arraybuffer",d.onError&&(c.onerror=function(m){d.onError(c.status)}),c.onreadystatechange=this.onStateChange.bind(this,a),c.onprogress=this.onProgress.bind(this,a),p.onHeadersReceived=d.onHeadersReceived,p.onDone=d.onDone,p.onError=d.onError,p.onProgress=d.onProgress,c.send(null),a}onProgress(d,c){let a=this.pendingRequests[d];a&&a.onProgress?.(c)}onStateChange(d,c){let a=this.pendingRequests[d];if(!a)return;let p=a.xhr;if(p.readyState>=2&&a.onHeadersReceived&&(a.onHeadersReceived(),delete a.onHeadersReceived),p.readyState!==4||!(d in this.pendingRequests))return;if(delete this.pendingRequests[d],p.status===0&&this.isHttp){a.onError?.(p.status);return}let m=p.status||u;if(!(m===u&&a.expectedStatus===_)&&m!==a.expectedStatus){a.onError?.(p.status);return}let k=C(p);if(m===_){let T=p.getResponseHeader("Content-Range"),b=/bytes (\d+)-(\d+)\/(\d+)/.exec(T);a.onDone({begin:parseInt(b[1],10),chunk:k})}else k?a.onDone({begin:0,chunk:k}):a.onError?.(p.status)}getRequestXhr(d){return this.pendingRequests[d].xhr}isPendingRequest(d){return d in this.pendingRequests}abortRequest(d){let c=this.pendingRequests[d].xhr;delete this.pendingRequests[d],c.abort()}}class h{constructor(d){this._source=d,this._manager=new x(d.url,{httpHeaders:d.httpHeaders,withCredentials:d.withCredentials}),this._rangeChunkSize=d.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(d){let c=this._rangeRequestReaders.indexOf(d);c>=0&&this._rangeRequestReaders.splice(c,1)}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new n(this._manager,this._source),this._fullRequestReader}getRangeReader(d,c){let a=new s(this._manager,d,c);return a.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(a),a}cancelAllRequests(d){this._fullRequestReader?.cancel(d);for(let c of this._rangeRequestReaders.slice(0))c.cancel(d)}}t.PDFNetworkStream=h;class n{constructor(d,c){this._manager=d;let a={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=c.url,this._fullRequestId=d.requestFull(a),this._headersReceivedCapability=new e.PromiseCapability,this._disableRange=c.disableRange||!1,this._contentLength=c.length,this._rangeChunkSize=c.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){let d=this._fullRequestId,c=this._manager.getRequestXhr(d),a=v=>c.getResponseHeader(v),{allowRangeRequests:p,suggestedLength:m}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:a,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});p&&(this._isRangeSupported=!0),this._contentLength=m||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(a),this._isRangeSupported&&this._manager.abortRequest(d),this._headersReceivedCapability.resolve()}_onDone(d){if(d&&(this._requests.length>0?this._requests.shift().resolve({value:d.chunk,done:!1}):this._cachedChunks.push(d.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(let c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(d){this._storedError=(0,i.createResponseStatusError)(d,this._url),this._headersReceivedCapability.reject(this._storedError);for(let c of this._requests)c.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(d){this.onProgress?.({loaded:d.loaded,total:d.lengthComputable?d.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}read(){return ht(this,null,function*(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let d=new e.PromiseCapability;return this._requests.push(d),d.promise})}cancel(d){this._done=!0,this._headersReceivedCapability.reject(d);for(let c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class s{constructor(d,c,a){this._manager=d;let p={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=d.url,this._requestId=d.requestRange(c,a,p),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(d){let c=d.chunk;this._requests.length>0?this._requests.shift().resolve({value:c,done:!1}):this._queuedChunk=c,this._done=!0;for(let a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(d){this._storedError=(0,i.createResponseStatusError)(d,this._url);for(let c of this._requests)c.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(d){this.isStreamingSupported||this.onProgress?.({loaded:d.loaded})}get isStreamingSupported(){return!1}read(){return ht(this,null,function*(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){let c=this._queuedChunk;return this._queuedChunk=null,{value:c,done:!1}}if(this._done)return{value:void 0,done:!0};let d=new e.PromiseCapability;return this._requests.push(d),d.promise})}cancel(d){this._done=!0;for(let c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var e=o(1),i=o(20);let u=/^file:\/\/\/[a-zA-Z]:\//;function _(a){let p=Os(),m=p.parse(a);return m.protocol==="file:"||m.host?m:/^[a-z]:[/\\]/i.test(a)?p.parse(`file:///${a}`):(m.host||(m.protocol="file:"),m)}class C{constructor(p){this.source=p,this.url=_(p.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&p.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new d(this):new s(this),this._fullRequestReader}getRangeReader(p,m){if(m<=this._progressiveDataLength)return null;let v=this.isFsUrl?new c(this,p,m):new r(this,p,m);return this._rangeRequestReaders.push(v),v}cancelAllRequests(p){this._fullRequestReader?.cancel(p);for(let m of this._rangeRequestReaders.slice(0))m.cancel(p)}}t.PDFNodeStream=C;class x{constructor(p){this._url=p.url,this._done=!1,this._storedError=null,this.onProgress=null;let m=p.source;this._contentLength=m.length,this._loaded=0,this._filename=null,this._disableRange=m.disableRange||!1,this._rangeChunkSize=m.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!m.disableStream,this._isRangeSupported=!m.disableRange,this._readableStream=null,this._readCapability=new e.PromiseCapability,this._headersCapability=new e.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return ht(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let p=this._readableStream.read();return p===null?(this._readCapability=new e.PromiseCapability,this.read()):(this._loaded+=p.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(p).buffer,done:!1})})}cancel(p){if(!this._readableStream){this._error(p);return}this._readableStream.destroy(p)}_error(p){this._storedError=p,this._readCapability.resolve()}_setReadableStream(p){this._readableStream=p,p.on("readable",()=>{this._readCapability.resolve()}),p.on("end",()=>{p.destroy(),this._done=!0,this._readCapability.resolve()}),p.on("error",m=>{this._error(m)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new e.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class h{constructor(p){this._url=p.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new e.PromiseCapability;let m=p.source;this._isStreamingSupported=!m.disableStream}get isStreamingSupported(){return this._isStreamingSupported}read(){return ht(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let p=this._readableStream.read();return p===null?(this._readCapability=new e.PromiseCapability,this.read()):(this._loaded+=p.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(p).buffer,done:!1})})}cancel(p){if(!this._readableStream){this._error(p);return}this._readableStream.destroy(p)}_error(p){this._storedError=p,this._readCapability.resolve()}_setReadableStream(p){this._readableStream=p,p.on("readable",()=>{this._readCapability.resolve()}),p.on("end",()=>{p.destroy(),this._done=!0,this._readCapability.resolve()}),p.on("error",m=>{this._error(m)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function n(a,p){return{protocol:a.protocol,auth:a.auth,host:a.hostname,port:a.port,path:a.path,method:"GET",headers:p}}class s extends x{constructor(p){super(p);let m=v=>{if(v.statusCode===404){let w=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=w,this._headersCapability.reject(w);return}this._headersCapability.resolve(),this._setReadableStream(v);let k=w=>this._readableStream.headers[w.toLowerCase()],{allowRangeRequests:T,suggestedLength:b}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:k,isHttp:p.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=T,this._contentLength=b||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(k)};if(this._request=null,this._url.protocol==="http:"){let v=li();this._request=v.request(n(this._url,p.httpHeaders),m)}else{let v=ci();this._request=v.request(n(this._url,p.httpHeaders),m)}this._request.on("error",v=>{this._storedError=v,this._headersCapability.reject(v)}),this._request.end()}}class r extends h{constructor(p,m,v){super(p),this._httpHeaders={};for(let T in p.httpHeaders){let b=p.httpHeaders[T];b!==void 0&&(this._httpHeaders[T]=b)}this._httpHeaders.Range=`bytes=${m}-${v-1}`;let k=T=>{if(T.statusCode===404){let b=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=b;return}this._setReadableStream(T)};if(this._request=null,this._url.protocol==="http:"){let T=li();this._request=T.request(n(this._url,this._httpHeaders),k)}else{let T=ci();this._request=T.request(n(this._url,this._httpHeaders),k)}this._request.on("error",T=>{this._storedError=T}),this._request.end()}}class d extends x{constructor(p){super(p);let m=decodeURIComponent(this._url.path);u.test(this._url.href)&&(m=m.replace(/^\//,""));let v=Ne();v.lstat(m,(k,T)=>{if(k){k.code==="ENOENT"&&(k=new e.MissingPDFException(`Missing PDF "${m}".`)),this._storedError=k,this._headersCapability.reject(k);return}this._contentLength=T.size,this._setReadableStream(v.createReadStream(m)),this._headersCapability.resolve()})}}class c extends h{constructor(p,m,v){super(p);let k=decodeURIComponent(this._url.path);u.test(this._url.href)&&(k=k.replace(/^\//,""));let T=Ne();this._setReadableStream(T.createReadStream(k,{start:m,end:v-1}))}}},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var e=o(6),i=o(1);let u={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},_="http://www.w3.org/XML/1998/namespace",C="http://www.w3.org/1999/xlink",x=["butt","round","square"],h=["miter","round","bevel"],n=function(T,b="",w=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!w)return URL.createObjectURL(new Blob([T],{type:b}));let B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",U=`data:${b};base64,`;for(let O=0,z=T.length;O<z;O+=3){let V=T[O]&255,it=T[O+1]&255,Q=T[O+2]&255,J=V>>2,nt=(V&3)<<4|it>>4,Z=O+1<z?(it&15)<<2|Q>>6:64,L=O+2<z?Q&63:64;U+=B[J]+B[nt]+B[Z]+B[L]}return U},s=function(){let T=new Uint8Array([137,80,78,71,13,10,26,10]),b=12,w=new Int32Array(256);for(let Q=0;Q<256;Q++){let J=Q;for(let nt=0;nt<8;nt++)J=J&1?3988292384^J>>1&2147483647:J>>1&2147483647;w[Q]=J}function B(Q,J,nt){let Z=-1;for(let L=J;L<nt;L++){let S=(Z^Q[L])&255,f=w[S];Z=Z>>>8^f}return Z^-1}function U(Q,J,nt,Z){let L=Z,S=J.length;nt[L]=S>>24&255,nt[L+1]=S>>16&255,nt[L+2]=S>>8&255,nt[L+3]=S&255,L+=4,nt[L]=Q.charCodeAt(0)&255,nt[L+1]=Q.charCodeAt(1)&255,nt[L+2]=Q.charCodeAt(2)&255,nt[L+3]=Q.charCodeAt(3)&255,L+=4,nt.set(J,L),L+=J.length;let f=B(nt,Z+4,L);nt[L]=f>>24&255,nt[L+1]=f>>16&255,nt[L+2]=f>>8&255,nt[L+3]=f&255}function O(Q,J,nt){let Z=1,L=0;for(let S=J;S<nt;++S)Z=(Z+(Q[S]&255))%65521,L=(L+Z)%65521;return L<<16|Z}function z(Q){if(!i.isNodeJS)return V(Q);try{let J=parseInt(process.versions.node)>=8?Q:Buffer.from(Q),nt=Ns().deflateSync(J,{level:9});return nt instanceof Uint8Array?nt:new Uint8Array(nt)}catch(J){(0,i.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+J)}return V(Q)}function V(Q){let J=Q.length,nt=65535,Z=Math.ceil(J/nt),L=new Uint8Array(2+J+Z*5+4),S=0;L[S++]=120,L[S++]=156;let f=0;for(;J>nt;)L[S++]=0,L[S++]=255,L[S++]=255,L[S++]=0,L[S++]=0,L.set(Q.subarray(f,f+nt),S),S+=nt,f+=nt,J-=nt;L[S++]=1,L[S++]=J&255,L[S++]=J>>8&255,L[S++]=~J&65535&255,L[S++]=(~J&65535)>>8&255,L.set(Q.subarray(f),S),S+=Q.length-f;let g=O(Q,0,Q.length);return L[S++]=g>>24&255,L[S++]=g>>16&255,L[S++]=g>>8&255,L[S++]=g&255,L}function it(Q,J,nt,Z){let L=Q.width,S=Q.height,f,g,E,I=Q.data;switch(J){case i.ImageKind.GRAYSCALE_1BPP:g=0,f=1,E=L+7>>3;break;case i.ImageKind.RGB_24BPP:g=2,f=8,E=L*3;break;case i.ImageKind.RGBA_32BPP:g=6,f=8,E=L*4;break;default:throw new Error("invalid format")}let F=new Uint8Array((1+E)*S),N=0,R=0;for(let j=0;j<S;++j)F[N++]=0,F.set(I.subarray(R,R+E),N),R+=E,N+=E;if(J===i.ImageKind.GRAYSCALE_1BPP&&Z){N=0;for(let j=0;j<S;j++){N++;for(let H=0;H<E;H++)F[N++]^=255}}let l=new Uint8Array([L>>24&255,L>>16&255,L>>8&255,L&255,S>>24&255,S>>16&255,S>>8&255,S&255,f,g,0,0,0]),y=z(F),P=T.length+b*3+l.length+y.length,D=new Uint8Array(P),M=0;return D.set(T,M),M+=T.length,U("IHDR",l,D,M),M+=b+l.length,U("IDATA",y,D,M),M+=b+y.length,U("IEND",new Uint8Array(0),D,M),n(D,"image/png",nt)}return function(J,nt,Z){let L=J.kind===void 0?i.ImageKind.GRAYSCALE_1BPP:J.kind;return it(J,L,nt,Z)}}();class r{constructor(){this.fontSizeScale=1,this.fontWeight=u.fontWeight,this.fontSize=0,this.textMatrix=i.IDENTITY_MATRIX,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=i.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=u.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(b,w){this.x=b,this.y=w}}function d(T){let b=[],w=[];for(let B of T){if(B.fn==="save"){b.push({fnId:92,fn:"group",items:[]}),w.push(b),b=b.at(-1).items;continue}B.fn==="restore"?b=w.pop():b.push(B)}return b}function c(T){if(Number.isInteger(T))return T.toString();let b=T.toFixed(10),w=b.length-1;if(b[w]!=="0")return b;do w--;while(b[w]==="0");return b.substring(0,b[w]==="."?w:w+1)}function a(T){if(T[4]===0&&T[5]===0){if(T[1]===0&&T[2]===0)return T[0]===1&&T[3]===1?"":`scale(${c(T[0])} ${c(T[3])})`;if(T[0]===T[3]&&T[1]===-T[2]){let b=Math.acos(T[0])*180/Math.PI;return`rotate(${c(b)})`}}else if(T[0]===1&&T[1]===0&&T[2]===0&&T[3]===1)return`translate(${c(T[4])} ${c(T[5])})`;return`matrix(${c(T[0])} ${c(T[1])} ${c(T[2])} ${c(T[3])} ${c(T[4])} ${c(T[5])})`}let p=0,m=0,v=0;class k{constructor(b,w,B=!1){(0,e.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new e.DOMSVGFactory,this.current=new r,this.transformMatrix=i.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=b,this.objs=w,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!B,this._operatorIdMapping=[];for(let U in i.OPS)this._operatorIdMapping[i.OPS[U]]=U}getObject(b,w=null){return typeof b=="string"?b.startsWith("g_")?this.commonObjs.get(b):this.objs.get(b):w}save(){this.transformStack.push(this.transformMatrix);let b=this.current;this.extraStack.push(b),this.current=b.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(b){this.save(),this.executeOpTree(b),this.restore()}loadDependencies(b){let w=b.fnArray,B=b.argsArray;for(let U=0,O=w.length;U<O;U++)if(w[U]===i.OPS.dependency)for(let z of B[U]){let V=z.startsWith("g_")?this.commonObjs:this.objs,it=new Promise(Q=>{V.get(z,Q)});this.current.dependencies.push(it)}return Promise.all(this.current.dependencies)}transform(b,w,B,U,O,z){let V=[b,w,B,U,O,z];this.transformMatrix=i.Util.transform(this.transformMatrix,V),this.tgrp=null}getSVG(b,w){this.viewport=w;let B=this._initialize(w);return this.loadDependencies(b).then(()=>(this.transformMatrix=i.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(b)),B))}convertOpList(b){let w=this._operatorIdMapping,B=b.argsArray,U=b.fnArray,O=[];for(let z=0,V=U.length;z<V;z++){let it=U[z];O.push({fnId:it,fn:w[it],args:B[z]})}return d(O)}executeOpTree(b){for(let w of b){let B=w.fn,U=w.fnId,O=w.args;switch(U|0){case i.OPS.beginText:this.beginText();break;case i.OPS.dependency:break;case i.OPS.setLeading:this.setLeading(O);break;case i.OPS.setLeadingMoveText:this.setLeadingMoveText(O[0],O[1]);break;case i.OPS.setFont:this.setFont(O);break;case i.OPS.showText:this.showText(O[0]);break;case i.OPS.showSpacedText:this.showText(O[0]);break;case i.OPS.endText:this.endText();break;case i.OPS.moveText:this.moveText(O[0],O[1]);break;case i.OPS.setCharSpacing:this.setCharSpacing(O[0]);break;case i.OPS.setWordSpacing:this.setWordSpacing(O[0]);break;case i.OPS.setHScale:this.setHScale(O[0]);break;case i.OPS.setTextMatrix:this.setTextMatrix(O[0],O[1],O[2],O[3],O[4],O[5]);break;case i.OPS.setTextRise:this.setTextRise(O[0]);break;case i.OPS.setTextRenderingMode:this.setTextRenderingMode(O[0]);break;case i.OPS.setLineWidth:this.setLineWidth(O[0]);break;case i.OPS.setLineJoin:this.setLineJoin(O[0]);break;case i.OPS.setLineCap:this.setLineCap(O[0]);break;case i.OPS.setMiterLimit:this.setMiterLimit(O[0]);break;case i.OPS.setFillRGBColor:this.setFillRGBColor(O[0],O[1],O[2]);break;case i.OPS.setStrokeRGBColor:this.setStrokeRGBColor(O[0],O[1],O[2]);break;case i.OPS.setStrokeColorN:this.setStrokeColorN(O);break;case i.OPS.setFillColorN:this.setFillColorN(O);break;case i.OPS.shadingFill:this.shadingFill(O[0]);break;case i.OPS.setDash:this.setDash(O[0],O[1]);break;case i.OPS.setRenderingIntent:this.setRenderingIntent(O[0]);break;case i.OPS.setFlatness:this.setFlatness(O[0]);break;case i.OPS.setGState:this.setGState(O[0]);break;case i.OPS.fill:this.fill();break;case i.OPS.eoFill:this.eoFill();break;case i.OPS.stroke:this.stroke();break;case i.OPS.fillStroke:this.fillStroke();break;case i.OPS.eoFillStroke:this.eoFillStroke();break;case i.OPS.clip:this.clip("nonzero");break;case i.OPS.eoClip:this.clip("evenodd");break;case i.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case i.OPS.paintImageXObject:this.paintImageXObject(O[0]);break;case i.OPS.paintInlineImageXObject:this.paintInlineImageXObject(O[0]);break;case i.OPS.paintImageMaskXObject:this.paintImageMaskXObject(O[0]);break;case i.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(O[0],O[1]);break;case i.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case i.OPS.closePath:this.closePath();break;case i.OPS.closeStroke:this.closeStroke();break;case i.OPS.closeFillStroke:this.closeFillStroke();break;case i.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case i.OPS.nextLine:this.nextLine();break;case i.OPS.transform:this.transform(O[0],O[1],O[2],O[3],O[4],O[5]);break;case i.OPS.constructPath:this.constructPath(O[0],O[1]);break;case i.OPS.endPath:this.endPath();break;case 92:this.group(w.items);break;default:(0,i.warn)(`Unimplemented operator ${B}`);break}}}setWordSpacing(b){this.current.wordSpacing=b}setCharSpacing(b){this.current.charSpacing=b}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(b,w,B,U,O,z){let V=this.current;V.textMatrix=V.lineMatrix=[b,w,B,U,O,z],V.textMatrixScale=Math.hypot(b,w),V.x=V.lineX=0,V.y=V.lineY=0,V.xcoords=[],V.ycoords=[],V.tspan=this.svgFactory.createElement("svg:tspan"),V.tspan.setAttributeNS(null,"font-family",V.fontFamily),V.tspan.setAttributeNS(null,"font-size",`${c(V.fontSize)}px`),V.tspan.setAttributeNS(null,"y",c(-V.y)),V.txtElement=this.svgFactory.createElement("svg:text"),V.txtElement.append(V.tspan)}beginText(){let b=this.current;b.x=b.lineX=0,b.y=b.lineY=0,b.textMatrix=i.IDENTITY_MATRIX,b.lineMatrix=i.IDENTITY_MATRIX,b.textMatrixScale=1,b.tspan=this.svgFactory.createElement("svg:tspan"),b.txtElement=this.svgFactory.createElement("svg:text"),b.txtgrp=this.svgFactory.createElement("svg:g"),b.xcoords=[],b.ycoords=[]}moveText(b,w){let B=this.current;B.x=B.lineX+=b,B.y=B.lineY+=w,B.xcoords=[],B.ycoords=[],B.tspan=this.svgFactory.createElement("svg:tspan"),B.tspan.setAttributeNS(null,"font-family",B.fontFamily),B.tspan.setAttributeNS(null,"font-size",`${c(B.fontSize)}px`),B.tspan.setAttributeNS(null,"y",c(-B.y))}showText(b){let w=this.current,B=w.font,U=w.fontSize;if(U===0)return;let O=w.fontSizeScale,z=w.charSpacing,V=w.wordSpacing,it=w.fontDirection,Q=w.textHScale*it,J=B.vertical,nt=J?1:-1,Z=B.defaultVMetrics,L=U*w.fontMatrix[0],S=0;for(let E of b){if(E===null){S+=it*V;continue}else if(typeof E=="number"){S+=nt*E*U/1e3;continue}let I=(E.isSpace?V:0)+z,F=E.fontChar,N,R,l=E.width;if(J){let P,D=E.vmetric||Z;P=E.vmetric?D[1]:l*.5,P=-P*L;let M=D[2]*L;l=D?-D[0]:l,N=P/O,R=(S+M)/O}else N=S/O,R=0;(E.isInFont||B.missingFile)&&(w.xcoords.push(w.x+N),J&&w.ycoords.push(-w.y+R),w.tspan.textContent+=F);let y=J?l*L-I*it:l*L+I*it;S+=y}w.tspan.setAttributeNS(null,"x",w.xcoords.map(c).join(" ")),J?w.tspan.setAttributeNS(null,"y",w.ycoords.map(c).join(" ")):w.tspan.setAttributeNS(null,"y",c(-w.y)),J?w.y-=S:w.x+=S*Q,w.tspan.setAttributeNS(null,"font-family",w.fontFamily),w.tspan.setAttributeNS(null,"font-size",`${c(w.fontSize)}px`),w.fontStyle!==u.fontStyle&&w.tspan.setAttributeNS(null,"font-style",w.fontStyle),w.fontWeight!==u.fontWeight&&w.tspan.setAttributeNS(null,"font-weight",w.fontWeight);let f=w.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;if(f===i.TextRenderingMode.FILL||f===i.TextRenderingMode.FILL_STROKE?(w.fillColor!==u.fillColor&&w.tspan.setAttributeNS(null,"fill",w.fillColor),w.fillAlpha<1&&w.tspan.setAttributeNS(null,"fill-opacity",w.fillAlpha)):w.textRenderingMode===i.TextRenderingMode.ADD_TO_PATH?w.tspan.setAttributeNS(null,"fill","transparent"):w.tspan.setAttributeNS(null,"fill","none"),f===i.TextRenderingMode.STROKE||f===i.TextRenderingMode.FILL_STROKE){let E=1/(w.textMatrixScale||1);this._setStrokeAttributes(w.tspan,E)}let g=w.textMatrix;w.textRise!==0&&(g=g.slice(),g[5]+=w.textRise),w.txtElement.setAttributeNS(null,"transform",`${a(g)} scale(${c(Q)}, -1)`),w.txtElement.setAttributeNS(_,"xml:space","preserve"),w.txtElement.append(w.tspan),w.txtgrp.append(w.txtElement),this._ensureTransformGroup().append(w.txtElement)}setLeadingMoveText(b,w){this.setLeading(-w),this.moveText(b,w)}addFontStyle(b){if(!b.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));let w=n(b.data,b.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${b.loadedName}"; src: url(${w}); }
`}setFont(b){let w=this.current,B=this.commonObjs.get(b[0]),U=b[1];w.font=B,this.embedFonts&&!B.missingFile&&!this.embeddedFonts[B.loadedName]&&(this.addFontStyle(B),this.embeddedFonts[B.loadedName]=B),w.fontMatrix=B.fontMatrix||i.FONT_IDENTITY_MATRIX;let O="normal";B.black?O="900":B.bold&&(O="bold");let z=B.italic?"italic":"normal";U<0?(U=-U,w.fontDirection=-1):w.fontDirection=1,w.fontSize=U,w.fontFamily=B.loadedName,w.fontWeight=O,w.fontStyle=z,w.tspan=this.svgFactory.createElement("svg:tspan"),w.tspan.setAttributeNS(null,"y",c(-w.y)),w.xcoords=[],w.ycoords=[]}endText(){let b=this.current;b.textRenderingMode&i.TextRenderingMode.ADD_TO_PATH_FLAG&&b.txtElement?.hasChildNodes()&&(b.element=b.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(b){b>0&&(this.current.lineWidth=b)}setLineCap(b){this.current.lineCap=x[b]}setLineJoin(b){this.current.lineJoin=h[b]}setMiterLimit(b){this.current.miterLimit=b}setStrokeAlpha(b){this.current.strokeAlpha=b}setStrokeRGBColor(b,w,B){this.current.strokeColor=i.Util.makeHexColor(b,w,B)}setFillAlpha(b){this.current.fillAlpha=b}setFillRGBColor(b,w,B){this.current.fillColor=i.Util.makeHexColor(b,w,B),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(b){this.current.strokeColor=this._makeColorN_Pattern(b)}setFillColorN(b){this.current.fillColor=this._makeColorN_Pattern(b)}shadingFill(b){let{width:w,height:B}=this.viewport,U=i.Util.inverseTransform(this.transformMatrix),[O,z,V,it]=i.Util.getAxialAlignedBoundingBox([0,0,w,B],U),Q=this.svgFactory.createElement("svg:rect");Q.setAttributeNS(null,"x",O),Q.setAttributeNS(null,"y",z),Q.setAttributeNS(null,"width",V-O),Q.setAttributeNS(null,"height",it-z),Q.setAttributeNS(null,"fill",this._makeShadingPattern(b)),this.current.fillAlpha<1&&Q.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Q)}_makeColorN_Pattern(b){return b[0]==="TilingPattern"?this._makeTilingPattern(b):this._makeShadingPattern(b)}_makeTilingPattern(b){let w=b[1],B=b[2],U=b[3]||i.IDENTITY_MATRIX,[O,z,V,it]=b[4],Q=b[5],J=b[6],nt=b[7],Z=`shading${v++}`,[L,S,f,g]=i.Util.normalizeRect([...i.Util.applyTransform([O,z],U),...i.Util.applyTransform([V,it],U)]),[E,I]=i.Util.singularValueDecompose2dScale(U),F=Q*E,N=J*I,R=this.svgFactory.createElement("svg:pattern");R.setAttributeNS(null,"id",Z),R.setAttributeNS(null,"patternUnits","userSpaceOnUse"),R.setAttributeNS(null,"width",F),R.setAttributeNS(null,"height",N),R.setAttributeNS(null,"x",`${L}`),R.setAttributeNS(null,"y",`${S}`);let l=this.svg,y=this.transformMatrix,P=this.current.fillColor,D=this.current.strokeColor,M=this.svgFactory.create(f-L,g-S);if(this.svg=M,this.transformMatrix=U,nt===2){let j=i.Util.makeHexColor(...w);this.current.fillColor=j,this.current.strokeColor=j}return this.executeOpTree(this.convertOpList(B)),this.svg=l,this.transformMatrix=y,this.current.fillColor=P,this.current.strokeColor=D,R.append(M.childNodes[0]),this.defs.append(R),`url(#${Z})`}_makeShadingPattern(b){switch(typeof b=="string"&&(b=this.objs.get(b)),b[0]){case"RadialAxial":let w=`shading${v++}`,B=b[3],U;switch(b[1]){case"axial":let O=b[4],z=b[5];U=this.svgFactory.createElement("svg:linearGradient"),U.setAttributeNS(null,"id",w),U.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),U.setAttributeNS(null,"x1",O[0]),U.setAttributeNS(null,"y1",O[1]),U.setAttributeNS(null,"x2",z[0]),U.setAttributeNS(null,"y2",z[1]);break;case"radial":let V=b[4],it=b[5],Q=b[6],J=b[7];U=this.svgFactory.createElement("svg:radialGradient"),U.setAttributeNS(null,"id",w),U.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),U.setAttributeNS(null,"cx",it[0]),U.setAttributeNS(null,"cy",it[1]),U.setAttributeNS(null,"r",J),U.setAttributeNS(null,"fx",V[0]),U.setAttributeNS(null,"fy",V[1]),U.setAttributeNS(null,"fr",Q);break;default:throw new Error(`Unknown RadialAxial type: ${b[1]}`)}for(let O of B){let z=this.svgFactory.createElement("svg:stop");z.setAttributeNS(null,"offset",O[0]),z.setAttributeNS(null,"stop-color",O[1]),U.append(z)}return this.defs.append(U),`url(#${w})`;case"Mesh":return(0,i.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${b[0]}`)}}setDash(b,w){this.current.dashArray=b,this.current.dashPhase=w}constructPath(b,w){let B=this.current,U=B.x,O=B.y,z=[],V=0;for(let it of b)switch(it|0){case i.OPS.rectangle:U=w[V++],O=w[V++];let Q=w[V++],J=w[V++],nt=U+Q,Z=O+J;z.push("M",c(U),c(O),"L",c(nt),c(O),"L",c(nt),c(Z),"L",c(U),c(Z),"Z");break;case i.OPS.moveTo:U=w[V++],O=w[V++],z.push("M",c(U),c(O));break;case i.OPS.lineTo:U=w[V++],O=w[V++],z.push("L",c(U),c(O));break;case i.OPS.curveTo:U=w[V+4],O=w[V+5],z.push("C",c(w[V]),c(w[V+1]),c(w[V+2]),c(w[V+3]),c(U),c(O)),V+=6;break;case i.OPS.curveTo2:z.push("C",c(U),c(O),c(w[V]),c(w[V+1]),c(w[V+2]),c(w[V+3])),U=w[V+2],O=w[V+3],V+=4;break;case i.OPS.curveTo3:U=w[V+2],O=w[V+3],z.push("C",c(w[V]),c(w[V+1]),c(U),c(O),c(U),c(O)),V+=4;break;case i.OPS.closePath:z.push("Z");break}z=z.join(" "),B.path&&b.length>0&&b[0]!==i.OPS.rectangle&&b[0]!==i.OPS.moveTo?z=B.path.getAttributeNS(null,"d")+z:(B.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(B.path)),B.path.setAttributeNS(null,"d",z),B.path.setAttributeNS(null,"fill","none"),B.element=B.path,B.setCurrentPoint(U,O)}endPath(){let b=this.current;if(b.path=null,!this.pendingClip)return;if(!b.element){this.pendingClip=null;return}let w=`clippath${p++}`,B=this.svgFactory.createElement("svg:clipPath");B.setAttributeNS(null,"id",w),B.setAttributeNS(null,"transform",a(this.transformMatrix));let U=b.element.cloneNode(!0);if(this.pendingClip==="evenodd"?U.setAttributeNS(null,"clip-rule","evenodd"):U.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,B.append(U),this.defs.append(B),b.activeClipUrl){b.clipGroup=null;for(let O of this.extraStack)O.clipGroup=null;B.setAttributeNS(null,"clip-path",b.activeClipUrl)}b.activeClipUrl=`url(#${w})`,this.tgrp=null}clip(b){this.pendingClip=b}closePath(){let b=this.current;if(b.path){let w=`${b.path.getAttributeNS(null,"d")}Z`;b.path.setAttributeNS(null,"d",w)}}setLeading(b){this.current.leading=-b}setTextRise(b){this.current.textRise=b}setTextRenderingMode(b){this.current.textRenderingMode=b}setHScale(b){this.current.textHScale=b/100}setRenderingIntent(b){}setFlatness(b){}setGState(b){for(let[w,B]of b)switch(w){case"LW":this.setLineWidth(B);break;case"LC":this.setLineCap(B);break;case"LJ":this.setLineJoin(B);break;case"ML":this.setMiterLimit(B);break;case"D":this.setDash(B[0],B[1]);break;case"RI":this.setRenderingIntent(B);break;case"FL":this.setFlatness(B);break;case"Font":this.setFont(B);break;case"CA":this.setStrokeAlpha(B);break;case"ca":this.setFillAlpha(B);break;default:(0,i.warn)(`Unimplemented graphic state operator ${w}`);break}}fill(){let b=this.current;b.element&&(b.element.setAttributeNS(null,"fill",b.fillColor),b.element.setAttributeNS(null,"fill-opacity",b.fillAlpha),this.endPath())}stroke(){let b=this.current;b.element&&(this._setStrokeAttributes(b.element),b.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(b,w=1){let B=this.current,U=B.dashArray;w!==1&&U.length>0&&(U=U.map(function(O){return w*O})),b.setAttributeNS(null,"stroke",B.strokeColor),b.setAttributeNS(null,"stroke-opacity",B.strokeAlpha),b.setAttributeNS(null,"stroke-miterlimit",c(B.miterLimit)),b.setAttributeNS(null,"stroke-linecap",B.lineCap),b.setAttributeNS(null,"stroke-linejoin",B.lineJoin),b.setAttributeNS(null,"stroke-width",c(w*B.lineWidth)+"px"),b.setAttributeNS(null,"stroke-dasharray",U.map(c).join(" ")),b.setAttributeNS(null,"stroke-dashoffset",c(w*B.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){let b=this.svgFactory.createElement("svg:rect");b.setAttributeNS(null,"x","0"),b.setAttributeNS(null,"y","0"),b.setAttributeNS(null,"width","1px"),b.setAttributeNS(null,"height","1px"),b.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(b)}paintImageXObject(b){let w=this.getObject(b);if(!w){(0,i.warn)(`Dependent image with object ID ${b} is not ready yet`);return}this.paintInlineImageXObject(w)}paintInlineImageXObject(b,w){let B=b.width,U=b.height,O=s(b,this.forceDataSchema,!!w),z=this.svgFactory.createElement("svg:rect");z.setAttributeNS(null,"x","0"),z.setAttributeNS(null,"y","0"),z.setAttributeNS(null,"width",c(B)),z.setAttributeNS(null,"height",c(U)),this.current.element=z,this.clip("nonzero");let V=this.svgFactory.createElement("svg:image");V.setAttributeNS(C,"xlink:href",O),V.setAttributeNS(null,"x","0"),V.setAttributeNS(null,"y",c(-U)),V.setAttributeNS(null,"width",c(B)+"px"),V.setAttributeNS(null,"height",c(U)+"px"),V.setAttributeNS(null,"transform",`scale(${c(1/B)} ${c(-1/U)})`),w?w.append(V):this._ensureTransformGroup().append(V)}paintImageMaskXObject(b){let w=this.getObject(b.data,b);if(w.bitmap){(0,i.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}let B=this.current,U=w.width,O=w.height,z=B.fillColor;B.maskId=`mask${m++}`;let V=this.svgFactory.createElement("svg:mask");V.setAttributeNS(null,"id",B.maskId);let it=this.svgFactory.createElement("svg:rect");it.setAttributeNS(null,"x","0"),it.setAttributeNS(null,"y","0"),it.setAttributeNS(null,"width",c(U)),it.setAttributeNS(null,"height",c(O)),it.setAttributeNS(null,"fill",z),it.setAttributeNS(null,"mask",`url(#${B.maskId})`),this.defs.append(V),this._ensureTransformGroup().append(it),this.paintInlineImageXObject(w,V)}paintFormXObjectBegin(b,w){if(Array.isArray(b)&&b.length===6&&this.transform(b[0],b[1],b[2],b[3],b[4],b[5]),w){let B=w[2]-w[0],U=w[3]-w[1],O=this.svgFactory.createElement("svg:rect");O.setAttributeNS(null,"x",w[0]),O.setAttributeNS(null,"y",w[1]),O.setAttributeNS(null,"width",c(B)),O.setAttributeNS(null,"height",c(U)),this.current.element=O,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(b){let w=this.svgFactory.create(b.width,b.height),B=this.svgFactory.createElement("svg:defs");w.append(B),this.defs=B;let U=this.svgFactory.createElement("svg:g");return U.setAttributeNS(null,"transform",a(b.transform)),w.append(U),this.svg=U,w}_ensureClipGroup(){if(!this.current.clipGroup){let b=this.svgFactory.createElement("svg:g");b.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(b),this.current.clipGroup=b}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",a(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}t.SVGGraphics=k},(A,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaText=void 0;class o{static textContent(i){let u=[],_={items:u,styles:Object.create(null)};function C(x){if(!x)return;let h=null,n=x.name;if(n==="#text")h=x.value;else if(o.shouldBuildText(n))x?.attributes?.textContent?h=x.attributes.textContent:x.value&&(h=x.value);else return;if(h!==null&&u.push({str:h}),!!x.children)for(let s of x.children)C(s)}return C(i),_}static shouldBuildText(i){return!(i==="textarea"||i==="input"||i==="option"||i==="select")}}t.XfaText=o},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayerRenderTask=void 0,t.renderTextLayer=a,t.updateTextLayer=p;var e=o(1),i=o(6);let u=1e5,_=30,C=.8,x=new Map;function h(m,v){let k;if(v&&e.FeatureTest.isOffscreenCanvasSupported)k=new OffscreenCanvas(m,m).getContext("2d",{alpha:!1});else{let T=document.createElement("canvas");T.width=T.height=m,k=T.getContext("2d",{alpha:!1})}return k}function n(m,v){let k=x.get(m);if(k)return k;let T=h(_,v);T.font=`${_}px ${m}`;let b=T.measureText(""),w=b.fontBoundingBoxAscent,B=Math.abs(b.fontBoundingBoxDescent);if(w){let O=w/(w+B);return x.set(m,O),T.canvas.width=T.canvas.height=0,O}T.strokeStyle="red",T.clearRect(0,0,_,_),T.strokeText("g",0,0);let U=T.getImageData(0,0,_,_).data;B=0;for(let O=U.length-1-3;O>=0;O-=4)if(U[O]>0){B=Math.ceil(O/4/_);break}T.clearRect(0,0,_,_),T.strokeText("A",0,_),U=T.getImageData(0,0,_,_).data,w=0;for(let O=0,z=U.length;O<z;O+=4)if(U[O]>0){w=_-Math.floor(O/4/_);break}if(T.canvas.width=T.canvas.height=0,w){let O=w/(w+B);return x.set(m,O),O}return x.set(m,C),C}function s(m,v,k){let T=document.createElement("span"),b={angle:0,canvasWidth:0,hasText:v.str!=="",hasEOL:v.hasEOL,fontSize:0};m._textDivs.push(T);let w=e.Util.transform(m._transform,v.transform),B=Math.atan2(w[1],w[0]),U=k[v.fontName];U.vertical&&(B+=Math.PI/2);let O=Math.hypot(w[2],w[3]),z=O*n(U.fontFamily,m._isOffscreenCanvasSupported),V,it;B===0?(V=w[4],it=w[5]-z):(V=w[4]+z*Math.sin(B),it=w[5]-z*Math.cos(B));let Q="calc(var(--scale-factor)*",J=T.style;m._container===m._rootContainer?(J.left=`${(100*V/m._pageWidth).toFixed(2)}%`,J.top=`${(100*it/m._pageHeight).toFixed(2)}%`):(J.left=`${Q}${V.toFixed(2)}px)`,J.top=`${Q}${it.toFixed(2)}px)`),J.fontSize=`${Q}${O.toFixed(2)}px)`,J.fontFamily=U.fontFamily,b.fontSize=O,T.setAttribute("role","presentation"),T.textContent=v.str,T.dir=v.dir,m._fontInspectorEnabled&&(T.dataset.fontName=v.fontName),B!==0&&(b.angle=B*(180/Math.PI));let nt=!1;if(v.str.length>1)nt=!0;else if(v.str!==" "&&v.transform[0]!==v.transform[3]){let Z=Math.abs(v.transform[0]),L=Math.abs(v.transform[3]);Z!==L&&Math.max(Z,L)/Math.min(Z,L)>1.5&&(nt=!0)}nt&&(b.canvasWidth=U.vertical?v.height:v.width),m._textDivProperties.set(T,b),m._isReadableStream&&m._layoutText(T)}function r(m){let{div:v,scale:k,properties:T,ctx:b,prevFontSize:w,prevFontFamily:B}=m,{style:U}=v,O="";if(T.canvasWidth!==0&&T.hasText){let{fontFamily:z}=U,{canvasWidth:V,fontSize:it}=T;(w!==it||B!==z)&&(b.font=`${it*k}px ${z}`,m.prevFontSize=it,m.prevFontFamily=z);let{width:Q}=b.measureText(v.textContent);Q>0&&(O=`scaleX(${V*k/Q})`)}T.angle!==0&&(O=`rotate(${T.angle}deg) ${O}`),O.length>0&&(U.transform=O)}function d(m){if(m._canceled)return;let v=m._textDivs,k=m._capability;if(v.length>u){k.resolve();return}if(!m._isReadableStream)for(let b of v)m._layoutText(b);k.resolve()}class c{constructor({textContentSource:v,container:k,viewport:T,textDivs:b,textDivProperties:w,textContentItemsStr:B,isOffscreenCanvasSupported:U}){this._textContentSource=v,this._isReadableStream=v instanceof ReadableStream,this._container=this._rootContainer=k,this._textDivs=b||[],this._textContentItemsStr=B||[],this._isOffscreenCanvasSupported=U,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=w||new WeakMap,this._canceled=!1,this._capability=new e.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:T.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:h(0,U)};let{pageWidth:O,pageHeight:z,pageX:V,pageY:it}=T.rawDims;this._transform=[1,0,0,-1,-V,it+z],this._pageWidth=O,this._pageHeight=z,(0,i.setLayerDimensions)(k,T),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new e.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new e.AbortException("TextLayer task cancelled."))}_processItems(v,k){for(let T of v){if(T.str===void 0){if(T.type==="beginMarkedContentProps"||T.type==="beginMarkedContent"){let b=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),T.id!==null&&this._container.setAttribute("id",`${T.id}`),b.append(this._container)}else T.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(T.str),s(this,T,k)}}_layoutText(v){let k=this._layoutTextParams.properties=this._textDivProperties.get(v);if(this._layoutTextParams.div=v,r(this._layoutTextParams),k.hasText&&this._container.append(v),k.hasEOL){let T=document.createElement("br");T.setAttribute("role","presentation"),this._container.append(T)}}_render(){let v=new e.PromiseCapability,k=Object.create(null);if(this._isReadableStream){let T=()=>{this._reader.read().then(({value:b,done:w})=>{if(w){v.resolve();return}Object.assign(k,b.styles),this._processItems(b.items,k),T()},v.reject)};this._reader=this._textContentSource.getReader(),T()}else if(this._textContentSource){let{items:T,styles:b}=this._textContentSource;this._processItems(T,b),v.resolve()}else throw new Error('No "textContentSource" parameter specified.');v.promise.then(()=>{k=null,d(this)},this._capability.reject)}}t.TextLayerRenderTask=c;function a(m){!m.textContentSource&&(m.textContent||m.textContentStream)&&((0,i.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),m.textContentSource=m.textContent||m.textContentStream);let{container:v,viewport:k}=m,T=getComputedStyle(v),b=T.getPropertyValue("visibility"),w=parseFloat(T.getPropertyValue("--scale-factor"));b==="visible"&&(!w||Math.abs(w-k.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");let B=new c(m);return B._render(),B}function p({container:m,viewport:v,textDivs:k,textDivProperties:T,isOffscreenCanvasSupported:b,mustRotate:w=!0,mustRescale:B=!0}){if(w&&(0,i.setLayerDimensions)(m,{rotation:v.rotation}),B){let U=h(0,b),z={prevFontSize:null,prevFontFamily:null,div:null,scale:v.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:U};for(let V of k)z.properties=T.get(V),z.div=V,r(z)}}},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditorLayer=void 0;var e=o(1),i=o(4),u=o(28),_=o(33),C=o(6),x=o(34);let h=(()=>{class n{#t;#e=!1;#i=null;#s=this.pointerup.bind(this);#o=this.pointerdown.bind(this);#a=new Map;#r=!1;#l=!1;#c=!1;#n;static _initialized=!1;constructor({uiManager:r,pageIndex:d,div:c,accessibilityManager:a,annotationLayer:p,viewport:m,l10n:v}){let k=[u.FreeTextEditor,_.InkEditor,x.StampEditor];if(!n._initialized){n._initialized=!0;for(let T of k)T.initialize(v)}r.registerEditorTypes(k),this.#n=r,this.pageIndex=d,this.div=c,this.#t=a,this.#i=p,this.viewport=m,this.#n.addLayer(this)}get isEmpty(){return this.#a.size===0}updateToolbar(r){this.#n.updateToolbar(r)}updateMode(r=this.#n.getMode()){this.#f(),r===e.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),r!==e.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",r===e.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",r===e.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",r===e.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(r){if(!r&&this.#n.getMode()!==e.AnnotationEditorType.INK)return;if(!r){for(let c of this.#a.values())if(c.isEmpty()){c.setInBackground();return}}this.#d({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(r){this.#n.setEditingState(r)}addCommands(r){this.#n.addCommands(r)}enable(){this.div.style.pointerEvents="auto";let r=new Set;for(let c of this.#a.values())c.enableEditing(),c.annotationElementId&&r.add(c.annotationElementId);if(!this.#i)return;let d=this.#i.getEditableAnnotations();for(let c of d){if(c.hide(),this.#n.isDeletedAnnotationElement(c.data.id)||r.has(c.data.id))continue;let a=this.deserialize(c);a&&(this.addOrRebuild(a),a.enableEditing())}}disable(){this.#c=!0,this.div.style.pointerEvents="none";let r=new Set;for(let d of this.#a.values()){if(d.disableEditing(),!d.annotationElementId||d.serialize()!==null){r.add(d.annotationElementId);continue}this.getEditableAnnotation(d.annotationElementId)?.show(),d.remove()}if(this.#i){let d=this.#i.getEditableAnnotations();for(let c of d){let{id:a}=c.data;r.has(a)||this.#n.isDeletedAnnotationElement(a)||c.show()}}this.#f(),this.isEmpty&&(this.div.hidden=!0),this.#c=!1}getEditableAnnotation(r){return this.#i?.getEditableAnnotation(r)||null}setActiveEditor(r){this.#n.getActive()!==r&&this.#n.setActiveEditor(r)}enableClick(){this.div.addEventListener("pointerdown",this.#o),this.div.addEventListener("pointerup",this.#s)}disableClick(){this.div.removeEventListener("pointerdown",this.#o),this.div.removeEventListener("pointerup",this.#s)}attach(r){this.#a.set(r.id,r);let{annotationElementId:d}=r;d&&this.#n.isDeletedAnnotationElement(d)&&this.#n.removeDeletedAnnotationElement(r)}detach(r){this.#a.delete(r.id),this.#t?.removePointerInTextLayer(r.contentDiv),!this.#c&&r.annotationElementId&&this.#n.addDeletedAnnotationElement(r)}remove(r){this.detach(r),this.#n.removeEditor(r),r.div.contains(document.activeElement)&&setTimeout(()=>{this.#n.focusMainContainer()},0),r.div.remove(),r.isAttachedToDOM=!1,this.#l||this.addInkEditorIfNeeded(!1)}changeParent(r){r.parent!==this&&(r.annotationElementId&&(this.#n.addDeletedAnnotationElement(r.annotationElementId),i.AnnotationEditor.deleteAnnotationElement(r),r.annotationElementId=null),this.attach(r),r.parent?.detach(r),r.setParent(this),r.div&&r.isAttachedToDOM&&(r.div.remove(),this.div.append(r.div)))}add(r){if(this.changeParent(r),this.#n.addEditor(r),this.attach(r),!r.isAttachedToDOM){let d=r.render();this.div.append(d),r.isAttachedToDOM=!0}r.fixAndSetPosition(),r.onceAdded(),this.#n.addToAnnotationStorage(r)}moveEditorInDOM(r){if(!r.isAttachedToDOM)return;let{activeElement:d}=document;r.div.contains(d)&&(r._focusEventsAllowed=!1,setTimeout(()=>{r.div.contains(document.activeElement)?r._focusEventsAllowed=!0:(r.div.addEventListener("focusin",()=>{r._focusEventsAllowed=!0},{once:!0}),d.focus())},0)),r._structTreeParentId=this.#t?.moveElementInDOM(this.div,r.div,r.contentDiv,!0)}addOrRebuild(r){r.needsToBeRebuilt()?r.rebuild():this.add(r)}addUndoableEditor(r){let d=()=>r._uiManager.rebuild(r),c=()=>{r.remove()};this.addCommands({cmd:d,undo:c,mustExec:!1})}getNextId(){return this.#n.getId()}#p(r){switch(this.#n.getMode()){case e.AnnotationEditorType.FREETEXT:return new u.FreeTextEditor(r);case e.AnnotationEditorType.INK:return new _.InkEditor(r);case e.AnnotationEditorType.STAMP:return new x.StampEditor(r)}return null}pasteEditor(r,d){this.#n.updateToolbar(r),this.#n.updateMode(r);let{offsetX:c,offsetY:a}=this.#u(),p=this.getNextId(),m=this.#p(Qt({parent:this,id:p,x:c,y:a,uiManager:this.#n,isCentered:!0},d));m&&this.add(m)}deserialize(r){switch(r.annotationType??r.annotationEditorType){case e.AnnotationEditorType.FREETEXT:return u.FreeTextEditor.deserialize(r,this,this.#n);case e.AnnotationEditorType.INK:return _.InkEditor.deserialize(r,this,this.#n);case e.AnnotationEditorType.STAMP:return x.StampEditor.deserialize(r,this,this.#n)}return null}#d(r,d){let c=this.getNextId(),a=this.#p({parent:this,id:c,x:r.offsetX,y:r.offsetY,uiManager:this.#n,isCentered:d});return a&&this.add(a),a}#u(){let{x:r,y:d,width:c,height:a}=this.div.getBoundingClientRect(),p=Math.max(0,r),m=Math.max(0,d),v=Math.min(window.innerWidth,r+c),k=Math.min(window.innerHeight,d+a),T=(p+v)/2-r,b=(m+k)/2-d,[w,B]=this.viewport.rotation%180===0?[T,b]:[b,T];return{offsetX:w,offsetY:B}}addNewEditor(){this.#d(this.#u(),!0)}setSelected(r){this.#n.setSelected(r)}toggleSelected(r){this.#n.toggleSelected(r)}isSelected(r){return this.#n.isSelected(r)}unselect(r){this.#n.unselect(r)}pointerup(r){let{isMac:d}=e.FeatureTest.platform;if(!(r.button!==0||r.ctrlKey&&d)&&r.target===this.div&&this.#r){if(this.#r=!1,!this.#e){this.#e=!0;return}if(this.#n.getMode()===e.AnnotationEditorType.STAMP){this.#n.unselectAll();return}this.#d(r,!1)}}pointerdown(r){if(this.#r){this.#r=!1;return}let{isMac:d}=e.FeatureTest.platform;if(r.button!==0||r.ctrlKey&&d||r.target!==this.div)return;this.#r=!0;let c=this.#n.getActive();this.#e=!c||c.isEmpty()}findNewParent(r,d,c){let a=this.#n.findParent(d,c);return a===null||a===this?!1:(a.changeParent(r),!0)}destroy(){this.#n.getActive()?.parent===this&&(this.#n.commitOrRemove(),this.#n.setActiveEditor(null));for(let r of this.#a.values())this.#t?.removePointerInTextLayer(r.contentDiv),r.setParent(null),r.isAttachedToDOM=!1,r.div.remove();this.div=null,this.#a.clear(),this.#n.removeLayer(this)}#f(){this.#l=!0;for(let r of this.#a.values())r.isEmpty()&&r.remove();this.#l=!1}render({viewport:r}){this.viewport=r,(0,C.setLayerDimensions)(this.div,r);for(let d of this.#n.getEditors(this.pageIndex))this.add(d);this.updateMode()}update({viewport:r}){this.#n.commitOrRemove(),this.viewport=r,(0,C.setLayerDimensions)(this.div,{rotation:r.rotation}),this.updateMode()}get pageDimensions(){let{pageWidth:r,pageHeight:d}=this.viewport.rawDims;return[r,d]}}return n})();t.AnnotationEditorLayer=h},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FreeTextEditor=void 0;var e=o(1),i=o(5),u=o(4),_=o(29);let C=(()=>{class x extends u.AnnotationEditor{#t=this.editorDivBlur.bind(this);#e=this.editorDivFocus.bind(this);#i=this.editorDivInput.bind(this);#s=this.editorDivKeydown.bind(this);#o;#a="";#r=`${this.id}-editor`;#l;#c=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){let n=x.prototype,s=c=>c.isEmpty(),r=i.AnnotationEditorUIManager.TRANSLATE_SMALL,d=i.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,e.shadow)(this,"_keyboardManager",new i.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],n.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],n.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],n._translateEmpty,{args:[-r,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],n._translateEmpty,{args:[-d,0],checker:s}],[["ArrowRight","mac+ArrowRight"],n._translateEmpty,{args:[r,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],n._translateEmpty,{args:[d,0],checker:s}],[["ArrowUp","mac+ArrowUp"],n._translateEmpty,{args:[0,-r],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],n._translateEmpty,{args:[0,-d],checker:s}],[["ArrowDown","mac+ArrowDown"],n._translateEmpty,{args:[0,r],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],n._translateEmpty,{args:[0,d],checker:s}]]))}static _type="freetext";constructor(n){super(ge(Qt({},n),{name:"freeTextEditor"})),this.#o=n.color||x._defaultColor||u.AnnotationEditor._defaultLineColor,this.#l=n.fontSize||x._defaultFontSize}static initialize(n){u.AnnotationEditor.initialize(n,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});let s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(n,s){switch(n){case e.AnnotationEditorParamsType.FREETEXT_SIZE:x._defaultFontSize=s;break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:x._defaultColor=s;break}}updateParams(n,s){switch(n){case e.AnnotationEditorParamsType.FREETEXT_SIZE:this.#n(s);break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:this.#p(s);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,x._defaultFontSize],[e.AnnotationEditorParamsType.FREETEXT_COLOR,x._defaultColor||u.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,this.#l],[e.AnnotationEditorParamsType.FREETEXT_COLOR,this.#o]]}#n(n){let s=d=>{this.editorDiv.style.fontSize=`calc(${d}px * var(--scale-factor))`,this.translate(0,-(d-this.#l)*this.parentScale),this.#l=d,this.#u()},r=this.#l;this.addCommands({cmd:()=>{s(n)},undo:()=>{s(r)},mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#p(n){let s=this.#o;this.addCommands({cmd:()=>{this.#o=this.editorDiv.style.color=n},undo:()=>{this.#o=this.editorDiv.style.color=s},mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(n,s){this._uiManager.translateSelectedEditors(n,s,!0)}getInitialTranslation(){let n=this.parentScale;return[-x._internalPadding*n,-(x._internalPadding+this.#l)*n]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(e.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#s),this.editorDiv.addEventListener("focus",this.#e),this.editorDiv.addEventListener("blur",this.#t),this.editorDiv.addEventListener("input",this.#i))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#r),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#s),this.editorDiv.removeEventListener("focus",this.#e),this.editorDiv.removeEventListener("blur",this.#t),this.editorDiv.removeEventListener("input",this.#i),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(n){this._focusEventsAllowed&&(super.focusin(n),n.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){if(this.width){this.#m();return}this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}#d(){let n=this.editorDiv.getElementsByTagName("div");if(n.length===0)return this.editorDiv.innerText;let s=[];for(let r of n)s.push(r.innerText.replace(/\r\n?|\n/,""));return s.join(`
`)}#u(){let[n,s]=this.parentDimensions,r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{let{currentLayer:d,div:c}=this,a=c.style.display;c.style.display="hidden",d.div.append(this.div),r=c.getBoundingClientRect(),c.remove(),c.style.display=a}this.rotation%180===this.parentRotation%180?(this.width=r.width/n,this.height=r.height/s):(this.width=r.height/n,this.height=r.width/s),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();let n=this.#a,s=this.#a=this.#d().trimEnd();if(n===s)return;let r=d=>{if(this.#a=d,!d){this.remove();return}this.#f(),this._uiManager.rebuild(this),this.#u()};this.addCommands({cmd:()=>{r(s)},undo:()=>{r(n)},mustExec:!1}),this.#u()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(n){this.enterInEditMode()}keydown(n){n.target===this.div&&n.key==="Enter"&&(this.enterInEditMode(),n.preventDefault())}editorDivKeydown(n){x._keyboardManager.exec(this,n)}editorDivFocus(n){this.isEditing=!0}editorDivBlur(n){this.isEditing=!1}editorDivInput(n){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let n,s;this.width&&(n=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#r),this.enableEditing(),u.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(d=>this.editorDiv?.setAttribute("aria-label",d)),u.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(d=>this.editorDiv?.setAttribute("default-content",d)),this.editorDiv.contentEditable=!0;let{style:r}=this.editorDiv;if(r.fontSize=`calc(${this.#l}px * var(--scale-factor))`,r.color=this.#o,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,i.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){let[d,c]=this.parentDimensions;if(this.annotationElementId){let{position:a}=this.#c,[p,m]=this.getInitialTranslation();[p,m]=this.pageTranslationToScreen(p,m);let[v,k]=this.pageDimensions,[T,b]=this.pageTranslation,w,B;switch(this.rotation){case 0:w=n+(a[0]-T)/v,B=s+this.height-(a[1]-b)/k;break;case 90:w=n+(a[0]-T)/v,B=s-(a[1]-b)/k,[p,m]=[m,-p];break;case 180:w=n-this.width+(a[0]-T)/v,B=s-(a[1]-b)/k,[p,m]=[-p,-m];break;case 270:w=n+(a[0]-T-this.height*k)/v,B=s+(a[1]-b-this.width*v)/k,[p,m]=[-m,p];break}this.setAt(w*d,B*c,p,m)}else this.setAt(n*d,s*c,this.width*d,this.height*c);this.#f(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}#f(){if(this.editorDiv.replaceChildren(),!!this.#a)for(let n of this.#a.split(`
`)){let s=document.createElement("div");s.append(n?document.createTextNode(n):document.createElement("br")),this.editorDiv.append(s)}}get contentDiv(){return this.editorDiv}static deserialize(n,s,r){let d=null;if(n instanceof _.FreeTextAnnotationElement){let{data:{defaultAppearanceData:{fontSize:a,fontColor:p},rect:m,rotation:v,id:k},textContent:T,textPosition:b,parent:{page:{pageNumber:w}}}=n;if(!T||T.length===0)return null;d=n={annotationType:e.AnnotationEditorType.FREETEXT,color:Array.from(p),fontSize:a,value:T.join(`
`),position:b,pageIndex:w-1,rect:m,rotation:v,id:k,deleted:!1}}let c=super.deserialize(n,s,r);return c.#l=n.fontSize,c.#o=e.Util.makeHexColor(...n.color),c.#a=n.value,c.annotationElementId=n.id||null,c.#c=d,c}serialize(n=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};let s=x._internalPadding*this.parentScale,r=this.getRect(s,s),d=u.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#o),c={annotationType:e.AnnotationEditorType.FREETEXT,color:d,fontSize:this.#l,value:this.#a,pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return n?c:this.annotationElementId&&!this.#_(c)?null:(c.id=this.annotationElementId,c)}#_(n){let{value:s,fontSize:r,color:d,rect:c,pageIndex:a}=this.#c;return n.value!==s||n.fontSize!==r||n.rect.some((p,m)=>Math.abs(p-c[m])>=1)||n.color.some((p,m)=>p!==d[m])||n.pageIndex!==a}#m(n=!1){if(!this.annotationElementId)return;if(this.#u(),!n&&(this.width===0||this.height===0)){setTimeout(()=>this.#m(!0),0);return}let s=x._internalPadding*this.parentScale;this.#c.rect=this.getRect(s,s)}}return x})();t.FreeTextEditor=C},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StampAnnotationElement=t.InkAnnotationElement=t.FreeTextAnnotationElement=t.AnnotationLayer=void 0;var e=o(1),i=o(6),u=o(3),_=o(30),C=o(31),x=o(32);let h=1e3,n=9,s=new WeakSet;function r(R){return{width:R[2]-R[0],height:R[3]-R[1]}}class d{static create(l){switch(l.data.annotationType){case e.AnnotationType.LINK:return new a(l);case e.AnnotationType.TEXT:return new p(l);case e.AnnotationType.WIDGET:switch(l.data.fieldType){case"Tx":return new v(l);case"Btn":return l.data.radioButton?new b(l):l.data.checkBox?new T(l):new w(l);case"Ch":return new B(l);case"Sig":return new k(l)}return new m(l);case e.AnnotationType.POPUP:return new U(l);case e.AnnotationType.FREETEXT:return new z(l);case e.AnnotationType.LINE:return new V(l);case e.AnnotationType.SQUARE:return new it(l);case e.AnnotationType.CIRCLE:return new Q(l);case e.AnnotationType.POLYLINE:return new J(l);case e.AnnotationType.CARET:return new Z(l);case e.AnnotationType.INK:return new L(l);case e.AnnotationType.POLYGON:return new nt(l);case e.AnnotationType.HIGHLIGHT:return new S(l);case e.AnnotationType.UNDERLINE:return new f(l);case e.AnnotationType.SQUIGGLY:return new g(l);case e.AnnotationType.STRIKEOUT:return new E(l);case e.AnnotationType.STAMP:return new I(l);case e.AnnotationType.FILEATTACHMENT:return new F(l);default:return new c(l)}}}class c{#t=!1;constructor(l,{isRenderable:y=!1,ignoreBorder:P=!1,createQuadrilaterals:D=!1}={}){this.isRenderable=y,this.data=l.data,this.layer=l.layer,this.linkService=l.linkService,this.downloadManager=l.downloadManager,this.imageResourcesPath=l.imageResourcesPath,this.renderForms=l.renderForms,this.svgFactory=l.svgFactory,this.annotationStorage=l.annotationStorage,this.enableScripting=l.enableScripting,this.hasJSActions=l.hasJSActions,this._fieldObjects=l.fieldObjects,this.parent=l.parent,y&&(this.container=this._createContainer(P)),D&&this._createQuadrilaterals()}static _hasPopupData({titleObj:l,contentsObj:y,richText:P}){return!!(l?.str||y?.str||P?.str)}get hasPopupData(){return c._hasPopupData(this.data)}_createContainer(l){let{data:y,parent:{page:P,viewport:D}}=this,M=document.createElement("section");M.setAttribute("data-annotation-id",y.id),this instanceof m||(M.tabIndex=h),M.style.zIndex=this.parent.zIndex++,this.data.popupRef&&M.setAttribute("aria-haspopup","dialog"),y.noRotate&&M.classList.add("norotate");let{pageWidth:j,pageHeight:H,pageX:X,pageY:st}=D.rawDims;if(!y.rect||this instanceof U){let{rotation:tt}=y;return!y.hasOwnCanvas&&tt!==0&&this.setRotation(tt,M),M}let{width:q,height:$}=r(y.rect),Y=e.Util.normalizeRect([y.rect[0],P.view[3]-y.rect[1]+P.view[1],y.rect[2],P.view[3]-y.rect[3]+P.view[1]]);if(!l&&y.borderStyle.width>0){M.style.borderWidth=`${y.borderStyle.width}px`;let tt=y.borderStyle.horizontalCornerRadius,rt=y.borderStyle.verticalCornerRadius;if(tt>0||rt>0){let lt=`calc(${tt}px * var(--scale-factor)) / calc(${rt}px * var(--scale-factor))`;M.style.borderRadius=lt}else if(this instanceof b){let lt=`calc(${q}px * var(--scale-factor)) / calc(${$}px * var(--scale-factor))`;M.style.borderRadius=lt}switch(y.borderStyle.style){case e.AnnotationBorderStyleType.SOLID:M.style.borderStyle="solid";break;case e.AnnotationBorderStyleType.DASHED:M.style.borderStyle="dashed";break;case e.AnnotationBorderStyleType.BEVELED:(0,e.warn)("Unimplemented border style: beveled");break;case e.AnnotationBorderStyleType.INSET:(0,e.warn)("Unimplemented border style: inset");break;case e.AnnotationBorderStyleType.UNDERLINE:M.style.borderBottomStyle="solid";break;default:break}let ot=y.borderColor||null;ot?(this.#t=!0,M.style.borderColor=e.Util.makeHexColor(ot[0]|0,ot[1]|0,ot[2]|0)):M.style.borderWidth=0}M.style.left=`${100*(Y[0]-X)/j}%`,M.style.top=`${100*(Y[1]-st)/H}%`;let{rotation:K}=y;return y.hasOwnCanvas||K===0?(M.style.width=`${100*q/j}%`,M.style.height=`${100*$/H}%`):this.setRotation(K,M),M}setRotation(l,y=this.container){if(!this.data.rect)return;let{pageWidth:P,pageHeight:D}=this.parent.viewport.rawDims,{width:M,height:j}=r(this.data.rect),H,X;l%180===0?(H=100*M/P,X=100*j/D):(H=100*j/P,X=100*M/D),y.style.width=`${H}%`,y.style.height=`${X}%`,y.setAttribute("data-main-rotation",(360-l)%360)}get _commonActions(){let l=(y,P,D)=>{let M=D.detail[y],j=M[0],H=M.slice(1);D.target.style[P]=_.ColorConverters[`${j}_HTML`](H),this.annotationStorage.setValue(this.data.id,{[P]:_.ColorConverters[`${j}_rgb`](H)})};return(0,e.shadow)(this,"_commonActions",{display:y=>{let{display:P}=y.detail,D=P%2===1;this.container.style.visibility=D?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:D,noPrint:P===1||P===2})},print:y=>{this.annotationStorage.setValue(this.data.id,{noPrint:!y.detail.print})},hidden:y=>{let{hidden:P}=y.detail;this.container.style.visibility=P?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:P,noView:P})},focus:y=>{setTimeout(()=>y.target.focus({preventScroll:!1}),0)},userName:y=>{y.target.title=y.detail.userName},readonly:y=>{y.target.disabled=y.detail.readonly},required:y=>{this._setRequired(y.target,y.detail.required)},bgColor:y=>{l("bgColor","backgroundColor",y)},fillColor:y=>{l("fillColor","backgroundColor",y)},fgColor:y=>{l("fgColor","color",y)},textColor:y=>{l("textColor","color",y)},borderColor:y=>{l("borderColor","borderColor",y)},strokeColor:y=>{l("strokeColor","borderColor",y)},rotation:y=>{let P=y.detail.rotation;this.setRotation(P),this.annotationStorage.setValue(this.data.id,{rotation:P})}})}_dispatchEventFromSandbox(l,y){let P=this._commonActions;for(let D of Object.keys(y.detail))(l[D]||P[D])?.(y)}_setDefaultPropertiesFromJS(l){if(!this.enableScripting)return;let y=this.annotationStorage.getRawValue(this.data.id);if(!y)return;let P=this._commonActions;for(let[D,M]of Object.entries(y)){let j=P[D];if(j){let H={detail:{[D]:M},target:l};j(H),delete y[D]}}}_createQuadrilaterals(){if(!this.container)return;let{quadPoints:l}=this.data;if(!l)return;let[y,P,D,M]=this.data.rect;if(l.length===1){let[,{x:rt,y:ot},{x:lt,y:ct}]=l[0];if(D===rt&&M===ot&&y===lt&&P===ct)return}let{style:j}=this.container,H;if(this.#t){let{borderColor:rt,borderWidth:ot}=j;j.borderWidth=0,H=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${rt}" stroke-width="${ot}">`],this.container.classList.add("hasBorder")}let X=D-y,st=M-P,{svgFactory:q}=this,$=q.createElement("svg");$.classList.add("quadrilateralsContainer"),$.setAttribute("width",0),$.setAttribute("height",0);let Y=q.createElement("defs");$.append(Y);let K=q.createElement("clipPath"),tt=`clippath_${this.data.id}`;K.setAttribute("id",tt),K.setAttribute("clipPathUnits","objectBoundingBox"),Y.append(K);for(let[,{x:rt,y:ot},{x:lt,y:ct}]of l){let dt=q.createElement("rect"),pt=(lt-y)/X,Et=(M-ot)/st,vt=(rt-lt)/X,zt=(ot-ct)/st;dt.setAttribute("x",pt),dt.setAttribute("y",Et),dt.setAttribute("width",vt),dt.setAttribute("height",zt),K.append(dt),H?.push(`<rect vector-effect="non-scaling-stroke" x="${pt}" y="${Et}" width="${vt}" height="${zt}"/>`)}this.#t&&(H.push("</g></svg>')"),j.backgroundImage=H.join("")),this.container.append($),this.container.style.clipPath=`url(#${tt})`}_createPopup(){let{container:l,data:y}=this;l.setAttribute("aria-haspopup","dialog");let P=new U({data:{color:y.color,titleObj:y.titleObj,modificationDate:y.modificationDate,contentsObj:y.contentsObj,richText:y.richText,parentRect:y.rect,borderStyle:0,id:`popup_${y.id}`,rotation:y.rotation},parent:this.parent,elements:[this]});this.parent.div.append(P.render())}render(){(0,e.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(l,y=null){let P=[];if(this._fieldObjects){let D=this._fieldObjects[l];if(D)for(let{page:M,id:j,exportValues:H}of D){if(M===-1||j===y)continue;let X=typeof H=="string"?H:null,st=document.querySelector(`[data-element-id="${j}"]`);if(st&&!s.has(st)){(0,e.warn)(`_getElementsByName - element not allowed: ${j}`);continue}P.push({id:j,exportValue:X,domElement:st})}return P}for(let D of document.getElementsByName(l)){let{exportValue:M}=D,j=D.getAttribute("data-element-id");j!==y&&s.has(D)&&P.push({id:j,exportValue:M,domElement:D})}return P}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){let l=this.getElementsToTriggerPopup();if(Array.isArray(l))for(let y of l)y.classList.add("highlightArea");else l.classList.add("highlightArea")}_editOnDoubleClick(){let{annotationEditorType:l,data:{id:y}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:l,editId:y})})}}class a extends c{constructor(l,y=null){super(l,{isRenderable:!0,ignoreBorder:!!y?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=l.data.isTooltipOnly}render(){let{data:l,linkService:y}=this,P=document.createElement("a");P.setAttribute("data-element-id",l.id);let D=!1;return l.url?(y.addLinkAttributes(P,l.url,l.newWindow),D=!0):l.action?(this._bindNamedAction(P,l.action),D=!0):l.attachment?(this._bindAttachment(P,l.attachment),D=!0):l.setOCGState?(this.#e(P,l.setOCGState),D=!0):l.dest?(this._bindLink(P,l.dest),D=!0):(l.actions&&(l.actions.Action||l.actions["Mouse Up"]||l.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(P,l),D=!0),l.resetForm?(this._bindResetFormAction(P,l.resetForm),D=!0):this.isTooltipOnly&&!D&&(this._bindLink(P,""),D=!0)),this.container.classList.add("linkAnnotation"),D&&this.container.append(P),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(l,y){l.href=this.linkService.getDestinationHash(y),l.onclick=()=>(y&&this.linkService.goToDestination(y),!1),(y||y==="")&&this.#t()}_bindNamedAction(l,y){l.href=this.linkService.getAnchorUrl(""),l.onclick=()=>(this.linkService.executeNamedAction(y),!1),this.#t()}_bindAttachment(l,y){l.href=this.linkService.getAnchorUrl(""),l.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,y.content,y.filename),!1),this.#t()}#e(l,y){l.href=this.linkService.getAnchorUrl(""),l.onclick=()=>(this.linkService.executeSetOCGState(y),!1),this.#t()}_bindJSAction(l,y){l.href=this.linkService.getAnchorUrl("");let P=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(let D of Object.keys(y.actions)){let M=P.get(D);M&&(l[M]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:y.id,name:D}}),!1))}l.onclick||(l.onclick=()=>!1),this.#t()}_bindResetFormAction(l,y){let P=l.onclick;if(P||(l.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){(0,e.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),P||(l.onclick=()=>!1);return}l.onclick=()=>{P?.();let{fields:D,refs:M,include:j}=y,H=[];if(D.length!==0||M.length!==0){let q=new Set(M);for(let $ of D){let Y=this._fieldObjects[$]||[];for(let{id:K}of Y)q.add(K)}for(let $ of Object.values(this._fieldObjects))for(let Y of $)q.has(Y.id)===j&&H.push(Y)}else for(let q of Object.values(this._fieldObjects))H.push(...q);let X=this.annotationStorage,st=[];for(let q of H){let{id:$}=q;switch(st.push($),q.type){case"text":{let K=q.defaultValue||"";X.setValue($,{value:K});break}case"checkbox":case"radiobutton":{let K=q.defaultValue===q.exportValues;X.setValue($,{value:K});break}case"combobox":case"listbox":{let K=q.defaultValue||"";X.setValue($,{value:K});break}default:continue}let Y=document.querySelector(`[data-element-id="${$}"]`);if(Y){if(!s.has(Y)){(0,e.warn)(`_bindResetFormAction - element not allowed: ${$}`);continue}}else continue;Y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:st,name:"ResetForm"}}),!1}}}class p extends c{constructor(l){super(l,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");let l=document.createElement("img");return l.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",l.alt="[{{type}} Annotation]",l.dataset.l10nId="text_annotation_type",l.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(l),this.container}}class m extends c{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(l){this.data.hasOwnCanvas&&(l.previousSibling?.nodeName==="CANVAS"&&(l.previousSibling.hidden=!0),l.hidden=!1)}_getKeyModifier(l){let{isWin:y,isMac:P}=e.FeatureTest.platform;return y&&l.ctrlKey||P&&l.metaKey}_setEventListener(l,y,P,D,M){P.includes("mouse")?l.addEventListener(P,j=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:D,value:M(j),shift:j.shiftKey,modifier:this._getKeyModifier(j)}})}):l.addEventListener(P,j=>{if(P==="blur"){if(!y.focused||!j.relatedTarget)return;y.focused=!1}else if(P==="focus"){if(y.focused)return;y.focused=!0}M&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:D,value:M(j)}})})}_setEventListeners(l,y,P,D){for(let[M,j]of P)(j==="Action"||this.data.actions?.[j])&&((j==="Focus"||j==="Blur")&&(y||={focused:!1}),this._setEventListener(l,y,M,j,D),j==="Focus"&&!this.data.actions?.Blur?this._setEventListener(l,y,"blur","Blur",null):j==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(l,y,"focus","Focus",null))}_setBackgroundColor(l){let y=this.data.backgroundColor||null;l.style.backgroundColor=y===null?"transparent":e.Util.makeHexColor(y[0],y[1],y[2])}_setTextStyle(l){let y=["left","center","right"],{fontColor:P}=this.data.defaultAppearanceData,D=this.data.defaultAppearanceData.fontSize||n,M=l.style,j,H=2,X=st=>Math.round(10*st)/10;if(this.data.multiLine){let st=Math.abs(this.data.rect[3]-this.data.rect[1]-H),q=Math.round(st/(e.LINE_FACTOR*D))||1,$=st/q;j=Math.min(D,X($/e.LINE_FACTOR))}else{let st=Math.abs(this.data.rect[3]-this.data.rect[1]-H);j=Math.min(D,X(st/e.LINE_FACTOR))}M.fontSize=`calc(${j}px * var(--scale-factor))`,M.color=e.Util.makeHexColor(P[0],P[1],P[2]),this.data.textAlignment!==null&&(M.textAlign=y[this.data.textAlignment])}_setRequired(l,y){y?l.setAttribute("required",!0):l.removeAttribute("required"),l.setAttribute("aria-required",y)}}class v extends m{constructor(l){let y=l.renderForms||!l.data.hasAppearance&&!!l.data.fieldValue;super(l,{isRenderable:y})}setPropertyOnSiblings(l,y,P,D){let M=this.annotationStorage;for(let j of this._getElementsByName(l.name,l.id))j.domElement&&(j.domElement[y]=P),M.setValue(j.id,{[D]:P})}render(){let l=this.annotationStorage,y=this.data.id;this.container.classList.add("textWidgetAnnotation");let P=null;if(this.renderForms){let D=l.getValue(y,{value:this.data.fieldValue}),M=D.value||"",j=l.getValue(y,{charLimit:this.data.maxLen}).charLimit;j&&M.length>j&&(M=M.slice(0,j));let H=D.formattedValue||this.data.textContent?.join(`
`)||null;H&&this.data.comb&&(H=H.replaceAll(/\s+/g,""));let X={userValue:M,formattedValue:H,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(P=document.createElement("textarea"),P.textContent=H??M,this.data.doNotScroll&&(P.style.overflowY="hidden")):(P=document.createElement("input"),P.type="text",P.setAttribute("value",H??M),this.data.doNotScroll&&(P.style.overflowX="hidden")),this.data.hasOwnCanvas&&(P.hidden=!0),s.add(P),P.setAttribute("data-element-id",y),P.disabled=this.data.readOnly,P.name=this.data.fieldName,P.tabIndex=h,this._setRequired(P,this.data.required),j&&(P.maxLength=j),P.addEventListener("input",q=>{l.setValue(y,{value:q.target.value}),this.setPropertyOnSiblings(P,"value",q.target.value,"value"),X.formattedValue=null}),P.addEventListener("resetform",q=>{let $=this.data.defaultFieldValue??"";P.value=X.userValue=$,X.formattedValue=null});let st=q=>{let{formattedValue:$}=X;$!=null&&(q.target.value=$),q.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){P.addEventListener("focus",$=>{if(X.focused)return;let{target:Y}=$;X.userValue&&(Y.value=X.userValue),X.lastCommittedValue=Y.value,X.commitKey=1,X.focused=!0}),P.addEventListener("updatefromsandbox",$=>{this.showElementAndHideCanvas($.target);let Y={value(K){X.userValue=K.detail.value??"",l.setValue(y,{value:X.userValue.toString()}),K.target.value=X.userValue},formattedValue(K){let{formattedValue:tt}=K.detail;X.formattedValue=tt,tt!=null&&K.target!==document.activeElement&&(K.target.value=tt),l.setValue(y,{formattedValue:tt})},selRange(K){K.target.setSelectionRange(...K.detail.selRange)},charLimit:K=>{let{charLimit:tt}=K.detail,{target:rt}=K;if(tt===0){rt.removeAttribute("maxLength");return}rt.setAttribute("maxLength",tt);let ot=X.userValue;!ot||ot.length<=tt||(ot=ot.slice(0,tt),rt.value=X.userValue=ot,l.setValue(y,{value:ot}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:y,name:"Keystroke",value:ot,willCommit:!0,commitKey:1,selStart:rt.selectionStart,selEnd:rt.selectionEnd}}))}};this._dispatchEventFromSandbox(Y,$)}),P.addEventListener("keydown",$=>{X.commitKey=1;let Y=-1;if($.key==="Escape"?Y=0:$.key==="Enter"&&!this.data.multiLine?Y=2:$.key==="Tab"&&(X.commitKey=3),Y===-1)return;let{value:K}=$.target;X.lastCommittedValue!==K&&(X.lastCommittedValue=K,X.userValue=K,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:y,name:"Keystroke",value:K,willCommit:!0,commitKey:Y,selStart:$.target.selectionStart,selEnd:$.target.selectionEnd}}))});let q=st;st=null,P.addEventListener("blur",$=>{if(!X.focused||!$.relatedTarget)return;X.focused=!1;let{value:Y}=$.target;X.userValue=Y,X.lastCommittedValue!==Y&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:y,name:"Keystroke",value:Y,willCommit:!0,commitKey:X.commitKey,selStart:$.target.selectionStart,selEnd:$.target.selectionEnd}}),q($)}),this.data.actions?.Keystroke&&P.addEventListener("beforeinput",$=>{X.lastCommittedValue=null;let{data:Y,target:K}=$,{value:tt,selectionStart:rt,selectionEnd:ot}=K,lt=rt,ct=ot;switch($.inputType){case"deleteWordBackward":{let dt=tt.substring(0,rt).match(/\w*[^\w]*$/);dt&&(lt-=dt[0].length);break}case"deleteWordForward":{let dt=tt.substring(rt).match(/^[^\w]*\w*/);dt&&(ct+=dt[0].length);break}case"deleteContentBackward":rt===ot&&(lt-=1);break;case"deleteContentForward":rt===ot&&(ct+=1);break}$.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:y,name:"Keystroke",value:tt,change:Y||"",willCommit:!1,selStart:lt,selEnd:ct}})}),this._setEventListeners(P,X,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],$=>$.target.value)}if(st&&P.addEventListener("blur",st),this.data.comb){let $=(this.data.rect[2]-this.data.rect[0])/j;P.classList.add("comb"),P.style.letterSpacing=`calc(${$}px * var(--scale-factor) - 1ch)`}}else P=document.createElement("div"),P.textContent=this.data.fieldValue,P.style.verticalAlign="middle",P.style.display="table-cell";return this._setTextStyle(P),this._setBackgroundColor(P),this._setDefaultPropertiesFromJS(P),this.container.append(P),this.container}}class k extends m{constructor(l){super(l,{isRenderable:!!l.data.hasOwnCanvas})}}class T extends m{constructor(l){super(l,{isRenderable:l.renderForms})}render(){let l=this.annotationStorage,y=this.data,P=y.id,D=l.getValue(P,{value:y.exportValue===y.fieldValue}).value;typeof D=="string"&&(D=D!=="Off",l.setValue(P,{value:D})),this.container.classList.add("buttonWidgetAnnotation","checkBox");let M=document.createElement("input");return s.add(M),M.setAttribute("data-element-id",P),M.disabled=y.readOnly,this._setRequired(M,this.data.required),M.type="checkbox",M.name=y.fieldName,D&&M.setAttribute("checked",!0),M.setAttribute("exportValue",y.exportValue),M.tabIndex=h,M.addEventListener("change",j=>{let{name:H,checked:X}=j.target;for(let st of this._getElementsByName(H,P)){let q=X&&st.exportValue===y.exportValue;st.domElement&&(st.domElement.checked=q),l.setValue(st.id,{value:q})}l.setValue(P,{value:X})}),M.addEventListener("resetform",j=>{let H=y.defaultFieldValue||"Off";j.target.checked=H===y.exportValue}),this.enableScripting&&this.hasJSActions&&(M.addEventListener("updatefromsandbox",j=>{let H={value(X){X.target.checked=X.detail.value!=="Off",l.setValue(P,{value:X.target.checked})}};this._dispatchEventFromSandbox(H,j)}),this._setEventListeners(M,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],j=>j.target.checked)),this._setBackgroundColor(M),this._setDefaultPropertiesFromJS(M),this.container.append(M),this.container}}class b extends m{constructor(l){super(l,{isRenderable:l.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");let l=this.annotationStorage,y=this.data,P=y.id,D=l.getValue(P,{value:y.fieldValue===y.buttonValue}).value;typeof D=="string"&&(D=D!==y.buttonValue,l.setValue(P,{value:D}));let M=document.createElement("input");if(s.add(M),M.setAttribute("data-element-id",P),M.disabled=y.readOnly,this._setRequired(M,this.data.required),M.type="radio",M.name=y.fieldName,D&&M.setAttribute("checked",!0),M.tabIndex=h,M.addEventListener("change",j=>{let{name:H,checked:X}=j.target;for(let st of this._getElementsByName(H,P))l.setValue(st.id,{value:!1});l.setValue(P,{value:X})}),M.addEventListener("resetform",j=>{let H=y.defaultFieldValue;j.target.checked=H!=null&&H===y.buttonValue}),this.enableScripting&&this.hasJSActions){let j=y.buttonValue;M.addEventListener("updatefromsandbox",H=>{let X={value:st=>{let q=j===st.detail.value;for(let $ of this._getElementsByName(st.target.name)){let Y=q&&$.id===P;$.domElement&&($.domElement.checked=Y),l.setValue($.id,{value:Y})}}};this._dispatchEventFromSandbox(X,H)}),this._setEventListeners(M,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],H=>H.target.checked)}return this._setBackgroundColor(M),this._setDefaultPropertiesFromJS(M),this.container.append(M),this.container}}class w extends a{constructor(l){super(l,{ignoreBorder:l.data.hasAppearance})}render(){let l=super.render();l.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(l.title=this.data.alternativeText);let y=l.lastChild;return this.enableScripting&&this.hasJSActions&&y&&(this._setDefaultPropertiesFromJS(y),y.addEventListener("updatefromsandbox",P=>{this._dispatchEventFromSandbox({},P)})),l}}class B extends m{constructor(l){super(l,{isRenderable:l.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");let l=this.annotationStorage,y=this.data.id,P=l.getValue(y,{value:this.data.fieldValue}),D=document.createElement("select");s.add(D),D.setAttribute("data-element-id",y),D.disabled=this.data.readOnly,this._setRequired(D,this.data.required),D.name=this.data.fieldName,D.tabIndex=h;let M=this.data.combo&&this.data.options.length>0;this.data.combo||(D.size=this.data.options.length,this.data.multiSelect&&(D.multiple=!0)),D.addEventListener("resetform",q=>{let $=this.data.defaultFieldValue;for(let Y of D.options)Y.selected=Y.value===$});for(let q of this.data.options){let $=document.createElement("option");$.textContent=q.displayValue,$.value=q.exportValue,P.value.includes(q.exportValue)&&($.setAttribute("selected",!0),M=!1),D.append($)}let j=null;if(M){let q=document.createElement("option");q.value=" ",q.setAttribute("hidden",!0),q.setAttribute("selected",!0),D.prepend(q),j=()=>{q.remove(),D.removeEventListener("input",j),j=null},D.addEventListener("input",j)}let H=q=>{let $=q?"value":"textContent",{options:Y,multiple:K}=D;return K?Array.prototype.filter.call(Y,tt=>tt.selected).map(tt=>tt[$]):Y.selectedIndex===-1?null:Y[Y.selectedIndex][$]},X=H(!1),st=q=>{let $=q.target.options;return Array.prototype.map.call($,Y=>({displayValue:Y.textContent,exportValue:Y.value}))};return this.enableScripting&&this.hasJSActions?(D.addEventListener("updatefromsandbox",q=>{let $={value(Y){j?.();let K=Y.detail.value,tt=new Set(Array.isArray(K)?K:[K]);for(let rt of D.options)rt.selected=tt.has(rt.value);l.setValue(y,{value:H(!0)}),X=H(!1)},multipleSelection(Y){D.multiple=!0},remove(Y){let K=D.options,tt=Y.detail.remove;K[tt].selected=!1,D.remove(tt),K.length>0&&Array.prototype.findIndex.call(K,ot=>ot.selected)===-1&&(K[0].selected=!0),l.setValue(y,{value:H(!0),items:st(Y)}),X=H(!1)},clear(Y){for(;D.length!==0;)D.remove(0);l.setValue(y,{value:null,items:[]}),X=H(!1)},insert(Y){let{index:K,displayValue:tt,exportValue:rt}=Y.detail.insert,ot=D.children[K],lt=document.createElement("option");lt.textContent=tt,lt.value=rt,ot?ot.before(lt):D.append(lt),l.setValue(y,{value:H(!0),items:st(Y)}),X=H(!1)},items(Y){let{items:K}=Y.detail;for(;D.length!==0;)D.remove(0);for(let tt of K){let{displayValue:rt,exportValue:ot}=tt,lt=document.createElement("option");lt.textContent=rt,lt.value=ot,D.append(lt)}D.options.length>0&&(D.options[0].selected=!0),l.setValue(y,{value:H(!0),items:st(Y)}),X=H(!1)},indices(Y){let K=new Set(Y.detail.indices);for(let tt of Y.target.options)tt.selected=K.has(tt.index);l.setValue(y,{value:H(!0)}),X=H(!1)},editable(Y){Y.target.disabled=!Y.detail.editable}};this._dispatchEventFromSandbox($,q)}),D.addEventListener("input",q=>{let $=H(!0);l.setValue(y,{value:$}),q.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:y,name:"Keystroke",value:X,changeEx:$,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(D,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],q=>q.target.value)):D.addEventListener("input",function(q){l.setValue(y,{value:H(!0)})}),this.data.combo&&this._setTextStyle(D),this._setBackgroundColor(D),this._setDefaultPropertiesFromJS(D),this.container.append(D),this.container}}class U extends c{constructor(l){let{data:y,elements:P}=l;super(l,{isRenderable:c._hasPopupData(y)}),this.elements=P}render(){this.container.classList.add("popupAnnotation");let l=new O({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),y=[];for(let P of this.elements)P.popup=l,y.push(P.data.id),P.addHighlightArea();return this.container.setAttribute("aria-controls",y.map(P=>`${e.AnnotationPrefix}${P}`).join(",")),this.container}}class O{#t=null;#e=this.#h.bind(this);#i=this.#S.bind(this);#s=this.#E.bind(this);#o=this.#b.bind(this);#a=null;#r=null;#l=null;#c=null;#n=null;#p=null;#d=!1;#u=null;#f=null;#_=null;#m=null;#g=!1;constructor({container:l,color:y,elements:P,titleObj:D,modificationDate:M,contentsObj:j,richText:H,parent:X,rect:st,parentRect:q,open:$}){this.#r=l,this.#m=D,this.#l=j,this.#_=H,this.#n=X,this.#a=y,this.#f=st,this.#p=q,this.#c=P;let Y=i.PDFDateString.toDateObject(M);Y&&(this.#t=X.l10n.get("annotation_date_string",{date:Y.toLocaleDateString(),time:Y.toLocaleTimeString()})),this.trigger=P.flatMap(K=>K.getElementsToTriggerPopup());for(let K of this.trigger)K.addEventListener("click",this.#o),K.addEventListener("mouseenter",this.#s),K.addEventListener("mouseleave",this.#i),K.classList.add("popupTriggerArea");for(let K of P)K.container?.addEventListener("keydown",this.#e);this.#r.hidden=!0,$&&this.#b()}render(){if(this.#u)return;let{page:{view:l},viewport:{rawDims:{pageWidth:y,pageHeight:P,pageX:D,pageY:M}}}=this.#n,j=this.#u=document.createElement("div");if(j.className="popup",this.#a){let dt=j.style.outlineColor=e.Util.makeHexColor(...this.#a);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?j.style.backgroundColor=`color-mix(in srgb, ${dt} 30%, white)`:j.style.backgroundColor=e.Util.makeHexColor(...this.#a.map(Et=>Math.floor(.7*(255-Et)+Et)))}let H=document.createElement("span");H.className="header";let X=document.createElement("h1");if(H.append(X),{dir:X.dir,str:X.textContent}=this.#m,j.append(H),this.#t){let dt=document.createElement("span");dt.classList.add("popupDate"),this.#t.then(pt=>{dt.textContent=pt}),H.append(dt)}let st=this.#l,q=this.#_;if(q?.str&&(!st?.str||st.str===q.str))x.XfaLayer.render({xfaHtml:q.html,intent:"richText",div:j}),j.lastChild.classList.add("richText","popupContent");else{let dt=this._formatContents(st);j.append(dt)}let $=!!this.#p,Y=$?this.#p:this.#f;for(let dt of this.#c)if(!Y||e.Util.intersect(dt.data.rect,Y)!==null){Y=dt.data.rect,$=!0;break}let K=e.Util.normalizeRect([Y[0],l[3]-Y[1]+l[1],Y[2],l[3]-Y[3]+l[1]]),rt=$?Y[2]-Y[0]+5:0,ot=K[0]+rt,lt=K[1],{style:ct}=this.#r;ct.left=`${100*(ot-D)/y}%`,ct.top=`${100*(lt-M)/P}%`,this.#r.append(j)}_formatContents({str:l,dir:y}){let P=document.createElement("p");P.classList.add("popupContent"),P.dir=y;let D=l.split(/(?:\r\n?|\n)/);for(let M=0,j=D.length;M<j;++M){let H=D[M];P.append(document.createTextNode(H)),M<j-1&&P.append(document.createElement("br"))}return P}#h(l){l.altKey||l.shiftKey||l.ctrlKey||l.metaKey||(l.key==="Enter"||l.key==="Escape"&&this.#d)&&this.#b()}#b(){this.#d=!this.#d,this.#d?(this.#E(),this.#r.addEventListener("click",this.#o),this.#r.addEventListener("keydown",this.#e)):(this.#S(),this.#r.removeEventListener("click",this.#o),this.#r.removeEventListener("keydown",this.#e))}#E(){this.#u||this.render(),this.isVisible?this.#d&&this.#r.classList.add("focused"):(this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#S(){this.#r.classList.remove("focused"),!(this.#d||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#g=this.isVisible,this.#g&&(this.#r.hidden=!0)}maybeShow(){this.#g&&(this.#g=!1,this.#r.hidden=!1)}get isVisible(){return this.#r.hidden===!1}}class z extends c{constructor(l){super(l,{isRenderable:!0,ignoreBorder:!0}),this.textContent=l.data.textContent,this.textPosition=l.data.textPosition,this.annotationEditorType=e.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){let l=document.createElement("div");l.classList.add("annotationTextContent"),l.setAttribute("role","comment");for(let y of this.textContent){let P=document.createElement("span");P.textContent=y,l.append(P)}this.container.append(l)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}t.FreeTextAnnotationElement=z;class V extends c{#t=null;constructor(l){super(l,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");let l=this.data,{width:y,height:P}=r(l.rect),D=this.svgFactory.create(y,P,!0),M=this.#t=this.svgFactory.createElement("svg:line");return M.setAttribute("x1",l.rect[2]-l.lineCoordinates[0]),M.setAttribute("y1",l.rect[3]-l.lineCoordinates[1]),M.setAttribute("x2",l.rect[2]-l.lineCoordinates[2]),M.setAttribute("y2",l.rect[3]-l.lineCoordinates[3]),M.setAttribute("stroke-width",l.borderStyle.width||1),M.setAttribute("stroke","transparent"),M.setAttribute("fill","transparent"),D.append(M),this.container.append(D),!l.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class it extends c{#t=null;constructor(l){super(l,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");let l=this.data,{width:y,height:P}=r(l.rect),D=this.svgFactory.create(y,P,!0),M=l.borderStyle.width,j=this.#t=this.svgFactory.createElement("svg:rect");return j.setAttribute("x",M/2),j.setAttribute("y",M/2),j.setAttribute("width",y-M),j.setAttribute("height",P-M),j.setAttribute("stroke-width",M||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),D.append(j),this.container.append(D),!l.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Q extends c{#t=null;constructor(l){super(l,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");let l=this.data,{width:y,height:P}=r(l.rect),D=this.svgFactory.create(y,P,!0),M=l.borderStyle.width,j=this.#t=this.svgFactory.createElement("svg:ellipse");return j.setAttribute("cx",y/2),j.setAttribute("cy",P/2),j.setAttribute("rx",y/2-M/2),j.setAttribute("ry",P/2-M/2),j.setAttribute("stroke-width",M||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),D.append(j),this.container.append(D),!l.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class J extends c{#t=null;constructor(l){super(l,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);let l=this.data,{width:y,height:P}=r(l.rect),D=this.svgFactory.create(y,P,!0),M=[];for(let H of l.vertices){let X=H.x-l.rect[0],st=l.rect[3]-H.y;M.push(X+","+st)}M=M.join(" ");let j=this.#t=this.svgFactory.createElement(this.svgElementName);return j.setAttribute("points",M),j.setAttribute("stroke-width",l.borderStyle.width||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),D.append(j),this.container.append(D),!l.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class nt extends J{constructor(l){super(l),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Z extends c{constructor(l){super(l,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class L extends c{#t=[];constructor(l){super(l,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=e.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);let l=this.data,{width:y,height:P}=r(l.rect),D=this.svgFactory.create(y,P,!0);for(let M of l.inkLists){let j=[];for(let X of M){let st=X.x-l.rect[0],q=l.rect[3]-X.y;j.push(`${st},${q}`)}j=j.join(" ");let H=this.svgFactory.createElement(this.svgElementName);this.#t.push(H),H.setAttribute("points",j),H.setAttribute("stroke-width",l.borderStyle.width||1),H.setAttribute("stroke","transparent"),H.setAttribute("fill","transparent"),!l.popupRef&&this.hasPopupData&&this._createPopup(),D.append(H)}return this.container.append(D),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}t.InkAnnotationElement=L;class S extends c{constructor(l){super(l,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class f extends c{constructor(l){super(l,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class g extends c{constructor(l){super(l,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class E extends c{constructor(l){super(l,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class I extends c{constructor(l){super(l,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}t.StampAnnotationElement=I;class F extends c{#t=null;constructor(l){super(l,{isRenderable:!0});let{filename:y,content:P}=this.data.file;this.filename=(0,i.getFilenameFromUrl)(y,!0),this.content=P,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:y,content:P})}render(){this.container.classList.add("fileAttachmentAnnotation");let{container:l,data:y}=this,P;y.hasAppearance||y.fillAlpha===0?P=document.createElement("div"):(P=document.createElement("img"),P.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(y.name)?"paperclip":"pushpin"}.svg`,y.fillAlpha&&y.fillAlpha<1&&(P.style=`filter: opacity(${Math.round(y.fillAlpha*100)}%);`)),P.addEventListener("dblclick",this.#e.bind(this)),this.#t=P;let{isMac:D}=e.FeatureTest.platform;return l.addEventListener("keydown",M=>{M.key==="Enter"&&(D?M.metaKey:M.ctrlKey)&&this.#e()}),!y.popupRef&&this.hasPopupData?this._createPopup():P.classList.add("popupTriggerArea"),l.append(P),l}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class N{#t=null;#e=null;#i=new Map;constructor({div:l,accessibilityManager:y,annotationCanvasMap:P,l10n:D,page:M,viewport:j}){this.div=l,this.#t=y,this.#e=P,this.l10n=D,this.page=M,this.viewport=j,this.zIndex=0,this.l10n||=C.NullL10n}#s(l,y){let P=l.firstChild||l;P.id=`${e.AnnotationPrefix}${y}`,this.div.append(l),this.#t?.moveElementInDOM(this.div,l,P,!1)}render(l){return ht(this,null,function*(){let{annotations:y}=l,P=this.div;(0,i.setLayerDimensions)(P,this.viewport);let D=new Map,M={data:null,layer:P,linkService:l.linkService,downloadManager:l.downloadManager,imageResourcesPath:l.imageResourcesPath||"",renderForms:l.renderForms!==!1,svgFactory:new i.DOMSVGFactory,annotationStorage:l.annotationStorage||new u.AnnotationStorage,enableScripting:l.enableScripting===!0,hasJSActions:l.hasJSActions,fieldObjects:l.fieldObjects,parent:this,elements:null};for(let j of y){if(j.noHTML)continue;let H=j.annotationType===e.AnnotationType.POPUP;if(H){let q=D.get(j.id);if(!q)continue;M.elements=q}else{let{width:q,height:$}=r(j.rect);if(q<=0||$<=0)continue}M.data=j;let X=d.create(M);if(!X.isRenderable)continue;if(!H&&j.popupRef){let q=D.get(j.popupRef);q?q.push(X):D.set(j.popupRef,[X])}X.annotationEditorType>0&&this.#i.set(X.data.id,X);let st=X.render();j.hidden&&(st.style.visibility="hidden"),this.#s(st,j.id)}this.#o(),yield this.l10n.translate(P)})}update({viewport:l}){let y=this.div;this.viewport=l,(0,i.setLayerDimensions)(y,{rotation:l.rotation}),this.#o(),y.hidden=!1}#o(){if(!this.#e)return;let l=this.div;for(let[y,P]of this.#e){let D=l.querySelector(`[data-annotation-id="${y}"]`);if(!D)continue;let{firstChild:M}=D;M?M.nodeName==="CANVAS"?M.replaceWith(P):M.before(P):D.append(P)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(l){return this.#i.get(l)}}t.AnnotationLayer=N},(A,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorConverters=void 0;function o(u){return Math.floor(Math.max(0,Math.min(1,u))*255).toString(16).padStart(2,"0")}function e(u){return Math.max(0,Math.min(255,255*u))}class i{static CMYK_G([_,C,x,h]){return["G",1-Math.min(1,.3*_+.59*x+.11*C+h)]}static G_CMYK([_]){return["CMYK",0,0,0,1-_]}static G_RGB([_]){return["RGB",_,_,_]}static G_rgb([_]){return _=e(_),[_,_,_]}static G_HTML([_]){let C=o(_);return`#${C}${C}${C}`}static RGB_G([_,C,x]){return["G",.3*_+.59*C+.11*x]}static RGB_rgb(_){return _.map(e)}static RGB_HTML(_){return`#${_.map(o).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([_,C,x,h]){return["RGB",1-Math.min(1,_+h),1-Math.min(1,x+h),1-Math.min(1,C+h)]}static CMYK_rgb([_,C,x,h]){return[e(1-Math.min(1,_+h)),e(1-Math.min(1,x+h)),e(1-Math.min(1,C+h))]}static CMYK_HTML(_){let C=this.CMYK_RGB(_).slice(1);return this.RGB_HTML(C)}static RGB_CMYK([_,C,x]){let h=1-_,n=1-C,s=1-x,r=Math.min(h,n,s);return["CMYK",h,n,s,r]}}t.ColorConverters=i},(A,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullL10n=void 0,t.getL10nFallback=e;let o={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} \xD7 {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} \xD7 {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing\u2026",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};o.print_progress_percent="{{progress}}%";function e(C,x){switch(C){case"find_match_count":C=`find_match_count[${x.total===1?"one":"other"}]`;break;case"find_match_count_limit":C=`find_match_count_limit[${x.limit===1?"one":"other"}]`;break}return o[C]||""}function i(C,x){return x?C.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(h,n)=>n in x?x[n]:"{{"+n+"}}"):C}let u={getLanguage(){return ht(this,null,function*(){return"en-us"})},getDirection(){return ht(this,null,function*(){return"ltr"})},get(n){return ht(this,arguments,function*(C,x=null,h=e(C,x)){return i(h,x)})},translate(C){return ht(this,null,function*(){})}};t.NullL10n=u},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaLayer=void 0;var e=o(25);class i{static setupStorage(_,C,x,h,n){let s=h.getValue(C,{value:null});switch(x.name){case"textarea":if(s.value!==null&&(_.textContent=s.value),n==="print")break;_.addEventListener("input",r=>{h.setValue(C,{value:r.target.value})});break;case"input":if(x.attributes.type==="radio"||x.attributes.type==="checkbox"){if(s.value===x.attributes.xfaOn?_.setAttribute("checked",!0):s.value===x.attributes.xfaOff&&_.removeAttribute("checked"),n==="print")break;_.addEventListener("change",r=>{h.setValue(C,{value:r.target.checked?r.target.getAttribute("xfaOn"):r.target.getAttribute("xfaOff")})})}else{if(s.value!==null&&_.setAttribute("value",s.value),n==="print")break;_.addEventListener("input",r=>{h.setValue(C,{value:r.target.value})})}break;case"select":if(s.value!==null){_.setAttribute("value",s.value);for(let r of x.children)r.attributes.value===s.value?r.attributes.selected=!0:r.attributes.hasOwnProperty("selected")&&delete r.attributes.selected}_.addEventListener("input",r=>{let d=r.target.options,c=d.selectedIndex===-1?"":d[d.selectedIndex].value;h.setValue(C,{value:c})});break}}static setAttributes({html:_,element:C,storage:x=null,intent:h,linkService:n}){let{attributes:s}=C,r=_ instanceof HTMLAnchorElement;s.type==="radio"&&(s.name=`${s.name}-${h}`);for(let[d,c]of Object.entries(s))if(c!=null)switch(d){case"class":c.length&&_.setAttribute(d,c.join(" "));break;case"dataId":break;case"id":_.setAttribute("data-element-id",c);break;case"style":Object.assign(_.style,c);break;case"textContent":_.textContent=c;break;default:(!r||d!=="href"&&d!=="newWindow")&&_.setAttribute(d,c)}r&&n.addLinkAttributes(_,s.href,s.newWindow),x&&s.dataId&&this.setupStorage(_,s.dataId,C,x)}static render(_){let C=_.annotationStorage,x=_.linkService,h=_.xfaHtml,n=_.intent||"display",s=document.createElement(h.name);h.attributes&&this.setAttributes({html:s,element:h,intent:n,linkService:x});let r=[[h,-1,s]],d=_.div;if(d.append(s),_.viewport){let a=`matrix(${_.viewport.transform.join(",")})`;d.style.transform=a}n!=="richText"&&d.setAttribute("class","xfaLayer xfaFont");let c=[];for(;r.length>0;){let[a,p,m]=r.at(-1);if(p+1===a.children.length){r.pop();continue}let v=a.children[++r.at(-1)[1]];if(v===null)continue;let{name:k}=v;if(k==="#text"){let b=document.createTextNode(v.value);c.push(b),m.append(b);continue}let T=v?.attributes?.xmlns?document.createElementNS(v.attributes.xmlns,k):document.createElement(k);if(m.append(T),v.attributes&&this.setAttributes({html:T,element:v,storage:C,intent:n,linkService:x}),v.children&&v.children.length>0)r.push([v,-1,T]);else if(v.value){let b=document.createTextNode(v.value);e.XfaText.shouldBuildText(k)&&c.push(b),T.append(b)}}for(let a of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))a.setAttribute("readOnly",!0);return{textDivs:c}}static update(_){let C=`matrix(${_.viewport.transform.join(",")})`;_.div.style.transform=C,_.div.hidden=!1}}t.XfaLayer=i},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InkEditor=void 0;var e=o(1),i=o(4),u=o(29),_=o(6),C=o(5);let x=(()=>{class h extends i.AnnotationEditor{#t=0;#e=0;#i=this.canvasPointermove.bind(this);#s=this.canvasPointerleave.bind(this);#o=this.canvasPointerup.bind(this);#a=this.canvasPointerdown.bind(this);#r=new Path2D;#l=!1;#c=!1;#n=!1;#p=null;#d=0;#u=0;#f=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";constructor(s){super(ge(Qt({},s),{name:"inkEditor"})),this.color=s.color||null,this.thickness=s.thickness||null,this.opacity=s.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(s){i.AnnotationEditor.initialize(s,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(s,r){switch(s){case e.AnnotationEditorParamsType.INK_THICKNESS:h._defaultThickness=r;break;case e.AnnotationEditorParamsType.INK_COLOR:h._defaultColor=r;break;case e.AnnotationEditorParamsType.INK_OPACITY:h._defaultOpacity=r/100;break}}updateParams(s,r){switch(s){case e.AnnotationEditorParamsType.INK_THICKNESS:this.#_(r);break;case e.AnnotationEditorParamsType.INK_COLOR:this.#m(r);break;case e.AnnotationEditorParamsType.INK_OPACITY:this.#g(r);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,h._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,h._defaultColor||i.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(h._defaultOpacity*100)]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||h._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,this.color||h._defaultColor||i.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??h._defaultOpacity))]]}#_(s){let r=this.thickness;this.addCommands({cmd:()=>{this.thickness=s,this.#P()},undo:()=>{this.thickness=r,this.#P()},mustExec:!0,type:e.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#m(s){let r=this.color;this.addCommands({cmd:()=>{this.color=s,this.#v()},undo:()=>{this.color=r,this.#v()},mustExec:!0,type:e.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#g(s){s/=100;let r=this.opacity;this.addCommands({cmd:()=>{this.opacity=s,this.#v()},undo:()=>{this.opacity=r,this.#v()},mustExec:!0,type:e.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#R(),this.#D()),this.isAttachedToDOM||(this.parent.add(this),this.#y()),this.#P()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#p.disconnect(),this.#p=null,super.remove())}setParent(s){!this.parent&&s?this._uiManager.removeShouldRescale(this):this.parent&&s===null&&this._uiManager.addShouldRescale(this),super.setParent(s)}onScaleChanging(){let[s,r]=this.parentDimensions,d=this.width*s,c=this.height*r;this.setDimensions(d,c)}enableEditMode(){this.#l||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#a))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#a))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#h(){let{parentRotation:s,parentDimensions:[r,d]}=this;switch(s){case 90:return[0,d,d,r];case 180:return[r,d,r,d];case 270:return[r,0,d,r];default:return[0,0,r,d]}}#b(){let{ctx:s,color:r,opacity:d,thickness:c,parentScale:a,scaleFactor:p}=this;s.lineWidth=c*a/p,s.lineCap="round",s.lineJoin="round",s.miterLimit=10,s.strokeStyle=`${r}${(0,C.opacityToHex)(d)}`}#E(s,r){this.canvas.addEventListener("contextmenu",_.noContextMenu),this.canvas.addEventListener("pointerleave",this.#s),this.canvas.addEventListener("pointermove",this.#i),this.canvas.addEventListener("pointerup",this.#o),this.canvas.removeEventListener("pointerdown",this.#a),this.isEditing=!0,this.#n||(this.#n=!0,this.#y(),this.thickness||=h._defaultThickness,this.color||=h._defaultColor||i.AnnotationEditor._defaultLineColor,this.opacity??=h._defaultOpacity),this.currentPath.push([s,r]),this.#c=!1,this.#b(),this.#f=()=>{this.#F(),this.#f&&window.requestAnimationFrame(this.#f)},window.requestAnimationFrame(this.#f)}#S(s,r){let[d,c]=this.currentPath.at(-1);if(this.currentPath.length>1&&s===d&&r===c)return;let a=this.currentPath,p=this.#r;if(a.push([s,r]),this.#c=!0,a.length<=2){p.moveTo(...a[0]),p.lineTo(s,r);return}a.length===3&&(this.#r=p=new Path2D,p.moveTo(...a[0])),this.#L(p,...a.at(-3),...a.at(-2),s,r)}#C(){if(this.currentPath.length===0)return;let s=this.currentPath.at(-1);this.#r.lineTo(...s)}#x(s,r){this.#f=null,s=Math.min(Math.max(s,0),this.canvas.width),r=Math.min(Math.max(r,0),this.canvas.height),this.#S(s,r),this.#C();let d;if(this.currentPath.length!==1)d=this.#O();else{let v=[s,r];d=[[v,v.slice(),v.slice(),v]]}let c=this.#r,a=this.currentPath;this.currentPath=[],this.#r=new Path2D;let p=()=>{this.allRawPaths.push(a),this.paths.push(d),this.bezierPath2D.push(c),this.rebuild()},m=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#R(),this.#D()),this.#P())};this.addCommands({cmd:p,undo:m,mustExec:!0})}#F(){if(!this.#c)return;this.#c=!1;let s=Math.ceil(this.thickness*this.parentScale),r=this.currentPath.slice(-3),d=r.map(T=>T[0]),c=r.map(T=>T[1]),a=Math.min(...d)-s,p=Math.max(...d)+s,m=Math.min(...c)-s,v=Math.max(...c)+s,{ctx:k}=this;k.save(),k.clearRect(0,0,this.canvas.width,this.canvas.height);for(let T of this.bezierPath2D)k.stroke(T);k.stroke(this.#r),k.restore()}#L(s,r,d,c,a,p,m){let v=(r+c)/2,k=(d+a)/2,T=(c+p)/2,b=(a+m)/2;s.bezierCurveTo(v+2*(c-v)/3,k+2*(a-k)/3,T+2*(c-T)/3,b+2*(a-b)/3,T,b)}#O(){let s=this.currentPath;if(s.length<=2)return[[s[0],s[0],s.at(-1),s.at(-1)]];let r=[],d,[c,a]=s[0];for(d=1;d<s.length-2;d++){let[w,B]=s[d],[U,O]=s[d+1],z=(w+U)/2,V=(B+O)/2,it=[c+2*(w-c)/3,a+2*(B-a)/3],Q=[z+2*(w-z)/3,V+2*(B-V)/3];r.push([[c,a],it,Q,[z,V]]),[c,a]=[z,V]}let[p,m]=s[d],[v,k]=s[d+1],T=[c+2*(p-c)/3,a+2*(m-a)/3],b=[v+2*(p-v)/3,k+2*(m-k)/3];return r.push([[c,a],T,b,[v,k]]),r}#v(){if(this.isEmpty()){this.#w();return}this.#b();let{canvas:s,ctx:r}=this;r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,s.width,s.height),this.#w();for(let d of this.bezierPath2D)r.stroke(d)}commit(){this.#l||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#l=!0,this.div.classList.add("disabled"),this.#P(!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(s){this._focusEventsAllowed&&(super.focusin(s),this.enableEditMode())}canvasPointerdown(s){s.button!==0||!this.isInEditMode()||this.#l||(this.setInForeground(),s.preventDefault(),s.type!=="mouse"&&this.div.focus(),this.#E(s.offsetX,s.offsetY))}canvasPointermove(s){s.preventDefault(),this.#S(s.offsetX,s.offsetY)}canvasPointerup(s){s.preventDefault(),this.#I(s)}canvasPointerleave(s){this.#I(s)}#I(s){this.canvas.removeEventListener("pointerleave",this.#s),this.canvas.removeEventListener("pointermove",this.#i),this.canvas.removeEventListener("pointerup",this.#o),this.canvas.addEventListener("pointerdown",this.#a),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",_.noContextMenu)},10),this.#x(s.offsetX,s.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#R(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",i.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(s=>this.canvas?.setAttribute("aria-label",s)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#D(){this.#p=new ResizeObserver(s=>{let r=s[0].contentRect;r.width&&r.height&&this.setDimensions(r.width,r.height)}),this.#p.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#l}render(){if(this.div)return this.div;let s,r;this.width&&(s=this.x,r=this.y),super.render(),i.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(m=>this.div?.setAttribute("aria-label",m));let[d,c,a,p]=this.#h();if(this.setAt(d,c,0,0),this.setDims(a,p),this.#R(),this.width){let[m,v]=this.parentDimensions;this.setAspectRatio(this.width*m,this.height*v),this.setAt(s*m,r*v,this.width*m,this.height*v),this.#n=!0,this.#y(),this.setDims(this.width*m,this.height*v),this.#v(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#D(),this.div}#y(){if(!this.#n)return;let[s,r]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*s),this.canvas.height=Math.ceil(this.height*r),this.#w()}setDimensions(s,r){let d=Math.round(s),c=Math.round(r);if(this.#d===d&&this.#u===c)return;this.#d=d,this.#u=c,this.canvas.style.visibility="hidden";let[a,p]=this.parentDimensions;this.width=s/a,this.height=r/p,this.fixAndSetPosition(),this.#l&&this.#T(s,r),this.#y(),this.#v(),this.canvas.style.visibility="visible",this.fixDims()}#T(s,r){let d=this.#M(),c=(s-d)/this.#e,a=(r-d)/this.#t;this.scaleFactor=Math.min(c,a)}#w(){let s=this.#M()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+s,this.translationY*this.scaleFactor+s)}static#N(s){let r=new Path2D;for(let d=0,c=s.length;d<c;d++){let[a,p,m,v]=s[d];d===0&&r.moveTo(...a),r.bezierCurveTo(p[0],p[1],m[0],m[1],v[0],v[1])}return r}static#B(s,r,d){let[c,a,p,m]=r;switch(d){case 0:for(let v=0,k=s.length;v<k;v+=2)s[v]+=c,s[v+1]=m-s[v+1];break;case 90:for(let v=0,k=s.length;v<k;v+=2){let T=s[v];s[v]=s[v+1]+c,s[v+1]=T+a}break;case 180:for(let v=0,k=s.length;v<k;v+=2)s[v]=p-s[v],s[v+1]+=a;break;case 270:for(let v=0,k=s.length;v<k;v+=2){let T=s[v];s[v]=p-s[v+1],s[v+1]=m-T}break;default:throw new Error("Invalid rotation")}return s}static#j(s,r,d){let[c,a,p,m]=r;switch(d){case 0:for(let v=0,k=s.length;v<k;v+=2)s[v]-=c,s[v+1]=m-s[v+1];break;case 90:for(let v=0,k=s.length;v<k;v+=2){let T=s[v];s[v]=s[v+1]-a,s[v+1]=T-c}break;case 180:for(let v=0,k=s.length;v<k;v+=2)s[v]=p-s[v],s[v+1]-=a;break;case 270:for(let v=0,k=s.length;v<k;v+=2){let T=s[v];s[v]=m-s[v+1],s[v+1]=p-T}break;default:throw new Error("Invalid rotation")}return s}#U(s,r,d,c){let a=[],p=this.thickness/2,m=s*r+p,v=s*d+p;for(let k of this.paths){let T=[],b=[];for(let w=0,B=k.length;w<B;w++){let[U,O,z,V]=k[w],it=s*U[0]+m,Q=s*U[1]+v,J=s*O[0]+m,nt=s*O[1]+v,Z=s*z[0]+m,L=s*z[1]+v,S=s*V[0]+m,f=s*V[1]+v;w===0&&(T.push(it,Q),b.push(it,Q)),T.push(J,nt,Z,L,S,f),b.push(J,nt),w===B-1&&b.push(S,f)}a.push({bezier:h.#B(T,c,this.rotation),points:h.#B(b,c,this.rotation)})}return a}#k(){let s=1/0,r=-1/0,d=1/0,c=-1/0;for(let a of this.paths)for(let[p,m,v,k]of a){let T=e.Util.bezierBoundingBox(...p,...m,...v,...k);s=Math.min(s,T[0]),d=Math.min(d,T[1]),r=Math.max(r,T[2]),c=Math.max(c,T[3])}return[s,d,r,c]}#M(){return this.#l?Math.ceil(this.thickness*this.parentScale):0}#P(s=!1){if(this.isEmpty())return;if(!this.#l){this.#v();return}let r=this.#k(),d=this.#M();this.#e=Math.max(i.AnnotationEditor.MIN_SIZE,r[2]-r[0]),this.#t=Math.max(i.AnnotationEditor.MIN_SIZE,r[3]-r[1]);let c=Math.ceil(d+this.#e*this.scaleFactor),a=Math.ceil(d+this.#t*this.scaleFactor),[p,m]=this.parentDimensions;this.width=c/p,this.height=a/m,this.setAspectRatio(c,a);let v=this.translationX,k=this.translationY;this.translationX=-r[0],this.translationY=-r[1],this.#y(),this.#v(),this.#d=c,this.#u=a,this.setDims(c,a);let T=s?d/this.scaleFactor/2:0;this.translate(v-this.translationX-T,k-this.translationY-T)}static deserialize(s,r,d){if(s instanceof u.InkAnnotationElement)return null;let c=super.deserialize(s,r,d);c.thickness=s.thickness,c.color=e.Util.makeHexColor(...s.color),c.opacity=s.opacity;let[a,p]=c.pageDimensions,m=c.width*a,v=c.height*p,k=c.parentScale,T=s.thickness/2;c.#l=!0,c.#d=Math.round(m),c.#u=Math.round(v);let{paths:b,rect:w,rotation:B}=s;for(let{bezier:O}of b){O=h.#j(O,w,B);let z=[];c.paths.push(z);let V=k*(O[0]-T),it=k*(O[1]-T);for(let J=2,nt=O.length;J<nt;J+=6){let Z=k*(O[J]-T),L=k*(O[J+1]-T),S=k*(O[J+2]-T),f=k*(O[J+3]-T),g=k*(O[J+4]-T),E=k*(O[J+5]-T);z.push([[V,it],[Z,L],[S,f],[g,E]]),V=g,it=E}let Q=this.#N(z);c.bezierPath2D.push(Q)}let U=c.#k();return c.#e=Math.max(i.AnnotationEditor.MIN_SIZE,U[2]-U[0]),c.#t=Math.max(i.AnnotationEditor.MIN_SIZE,U[3]-U[1]),c.#T(m,v),c}serialize(){if(this.isEmpty())return null;let s=this.getRect(0,0),r=i.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:e.AnnotationEditorType.INK,color:r,thickness:this.thickness,opacity:this.opacity,paths:this.#U(this.scaleFactor/this.parentScale,this.translationX,this.translationY,s),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}return h})();t.InkEditor=x},(A,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StampEditor=void 0;var e=o(1),i=o(4),u=o(6),_=o(29);let C=(()=>{class x extends i.AnnotationEditor{#t=null;#e=null;#i=null;#s=null;#o=null;#a=null;#r=null;#l=null;#c=!1;#n=!1;static _type="stamp";constructor(n){super(ge(Qt({},n),{name:"stampEditor"})),this.#s=n.bitmapUrl,this.#o=n.bitmapFile}static initialize(n){i.AnnotationEditor.initialize(n)}static get supportedTypes(){let n=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,e.shadow)(this,"supportedTypes",n.map(s=>`image/${s}`))}static get supportedTypesStr(){return(0,e.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(n){return this.supportedTypes.includes(n)}static paste(n,s){s.pasteEditor(e.AnnotationEditorType.STAMP,{bitmapFile:n.getAsFile()})}#p(n,s=!1){if(!n){this.remove();return}this.#t=n.bitmap,s||(this.#e=n.id,this.#c=n.isSvg),this.#f()}#d(){this.#i=null,this._uiManager.enableWaiting(!1),this.#a&&this.div.focus()}#u(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#p(s,!0)).finally(()=>this.#d());return}if(this.#s){let s=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(s).then(r=>this.#p(r)).finally(()=>this.#d());return}if(this.#o){let s=this.#o;this.#o=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(s).then(r=>this.#p(r)).finally(()=>this.#d());return}let n=document.createElement("input");n.type="file",n.accept=x.supportedTypesStr,this.#i=new Promise(s=>{n.addEventListener("change",()=>ht(this,null,function*(){if(!n.files||n.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);let r=yield this._uiManager.imageManager.getFromFile(n.files[0]);this.#p(r)}s()})),n.addEventListener("cancel",()=>{this.remove(),s()})}).finally(()=>this.#d()),n.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#r?.disconnect(),this.#r=null),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#u();return}super.rebuild(),this.div!==null&&(this.#e&&this.#u(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#s||this.#o)}get isResizable(){return!0}render(){if(this.div)return this.div;let n,s;if(this.width&&(n=this.x,s=this.y),super.render(),this.div.hidden=!0,this.#t?this.#f():this.#u(),this.width){let[r,d]=this.parentDimensions;this.setAt(n*r,s*d,this.width*r,this.height*d)}return this.div}#f(){let{div:n}=this,{width:s,height:r}=this.#t,[d,c]=this.pageDimensions,a=.75;if(this.width)s=this.width*d,r=this.height*c;else if(s>a*d||r>a*c){let k=Math.min(a*d/s,a*c/r);s*=k,r*=k}let[p,m]=this.parentDimensions;this.setDims(s*p/d,r*m/c),this._uiManager.enableWaiting(!1);let v=this.#a=document.createElement("canvas");n.append(v),n.hidden=!1,this.#g(s,r),this.#b(),this.#n||(this.parent.addUndoableEditor(this),this.#n=!0),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()}#_(n,s){let[r,d]=this.parentDimensions;this.width=n/r,this.height=s/d,this.setDims(n,s),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#l!==null&&clearTimeout(this.#l);let c=200;this.#l=setTimeout(()=>{this.#l=null,this.#g(n,s)},c)}#m(n,s){let{width:r,height:d}=this.#t,c=r,a=d,p=this.#t;for(;c>2*n||a>2*s;){let m=c,v=a;c>2*n&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2)),a>2*s&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));let k=new OffscreenCanvas(c,a);k.getContext("2d").drawImage(p,0,0,m,v,0,0,c,a),p=k.transferToImageBitmap()}return p}#g(n,s){n=Math.ceil(n),s=Math.ceil(s);let r=this.#a;if(!r||r.width===n&&r.height===s)return;r.width=n,r.height=s;let d=this.#c?this.#t:this.#m(n,s),c=r.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(d,0,0,d.width,d.height,0,0,n,s)}#h(n){if(n){if(this.#c){let d=this._uiManager.imageManager.getSvgUrl(this.#e);if(d)return d}let s=document.createElement("canvas");return{width:s.width,height:s.height}=this.#t,s.getContext("2d").drawImage(this.#t,0,0),s.toDataURL()}if(this.#c){let[s,r]=this.pageDimensions,d=Math.round(this.width*s*u.PixelsPerInch.PDF_TO_CSS_UNITS),c=Math.round(this.height*r*u.PixelsPerInch.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(d,c);return a.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,d,c),a.transferToImageBitmap()}return structuredClone(this.#t)}#b(){this.#r=new ResizeObserver(n=>{let s=n[0].contentRect;s.width&&s.height&&this.#_(s.width,s.height)}),this.#r.observe(this.div)}static deserialize(n,s,r){if(n instanceof _.StampAnnotationElement)return null;let d=super.deserialize(n,s,r),{rect:c,bitmapUrl:a,bitmapId:p,isSvg:m,accessibilityData:v}=n;p&&r.imageManager.isValidId(p)?d.#e=p:d.#s=a,d.#c=m;let[k,T]=d.pageDimensions;return d.width=(c[2]-c[0])/k,d.height=(c[3]-c[1])/T,v&&(d.altTextData=v),d}serialize(n=!1,s=null){if(this.isEmpty())return null;let r={annotationType:e.AnnotationEditorType.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(n)return r.bitmapUrl=this.#h(!0),r.accessibilityData=this.altTextData,r;let{decorative:d,altText:c}=this.altTextData;if(!d&&c&&(r.accessibilityData={type:"Figure",alt:c}),s===null)return r;s.stamps||=new Map;let a=this.#c?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!s.stamps.has(this.#e))s.stamps.set(this.#e,{area:a,serialized:r}),r.bitmap=this.#h(!1);else if(this.#c){let p=s.stamps.get(this.#e);a>p.area&&(p.area=a,p.serialized.bitmap.close(),p.serialized.bitmap=this.#h(!1))}return r}}return x})();t.StampEditor=C}],__webpack_module_cache__={};function __w_pdfjs_require__(A){var t=__webpack_module_cache__[A];if(t!==void 0)return t.exports;var o=__webpack_module_cache__[A]={exports:{}};return __webpack_modules__[A](o,o.exports,__w_pdfjs_require__),o.exports}var __webpack_exports__={};return(()=>{var A=__webpack_exports__;Object.defineProperty(A,"__esModule",{value:!0}),Object.defineProperty(A,"AbortException",{enumerable:!0,get:function(){return t.AbortException}}),Object.defineProperty(A,"AnnotationEditorLayer",{enumerable:!0,get:function(){return u.AnnotationEditorLayer}}),Object.defineProperty(A,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return t.AnnotationEditorParamsType}}),Object.defineProperty(A,"AnnotationEditorType",{enumerable:!0,get:function(){return t.AnnotationEditorType}}),Object.defineProperty(A,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return _.AnnotationEditorUIManager}}),Object.defineProperty(A,"AnnotationLayer",{enumerable:!0,get:function(){return C.AnnotationLayer}}),Object.defineProperty(A,"AnnotationMode",{enumerable:!0,get:function(){return t.AnnotationMode}}),Object.defineProperty(A,"CMapCompressionType",{enumerable:!0,get:function(){return t.CMapCompressionType}}),Object.defineProperty(A,"DOMSVGFactory",{enumerable:!0,get:function(){return e.DOMSVGFactory}}),Object.defineProperty(A,"FeatureTest",{enumerable:!0,get:function(){return t.FeatureTest}}),Object.defineProperty(A,"GlobalWorkerOptions",{enumerable:!0,get:function(){return x.GlobalWorkerOptions}}),Object.defineProperty(A,"ImageKind",{enumerable:!0,get:function(){return t.ImageKind}}),Object.defineProperty(A,"InvalidPDFException",{enumerable:!0,get:function(){return t.InvalidPDFException}}),Object.defineProperty(A,"MissingPDFException",{enumerable:!0,get:function(){return t.MissingPDFException}}),Object.defineProperty(A,"OPS",{enumerable:!0,get:function(){return t.OPS}}),Object.defineProperty(A,"PDFDataRangeTransport",{enumerable:!0,get:function(){return o.PDFDataRangeTransport}}),Object.defineProperty(A,"PDFDateString",{enumerable:!0,get:function(){return e.PDFDateString}}),Object.defineProperty(A,"PDFWorker",{enumerable:!0,get:function(){return o.PDFWorker}}),Object.defineProperty(A,"PasswordResponses",{enumerable:!0,get:function(){return t.PasswordResponses}}),Object.defineProperty(A,"PermissionFlag",{enumerable:!0,get:function(){return t.PermissionFlag}}),Object.defineProperty(A,"PixelsPerInch",{enumerable:!0,get:function(){return e.PixelsPerInch}}),Object.defineProperty(A,"PromiseCapability",{enumerable:!0,get:function(){return t.PromiseCapability}}),Object.defineProperty(A,"RenderingCancelledException",{enumerable:!0,get:function(){return e.RenderingCancelledException}}),Object.defineProperty(A,"SVGGraphics",{enumerable:!0,get:function(){return o.SVGGraphics}}),Object.defineProperty(A,"UnexpectedResponseException",{enumerable:!0,get:function(){return t.UnexpectedResponseException}}),Object.defineProperty(A,"Util",{enumerable:!0,get:function(){return t.Util}}),Object.defineProperty(A,"VerbosityLevel",{enumerable:!0,get:function(){return t.VerbosityLevel}}),Object.defineProperty(A,"XfaLayer",{enumerable:!0,get:function(){return h.XfaLayer}}),Object.defineProperty(A,"build",{enumerable:!0,get:function(){return o.build}}),Object.defineProperty(A,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return t.createValidAbsoluteUrl}}),Object.defineProperty(A,"getDocument",{enumerable:!0,get:function(){return o.getDocument}}),Object.defineProperty(A,"getFilenameFromUrl",{enumerable:!0,get:function(){return e.getFilenameFromUrl}}),Object.defineProperty(A,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return e.getPdfFilenameFromUrl}}),Object.defineProperty(A,"getXfaPageViewport",{enumerable:!0,get:function(){return e.getXfaPageViewport}}),Object.defineProperty(A,"isDataScheme",{enumerable:!0,get:function(){return e.isDataScheme}}),Object.defineProperty(A,"isPdfFile",{enumerable:!0,get:function(){return e.isPdfFile}}),Object.defineProperty(A,"loadScript",{enumerable:!0,get:function(){return e.loadScript}}),Object.defineProperty(A,"noContextMenu",{enumerable:!0,get:function(){return e.noContextMenu}}),Object.defineProperty(A,"normalizeUnicode",{enumerable:!0,get:function(){return t.normalizeUnicode}}),Object.defineProperty(A,"renderTextLayer",{enumerable:!0,get:function(){return i.renderTextLayer}}),Object.defineProperty(A,"setLayerDimensions",{enumerable:!0,get:function(){return e.setLayerDimensions}}),Object.defineProperty(A,"shadow",{enumerable:!0,get:function(){return t.shadow}}),Object.defineProperty(A,"updateTextLayer",{enumerable:!0,get:function(){return i.updateTextLayer}}),Object.defineProperty(A,"version",{enumerable:!0,get:function(){return o.version}});var t=__w_pdfjs_require__(1),o=__w_pdfjs_require__(2),e=__w_pdfjs_require__(6),i=__w_pdfjs_require__(26),u=__w_pdfjs_require__(27),_=__w_pdfjs_require__(5),C=__w_pdfjs_require__(29),x=__w_pdfjs_require__(14),h=__w_pdfjs_require__(32);let n="3.11.174",s="ce8716743"})(),__webpack_exports__})())});function bs(A){let t=A.cloneNode(!0),o=t.querySelectorAll("[id]"),e=A.nodeName.toLowerCase();t.removeAttribute("id");for(let i=0;i<o.length;i++)o[i].removeAttribute("id");return e==="canvas"?ns(A,t):(e==="input"||e==="select"||e==="textarea")&&ss(A,t),is("canvas",A,t,ns),is("input, textarea, select",A,t,ss),t}function is(A,t,o,e){let i=t.querySelectorAll(A);if(i.length){let u=o.querySelectorAll(A);for(let _=0;_<i.length;_++)e(i[_],u[_])}}var Gs=0;function ss(A,t){t.type!=="file"&&(t.value=A.value),t.type==="radio"&&t.name&&(t.name=`mat-clone-${t.name}-${Gs++}`)}function ns(A,t){let o=t.getContext("2d");if(o)try{o.drawImage(A,0,0)}catch{}}function ni(A){let t=A.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height,x:t.x,y:t.y}}function Qe(A,t,o){let{top:e,bottom:i,left:u,right:_}=A;return o>=e&&o<=i&&t>=u&&t<=_}function he(A,t,o){A.top+=t,A.bottom=A.top+A.height,A.left+=o,A.right=A.left+A.width}function rs(A,t,o,e){let{top:i,right:u,bottom:_,left:C,width:x,height:h}=A,n=x*t,s=h*t;return e>i-s&&e<_+s&&o>C-n&&o<u+n}var Me=class{constructor(t){this._document=t,this.positions=new Map}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),t.forEach(o=>{this.positions.set(o,{scrollPosition:{top:o.scrollTop,left:o.scrollLeft},clientRect:ni(o)})})}handleScroll(t){let o=le(t),e=this.positions.get(o);if(!e)return null;let i=e.scrollPosition,u,_;if(o===this._document){let h=this.getViewportScrollPosition();u=h.top,_=h.left}else u=o.scrollTop,_=o.scrollLeft;let C=i.top-u,x=i.left-_;return this.positions.forEach((h,n)=>{h.clientRect&&o!==n&&o.contains(n)&&he(h.clientRect,C,x)}),i.top=u,i.left=_,{top:C,left:x}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function vs(A,t){let o=A.rootNodes;if(o.length===1&&o[0].nodeType===t.ELEMENT_NODE)return o[0];let e=t.createElement("div");return o.forEach(i=>e.appendChild(i)),e}function ri(A,t,o){for(let e in t)if(t.hasOwnProperty(e)){let i=t[e];i?A.setProperty(e,i,o?.has(e)?"important":""):A.removeProperty(e)}return A}function Yt(A,t){let o=t?"":"none";ri(A.style,{"touch-action":t?"":"none","-webkit-user-drag":t?"":"none","-webkit-tap-highlight-color":t?"":"transparent","user-select":o,"-ms-user-select":o,"-webkit-user-select":o,"-moz-user-select":o})}function as(A,t,o){ri(A.style,{position:t?"":"fixed",top:t?"":"0",opacity:t?"":"0",left:t?"":"-999em"},o)}function Ie(A,t){return t&&t!="none"?A+" "+t:A}function os(A,t){A.style.width=`${t.width}px`,A.style.height=`${t.height}px`,A.style.transform=Fe(t.left,t.top)}function Fe(A,t){return`translate3d(${Math.round(A)}px, ${Math.round(t)}px, 0)`}function ls(A){let t=A.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(A)*t}function Vs(A){let t=getComputedStyle(A),o=Je(t,"transition-property"),e=o.find(C=>C==="transform"||C==="all");if(!e)return 0;let i=o.indexOf(e),u=Je(t,"transition-duration"),_=Je(t,"transition-delay");return ls(u[i])+ls(_[i])}function Je(A,t){return A.getPropertyValue(t).split(",").map(e=>e.trim())}var Xs=new Set(["position"]),ti=class{get element(){return this._preview}constructor(t,o,e,i,u,_,C,x,h){this._document=t,this._rootElement=o,this._direction=e,this._initialDomRect=i,this._previewTemplate=u,this._previewClass=_,this._pickupPositionOnPage=C,this._initialTransform=x,this._zIndex=h}attach(t){this._preview=this._createPreview(),t.appendChild(this._preview),"showPopover"in this._preview&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(t){this._preview.style.transform=t}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(t){this._preview.classList.add(t)}getTransitionDuration(){return Vs(this._preview)}addEventListener(t,o){this._preview.addEventListener(t,o)}removeEventListener(t,o){this._preview.removeEventListener(t,o)}_createPreview(){let t=this._previewTemplate,o=this._previewClass,e=t?t.template:null,i;if(e&&t){let u=t.matchSize?this._initialDomRect:null,_=t.viewContainer.createEmbeddedView(e,t.context);_.detectChanges(),i=vs(_,this._document),this._previewEmbeddedView=_,t.matchSize?os(i,u):i.style.transform=Fe(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else i=bs(this._rootElement),os(i,this._initialDomRect),this._initialTransform&&(i.style.transform=this._initialTransform);return ri(i.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},Xs),Yt(i,!1),i.classList.add("cdk-drag-preview"),i.setAttribute("popover","manual"),i.setAttribute("dir",this._direction),o&&(Array.isArray(o)?o.forEach(u=>i.classList.add(u)):i.classList.add(o)),i}},cs=oe({passive:!0}),Re=oe({passive:!1}),hs=oe({passive:!1,capture:!0}),qs=800,ds=new Set(["position"]),ei=class{get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(t){t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(o=>Yt(o,t)))}constructor(t,o,e,i,u,_){this._config=o,this._document=e,this._ngZone=i,this._viewportRuler=u,this._dragDropRegistry=_,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=se(!1),this._moveEvents=new gt,this._pointerMoveSubscription=qt.EMPTY,this._pointerUpSubscription=qt.EMPTY,this._scrollSubscription=qt.EMPTY,this._resizeSubscription=qt.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new gt,this.started=new gt,this.released=new gt,this.ended=new gt,this.entered=new gt,this.exited=new gt,this.dropped=new gt,this.moved=this._moveEvents,this._pointerDown=C=>{if(this.beforeStarted.next(),this._handles.length){let x=this._getTargetHandle(C);x&&!this._disabledHandles.has(x)&&!this.disabled&&this._initializeDragSequence(x,C)}else this.disabled||this._initializeDragSequence(this._rootElement,C)},this._pointerMove=C=>{let x=this._getPointerPositionOnPage(C);if(!this._hasStartedDragging()){let n=Math.abs(x.x-this._pickupPositionOnPage.x),s=Math.abs(x.y-this._pickupPositionOnPage.y);if(n+s>=this._config.dragStartThreshold){let d=Date.now()>=this._dragStartTime+this._getDragStartDelay(C),c=this._dropContainer;if(!d){this._endDragSequence(C);return}(!c||!c.isDragging()&&!c.isReceiving())&&(C.cancelable&&C.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(C)))}return}C.cancelable&&C.preventDefault();let h=this._getConstrainedPointerPosition(x);if(this._hasMoved=!0,this._lastKnownPointerPosition=x,this._updatePointerDirectionDelta(h),this._dropContainer)this._updateActiveDropContainer(h,x);else{let n=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,s=this._activeTransform;s.x=h.x-n.x+this._passiveTransform.x,s.y=h.y-n.y+this._passiveTransform.y,this._applyRootElementTransform(s.x,s.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:h,event:C,distance:this._getDragDistance(h),delta:this._pointerDirectionDelta})})},this._pointerUp=C=>{this._endDragSequence(C)},this._nativeDragStart=C=>{if(this._handles.length){let x=this._getTargetHandle(C);x&&!this._disabledHandles.has(x)&&!this.disabled&&C.preventDefault()}else this.disabled||C.preventDefault()},this.withRootElement(t).withParent(o.parentDragRef||null),this._parentPositions=new Me(e),_.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){this._handles=t.map(e=>Ut(e)),this._handles.forEach(e=>Yt(e,this.disabled)),this._toggleNativeDragInteractions();let o=new Set;return this._disabledHandles.forEach(e=>{this._handles.indexOf(e)>-1&&o.add(e)}),this._disabledHandles=o,this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){let o=Ut(t);return o!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{o.addEventListener("mousedown",this._pointerDown,Re),o.addEventListener("touchstart",this._pointerDown,cs),o.addEventListener("dragstart",this._nativeDragStart,Re)}),this._initialTransform=void 0,this._rootElement=o),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?Ut(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(t){return this._parentDragRef=t,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(t){!this._disabledHandles.has(t)&&this._handles.indexOf(t)>-1&&(this._disabledHandles.add(t),Yt(t,!0))}enableHandle(t){this._disabledHandles.has(t)&&(this._disabledHandles.delete(t),Yt(t,this.disabled))}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){let t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}withPreviewContainer(t){return this._previewContainer=t,this}_sortFromLastPointerPosition(){let t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._getShadowRoot()?.removeEventListener("selectstart",ps,hs)}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(t){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:t}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let o=this._getPointerPositionOnPage(t);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(o),dropPoint:o,event:t})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(t){ce(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let o=this._getShadowRoot(),e=this._dropContainer;if(o&&this._ngZone.runOutsideAngular(()=>{o.addEventListener("selectstart",ps,hs)}),e){let i=this._rootElement,u=i.parentNode,_=this._placeholder=this._createPlaceholderElement(),C=this._anchor=this._anchor||this._document.createComment("");u.insertBefore(C,i),this._initialTransform=i.style.transform||"",this._preview=new ti(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3),this._preview.attach(this._getPreviewInsertionPoint(u,o)),as(i,!1,ds),this._document.body.appendChild(u.replaceChild(_,i)),this.started.next({source:this,event:t}),e.start(),this._initialContainer=e,this._initialIndex=e.getItemIndex(this)}else this.started.next({source:this,event:t}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(e?e.getScrollableParents():[])}_initializeDragSequence(t,o){this._parentDragRef&&o.stopPropagation();let e=this.isDragging(),i=ce(o),u=!i&&o.button!==0,_=this._rootElement,C=le(o),x=!i&&this._lastTouchEventTime&&this._lastTouchEventTime+qs>Date.now(),h=i?qi(o):Xi(o);if(C&&C.draggable&&o.type==="mousedown"&&o.preventDefault(),e||u||x||h)return;if(this._handles.length){let r=_.style;this._rootElementTapHighlight=r.webkitTapHighlightColor||"",r.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(r=>this._updateOnScroll(r)),this._boundaryElement&&(this._boundaryRect=ni(this._boundaryElement));let n=this._previewTemplate;this._pickupPositionInElement=n&&n.template&&!n.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,t,o);let s=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(o);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:s.x,y:s.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,o)}_cleanupDragArtifacts(t){as(this._rootElement,!0,ds),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let o=this._dropContainer,e=o.getItemIndex(this),i=this._getPointerPositionOnPage(t),u=this._getDragDistance(i),_=o._isOverContainer(i.x,i.y);this.ended.next({source:this,distance:u,dropPoint:i,event:t}),this.dropped.next({item:this,currentIndex:e,previousIndex:this._initialIndex,container:o,previousContainer:this._initialContainer,isPointerOverContainer:_,distance:u,dropPoint:i,event:t}),o.drop(this,e,this._initialIndex,this._initialContainer,_,u,i,t),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:o},{x:e,y:i}){let u=this._initialContainer._getSiblingContainerFromPosition(this,t,o);!u&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,o)&&(u=this._initialContainer),u&&u!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=u,this._dropContainer.enter(this,t,o,u===this._initialContainer&&u.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:u,currentIndex:u.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(e,i),this._dropContainer._sortItem(this,t,o,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(t,o):this._applyPreviewTransform(t-this._pickupPositionInElement.x,o-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let t=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(t.left,t.top);let o=this._preview.getTransitionDuration();return o===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(e=>{let i=_=>{(!_||this._preview&&le(_)===this._preview.element&&_.propertyName==="transform")&&(this._preview?.removeEventListener("transitionend",i),e(),clearTimeout(u))},u=setTimeout(i,o*1.5);this._preview.addEventListener("transitionend",i)}))}_createPlaceholderElement(){let t=this._placeholderTemplate,o=t?t.template:null,e;return o?(this._placeholderRef=t.viewContainer.createEmbeddedView(o,t.context),this._placeholderRef.detectChanges(),e=vs(this._placeholderRef,this._document)):e=bs(this._rootElement),e.style.pointerEvents="none",e.classList.add("cdk-drag-placeholder"),e}_getPointerPositionInElement(t,o,e){let i=o===this._rootElement?null:o,u=i?i.getBoundingClientRect():t,_=ce(e)?e.targetTouches[0]:e,C=this._getViewportScrollPosition(),x=_.pageX-u.left-C.left,h=_.pageY-u.top-C.top;return{x:u.left-t.left+x,y:u.top-t.top+h}}_getPointerPositionOnPage(t){let o=this._getViewportScrollPosition(),e=ce(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,i=e.pageX-o.left,u=e.pageY-o.top;if(this._ownerSVGElement){let _=this._ownerSVGElement.getScreenCTM();if(_){let C=this._ownerSVGElement.createSVGPoint();return C.x=i,C.y=u,C.matrixTransform(_.inverse())}}return{x:i,y:u}}_getConstrainedPointerPosition(t){let o=this._dropContainer?this._dropContainer.lockAxis:null,{x:e,y:i}=this.constrainPosition?this.constrainPosition(t,this,this._initialDomRect,this._pickupPositionInElement):t;if(this.lockAxis==="x"||o==="x"?i=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||o==="y")&&(e=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:u,y:_}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,C=this._boundaryRect,{width:x,height:h}=this._getPreviewRect(),n=C.top+_,s=C.bottom-(h-_),r=C.left+u,d=C.right-(x-u);e=us(e,r,d),i=us(i,n,s)}return{x:e,y:i}}_updatePointerDirectionDelta(t){let{x:o,y:e}=t,i=this._pointerDirectionDelta,u=this._pointerPositionAtLastDirectionChange,_=Math.abs(o-u.x),C=Math.abs(e-u.y);return _>this._config.pointerDirectionChangeThreshold&&(i.x=o>u.x?1:-1,u.x=o),C>this._config.pointerDirectionChangeThreshold&&(i.y=e>u.y?1:-1,u.y=e),i}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,Yt(this._rootElement,t))}_removeRootElementListeners(t){t.removeEventListener("mousedown",this._pointerDown,Re),t.removeEventListener("touchstart",this._pointerDown,cs),t.removeEventListener("dragstart",this._nativeDragStart,Re)}_applyRootElementTransform(t,o){let e=Fe(t,o),i=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=i.transform&&i.transform!="none"?i.transform:""),i.transform=Ie(e,this._initialTransform)}_applyPreviewTransform(t,o){let e=this._previewTemplate?.template?void 0:this._initialTransform,i=Fe(t,o);this._preview.setTransform(Ie(i,e))}_getDragDistance(t){let o=this._pickupPositionOnPage;return o?{x:t.x-o.x,y:t.y-o.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:o}=this._passiveTransform;if(t===0&&o===0||this.isDragging()||!this._boundaryElement)return;let e=this._rootElement.getBoundingClientRect(),i=this._boundaryElement.getBoundingClientRect();if(i.width===0&&i.height===0||e.width===0&&e.height===0)return;let u=i.left-e.left,_=e.right-i.right,C=i.top-e.top,x=e.bottom-i.bottom;i.width>e.width?(u>0&&(t+=u),_>0&&(t-=_)):t=0,i.height>e.height?(C>0&&(o+=C),x>0&&(o-=x)):o=0,(t!==this._passiveTransform.x||o!==this._passiveTransform.y)&&this.setFreeDragPosition({y:o,x:t})}_getDragStartDelay(t){let o=this.dragStartDelay;return typeof o=="number"?o:ce(t)?o.touch:o?o.mouse:0}_updateOnScroll(t){let o=this._parentPositions.handleScroll(t);if(o){let e=le(t);this._boundaryRect&&e!==this._boundaryElement&&e.contains(this._boundaryElement)&&he(this._boundaryRect,o.top,o.left),this._pickupPositionOnPage.x+=o.left,this._pickupPositionOnPage.y+=o.top,this._dropContainer||(this._activeTransform.x-=o.left,this._activeTransform.y-=o.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=xe(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(t,o){let e=this._previewContainer||"global";if(e==="parent")return t;if(e==="global"){let i=this._document;return o||i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement||i.body}return Ut(e)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_getTargetHandle(t){return this._handles.find(o=>t.target&&(t.target===o||o.contains(t.target)))}};function us(A,t,o){return Math.max(t,Math.min(o,A))}function ce(A){return A.type[0]==="t"}function ps(A){A.preventDefault()}function ys(A,t,o){let e=fs(t,A.length-1),i=fs(o,A.length-1);if(e===i)return;let u=A[e],_=i<e?-1:1;for(let C=e;C!==i;C+=_)A[C]=A[C+_];A[i]=u}function fs(A,t){return Math.max(0,Math.min(t,A))}var Le=class{constructor(t){this._dragDropRegistry=t,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(t){this.withItems(t)}sort(t,o,e,i){let u=this._itemPositions,_=this._getItemIndexFromPointerPosition(t,o,e,i);if(_===-1&&u.length>0)return null;let C=this.orientation==="horizontal",x=u.findIndex(p=>p.drag===t),h=u[_],n=u[x].clientRect,s=h.clientRect,r=x>_?1:-1,d=this._getItemOffsetPx(n,s,r),c=this._getSiblingOffsetPx(x,u,r),a=u.slice();return ys(u,x,_),u.forEach((p,m)=>{if(a[m]===p)return;let v=p.drag===t,k=v?d:c,T=v?t.getPlaceholderElement():p.drag.getRootElement();p.offset+=k,C?(T.style.transform=Ie(`translate3d(${Math.round(p.offset)}px, 0, 0)`,p.initialTransform),he(p.clientRect,0,k)):(T.style.transform=Ie(`translate3d(0, ${Math.round(p.offset)}px, 0)`,p.initialTransform),he(p.clientRect,k,0))}),this._previousSwap.overlaps=Qe(s,o,e),this._previousSwap.drag=h.drag,this._previousSwap.delta=C?i.x:i.y,{previousIndex:x,currentIndex:_}}enter(t,o,e,i){let u=i==null||i<0?this._getItemIndexFromPointerPosition(t,o,e):i,_=this._activeDraggables,C=_.indexOf(t),x=t.getPlaceholderElement(),h=_[u];if(h===t&&(h=_[u+1]),!h&&(u==null||u===-1||u<_.length-1)&&this._shouldEnterAsFirstChild(o,e)&&(h=_[0]),C>-1&&_.splice(C,1),h&&!this._dragDropRegistry.isDragging(h)){let n=h.getRootElement();n.parentElement.insertBefore(x,n),_.splice(u,0,t)}else this._element.appendChild(x),_.push(t);x.style.transform="",this._cacheItemPositions()}withItems(t){this._activeDraggables=t.slice(),this._cacheItemPositions()}withSortPredicate(t){this._sortPredicate=t}reset(){this._activeDraggables?.forEach(t=>{let o=t.getRootElement();if(o){let e=this._itemPositions.find(i=>i.drag===t)?.initialTransform;o.style.transform=e||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(t){return(this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions).findIndex(e=>e.drag===t)}updateOnScroll(t,o){this._itemPositions.forEach(({clientRect:e})=>{he(e,t,o)}),this._itemPositions.forEach(({drag:e})=>{this._dragDropRegistry.isDragging(e)&&e._sortFromLastPointerPosition()})}withElementContainer(t){this._element=t}_cacheItemPositions(){let t=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(o=>{let e=o.getVisibleElement();return{drag:o,offset:0,initialTransform:e.style.transform||"",clientRect:ni(e)}}).sort((o,e)=>t?o.clientRect.left-e.clientRect.left:o.clientRect.top-e.clientRect.top)}_getItemOffsetPx(t,o,e){let i=this.orientation==="horizontal",u=i?o.left-t.left:o.top-t.top;return e===-1&&(u+=i?o.width-t.width:o.height-t.height),u}_getSiblingOffsetPx(t,o,e){let i=this.orientation==="horizontal",u=o[t].clientRect,_=o[t+e*-1],C=u[i?"width":"height"]*e;if(_){let x=i?"left":"top",h=i?"right":"bottom";e===-1?C-=_.clientRect[x]-u[h]:C+=u[x]-_.clientRect[h]}return C}_shouldEnterAsFirstChild(t,o){if(!this._activeDraggables.length)return!1;let e=this._itemPositions,i=this.orientation==="horizontal";if(e[0].drag!==this._activeDraggables[0]){let _=e[e.length-1].clientRect;return i?t>=_.right:o>=_.bottom}else{let _=e[0].clientRect;return i?t<=_.left:o<=_.top}}_getItemIndexFromPointerPosition(t,o,e,i){let u=this.orientation==="horizontal",_=this._itemPositions.findIndex(({drag:C,clientRect:x})=>{if(C===t)return!1;if(i){let h=u?i.x:i.y;if(C===this._previousSwap.drag&&this._previousSwap.overlaps&&h===this._previousSwap.delta)return!1}return u?o>=Math.floor(x.left)&&o<Math.floor(x.right):e>=Math.floor(x.top)&&e<Math.floor(x.bottom)});return _===-1||!this._sortPredicate(_,t)?-1:_}},ii=class{constructor(t,o){this._document=t,this._dragDropRegistry=o,this._previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1},this._relatedNodes=[]}start(t){let o=this._element.childNodes;this._relatedNodes=[];for(let e=0;e<o.length;e++){let i=o[e];this._relatedNodes.push([i,i.nextSibling])}this.withItems(t)}sort(t,o,e,i){let u=this._getItemIndexFromPointerPosition(t,o,e),_=this._previousSwap;if(u===-1||this._activeItems[u]===t)return null;let C=this._activeItems[u];if(_.drag===C&&_.overlaps&&_.deltaX===i.x&&_.deltaY===i.y)return null;let x=this.getItemIndex(t),h=t.getPlaceholderElement(),n=C.getRootElement();u>x?n.after(h):n.before(h),ys(this._activeItems,x,u);let s=this._getRootNode().elementFromPoint(o,e);return _.deltaX=i.x,_.deltaY=i.y,_.drag=C,_.overlaps=n===s||n.contains(s),{previousIndex:x,currentIndex:u}}enter(t,o,e,i){let u=i==null||i<0?this._getItemIndexFromPointerPosition(t,o,e):i;u===-1&&(u=this._getClosestItemIndexToPointer(t,o,e));let _=this._activeItems[u],C=this._activeItems.indexOf(t);C>-1&&this._activeItems.splice(C,1),_&&!this._dragDropRegistry.isDragging(_)?(this._activeItems.splice(u,0,t),_.getRootElement().before(t.getPlaceholderElement())):(this._activeItems.push(t),this._element.appendChild(t.getPlaceholderElement()))}withItems(t){this._activeItems=t.slice()}withSortPredicate(t){this._sortPredicate=t}reset(){let t=this._element,o=this._previousSwap;for(let e=this._relatedNodes.length-1;e>-1;e--){let[i,u]=this._relatedNodes[e];i.parentNode===t&&i.nextSibling!==u&&(u===null?t.appendChild(i):u.parentNode===t&&t.insertBefore(i,u))}this._relatedNodes=[],this._activeItems=[],o.drag=null,o.deltaX=o.deltaY=0,o.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(t){return this._activeItems.indexOf(t)}updateOnScroll(){this._activeItems.forEach(t=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()})}withElementContainer(t){t!==this._element&&(this._element=t,this._rootNode=void 0)}_getItemIndexFromPointerPosition(t,o,e){let i=this._getRootNode().elementFromPoint(Math.floor(o),Math.floor(e)),u=i?this._activeItems.findIndex(_=>{let C=_.getRootElement();return i===C||C.contains(i)}):-1;return u===-1||!this._sortPredicate(u,t)?-1:u}_getRootNode(){return this._rootNode||(this._rootNode=xe(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(t,o,e){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let i=1/0,u=-1;for(let _=0;_<this._activeItems.length;_++){let C=this._activeItems[_];if(C!==t){let{x,y:h}=C.getRootElement().getBoundingClientRect(),n=Math.hypot(o-x,e-h);n<i&&(i=n,u=_)}}return u}},gs=.05,As=.05,Pt=function(A){return A[A.NONE=0]="NONE",A[A.UP=1]="UP",A[A.DOWN=2]="DOWN",A}(Pt||{}),At=function(A){return A[A.NONE=0]="NONE",A[A.LEFT=1]="LEFT",A[A.RIGHT=2]="RIGHT",A}(At||{}),si=class{constructor(t,o,e,i,u){this._dragDropRegistry=o,this._ngZone=i,this._viewportRuler=u,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new gt,this.entered=new gt,this.exited=new gt,this.dropped=new gt,this.sorted=new gt,this.receivingStarted=new gt,this.receivingStopped=new gt,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=qt.EMPTY,this._verticalScrollDirection=Pt.NONE,this._horizontalScrollDirection=At.NONE,this._stopScrollTimers=new gt,this._cachedShadowRoot=null,this._scrollableElements=[],this._direction="ltr",this._startScrollInterval=()=>{this._stopScrolling(),pi(0,di).pipe(be(this._stopScrollTimers)).subscribe(()=>{let C=this._scrollNode,x=this.autoScrollStep;this._verticalScrollDirection===Pt.UP?C.scrollBy(0,-x):this._verticalScrollDirection===Pt.DOWN&&C.scrollBy(0,x),this._horizontalScrollDirection===At.LEFT?C.scrollBy(-x,0):this._horizontalScrollDirection===At.RIGHT&&C.scrollBy(x,0)})};let _=this.element=Ut(t);this._document=e,this.withOrientation("vertical").withElementContainer(_),o.registerDropContainer(this),this._parentPositions=new Me(e)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(t,o,e,i){this._draggingStarted(),i==null&&this.sortingDisabled&&(i=this._draggables.indexOf(t)),this._sortStrategy.enter(t,o,e,i),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,o,e,i,u,_,C,x={}){this._reset(),this.dropped.next({item:t,currentIndex:o,previousIndex:e,container:this,previousContainer:i,isPointerOverContainer:u,distance:_,dropPoint:C,event:x})}withItems(t){let o=this._draggables;return this._draggables=t,t.forEach(e=>e._withDropContainer(this)),this.isDragging()&&(o.filter(i=>i.isDragging()).every(i=>t.indexOf(i)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(t){return this._direction=t,this._sortStrategy instanceof Le&&(this._sortStrategy.direction=t),this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){if(t==="mixed")this._sortStrategy=new ii(this._document,this._dragDropRegistry);else{let o=new Le(this._dragDropRegistry);o.direction=this._direction,o.orientation=t,this._sortStrategy=o}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((o,e)=>this.sortPredicate(o,e,this)),this}withScrollableParents(t){let o=this._container;return this._scrollableElements=t.indexOf(o)===-1?[o,...t]:t.slice(),this}withElementContainer(t){if(t===this._container)return this;let o=Ut(this.element),e=this._scrollableElements.indexOf(this._container),i=this._scrollableElements.indexOf(t);return e>-1&&this._scrollableElements.splice(e,1),i>-1&&this._scrollableElements.splice(i,1),this._sortStrategy&&this._sortStrategy.withElementContainer(t),this._cachedShadowRoot=null,this._scrollableElements.unshift(t),this._container=t,this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?this._sortStrategy.getItemIndex(t):this._draggables.indexOf(t)}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,o,e,i){if(this.sortingDisabled||!this._domRect||!rs(this._domRect,gs,o,e))return;let u=this._sortStrategy.sort(t,o,e,i);u&&this.sorted.next({previousIndex:u.previousIndex,currentIndex:u.currentIndex,container:this,item:t})}_startScrollingIfNecessary(t,o){if(this.autoScrollDisabled)return;let e,i=Pt.NONE,u=At.NONE;if(this._parentPositions.positions.forEach((_,C)=>{C===this._document||!_.clientRect||e||rs(_.clientRect,gs,t,o)&&([i,u]=$s(C,_.clientRect,this._direction,t,o),(i||u)&&(e=C))}),!i&&!u){let{width:_,height:C}=this._viewportRuler.getViewportSize(),x={width:_,height:C,top:0,right:_,bottom:C,left:0};i=Ss(x,o),u=Es(x,t),e=window}e&&(i!==this._verticalScrollDirection||u!==this._horizontalScrollDirection||e!==this._scrollNode)&&(this._verticalScrollDirection=i,this._horizontalScrollDirection=u,this._scrollNode=e,(i||u)&&e?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let t=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let t=this._container.style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(o=>o._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(t,o){return this._domRect!=null&&Qe(this._domRect,t,o)}_getSiblingContainerFromPosition(t,o,e){return this._siblings.find(i=>i._canReceive(t,o,e))}_canReceive(t,o,e){if(!this._domRect||!Qe(this._domRect,o,e)||!this.enterPredicate(t,this))return!1;let i=this._getShadowRoot().elementFromPoint(o,e);return i?i===this._container||this._container.contains(i):!1}_startReceiving(t,o){let e=this._activeSiblings;!e.has(t)&&o.every(i=>this.enterPredicate(i,this)||this._draggables.indexOf(i)>-1)&&(e.add(t),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:t,receiver:this,items:o}))}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:t,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(t=>{if(this.isDragging()){let o=this._parentPositions.handleScroll(t);o&&this._sortStrategy.updateOnScroll(o.top,o.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let t=xe(this._container);this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let t=this._sortStrategy.getActiveItemsSnapshot().filter(o=>o.isDragging());this._siblings.forEach(o=>o._startReceiving(this,t))}};function Ss(A,t){let{top:o,bottom:e,height:i}=A,u=i*As;return t>=o-u&&t<=o+u?Pt.UP:t>=e-u&&t<=e+u?Pt.DOWN:Pt.NONE}function Es(A,t){let{left:o,right:e,width:i}=A,u=i*As;return t>=o-u&&t<=o+u?At.LEFT:t>=e-u&&t<=e+u?At.RIGHT:At.NONE}function $s(A,t,o,e,i){let u=Ss(t,i),_=Es(t,e),C=Pt.NONE,x=At.NONE;if(u){let h=A.scrollTop;u===Pt.UP?h>0&&(C=Pt.UP):A.scrollHeight-h>A.clientHeight&&(C=Pt.DOWN)}if(_){let h=A.scrollLeft;o==="rtl"?_===At.RIGHT?h<0&&(x=At.RIGHT):A.scrollWidth+h>A.clientWidth&&(x=At.LEFT):_===At.LEFT?h>0&&(x=At.LEFT):A.scrollWidth-h>A.clientWidth&&(x=At.RIGHT)}return[C,x]}var De=oe({passive:!1,capture:!0}),ke=new Set,Ys=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=Lt({type:t,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],standalone:!0,features:[jt],decls:0,vars:0,template:function(i,u){},styles:["@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}"],encapsulation:2,changeDetection:0});let A=t;return A})(),Ks=(()=>{let t=class t{constructor(e,i){this._ngZone=e,this._appRef=xt(Bi),this._environmentInjector=xt(gi),this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=se([]),this._globalListeners=new Map,this._draggingPredicate=u=>u.isDragging(),this.pointerMove=new gt,this.pointerUp=new gt,this.scroll=new gt,this._preventDefaultWhileDragging=u=>{this._activeDragInstances().length>0&&u.preventDefault()},this._persistentTouchmoveListener=u=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&u.preventDefault(),this.pointerMove.next(u))},this._document=i}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,De)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),this._dragInstances.size===0&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,De)}startDragging(e,i){if(!(this._activeDragInstances().indexOf(e)>-1)&&(this._loadResets(),this._activeDragInstances.update(u=>[...u,e]),this._activeDragInstances().length===1)){let u=i.type.startsWith("touch");this._globalListeners.set(u?"touchend":"mouseup",{handler:_=>this.pointerUp.next(_),options:!0}).set("scroll",{handler:_=>this.scroll.next(_),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:De}),u||this._globalListeners.set("mousemove",{handler:_=>this.pointerMove.next(_),options:De}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((_,C)=>{this._document.addEventListener(C,_.handler,_.options)})})}}stopDragging(e){this._activeDragInstances.update(i=>{let u=i.indexOf(e);return u>-1?(i.splice(u,1),[...i]):i}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances().indexOf(e)>-1}scrolled(e){let i=[this.scroll];return e&&e!==this._document&&i.push(new ze(u=>this._ngZone.runOutsideAngular(()=>{let C=x=>{this._activeDragInstances().length&&u.next(x)};return e.addEventListener("scroll",C,!0),()=>{e.removeEventListener("scroll",C,!0)}}))),me(...i)}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((e,i)=>{this._document.removeEventListener(i,e.handler,e.options)}),this._globalListeners.clear()}_loadResets(){if(!ke.has(this._appRef)){ke.add(this._appRef);let e=ji(Ys,{environmentInjector:this._environmentInjector});this._appRef.onDestroy(()=>{ke.delete(this._appRef),ke.size===0&&e.destroy()})}}};t.\u0275fac=function(i){return new(i||t)(Wt(Ae),Wt(Te))},t.\u0275prov=ee({token:t,factory:t.\u0275fac,providedIn:"root"});let A=t;return A})(),Zs={dragStartThreshold:5,pointerDirectionChangeThreshold:5},ai=(()=>{let t=class t{constructor(e,i,u,_){this._document=e,this._ngZone=i,this._viewportRuler=u,this._dragDropRegistry=_}createDrag(e,i=Zs){return new ei(e,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(e){return new si(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}};t.\u0275fac=function(i){return new(i||t)(Wt(Te),Wt(Ae),Wt(ts),Wt(Ks))},t.\u0275prov=ee({token:t,factory:t.\u0275fac,providedIn:"root"});let A=t;return A})(),ms=new Ft("CDK_DRAG_PARENT");var Js=new Ft("CdkDragHandle");var ws=new Ft("CDK_DRAG_CONFIG"),Qs="cdk-drag",Ps=new Ft("CdkDropList"),Cs=(()=>{let t=class t{get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(e){this._disabled=e,this._dragRef.disabled=this._disabled}constructor(e,i,u,_,C,x,h,n,s,r,d){this.element=e,this.dropContainer=i,this._ngZone=_,this._viewContainerRef=C,this._dir=h,this._changeDetectorRef=s,this._selfHandle=r,this._parentDrag=d,this._destroyed=new gt,this._handles=new hi([]),this.started=new Ct,this.released=new Ct,this.ended=new Ct,this.entered=new Ct,this.exited=new Ct,this.dropped=new Ct,this.moved=new ze(c=>{let a=this._dragRef.moved.pipe(ui(p=>({source:this,pointerPosition:p.pointerPosition,event:p.event,delta:p.delta,distance:p.distance}))).subscribe(c);return()=>{a.unsubscribe()}}),this._injector=xt(yi),this._dragRef=n.createDrag(e,{dragStartThreshold:x&&x.dragStartThreshold!=null?x.dragStartThreshold:5,pointerDirectionChangeThreshold:x&&x.pointerDirectionChangeThreshold!=null?x.pointerDirectionChangeThreshold:5,zIndex:x?.zIndex}),this._dragRef.data=this,t._dragInstances.push(this),x&&this._assignDefaults(x),i&&(this._dragRef._withDropContainer(i._dropListRef),i.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(e){this._dragRef.setFreeDragPosition(e)}ngAfterViewInit(){wi(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(e){let i=e.rootElementSelector,u=e.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),u&&!u.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);let e=t._dragInstances.indexOf(this);e>-1&&t._dragInstances.splice(e,1),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(e){let i=this._handles.getValue();i.push(e),this._handles.next(i)}_removeHandle(e){let i=this._handles.getValue(),u=i.indexOf(e);u>-1&&(i.splice(u,1),this._handles.next(i))}_setPreviewTemplate(e){this._previewTemplate=e}_resetPreviewTemplate(e){e===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(e){this._placeholderTemplate=e}_resetPlaceholderTemplate(e){e===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let e=this.element.nativeElement,i=e;this.rootElementSelector&&(i=e.closest!==void 0?e.closest(this.rootElementSelector):e.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||e)}_getBoundaryElement(){let e=this.boundaryElement;return e?typeof e=="string"?this.element.nativeElement.closest(e):Ut(e):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){let i=this._dir,u=this.dragStartDelay,_=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,C=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.dragStartDelay=typeof u=="object"&&u?u:Ke(u),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(_).withPreviewTemplate(C).withPreviewContainer(this.previewContainer||"global"),i&&e.withDirection(i.value)}}),e.beforeStarted.pipe(fi(1)).subscribe(()=>{if(this._parentDrag){e.withParent(this._parentDrag._dragRef);return}let i=this.element.nativeElement.parentElement;for(;i;){if(i.classList.contains(Qs)){e.withParent(t._dragInstances.find(u=>u.element.nativeElement===i)?._dragRef||null);break}i=i.parentElement}})}_handleEvents(e){e.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),e.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),e.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),e.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(e){let{lockAxis:i,dragStartDelay:u,constrainPosition:_,previewClass:C,boundaryElement:x,draggingDisabled:h,rootElementSelector:n,previewContainer:s}=e;this.disabled=h??!1,this.dragStartDelay=u||0,i&&(this.lockAxis=i),_&&(this.constrainPosition=_),C&&(this.previewClass=C),x&&(this.boundaryElement=x),n&&(this.rootElementSelector=n),s&&(this.previewContainer=s)}_setupHandlesListener(){this._handles.pipe(te(e=>{let i=e.map(u=>u.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),_e(e=>me(...e.map(i=>i._stateChanges.pipe(Ge(i))))),be(this._destroyed)).subscribe(e=>{let i=this._dragRef,u=e.element.nativeElement;e.disabled?i.disableHandle(u):i.enableHandle(u)})}};t._dragInstances=[],t.\u0275fac=function(i){return new(i||t)(ft(ie),ft(Ps,12),ft(Te),ft(Ae),ft(Pi),ft(ws,8),ft(Ze,8),ft(ai),ft(Ye),ft(Js,10),ft(ms,12))},t.\u0275dir=Ve({type:t,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(i,u){i&2&&re("cdk-drag-disabled",u.disabled)("cdk-drag-dragging",u._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",ae],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[$e([{provide:ms,useExisting:t}]),ne,mi]});let A=t;return A})(),_s=new Ft("CdkDropListGroup");var tn=0,Ts=(()=>{let t=class t{get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(e){this._dropListRef.disabled=this._disabled=e}constructor(e,i,u,_,C,x,h){this.element=e,this._changeDetectorRef=u,this._scrollDispatcher=_,this._dir=C,this._group=x,this._destroyed=new gt,this.connectedTo=[],this.id=`cdk-drop-list-${tn++}`,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.dropped=new Ct,this.entered=new Ct,this.exited=new Ct,this.sorted=new Ct,this._unsortedItems=new Set,this._dropListRef=i.createDropList(e),this._dropListRef.data=this,h&&this._assignDefaults(h),this._dropListRef.enterPredicate=(n,s)=>this.enterPredicate(n.data,s.data),this._dropListRef.sortPredicate=(n,s,r)=>this.sortPredicate(n,s.data,r.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),t._dropLists.push(this),x&&x._items.add(this)}addItem(e){this._unsortedItems.add(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(e){this._unsortedItems.delete(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((e,i)=>e._dragRef.getVisibleElement().compareDocumentPosition(i._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){let e=t._dropLists.indexOf(this);e>-1&&t._dropLists.splice(e,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(e){this._dir&&this._dir.change.pipe(Ge(this._dir.value),be(this._destroyed)).subscribe(i=>e.withDirection(i)),e.beforeStarted.subscribe(()=>{let i=Vi(this.connectedTo).map(u=>{if(typeof u=="string"){let _=t._dropLists.find(C=>C.id===u);return _}return u});if(this._group&&this._group._items.forEach(u=>{i.indexOf(u)===-1&&i.push(u)}),!this._scrollableParentsResolved){let u=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(_=>_.getElementRef().nativeElement);this._dropListRef.withScrollableParents(u),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){let u=this.element.nativeElement.querySelector(this.elementContainerSelector);e.withElementContainer(u)}e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.sortingDisabled=this.sortingDisabled,e.autoScrollDisabled=this.autoScrollDisabled,e.autoScrollStep=Ke(this.autoScrollStep,2),e.connectedTo(i.filter(u=>u&&u!==this).map(u=>u._dropListRef)).withOrientation(this.orientation)})}_handleEvents(e){e.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(i=>{this.entered.emit({container:this,item:i.item.data,currentIndex:i.currentIndex})}),e.exited.subscribe(i=>{this.exited.emit({container:this,item:i.item.data}),this._changeDetectorRef.markForCheck()}),e.sorted.subscribe(i=>{this.sorted.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,container:this,item:i.item.data})}),e.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,item:i.item.data,isPointerOverContainer:i.isPointerOverContainer,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),me(e.receivingStarted,e.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(e){let{lockAxis:i,draggingDisabled:u,sortingDisabled:_,listAutoScrollDisabled:C,listOrientation:x}=e;this.disabled=u??!1,this.sortingDisabled=_??!1,this.autoScrollDisabled=C??!1,this.orientation=x||"vertical",i&&(this.lockAxis=i)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(e=>e._dragRef))}};t._dropLists=[],t.\u0275fac=function(i){return new(i||t)(ft(ie),ft(ai),ft(Ye),ft(Qi),ft(Ze,8),ft(_s,12),ft(ws,8))},t.\u0275dir=Ve({type:t,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(i,u){i&2&&(Ot("id",u.id),re("cdk-drop-list-disabled",u.disabled)("cdk-drop-list-dragging",u._dropListRef.isDragging())("cdk-drop-list-receiving",u._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",ae],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",ae],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",ae],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],standalone:!0,features:[$e([{provide:_s,useValue:void 0},{provide:Ps,useExisting:t}]),ne]});let A=t;return A})();var xs=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=ye({type:t}),t.\u0275inj=ve({providers:[ai],imports:[es]});let A=t;return A})();var sn=["determinateSpinner"];function nn(A,t){if(A&1&&(Xe(),Tt(0,"svg",11),Bt(1,"circle",12),Dt()),A&2){let o=$t();Ot("viewBox",o._viewBox()),Rt(),Ee("stroke-dasharray",o._strokeCircumference(),"px")("stroke-dashoffset",o._strokeCircumference()/2,"px")("stroke-width",o._circleStrokeWidth(),"%"),Ot("r",o._circleRadius())}}var rn=new Ft("mat-progress-spinner-default-options",{providedIn:"root",factory:an});function an(){return{diameter:Rs}}var Rs=100,on=10,Ds=(()=>{let t=class t{get color(){return this._color||this._defaultColor}set color(e){this._color=e}constructor(e,i,u){this._elementRef=e,this._defaultColor="primary",this._value=0,this._diameter=Rs,this._noopAnimations=i==="NoopAnimations"&&!!u&&!u._forceAnimations,this.mode=e.nativeElement.nodeName.toLowerCase()==="mat-spinner"?"indeterminate":"determinate",u&&(u.color&&(this.color=this._defaultColor=u.color),u.diameter&&(this.diameter=u.diameter),u.strokeWidth&&(this.strokeWidth=u.strokeWidth))}get value(){return this.mode==="determinate"?this._value:0}set value(e){this._value=Math.max(0,Math.min(100,e||0))}get diameter(){return this._diameter}set diameter(e){this._diameter=e||0}get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(e){this._strokeWidth=e||0}_circleRadius(){return(this.diameter-on)/2}_viewBox(){let e=this._circleRadius()*2+this.strokeWidth;return`0 0 ${e} ${e}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return this.mode==="determinate"?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}};t.\u0275fac=function(i){return new(i||t)(ft(ie),ft(Si,8),ft(rn))},t.\u0275cmp=Lt({type:t,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(i,u){if(i&1&&Mi(sn,5),i&2){let _;Ii(_=Fi())&&(u._determinateCircle=_.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:18,hostBindings:function(i,u){i&2&&(Ot("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow",u.mode==="determinate"?u.value:null)("mode",u.mode),Ci("mat-"+u.color),Ee("width",u.diameter,"px")("height",u.diameter,"px")("--mdc-circular-progress-size",u.diameter+"px")("--mdc-circular-progress-active-indicator-width",u.diameter+"px"),re("_mat-animation-noopable",u._noopAnimations)("mdc-circular-progress--indeterminate",u.mode==="indeterminate"))},inputs:{color:"color",mode:"mode",value:[2,"value","value",Pe],diameter:[2,"diameter","diameter",Pe],strokeWidth:[2,"strokeWidth","strokeWidth",Pe]},exportAs:["matProgressSpinner"],standalone:!0,features:[ne,jt],decls:14,vars:11,consts:[["circle",""],["determinateSpinner",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(i,u){if(i&1&&(Se(0,nn,2,8,"ng-template",null,0,Ni),Tt(2,"div",2,1),Xe(),Tt(4,"svg",3),Bt(5,"circle",4),Dt()(),vi(),Tt(6,"div",5)(7,"div",6)(8,"div",7),we(9,8),Dt(),Tt(10,"div",9),we(11,8),Dt(),Tt(12,"div",10),we(13,8),Dt()()()),i&2){let _=Li(1);Rt(4),Ot("viewBox",u._viewBox()),Rt(),Ee("stroke-dasharray",u._strokeCircumference(),"px")("stroke-dashoffset",u._strokeDashOffset(),"px")("stroke-width",u._circleStrokeWidth(),"%"),Ot("r",u._circleRadius()),Rt(4),Nt("ngTemplateOutlet",_),Rt(2),Nt("ngTemplateOutlet",_),Rt(2),Nt("ngTemplateOutlet",_)}},dependencies:[Ui],styles:[".mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0;position:relative;direction:ltr;transition:opacity 250ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width)}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1;animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color)}.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}"],encapsulation:2,changeDetection:0});let A=t;return A})();var ks=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=ye({type:t}),t.\u0275inj=ve({imports:[Hi,$i]});let A=t;return A})();var Kt=zs(Bs());var js=(()=>{let t=class t{constructor(){this.storeService=xt(zi),this.pagesPreviews=se(null);let e=`https://cdn.jsdelivr.net/npm/pdfjs-dist@${Kt.version}/build/pdf.worker.min.js`;Kt.GlobalWorkerOptions.workerSrc=e,Wi(this.storeService.documentBuffer).pipe(te(()=>this.storeService.pageRenderingProcessing.set(!0)),_e(i=>this.generatePagePreviews(i)),te(()=>this.storeService.pageRenderingProcessing.set(!1))).subscribe()}generatePagePreviews(e){return ht(this,null,function*(){if(!e)return!1;let u=yield(0,Kt.getDocument)({data:e,isEvalSupported:!1}).promise;return yield Promise.all(Array.from(Array(u.numPages).keys()).map(_=>this.renderPagePreview(u,_))),!0})}renderPagePreview(e,i){return ht(this,null,function*(){let u=yield e.getPage(i+1),_=u.getViewport({scale:.5}),C=document.createElement("canvas"),x=C.getContext("2d",{willReadFrequently:!0,alpha:!1});C.height=_.height,C.width=_.width,yield u.render({canvasContext:x,viewport:_}).promise;let n=C.toDataURL();u.cleanup();let s={pageIndex:i,base64:n};this.addOrReplacePreview(s)})}addOrReplacePreview(e){return ht(this,null,function*(){this.pagesPreviews.update(i=>i?[...i?.filter(_=>_.pageIndex!==e.pageIndex),e]:[e])})}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=ee({token:t,factory:t.\u0275fac,providedIn:"root"});let A=t;return A})();function An(A,t){if(A&1&&Bt(0,"img",0),A&2){let o=$t();Nt("src",o.imageSrc(),Ei)}}function Sn(A,t){A&1&&Bt(0,"mat-progress-spinner",1)}var Us=(()=>{let t=class t{constructor(){this.pagesPreviews=xt(js).pagesPreviews,this.pageIndex=Ai.required(),this.imageSrc=Ce(()=>{let e=this.pageIndex();return this.pagesPreviews()?.find(u=>u.pageIndex===e)?.base64||void 0})}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=Lt({type:t,selectors:[["app-thumb"]],inputs:{pageIndex:[1,"pageIndex"]},standalone:!0,features:[jt],decls:2,vars:1,consts:[[3,"src"],["mode","indeterminate"]],template:function(i,u){i&1&&Se(0,An,1,1,"img",0)(1,Sn,1,0,"mat-progress-spinner",1),i&2&&Ti(u.imageSrc()?0:1)},dependencies:[ks,Ds],styles:["[_nghost-%COMP%]{display:grid}mat-progress-spinner[_ngcontent-%COMP%]{margin:2rem}img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain;pointer-events:none}"],changeDetection:0});let A=t;return A})();function En(A,t){if(A&1){let o=ki();Tt(0,"div",1)(1,"button",2),qe("click",function(){let i=_i(o).$implicit,u=$t();return bi(u.onRemovePage(i))}),Tt(2,"mat-icon"),Oi(3,"delete"),Dt()(),Bt(4,"app-thumb",3),Dt()}if(A&2){let o=t.$implicit;Rt(4),Nt("pageIndex",o)}}function wn(A,t){}var zr=(()=>{let t=class t{constructor(){this.documentService=xt(Gi),this.pageCount=this.documentService.pageCount,this.pages=Ce(()=>{let e=this.pageCount();if(e)return Array.from(Array(e).keys())})}onChangePosition(e){return ht(this,null,function*(){yield this.documentService.movePage(e.previousIndex,e.currentIndex)})}onRemovePage(e){return ht(this,null,function*(){yield this.documentService.removePage(e)})}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=Lt({type:t,selectors:[["app-pages"]],standalone:!0,features:[jt],decls:4,vars:1,consts:[["cdkDropList","","cdkDropListOrientation","mixed",1,"list",3,"cdkDropListDropped"],["cdkDrag","",1,"item"],["mat-mini-fab","","color","warn",1,"remove",3,"click"],[3,"pageIndex"]],template:function(i,u){i&1&&(Tt(0,"div",0),qe("cdkDropListDropped",function(C){return u.onChangePosition(C)}),Ri(1,En,5,1,"div",1,xi,!1,wn,0,0),Dt()),i&2&&(Rt(),Di(u.pages()))},dependencies:[Ki,Yi,Ji,Zi,xs,Ts,Cs,Us],styles:["[_nghost-%COMP%]{display:block;position:relative;text-align:center}.list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;flex-direction:row;box-sizing:border-box}.item[_ngcontent-%COMP%]{position:relative;border-radius:.25rem;border:grey solid 2px;display:flex;align-items:center;justify-content:center;box-sizing:border-box;margin:.5rem;max-width:200px}.item[_ngcontent-%COMP%]:hover{border-color:#3f51b5}button.remove[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}@media only screen and (max-width: 599px){.item[_ngcontent-%COMP%]{max-width:160px}}"],changeDetection:0});let A=t;return A})();export{zr as PagesComponent};
