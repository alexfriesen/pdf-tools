import{a as $e,b as Ye,c as Ke,d as Je,e as Qe,f as Ze,g as ti,h as ei,i as ii}from"./chunk-N2BNHIPG.js";import{$ as ke,$a as Ge,$b as si,Ca as St,Da as Et,E as be,Ea as Mt,Fa as Zt,G as le,Ga as Ue,J as Ae,Ja as de,K as ye,Ka as Bt,L as ve,N as Pt,Na as je,O as Ot,Oa as We,P as Se,S as Ee,Sa as te,T as we,U as ce,V as Ce,Y as Te,Ya as He,Z as xe,Za as ze,_ as Pe,a as Ht,ab as Xe,ac as ni,b as Yt,ba as Me,c as oe,d as xt,da as zt,e as Ei,ea as Gt,f as ht,fa as he,fc as ri,ga as Ct,gc as ai,ha as Kt,ib as Ve,ja as Re,ka as Fe,kb as qe,kc as oi,mc as li,n as _e,na as De,qa as Nt,ra as kt,sa as Jt,ta as Ie,va as Qt,vb as ee,wa as Le,xa as Oe,ya as Ne,za as Be}from"./chunk-GZRWXZR7.js";var ie=xt(()=>{"use strict"});var pi=xt((ms,fi)=>{"use strict";var Ri="bold|bolder|lighter|[1-9]00",Fi="italic|oblique",Di="small-caps",Ii="ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded",Li="px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q",ui=`'([^']+)'|"([^"]+)"|[\\w\\s-]+`,Oi=new RegExp(`(${Ri}) +`,"i"),Ni=new RegExp(`(${Fi}) +`,"i"),Bi=new RegExp(`(${Di}) +`,"i"),Ui=new RegExp(`(${Ii}) +`,"i"),ji=new RegExp(`([\\d\\.]+)(${Li}) *((?:${ui})( *, *(?:${ui}))*)`),pe={},Wi=16;fi.exports=F=>{if(pe[F])return pe[F];let i=ji.exec(F);if(!i)return;let E={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(i[1]),unit:i[2],family:i[3].replace(/["']/g,"").replace(/ *, */g,",")},r,g,P,x,U=F.substring(0,i.index);switch((r=Oi.exec(U))&&(E.weight=r[1]),(g=Ni.exec(U))&&(E.style=g[1]),(P=Bi.exec(U))&&(E.variant=P[1]),(x=Ui.exec(U))&&(E.stretch=x[1]),E.unit){case"pt":E.size/=.75;break;case"pc":E.size*=16;break;case"in":E.size*=96;break;case"cm":E.size*=96/2.54;break;case"mm":E.size*=96/25.4;break;case"%":break;case"em":case"rem":E.size*=Wi/.75;break;case"q":E.size*=96/25.4/4;break}return pe[F]=E}});var gi=xt(Xt=>{"use strict";var Hi=pi();Xt.parseFont=Hi;Xt.createCanvas=function(F,i){return Object.assign(document.createElement("canvas"),{width:F,height:i})};Xt.createImageData=function(F,i,E){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(F);case 2:return new ImageData(F,i);default:return new ImageData(F,i,E)}};Xt.loadImage=function(F,i){return new Promise(function(E,r){let g=Object.assign(document.createElement("img"),i);function P(){g.onload=null,g.onerror=null}g.onload=function(){P(),E(g)},g.onerror=function(){P(),r(new Error('Failed to load the image "'+F+'"'))},g.src=F})}});var mi=xt(()=>{"use strict"});var ge=xt(()=>{"use strict"});var me=xt(()=>{"use strict"});var _i=xt(()=>{"use strict"});var bi=xt((exports,module)=>{"use strict";(function(i,E){typeof exports=="object"&&typeof module=="object"?module.exports=i.pdfjsLib=E():typeof define=="function"&&define.amd?define("pdfjs-dist/build/pdf",[],()=>i.pdfjsLib=E()):typeof exports=="object"?exports["pdfjs-dist/build/pdf"]=i.pdfjsLib=E():i["pdfjs-dist/build/pdf"]=i.pdfjsLib=E()})(globalThis,()=>(()=>{"use strict";var __webpack_modules__=[,(F,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.VerbosityLevel=i.Util=i.UnknownErrorException=i.UnexpectedResponseException=i.TextRenderingMode=i.RenderingIntentFlag=i.PromiseCapability=i.PermissionFlag=i.PasswordResponses=i.PasswordException=i.PageActionEventType=i.OPS=i.MissingPDFException=i.MAX_IMAGE_SIZE_TO_CACHE=i.LINE_FACTOR=i.LINE_DESCENT_FACTOR=i.InvalidPDFException=i.ImageKind=i.IDENTITY_MATRIX=i.FormatError=i.FeatureTest=i.FONT_IDENTITY_MATRIX=i.DocumentActionEventType=i.CMapCompressionType=i.BaseException=i.BASELINE_FACTOR=i.AnnotationType=i.AnnotationReplyType=i.AnnotationPrefix=i.AnnotationMode=i.AnnotationFlag=i.AnnotationFieldFlag=i.AnnotationEditorType=i.AnnotationEditorPrefix=i.AnnotationEditorParamsType=i.AnnotationBorderStyleType=i.AnnotationActionEventType=i.AbortException=void 0,i.assert=c,i.bytesToString=N,i.createValidAbsoluteUrl=A,i.getModificationDate=_t,i.getUuid=vi,i.getVerbosityLevel=nt,i.info=J,i.isArrayBuffer=ft,i.isArrayEqual=yt,i.isNodeJS=void 0,i.normalizeUnicode=se,i.objectFromMap=q,i.objectSize=st,i.setVerbosityLevel=Q,i.shadow=M,i.string32=V,i.stringToBytes=W,i.stringToPDFString=lt,i.stringToUTF8String=ct,i.unreachable=b,i.utf8StringToString=dt,i.warn=D;let E=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");i.isNodeJS=E;let r=[1,0,0,1,0,0];i.IDENTITY_MATRIX=r;let g=[.001,0,0,.001,0,0];i.FONT_IDENTITY_MATRIX=g;let P=1e7;i.MAX_IMAGE_SIZE_TO_CACHE=P;let x=1.35;i.LINE_FACTOR=x;let U=.35;i.LINE_DESCENT_FACTOR=U;let B=U/x;i.BASELINE_FACTOR=B;let h={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};i.RenderingIntentFlag=h;let n={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};i.AnnotationMode=n;let t="pdfjs_internal_editor_";i.AnnotationEditorPrefix=t;let s={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};i.AnnotationEditorType=s;let l={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};i.AnnotationEditorParamsType=l;let o={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};i.PermissionFlag=o;let e={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};i.TextRenderingMode=e;let u={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};i.ImageKind=u;let f={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};i.AnnotationType=f;let _={GROUP:"Group",REPLY:"R"};i.AnnotationReplyType=_;let T={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};i.AnnotationFlag=T;let S={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};i.AnnotationFieldFlag=S;let p={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};i.AnnotationBorderStyleType=p;let y={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};i.AnnotationActionEventType=y;let O={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};i.DocumentActionEventType=O;let j={O:"PageOpen",C:"PageClose"};i.PageActionEventType=j;let I={ERRORS:0,WARNINGS:1,INFOS:5};i.VerbosityLevel=I;let z={NONE:0,BINARY:1};i.CMapCompressionType=z;let X={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};i.OPS=X;let it={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};i.PasswordResponses=it;let tt=I.WARNINGS;function Q(et){Number.isInteger(et)&&(tt=et)}function nt(){return tt}function J(et){tt>=I.INFOS&&console.log(`Info: ${et}`)}function D(et){tt>=I.WARNINGS&&console.log(`Warning: ${et}`)}function b(et){throw new Error(et)}function c(et,G){et||b(G)}function d(et){switch(et?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function A(et,G=null,H=null){if(!et)return null;try{if(H&&typeof et=="string"&&(H.addDefaultProtocol&&et.startsWith("www.")&&et.match(/\./g)?.length>=2&&(et=`http://${et}`),H.tryConvertEncoding))try{et=ct(et)}catch{}let at=G?new URL(et,G):new URL(et);if(d(at))return at}catch{}return null}function M(et,G,H,at=!1){return Object.defineProperty(et,G,{value:H,enumerable:!at,configurable:!0,writable:!1}),H}let R=function(){function G(H,at){this.constructor===G&&b("Cannot initialize BaseException."),this.message=H,this.name=at}return G.prototype=new Error,G.constructor=G,G}();i.BaseException=R;class L extends R{constructor(G,H){super(G,"PasswordException"),this.code=H}}i.PasswordException=L;class w extends R{constructor(G,H){super(G,"UnknownErrorException"),this.details=H}}i.UnknownErrorException=w;class a extends R{constructor(G){super(G,"InvalidPDFException")}}i.InvalidPDFException=a;class m extends R{constructor(G){super(G,"MissingPDFException")}}i.MissingPDFException=m;class v extends R{constructor(G,H){super(G,"UnexpectedResponseException"),this.status=H}}i.UnexpectedResponseException=v;class C extends R{constructor(G){super(G,"FormatError")}}i.FormatError=C;class k extends R{constructor(G){super(G,"AbortException")}}i.AbortException=k;function N(et){(typeof et!="object"||et?.length===void 0)&&b("Invalid argument for bytesToString");let G=et.length,H=8192;if(G<H)return String.fromCharCode.apply(null,et);let at=[];for(let ut=0;ut<G;ut+=H){let gt=Math.min(ut+H,G),mt=et.subarray(ut,gt);at.push(String.fromCharCode.apply(null,mt))}return at.join("")}function W(et){typeof et!="string"&&b("Invalid argument for stringToBytes");let G=et.length,H=new Uint8Array(G);for(let at=0;at<G;++at)H[at]=et.charCodeAt(at)&255;return H}function V(et){return String.fromCharCode(et>>24&255,et>>16&255,et>>8&255,et&255)}function st(et){return Object.keys(et).length}function q(et){let G=Object.create(null);for(let[H,at]of et)G[H]=at;return G}function $(){let et=new Uint8Array(4);return et[0]=1,new Uint32Array(et.buffer,0,1)[0]===1}function Y(){try{return new Function(""),!0}catch{return!1}}class K{static get isLittleEndian(){return M(this,"isLittleEndian",$())}static get isEvalSupported(){return M(this,"isEvalSupported",Y())}static get isOffscreenCanvasSupported(){return M(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?M(this,"platform",{isWin:!1,isMac:!1}):M(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){return M(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}i.FeatureTest=K;let Z=[...Array(256).keys()].map(et=>et.toString(16).padStart(2,"0"));class rt{static makeHexColor(G,H,at){return`#${Z[G]}${Z[H]}${Z[at]}`}static scaleMinMax(G,H){let at;G[0]?(G[0]<0&&(at=H[0],H[0]=H[1],H[1]=at),H[0]*=G[0],H[1]*=G[0],G[3]<0&&(at=H[2],H[2]=H[3],H[3]=at),H[2]*=G[3],H[3]*=G[3]):(at=H[0],H[0]=H[2],H[2]=at,at=H[1],H[1]=H[3],H[3]=at,G[1]<0&&(at=H[2],H[2]=H[3],H[3]=at),H[2]*=G[1],H[3]*=G[1],G[2]<0&&(at=H[0],H[0]=H[1],H[1]=at),H[0]*=G[2],H[1]*=G[2]),H[0]+=G[4],H[1]+=G[4],H[2]+=G[5],H[3]+=G[5]}static transform(G,H){return[G[0]*H[0]+G[2]*H[1],G[1]*H[0]+G[3]*H[1],G[0]*H[2]+G[2]*H[3],G[1]*H[2]+G[3]*H[3],G[0]*H[4]+G[2]*H[5]+G[4],G[1]*H[4]+G[3]*H[5]+G[5]]}static applyTransform(G,H){let at=G[0]*H[0]+G[1]*H[2]+H[4],ut=G[0]*H[1]+G[1]*H[3]+H[5];return[at,ut]}static applyInverseTransform(G,H){let at=H[0]*H[3]-H[1]*H[2],ut=(G[0]*H[3]-G[1]*H[2]+H[2]*H[5]-H[4]*H[3])/at,gt=(-G[0]*H[1]+G[1]*H[0]+H[4]*H[1]-H[5]*H[0])/at;return[ut,gt]}static getAxialAlignedBoundingBox(G,H){let at=this.applyTransform(G,H),ut=this.applyTransform(G.slice(2,4),H),gt=this.applyTransform([G[0],G[3]],H),mt=this.applyTransform([G[2],G[1]],H);return[Math.min(at[0],ut[0],gt[0],mt[0]),Math.min(at[1],ut[1],gt[1],mt[1]),Math.max(at[0],ut[0],gt[0],mt[0]),Math.max(at[1],ut[1],gt[1],mt[1])]}static inverseTransform(G){let H=G[0]*G[3]-G[1]*G[2];return[G[3]/H,-G[1]/H,-G[2]/H,G[0]/H,(G[2]*G[5]-G[4]*G[3])/H,(G[4]*G[1]-G[5]*G[0])/H]}static singularValueDecompose2dScale(G){let H=[G[0],G[2],G[1],G[3]],at=G[0]*H[0]+G[1]*H[2],ut=G[0]*H[1]+G[1]*H[3],gt=G[2]*H[0]+G[3]*H[2],mt=G[2]*H[1]+G[3]*H[3],Dt=(at+mt)/2,It=Math.sqrt((at+mt)**2-4*(at*mt-gt*ut))/2,Rt=Dt+It||1,At=Dt-It||1;return[Math.sqrt(Rt),Math.sqrt(At)]}static normalizeRect(G){let H=G.slice(0);return G[0]>G[2]&&(H[0]=G[2],H[2]=G[0]),G[1]>G[3]&&(H[1]=G[3],H[3]=G[1]),H}static intersect(G,H){let at=Math.max(Math.min(G[0],G[2]),Math.min(H[0],H[2])),ut=Math.min(Math.max(G[0],G[2]),Math.max(H[0],H[2]));if(at>ut)return null;let gt=Math.max(Math.min(G[1],G[3]),Math.min(H[1],H[3])),mt=Math.min(Math.max(G[1],G[3]),Math.max(H[1],H[3]));return gt>mt?null:[at,gt,ut,mt]}static bezierBoundingBox(G,H,at,ut,gt,mt,Dt,It){let Rt=[],At=[[],[]],Lt,Tt,Vt,pt,qt,$t,ne,re;for(let ae=0;ae<2;++ae){if(ae===0?(Tt=6*G-12*at+6*gt,Lt=-3*G+9*at-9*gt+3*Dt,Vt=3*at-3*G):(Tt=6*H-12*ut+6*mt,Lt=-3*H+9*ut-9*mt+3*It,Vt=3*ut-3*H),Math.abs(Lt)<1e-12){if(Math.abs(Tt)<1e-12)continue;pt=-Vt/Tt,0<pt&&pt<1&&Rt.push(pt);continue}ne=Tt*Tt-4*Vt*Lt,re=Math.sqrt(ne),!(ne<0)&&(qt=(-Tt+re)/(2*Lt),0<qt&&qt<1&&Rt.push(qt),$t=(-Tt-re)/(2*Lt),0<$t&&$t<1&&Rt.push($t))}let jt=Rt.length,vt,Wt=jt;for(;jt--;)pt=Rt[jt],vt=1-pt,At[0][jt]=vt*vt*vt*G+3*vt*vt*pt*at+3*vt*pt*pt*gt+pt*pt*pt*Dt,At[1][jt]=vt*vt*vt*H+3*vt*vt*pt*ut+3*vt*pt*pt*mt+pt*pt*pt*It;return At[0][Wt]=G,At[1][Wt]=H,At[0][Wt+1]=Dt,At[1][Wt+1]=It,At[0].length=At[1].length=Wt+2,[Math.min(...At[0]),Math.min(...At[1]),Math.max(...At[0]),Math.max(...At[1])]}}i.Util=rt;let ot=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function lt(et){if(et[0]>="\xEF"){let H;if(et[0]==="\xFE"&&et[1]==="\xFF"?H="utf-16be":et[0]==="\xFF"&&et[1]==="\xFE"?H="utf-16le":et[0]==="\xEF"&&et[1]==="\xBB"&&et[2]==="\xBF"&&(H="utf-8"),H)try{let at=new TextDecoder(H,{fatal:!0}),ut=W(et);return at.decode(ut)}catch(at){D(`stringToPDFString: "${at}".`)}}let G=[];for(let H=0,at=et.length;H<at;H++){let ut=ot[et.charCodeAt(H)];G.push(ut?String.fromCharCode(ut):et.charAt(H))}return G.join("")}function ct(et){return decodeURIComponent(escape(et))}function dt(et){return unescape(encodeURIComponent(et))}function ft(et){return typeof et=="object"&&et?.byteLength!==void 0}function yt(et,G){if(et.length!==G.length)return!1;for(let H=0,at=et.length;H<at;H++)if(et[H]!==G[H])return!1;return!0}function _t(et=new Date){return[et.getUTCFullYear().toString(),(et.getUTCMonth()+1).toString().padStart(2,"0"),et.getUTCDate().toString().padStart(2,"0"),et.getUTCHours().toString().padStart(2,"0"),et.getUTCMinutes().toString().padStart(2,"0"),et.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ft{#t=!1;constructor(){this.promise=new Promise((G,H)=>{this.resolve=at=>{this.#t=!0,G(at)},this.reject=at=>{this.#t=!0,H(at)}})}get settled(){return this.#t}}i.PromiseCapability=Ft;let bt=null,wt=null;function se(et){return bt||(bt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,wt=new Map([["\uFB05","\u017Ft"]])),et.replaceAll(bt,(G,H,at)=>H?H.normalize("NFKC"):wt.get(at))}function vi(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();let et=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(et);else for(let G=0;G<32;G++)et[G]=Math.floor(Math.random()*255);return N(et)}let Si="pdfjs_internal_id_";i.AnnotationPrefix=Si},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);let DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(F){if(typeof F=="string"||F instanceof URL?F={url:F}:(0,_util.isArrayBuffer)(F)&&(F={data:F}),typeof F!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!F.url&&!F.data&&!F.range)throw new Error("Invalid parameter object: need either .data, .range or .url");let i=new PDFDocumentLoadingTask,{docId:E}=i,r=F.url?getUrlProp(F.url):null,g=F.data?getDataProp(F.data):null,P=F.httpHeaders||null,x=F.withCredentials===!0,U=F.password??null,B=F.range instanceof PDFDataRangeTransport?F.range:null,h=Number.isInteger(F.rangeChunkSize)&&F.rangeChunkSize>0?F.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE,n=F.worker instanceof PDFWorker?F.worker:null,t=F.verbosity,s=typeof F.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(F.docBaseUrl)?F.docBaseUrl:null,l=typeof F.cMapUrl=="string"?F.cMapUrl:null,o=F.cMapPacked!==!1,e=F.CMapReaderFactory||DefaultCMapReaderFactory,u=typeof F.standardFontDataUrl=="string"?F.standardFontDataUrl:null,f=F.StandardFontDataFactory||DefaultStandardFontDataFactory,_=F.stopAtErrors!==!0,T=Number.isInteger(F.maxImageSize)&&F.maxImageSize>-1?F.maxImageSize:-1,S=F.isEvalSupported!==!1,p=typeof F.isOffscreenCanvasSupported=="boolean"?F.isOffscreenCanvasSupported:!_util.isNodeJS,y=Number.isInteger(F.canvasMaxAreaInBytes)?F.canvasMaxAreaInBytes:-1,O=typeof F.disableFontFace=="boolean"?F.disableFontFace:_util.isNodeJS,j=F.fontExtraProperties===!0,I=F.enableXfa===!0,z=F.ownerDocument||globalThis.document,X=F.disableRange===!0,it=F.disableStream===!0,tt=F.disableAutoFetch===!0,Q=F.pdfBug===!0,nt=B?B.length:F.length??NaN,J=typeof F.useSystemFonts=="boolean"?F.useSystemFonts:!_util.isNodeJS&&!O,D=typeof F.useWorkerFetch=="boolean"?F.useWorkerFetch:e===_display_utils.DOMCMapReaderFactory&&f===_display_utils.DOMStandardFontDataFactory&&l&&u&&(0,_display_utils.isValidFetchUrl)(l,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(u,document.baseURI),b=F.canvasFactory||new DefaultCanvasFactory({ownerDocument:z}),c=F.filterFactory||new DefaultFilterFactory({docId:E,ownerDocument:z}),d=null;(0,_util.setVerbosityLevel)(t);let A={canvasFactory:b,filterFactory:c};if(D||(A.cMapReaderFactory=new e({baseUrl:l,isCompressed:o}),A.standardFontDataFactory=new f({baseUrl:u})),!n){let L={verbosity:t,port:_worker_options.GlobalWorkerOptions.workerPort};n=L.port?PDFWorker.fromPort(L):new PDFWorker(L),i._worker=n}let M={docId:E,apiVersion:"3.11.174",data:g,password:U,disableAutoFetch:tt,rangeChunkSize:h,length:nt,docBaseUrl:s,enableXfa:I,evaluatorOptions:{maxImageSize:T,disableFontFace:O,ignoreErrors:_,isEvalSupported:S,isOffscreenCanvasSupported:p,canvasMaxAreaInBytes:y,fontExtraProperties:j,useSystemFonts:J,cMapUrl:D?l:null,standardFontDataUrl:D?u:null}},R={ignoreErrors:_,isEvalSupported:S,disableFontFace:O,fontExtraProperties:j,enableXfa:I,ownerDocument:z,disableAutoFetch:tt,pdfBug:Q,styleElement:d};return n.promise.then(function(){if(i.destroyed)throw new Error("Loading aborted");let L=_fetchDocument(n,M),w=new Promise(function(a){let m;B?m=new _transport_stream.PDFDataTransportStream({length:nt,initialData:B.initialData,progressiveDone:B.progressiveDone,contentDispositionFilename:B.contentDispositionFilename,disableRange:X,disableStream:it},B):g||(m=(C=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(C):(0,_display_utils.isValidFetchUrl)(C.url)?new _displayFetch_stream.PDFFetchStream(C):new _displayNetwork.PDFNetworkStream(C))({url:r,length:nt,httpHeaders:P,withCredentials:x,rangeChunkSize:h,disableRange:X,disableStream:it})),a(m)});return Promise.all([L,w]).then(function([a,m]){if(i.destroyed)throw new Error("Loading aborted");let v=new _message_handler.MessageHandler(E,a,n.port),C=new WorkerTransport(v,i,m,R,A);i._transport=C,v.send("Ready",null)})}).catch(i._capability.reject),i}function _fetchDocument(F,i){return ht(this,null,function*(){if(F.destroyed)throw new Error("Worker was destroyed");let E=yield F.messageHandler.sendWithPromise("GetDocRequest",i,i.data?[i.data.buffer]:null);if(F.destroyed)throw new Error("Worker was destroyed");return E})}function getUrlProp(F){if(F instanceof URL)return F.href;try{return new URL(F,window.location).href}catch{if(_util.isNodeJS&&typeof F=="string")return F}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(F){if(_util.isNodeJS&&typeof Buffer<"u"&&F instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(F instanceof Uint8Array&&F.byteLength===F.buffer.byteLength)return F;if(typeof F=="string")return(0,_util.stringToBytes)(F);if(typeof F=="object"&&!isNaN(F?.length)||(0,_util.isArrayBuffer)(F))return new Uint8Array(F);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#t=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}destroy(){return ht(this,null,function*(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),yield this._transport?.destroy()}catch(i){throw this._worker?.port&&delete this._worker._pendingDestroy,i}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)})}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(i,E,r=!1,g=null){this.length=i,this.initialData=E,this.progressiveDone=r,this.contentDispositionFilename=g,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(i){this._rangeListeners.push(i)}addProgressListener(i){this._progressListeners.push(i)}addProgressiveReadListener(i){this._progressiveReadListeners.push(i)}addProgressiveDoneListener(i){this._progressiveDoneListeners.push(i)}onDataRange(i,E){for(let r of this._rangeListeners)r(i,E)}onDataProgress(i,E){this._readyCapability.promise.then(()=>{for(let r of this._progressListeners)r(i,E)})}onDataProgressiveRead(i){this._readyCapability.promise.then(()=>{for(let E of this._progressiveReadListeners)E(i)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(let i of this._progressiveDoneListeners)i()})}transportReady(){this._readyCapability.resolve()}requestDataRange(i,E){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(i,E){this._pdfInfo=i,this._transport=E,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(r=>{if(!r)return r;let g=[];for(let P in r)g.push(...r[P]);return g}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(i){return this._transport.getPage(i)}getPageIndex(i){return this._transport.getPageIndex(i)}getDestinations(){return this._transport.getDestinations()}getDestination(i){return this._transport.getDestination(i)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(i=!1){return this._transport.startCleanup(i||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#t=null;#e=!1;constructor(i,E,r,g=!1){this._pageIndex=i,this._pageInfo=E,this._transport=r,this._stats=g?new _display_utils.StatTimer:null,this._pdfBug=g,this.commonObjs=r.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:i,rotation:E=this.rotate,offsetX:r=0,offsetY:g=0,dontFlip:P=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:i,rotation:E,offsetX:r,offsetY:g,dontFlip:P})}getAnnotations({intent:i="display"}={}){let E=this._transport.getRenderingIntent(i);return this._transport.getAnnotations(this._pageIndex,E.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}getXfa(){return ht(this,null,function*(){return this._transport._htmlForXfa?.children[this._pageIndex]||null})}render({canvasContext:i,viewport:E,intent:r="display",annotationMode:g=_util.AnnotationMode.ENABLE,transform:P=null,background:x=null,optionalContentConfigPromise:U=null,annotationCanvasMap:B=null,pageColors:h=null,printAnnotationStorage:n=null}){this._stats?.time("Overall");let t=this._transport.getRenderingIntent(r,g,n);this.#e=!1,this.#s(),U||(U=this._transport.getOptionalContentConfig());let s=this._intentStates.get(t.cacheKey);s||(s=Object.create(null),this._intentStates.set(t.cacheKey,s)),s.streamReaderCancelTimeout&&(clearTimeout(s.streamReaderCancelTimeout),s.streamReaderCancelTimeout=null);let l=!!(t.renderingIntent&_util.RenderingIntentFlag.PRINT);s.displayReadyCapability||(s.displayReadyCapability=new _util.PromiseCapability,s.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(t));let o=f=>{s.renderTasks.delete(e),(this._maybeCleanupAfterRender||l)&&(this.#e=!0),this.#i(!l),f?(e.capability.reject(f),this._abortOperatorList({intentState:s,reason:f instanceof Error?f:new Error(f)})):e.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},e=new InternalRenderTask({callback:o,params:{canvasContext:i,viewport:E,transform:P,background:x},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:B,operatorList:s.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!l,pdfBug:this._pdfBug,pageColors:h});(s.renderTasks||=new Set).add(e);let u=e.task;return Promise.all([s.displayReadyCapability.promise,U]).then(([f,_])=>{if(this.destroyed){o();return}this._stats?.time("Rendering"),e.initializeGraphics({transparency:f,optionalContentConfig:_}),e.operatorListChanged()}).catch(o),u}getOperatorList({intent:i="display",annotationMode:E=_util.AnnotationMode.ENABLE,printAnnotationStorage:r=null}={}){function g(){x.operatorList.lastChunk&&(x.opListReadCapability.resolve(x.operatorList),x.renderTasks.delete(U))}let P=this._transport.getRenderingIntent(i,E,r,!0),x=this._intentStates.get(P.cacheKey);x||(x=Object.create(null),this._intentStates.set(P.cacheKey,x));let U;return x.opListReadCapability||(U=Object.create(null),U.operatorListChanged=g,x.opListReadCapability=new _util.PromiseCapability,(x.renderTasks||=new Set).add(U),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(P)),x.opListReadCapability.promise}streamTextContent({includeMarkedContent:i=!1,disableNormalization:E=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:i===!0,disableNormalization:E===!0},{highWaterMark:100,size(g){return g.items.length}})}getTextContent(i={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>_xfa_text.XfaText.textContent(r));let E=this.streamTextContent(i);return new Promise(function(r,g){function P(){x.read().then(function({value:B,done:h}){if(h){r(U);return}Object.assign(U.styles,B.styles),U.items.push(...B.items),P()},g)}let x=E.getReader(),U={items:[],styles:Object.create(null)};P()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;let i=[];for(let E of this._intentStates.values())if(this._abortOperatorList({intentState:E,reason:new Error("Page was destroyed."),force:!0}),!E.opListReadCapability)for(let r of E.renderTasks)i.push(r.completed),r.cancel();return this.objs.clear(),this.#e=!1,this.#s(),Promise.all(i)}cleanup(i=!1){this.#e=!0;let E=this.#i(!1);return i&&E&&(this._stats&&=new _display_utils.StatTimer),E}#i(i=!1){if(this.#s(),!this.#e||this.destroyed)return!1;if(i)return this.#t=setTimeout(()=>{this.#t=null,this.#i(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(let{renderTasks:E,operatorList:r}of this._intentStates.values())if(E.size>0||!r.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#s(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(i,E){let r=this._intentStates.get(E);r&&(this._stats?.timeEnd("Page Request"),r.displayReadyCapability?.resolve(i))}_renderPageChunk(i,E){for(let r=0,g=i.length;r<g;r++)E.operatorList.fnArray.push(i.fnArray[r]),E.operatorList.argsArray.push(i.argsArray[r]);E.operatorList.lastChunk=i.lastChunk,E.operatorList.separateAnnots=i.separateAnnots;for(let r of E.renderTasks)r.operatorListChanged();i.lastChunk&&this.#i(!0)}_pumpOperatorList({renderingIntent:i,cacheKey:E,annotationStorageSerializable:r}){let{map:g,transfers:P}=r,U=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:i,cacheKey:E,annotationStorage:g},P).getReader(),B=this._intentStates.get(E);B.streamReader=U;let h=()=>{U.read().then(({value:n,done:t})=>{if(t){B.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(n,B),h())},n=>{if(B.streamReader=null,!this._transport.destroyed){if(B.operatorList){B.operatorList.lastChunk=!0;for(let t of B.renderTasks)t.operatorListChanged();this.#i(!0)}if(B.displayReadyCapability)B.displayReadyCapability.reject(n);else if(B.opListReadCapability)B.opListReadCapability.reject(n);else throw n}})};h()}_abortOperatorList({intentState:i,reason:E,force:r=!1}){if(i.streamReader){if(i.streamReaderCancelTimeout&&(clearTimeout(i.streamReaderCancelTimeout),i.streamReaderCancelTimeout=null),!r){if(i.renderTasks.size>0)return;if(E instanceof _display_utils.RenderingCancelledException){let g=RENDERING_CANCELLED_TIMEOUT;E.extraDelay>0&&E.extraDelay<1e3&&(g+=E.extraDelay),i.streamReaderCancelTimeout=setTimeout(()=>{i.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:i,reason:E,force:!0})},g);return}}if(i.streamReader.cancel(new _util.AbortException(E.message)).catch(()=>{}),i.streamReader=null,!this._transport.destroyed){for(let[g,P]of this._intentStates)if(P===i){this._intentStates.delete(g);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#t=new Set;#e=Promise.resolve();postMessage(i,E){let r={data:structuredClone(i,E?{transfer:E}:null)};this.#e.then(()=>{for(let g of this.#t)g.call(this,r)})}addEventListener(i,E){this.#t.add(E)}removeEventListener(i,E){this.#t.delete(E)}terminate(){this.#t.clear()}}exports.LoopbackPort=LoopbackPort;let PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof oe=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){let F=document?.currentScript?.src;F&&(PDFWorkerUtil.fallbackWorkerSrc=F.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(F,i){let E;try{if(E=new URL(F),!E.origin||E.origin==="null")return!1}catch{return!1}let r=new URL(i,E);return E.origin===r.origin},PDFWorkerUtil.createCDNWrapper=function(F){let i=`importScripts("${F}");`;return URL.createObjectURL(new Blob([i]))}}class PDFWorker{static#workerPorts;constructor({name:F=null,port:i=null,verbosity:E=(0,_util.getVerbosityLevel)()}={}){if(this.name=F,this.destroyed=!1,this.verbosity=E,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,i){if(PDFWorker.#workerPorts?.has(i))throw new Error("Cannot use more than one PDFWorker per port.");(PDFWorker.#workerPorts||=new WeakMap).set(i,this),this._initializeFromPort(i);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(F){this._port=F,this._messageHandler=new _message_handler.MessageHandler("main","worker",F),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:F}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,F)||(F=PDFWorkerUtil.createCDNWrapper(new URL(F,window.location).href));let i=new Worker(F),E=new _message_handler.MessageHandler("main","worker",i),r=()=>{i.removeEventListener("error",g),E.destroy(),i.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},g=()=>{this._webWorker||r()};i.addEventListener("error",g),E.on("test",x=>{if(i.removeEventListener("error",g),this.destroyed){r();return}x?(this._messageHandler=E,this._port=i,this._webWorker=i,this._readyCapability.resolve(),E.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),E.destroy(),i.terminate())}),E.on("ready",x=>{if(i.removeEventListener("error",g),this.destroyed){r();return}try{P()}catch{this._setupFakeWorker()}});let P=()=>{let x=new Uint8Array;E.send("test",x,[x.buffer])};P();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(F=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}let i=new LoopbackPort;this._port=i;let E=`fake${PDFWorkerUtil.fakeWorkerId++}`,r=new _message_handler.MessageHandler(E+"_worker",E,i);F.setup(r,i);let g=new _message_handler.MessageHandler(E,E+"_worker",i);this._messageHandler=g,this._readyCapability.resolve(),g.send("configure",{verbosity:this.verbosity})}).catch(F=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${F.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(F){if(!F?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");let i=this.#workerPorts?.get(F.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new PDFWorker(F)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){let loader=()=>ht(this,null,function*(){let mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof oe=="function"){let worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return yield(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler});return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker;class WorkerTransport{#t=new Map;#e=new Map;#i=new Map;#s=null;constructor(i,E,r,g,P){this.messageHandler=i,this.loadingTask=E,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:g.ownerDocument,styleElement:g.styleElement}),this._params=g,this.canvasFactory=P.canvasFactory,this.filterFactory=P.filterFactory,this.cMapReaderFactory=P.cMapReaderFactory,this.standardFontDataFactory=P.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#o(i,E=null){let r=this.#t.get(i);if(r)return r;let g=this.messageHandler.sendWithPromise(i,E);return this.#t.set(i,g),g}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(i,E=_util.AnnotationMode.ENABLE,r=null,g=!1){let P=_util.RenderingIntentFlag.DISPLAY,x=_annotation_storage.SerializableEmpty;switch(i){case"any":P=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":P=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${i}`)}switch(E){case _util.AnnotationMode.DISABLE:P+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:P+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:P+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,x=(P&_util.RenderingIntentFlag.PRINT&&r instanceof _annotation_storage.PrintAnnotationStorage?r:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${E}`)}return g&&(P+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:P,cacheKey:`${P}_${x.hash}`,annotationStorageSerializable:x}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));let i=[];for(let r of this.#e.values())i.push(r._destroy());this.#e.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();let E=this.messageHandler.sendWithPromise("Terminate",null);return i.push(E),Promise.all(i).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){let{messageHandler:i,loadingTask:E}=this;i.on("GetReader",(r,g)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=P=>{this._lastProgress={loaded:P.loaded,total:P.total}},g.onPull=()=>{this._fullReader.read().then(function({value:P,done:x}){if(x){g.close();return}(0,_util.assert)(P instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),g.enqueue(new Uint8Array(P),1,[P])}).catch(P=>{g.error(P)})},g.onCancel=P=>{this._fullReader.cancel(P),g.ready.catch(x=>{if(!this.destroyed)throw x})}}),i.on("ReaderHeadersReady",r=>{let g=new _util.PromiseCapability,P=this._fullReader;return P.headersReady.then(()=>{(!P.isStreamingSupported||!P.isRangeSupported)&&(this._lastProgress&&E.onProgress?.(this._lastProgress),P.onProgress=x=>{E.onProgress?.({loaded:x.loaded,total:x.total})}),g.resolve({isStreamingSupported:P.isStreamingSupported,isRangeSupported:P.isRangeSupported,contentLength:P.contentLength})},g.reject),g.promise}),i.on("GetRangeReader",(r,g)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");let P=this._networkStream.getRangeReader(r.begin,r.end);if(!P){g.close();return}g.onPull=()=>{P.read().then(function({value:x,done:U}){if(U){g.close();return}(0,_util.assert)(x instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),g.enqueue(new Uint8Array(x),1,[x])}).catch(x=>{g.error(x)})},g.onCancel=x=>{P.cancel(x),g.ready.catch(U=>{if(!this.destroyed)throw U})}}),i.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,E._capability.resolve(new PDFDocumentProxy(r,this))}),i.on("DocException",function(r){let g;switch(r.name){case"PasswordException":g=new _util.PasswordException(r.message,r.code);break;case"InvalidPDFException":g=new _util.InvalidPDFException(r.message);break;case"MissingPDFException":g=new _util.MissingPDFException(r.message);break;case"UnexpectedResponseException":g=new _util.UnexpectedResponseException(r.message,r.status);break;case"UnknownErrorException":g=new _util.UnknownErrorException(r.message,r.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}E._capability.reject(g)}),i.on("PasswordRequest",r=>{if(this.#s=new _util.PromiseCapability,E.onPassword){let g=P=>{P instanceof Error?this.#s.reject(P):this.#s.resolve({password:P})};try{E.onPassword(g,r.code)}catch(P){this.#s.reject(P)}}else this.#s.reject(new _util.PasswordException(r.message,r.code));return this.#s.promise}),i.on("DataLoaded",r=>{E.onProgress?.({loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),i.on("StartRenderPage",r=>{if(this.destroyed)return;this.#e.get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),i.on("commonobj",([r,g,P])=>{if(!this.destroyed&&!this.commonObjs.has(r))switch(g){case"Font":let x=this._params;if("error"in P){let h=P.error;(0,_util.warn)(`Error during font loading: ${h}`),this.commonObjs.resolve(r,h);break}let U=x.pdfBug&&globalThis.FontInspector?.enabled?(h,n)=>globalThis.FontInspector.fontAdded(h,n):null,B=new _font_loader.FontFaceObject(P,{isEvalSupported:x.isEvalSupported,disableFontFace:x.disableFontFace,ignoreErrors:x.ignoreErrors,inspectFont:U});this.fontLoader.bind(B).catch(h=>i.sendWithPromise("FontFallback",{id:r})).finally(()=>{!x.fontExtraProperties&&B.data&&(B.data=null),this.commonObjs.resolve(r,B)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,P);break;default:throw new Error(`Got unknown common object type ${g}`)}}),i.on("obj",([r,g,P,x])=>{if(this.destroyed)return;let U=this.#e.get(g);if(!U.objs.has(r))switch(P){case"Image":if(U.objs.resolve(r,x),x){let B;if(x.bitmap){let{width:h,height:n}=x;B=h*n*4}else B=x.data?.length||0;B>_util.MAX_IMAGE_SIZE_TO_CACHE&&(U._maybeCleanupAfterRender=!0)}break;case"Pattern":U.objs.resolve(r,x);break;default:throw new Error(`Got unknown object type ${P}`)}}),i.on("DocProgress",r=>{this.destroyed||E.onProgress?.({loaded:r.loaded,total:r.total})}),i.on("FetchBuiltInCMap",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(r):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),i.on("FetchStandardFontData",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(r):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");let{map:i,transfers:E}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:i,filename:this._fullReader?.filename??null},E).finally(()=>{this.annotationStorage.resetModified()})}getPage(i){if(!Number.isInteger(i)||i<=0||i>this._numPages)return Promise.reject(new Error("Invalid page request."));let E=i-1,r=this.#i.get(E);if(r)return r;let g=this.messageHandler.sendWithPromise("GetPage",{pageIndex:E}).then(P=>{if(this.destroyed)throw new Error("Transport destroyed");let x=new PDFPageProxy(E,P,this,this._params.pdfBug);return this.#e.set(E,x),x});return this.#i.set(E,g),g}getPageIndex(i){return typeof i!="object"||i===null||!Number.isInteger(i.num)||i.num<0||!Number.isInteger(i.gen)||i.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:i.num,gen:i.gen})}getAnnotations(i,E){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:i,intent:E})}getFieldObjects(){return this.#o("GetFieldObjects")}hasJSActions(){return this.#o("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(i){return typeof i!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:i})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#o("GetDocJSActions")}getPageJSActions(i){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:i})}getStructTree(i){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:i})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(i=>new _optional_content_config.OptionalContentConfig(i))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){let i="GetMetadata",E=this.#t.get(i);if(E)return E;let r=this.messageHandler.sendWithPromise(i,null).then(g=>({info:g[0],metadata:g[1]?new _metadata.Metadata(g[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(i,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}startCleanup(i=!1){return ht(this,null,function*(){if(!this.destroyed){yield this.messageHandler.sendWithPromise("Cleanup",null);for(let E of this.#e.values())if(!E.cleanup())throw new Error(`startCleanup: Page ${E.pageNumber} is currently rendering.`);this.commonObjs.clear(),i||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0)}})}get loadingParams(){let{disableAutoFetch:i,enableXfa:E}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:i,enableXfa:E})}}class PDFObjects{#t=Object.create(null);#e(i){return this.#t[i]||={capability:new _util.PromiseCapability,data:null}}get(i,E=null){if(E){let g=this.#e(i);return g.capability.promise.then(()=>E(g.data)),null}let r=this.#t[i];if(!r?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${i}.`);return r.data}has(i){return this.#t[i]?.capability.settled||!1}resolve(i,E=null){let r=this.#e(i);r.data=E,r.capability.resolve()}clear(){for(let i in this.#t){let{data:E}=this.#t[i];E?.bitmap?.close()}this.#t=Object.create(null)}}class RenderTask{#t=null;constructor(i){this.#t=i,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(i=0){this.#t.cancel(null,i)}get separateAnnots(){let{separateAnnots:i}=this.#t.operatorList;if(!i)return!1;let{annotationCanvasMap:E}=this.#t;return i.form||i.canvas&&E?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#t=new WeakSet;constructor({callback:i,params:E,objs:r,commonObjs:g,annotationCanvasMap:P,operatorList:x,pageIndex:U,canvasFactory:B,filterFactory:h,useRequestAnimationFrame:n=!1,pdfBug:t=!1,pageColors:s=null}){this.callback=i,this.params=E,this.objs=r,this.commonObjs=g,this.annotationCanvasMap=P,this.operatorListIdx=null,this.operatorList=x,this._pageIndex=U,this.canvasFactory=B,this.filterFactory=h,this._pdfBug=t,this.pageColors=s,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=n===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=E.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:i=!1,optionalContentConfig:E}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());let{canvasContext:r,viewport:g,transform:P,background:x}=this.params;this.gfx=new _canvas.CanvasGraphics(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:E},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:P,viewport:g,transparency:i,background:x}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(i=null,E=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),InternalRenderTask.#t.delete(this._canvas),this.callback(i||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,E))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}_next(){return ht(this,null,function*(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),InternalRenderTask.#t.delete(this._canvas),this.callback())))})}}let version="3.11.174";exports.version=version;let build="ce8716743";exports.build=build},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.SerializableEmpty=i.PrintAnnotationStorage=i.AnnotationStorage=void 0;var r=E(1),g=E(4),P=E(8);let x=Object.freeze({map:null,hash:"",transfers:void 0});i.SerializableEmpty=x;class U{#t=!1;#e=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(n,t){let s=this.#e.get(n);return s===void 0?t:Object.assign(t,s)}getRawValue(n){return this.#e.get(n)}remove(n){if(this.#e.delete(n),this.#e.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(let t of this.#e.values())if(t instanceof g.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(n,t){let s=this.#e.get(n),l=!1;if(s!==void 0)for(let[o,e]of Object.entries(t))s[o]!==e&&(l=!0,s[o]=e);else l=!0,this.#e.set(n,t);l&&this.#i(),t instanceof g.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(n){return this.#e.has(n)}getAll(){return this.#e.size>0?(0,r.objectFromMap)(this.#e):null}setAll(n){for(let[t,s]of Object.entries(n))this.setValue(t,s)}get size(){return this.#e.size}#i(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new B(this)}get serializable(){if(this.#e.size===0)return x;let n=new Map,t=new P.MurmurHash3_64,s=[],l=Object.create(null),o=!1;for(let[e,u]of this.#e){let f=u instanceof g.AnnotationEditor?u.serialize(!1,l):u;f&&(n.set(e,f),t.update(`${e}:${JSON.stringify(f)}`),o||=!!f.bitmap)}if(o)for(let e of n.values())e.bitmap&&s.push(e.bitmap);return n.size>0?{map:n,hash:t.hexdigest(),transfers:s}:x}}i.AnnotationStorage=U;class B extends U{#t;constructor(n){super();let{map:t,hash:s,transfers:l}=n.serializable,o=structuredClone(t,l?{transfer:l}:null);this.#t={map:o,hash:s,transfers:l}}get print(){(0,r.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}}i.PrintAnnotationStorage=B},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationEditor=void 0;var r=E(5),g=E(1),P=E(6);class x{#t="";#e=!1;#i=null;#s=null;#o=null;#a=!1;#r=null;#l=this.focusin.bind(this);#c=this.focusout.bind(this);#n=!1;#f=!1;#d=!1;_initialOptions=Object.create(null);_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#u=!1;#p=x._zIndex++;static _borderLineWidth=-1;static _colorManager=new r.ColorManager;static _zIndex=1;static SMALL_EDITOR_SIZE=0;constructor(h){this.constructor===x&&(0,g.unreachable)("Cannot initialize AnnotationEditor."),this.parent=h.parent,this.id=h.id,this.width=this.height=null,this.pageIndex=h.parent.pageIndex,this.name=h.name,this.div=null,this._uiManager=h.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=h.isCentered,this._structTreeParentId=null;let{rotation:n,rawDims:{pageWidth:t,pageHeight:s,pageX:l,pageY:o}}=this.parent.viewport;this.rotation=n,this.pageRotation=(360+n-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[t,s],this.pageTranslation=[l,o];let[e,u]=this.parentDimensions;this.x=h.x/e,this.y=h.y/u,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,g.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(h){let n=new U({id:h.parent.getNextId(),parent:h.parent,uiManager:h._uiManager});n.annotationElementId=h.annotationElementId,n.deleted=!0,n._uiManager.addToAnnotationStorage(n)}static initialize(h,n=null){if(x._l10nPromise||=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(s=>[s,h.get(s)])),n?.strings)for(let s of n.strings)x._l10nPromise.set(s,h.get(s));if(x._borderLineWidth!==-1)return;let t=getComputedStyle(document.documentElement);x._borderLineWidth=parseFloat(t.getPropertyValue("--outline-width"))||0}static updateDefaultParams(h,n){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(h){return!1}static paste(h,n){(0,g.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#u}set _isDraggable(h){this.#u=h,this.div?.classList.toggle("draggable",h)}center(){let[h,n]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*n/(h*2),this.y+=this.width*h/(n*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*n/(h*2),this.y-=this.width*h/(n*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(h){this._uiManager.addCommands(h)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#p}setParent(h){h!==null&&(this.pageIndex=h.pageIndex,this.pageDimensions=h.pageDimensions),this.parent=h}focusin(h){this._focusEventsAllowed&&(this.#n?this.#n=!1:this.parent.setSelected(this))}focusout(h){!this._focusEventsAllowed||!this.isAttachedToDOM||h.relatedTarget?.closest(`#${this.id}`)||(h.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(h,n,t,s){let[l,o]=this.parentDimensions;[t,s]=this.screenToPageTranslation(t,s),this.x=(h+t)/l,this.y=(n+s)/o,this.fixAndSetPosition()}#_([h,n],t,s){[t,s]=this.screenToPageTranslation(t,s),this.x+=t/h,this.y+=s/n,this.fixAndSetPosition()}translate(h,n){this.#_(this.parentDimensions,h,n)}translateInPage(h,n){this.#_(this.pageDimensions,h,n),this.div.scrollIntoView({block:"nearest"})}drag(h,n){let[t,s]=this.parentDimensions;if(this.x+=h/t,this.y+=n/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){let{x:f,y:_}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,_)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:o}=this,[e,u]=this.#m();l+=e,o+=u,this.div.style.left=`${(100*l).toFixed(2)}%`,this.div.style.top=`${(100*o).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}#m(){let[h,n]=this.parentDimensions,{_borderLineWidth:t}=x,s=t/h,l=t/n;switch(this.rotation){case 90:return[-s,l];case 180:return[s,l];case 270:return[s,-l];default:return[-s,-l]}}fixAndSetPosition(){let[h,n]=this.pageDimensions,{x:t,y:s,width:l,height:o}=this;switch(l*=h,o*=n,t*=h,s*=n,this.rotation){case 0:t=Math.max(0,Math.min(h-l,t)),s=Math.max(0,Math.min(n-o,s));break;case 90:t=Math.max(0,Math.min(h-o,t)),s=Math.min(n,Math.max(l,s));break;case 180:t=Math.min(h,Math.max(l,t)),s=Math.min(n,Math.max(o,s));break;case 270:t=Math.min(h,Math.max(o,t)),s=Math.max(0,Math.min(n-l,s));break}this.x=t/=h,this.y=s/=n;let[e,u]=this.#m();t+=e,s+=u;let{style:f}=this.div;f.left=`${(100*t).toFixed(2)}%`,f.top=`${(100*s).toFixed(2)}%`,this.moveInDOM()}static#g(h,n,t){switch(t){case 90:return[n,-h];case 180:return[-h,-n];case 270:return[-n,h];default:return[h,n]}}screenToPageTranslation(h,n){return x.#g(h,n,this.parentRotation)}pageTranslationToScreen(h,n){return x.#g(h,n,360-this.parentRotation)}#h(h){switch(h){case 90:{let[n,t]=this.pageDimensions;return[0,-n/t,t/n,0]}case 180:return[-1,0,0,-1];case 270:{let[n,t]=this.pageDimensions;return[0,n/t,-t/n,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){let{parentScale:h,pageDimensions:[n,t]}=this,s=n*h,l=t*h;return g.FeatureTest.isCSSRoundSupported?[Math.round(s),Math.round(l)]:[s,l]}setDims(h,n){let[t,s]=this.parentDimensions;this.div.style.width=`${(100*h/t).toFixed(2)}%`,this.#a||(this.div.style.height=`${(100*n/s).toFixed(2)}%`),this.#i?.classList.toggle("small",h<x.SMALL_EDITOR_SIZE||n<x.SMALL_EDITOR_SIZE)}fixDims(){let{style:h}=this.div,{height:n,width:t}=h,s=t.endsWith("%"),l=!this.#a&&n.endsWith("%");if(s&&l)return;let[o,e]=this.parentDimensions;s||(h.width=`${(100*parseFloat(t)/o).toFixed(2)}%`),!this.#a&&!l&&(h.height=`${(100*parseFloat(n)/e).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#b(){if(this.#r)return;this.#r=document.createElement("div"),this.#r.classList.add("resizers");let h=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||h.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(let n of h){let t=document.createElement("div");this.#r.append(t),t.classList.add("resizer",n),t.addEventListener("pointerdown",this.#E.bind(this,n)),t.addEventListener("contextmenu",P.noContextMenu)}this.div.prepend(this.#r)}#E(h,n){n.preventDefault();let{isMac:t}=g.FeatureTest.platform;if(n.button!==0||n.ctrlKey&&t)return;let s=this.#S.bind(this,h),l=this._isDraggable;this._isDraggable=!1;let o={passive:!0,capture:!0};window.addEventListener("pointermove",s,o);let e=this.x,u=this.y,f=this.width,_=this.height,T=this.parent.div.style.cursor,S=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(n.target).cursor;let p=()=>{this._isDraggable=l,window.removeEventListener("pointerup",p),window.removeEventListener("blur",p),window.removeEventListener("pointermove",s,o),this.parent.div.style.cursor=T,this.div.style.cursor=S;let y=this.x,O=this.y,j=this.width,I=this.height;y===e&&O===u&&j===f&&I===_||this.addCommands({cmd:()=>{this.width=j,this.height=I,this.x=y,this.y=O;let[z,X]=this.parentDimensions;this.setDims(z*j,X*I),this.fixAndSetPosition()},undo:()=>{this.width=f,this.height=_,this.x=e,this.y=u;let[z,X]=this.parentDimensions;this.setDims(z*f,X*_),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",p),window.addEventListener("blur",p)}#S(h,n){let[t,s]=this.parentDimensions,l=this.x,o=this.y,e=this.width,u=this.height,f=x.MIN_SIZE/t,_=x.MIN_SIZE/s,T=w=>Math.round(w*1e4)/1e4,S=this.#h(this.rotation),p=(w,a)=>[S[0]*w+S[2]*a,S[1]*w+S[3]*a],y=this.#h(360-this.rotation),O=(w,a)=>[y[0]*w+y[2]*a,y[1]*w+y[3]*a],j,I,z=!1,X=!1;switch(h){case"topLeft":z=!0,j=(w,a)=>[0,0],I=(w,a)=>[w,a];break;case"topMiddle":j=(w,a)=>[w/2,0],I=(w,a)=>[w/2,a];break;case"topRight":z=!0,j=(w,a)=>[w,0],I=(w,a)=>[0,a];break;case"middleRight":X=!0,j=(w,a)=>[w,a/2],I=(w,a)=>[0,a/2];break;case"bottomRight":z=!0,j=(w,a)=>[w,a],I=(w,a)=>[0,0];break;case"bottomMiddle":j=(w,a)=>[w/2,a],I=(w,a)=>[w/2,0];break;case"bottomLeft":z=!0,j=(w,a)=>[0,a],I=(w,a)=>[w,0];break;case"middleLeft":X=!0,j=(w,a)=>[0,a/2],I=(w,a)=>[w,a/2];break}let it=j(e,u),tt=I(e,u),Q=p(...tt),nt=T(l+Q[0]),J=T(o+Q[1]),D=1,b=1,[c,d]=this.screenToPageTranslation(n.movementX,n.movementY);if([c,d]=O(c/t,d/s),z){let w=Math.hypot(e,u);D=b=Math.max(Math.min(Math.hypot(tt[0]-it[0]-c,tt[1]-it[1]-d)/w,1/e,1/u),f/e,_/u)}else X?D=Math.max(f,Math.min(1,Math.abs(tt[0]-it[0]-c)))/e:b=Math.max(_,Math.min(1,Math.abs(tt[1]-it[1]-d)))/u;let A=T(e*D),M=T(u*b);Q=p(...I(A,M));let R=nt-Q[0],L=J-Q[1];this.width=A,this.height=M,this.x=R,this.y=L,this.setDims(t*A,s*M),this.fixAndSetPosition()}addAltTextButton(){return ht(this,null,function*(){if(this.#i)return;let h=this.#i=document.createElement("button");h.className="altText";let n=yield x._l10nPromise.get("editor_alt_text_button_label");h.textContent=n,h.setAttribute("aria-label",n),h.tabIndex="0",h.addEventListener("contextmenu",P.noContextMenu),h.addEventListener("pointerdown",t=>t.stopPropagation()),h.addEventListener("click",t=>{t.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),h.addEventListener("keydown",t=>{t.target===h&&t.key==="Enter"&&(t.preventDefault(),this._uiManager.editAltText(this))}),this.#T(),this.div.append(h),x.SMALL_EDITOR_SIZE||(x.SMALL_EDITOR_SIZE=Math.min(128,Math.round(h.getBoundingClientRect().width*1.4)))})}#T(){return ht(this,null,function*(){let h=this.#i;if(!h)return;if(!this.#t&&!this.#e){h.classList.remove("done"),this.#s?.remove();return}x._l10nPromise.get("editor_alt_text_edit_button_label").then(t=>{h.setAttribute("aria-label",t)});let n=this.#s;if(!n){this.#s=n=document.createElement("span"),n.className="tooltip",n.setAttribute("role","tooltip");let t=n.id=`alt-text-tooltip-${this.id}`;h.setAttribute("aria-describedby",t);let s=100;h.addEventListener("mouseenter",()=>{this.#o=setTimeout(()=>{this.#o=null,this.#s.classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},s)}),h.addEventListener("mouseleave",()=>{clearTimeout(this.#o),this.#o=null,this.#s?.classList.remove("show")})}h.classList.add("done"),n.innerText=this.#e?yield x._l10nPromise.get("editor_alt_text_decorative_tooltip"):this.#t,n.parentNode||h.append(n)})}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:this.#t,decorative:this.#e}}set altTextData({altText:h,decorative:n}){this.#t===h&&this.#e===n||(this.#t=h,this.#e=n,this.#T())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#l),this.div.addEventListener("focusout",this.#c);let[h,n]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*n/h).toFixed(2)}%`,this.div.style.maxHeight=`${(100*h/n).toFixed(2)}%`);let[t,s]=this.getInitialTranslation();return this.translate(t,s),(0,r.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(h){let{isMac:n}=g.FeatureTest.platform;if(h.button!==0||h.ctrlKey&&n){h.preventDefault();return}this.#n=!0,this.#P(h)}#P(h){if(!this._isDraggable)return;let n=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let t,s;n&&(t={passive:!0,capture:!0},s=o=>{let[e,u]=this.screenToPageTranslation(o.movementX,o.movementY);this._uiManager.dragSelectedEditors(e,u)},window.addEventListener("pointermove",s,t));let l=()=>{if(window.removeEventListener("pointerup",l),window.removeEventListener("blur",l),n&&window.removeEventListener("pointermove",s,t),this.#n=!1,!this._uiManager.endDragSession()){let{isMac:o}=g.FeatureTest.platform;h.ctrlKey&&!o||h.shiftKey||h.metaKey&&o?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",l),window.addEventListener("blur",l)}moveInDOM(){this.parent?.moveEditorInDOM(this)}_setParentAndPosition(h,n,t){h.changeParent(this),this.x=n,this.y=t,this.fixAndSetPosition()}getRect(h,n){let t=this.parentScale,[s,l]=this.pageDimensions,[o,e]=this.pageTranslation,u=h/t,f=n/t,_=this.x*s,T=this.y*l,S=this.width*s,p=this.height*l;switch(this.rotation){case 0:return[_+u+o,l-T-f-p+e,_+u+S+o,l-T-f+e];case 90:return[_+f+o,l-T+u+e,_+f+p+o,l-T+u+S+e];case 180:return[_-u-S+o,l-T+f+e,_-u+o,l-T+f+p+e];case 270:return[_-f-p+o,l-T-u-S+e,_-f+o,l-T-u+e];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(h,n){let[t,s,l,o]=h,e=l-t,u=o-s;switch(this.rotation){case 0:return[t,n-o,e,u];case 90:return[t,n-s,u,e];case 180:return[l,n-s,e,u];case 270:return[l,n-o,u,e];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#d=!0}disableEditMode(){this.#d=!1}isInEditMode(){return this.#d}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#l),this.div?.addEventListener("focusout",this.#c)}serialize(h=!1,n=null){(0,g.unreachable)("An editor must be serializable")}static deserialize(h,n,t){let s=new this.prototype.constructor({parent:n,id:n.getNextId(),uiManager:t});s.rotation=h.rotation;let[l,o]=s.pageDimensions,[e,u,f,_]=s.getRectInCurrentCoords(h.rect,o);return s.x=e/l,s.y=u/o,s.width=f/l,s.height=_/o,s}remove(){this.div.removeEventListener("focusin",this.#l),this.div.removeEventListener("focusout",this.#c),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#i?.remove(),this.#i=null,this.#s=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#b(),this.#r.classList.remove("hidden"))}select(){this.makeResizable(),this.div?.classList.add("selectedEditor")}unselect(){this.#r?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(h,n){}disableEditing(){this.#i&&(this.#i.hidden=!0)}enableEditing(){this.#i&&(this.#i.hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return this.#f}set isEditing(h){this.#f=h,this.parent&&(h?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(h,n){this.#a=!0;let t=h/n,{style:s}=this.div;s.aspectRatio=t,s.height="auto"}static get MIN_SIZE(){return 16}}i.AnnotationEditor=x;class U extends x{constructor(h){super(h),this.annotationElementId=h.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.KeyboardManager=i.CommandManager=i.ColorManager=i.AnnotationEditorUIManager=void 0,i.bindEvents=P,i.opacityToHex=x;var r=E(1),g=E(6);function P(l,o,e){for(let u of e)o.addEventListener(u,l[u].bind(l))}function x(l){return Math.round(Math.min(255,Math.max(1,255*l))).toString(16).padStart(2,"0")}class U{#t=0;getId(){return`${r.AnnotationEditorPrefix}${this.#t++}`}}class B{#t=(0,r.getUuid)();#e=0;#i=null;static get _isSVGFittingCanvas(){let o='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',u=new OffscreenCanvas(1,3).getContext("2d"),f=new Image;f.src=o;let _=f.decode().then(()=>(u.drawImage(f,0,0,1,1,0,0,1,3),new Uint32Array(u.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,r.shadow)(this,"_isSVGFittingCanvas",_)}#s(o,e){return ht(this,null,function*(){this.#i||=new Map;let u=this.#i.get(o);if(u===null)return null;if(u?.bitmap)return u.refCounter+=1,u;try{u||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let f;if(typeof e=="string"){u.url=e;let _=yield fetch(e);if(!_.ok)throw new Error(_.statusText);f=yield _.blob()}else f=u.file=e;if(f.type==="image/svg+xml"){let _=B._isSVGFittingCanvas,T=new FileReader,S=new Image,p=new Promise((y,O)=>{S.onload=()=>{u.bitmap=S,u.isSvg=!0,y()},T.onload=()=>ht(this,null,function*(){let j=u.svgUrl=T.result;S.src=(yield _)?`${j}#svgView(preserveAspectRatio(none))`:j}),S.onerror=T.onerror=O});T.readAsDataURL(f),yield p}else u.bitmap=yield createImageBitmap(f);u.refCounter=1}catch(f){console.error(f),u=null}return this.#i.set(o,u),u&&this.#i.set(u.id,u),u})}getFromFile(o){return ht(this,null,function*(){let{lastModified:e,name:u,size:f,type:_}=o;return this.#s(`${e}_${u}_${f}_${_}`,o)})}getFromUrl(o){return ht(this,null,function*(){return this.#s(o,o)})}getFromId(o){return ht(this,null,function*(){this.#i||=new Map;let e=this.#i.get(o);return e?e.bitmap?(e.refCounter+=1,e):e.file?this.getFromFile(e.file):this.getFromUrl(e.url):null})}getSvgUrl(o){let e=this.#i.get(o);return e?.isSvg?e.svgUrl:null}deleteId(o){this.#i||=new Map;let e=this.#i.get(o);e&&(e.refCounter-=1,e.refCounter===0&&(e.bitmap=null))}isValidId(o){return o.startsWith(`image_${this.#t}_`)}}class h{#t=[];#e=!1;#i;#s=-1;constructor(o=128){this.#i=o}add({cmd:o,undo:e,mustExec:u,type:f=NaN,overwriteIfSameType:_=!1,keepUndo:T=!1}){if(u&&o(),this.#e)return;let S={cmd:o,undo:e,type:f};if(this.#s===-1){this.#t.length>0&&(this.#t.length=0),this.#s=0,this.#t.push(S);return}if(_&&this.#t[this.#s].type===f){T&&(S.undo=this.#t[this.#s].undo),this.#t[this.#s]=S;return}let p=this.#s+1;p===this.#i?this.#t.splice(0,1):(this.#s=p,p<this.#t.length&&this.#t.splice(p)),this.#t.push(S)}undo(){this.#s!==-1&&(this.#e=!0,this.#t[this.#s].undo(),this.#e=!1,this.#s-=1)}redo(){this.#s<this.#t.length-1&&(this.#s+=1,this.#e=!0,this.#t[this.#s].cmd(),this.#e=!1)}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#t.length-1}destroy(){this.#t=null}}i.CommandManager=h;class n{constructor(o){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;let{isMac:e}=r.FeatureTest.platform;for(let[u,f,_={}]of o)for(let T of u){let S=T.startsWith("mac+");e&&S?(this.callbacks.set(T.slice(4),{callback:f,options:_}),this.allKeys.add(T.split("+").at(-1))):!e&&!S&&(this.callbacks.set(T,{callback:f,options:_}),this.allKeys.add(T.split("+").at(-1)))}}#t(o){o.altKey&&this.buffer.push("alt"),o.ctrlKey&&this.buffer.push("ctrl"),o.metaKey&&this.buffer.push("meta"),o.shiftKey&&this.buffer.push("shift"),this.buffer.push(o.key);let e=this.buffer.join("+");return this.buffer.length=0,e}exec(o,e){if(!this.allKeys.has(e.key))return;let u=this.callbacks.get(this.#t(e));if(!u)return;let{callback:f,options:{bubbles:_=!1,args:T=[],checker:S=null}}=u;S&&!S(o,e)||(f.bind(o,...T)(),_||(e.stopPropagation(),e.preventDefault()))}}i.KeyboardManager=n;class t{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){let o=new Map([["CanvasText",null],["Canvas",null]]);return(0,g.getColorValues)(o),(0,r.shadow)(this,"_colors",o)}convert(o){let e=(0,g.getRGB)(o);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(let[u,f]of this._colors)if(f.every((_,T)=>_===e[T]))return t._colorsMapping.get(u);return e}getHexCode(o){let e=this._colors.get(o);return e?r.Util.makeHexColor(...e):o}}i.ColorManager=t;let s=(()=>{class l{#t=null;#e=new Map;#i=new Map;#s=null;#o=null;#a=new h;#r=0;#l=new Set;#c=null;#n=null;#f=new Set;#d=null;#u=new U;#p=!1;#_=!1;#m=null;#g=r.AnnotationEditorType.NONE;#h=new Set;#b=null;#E=this.blur.bind(this);#S=this.focus.bind(this);#T=this.copy.bind(this);#P=this.cut.bind(this);#I=this.paste.bind(this);#L=this.keydown.bind(this);#O=this.onEditingAction.bind(this);#A=this.onPageChanging.bind(this);#D=this.onScaleChanging.bind(this);#k=this.onRotationChanging.bind(this);#M={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#y=[0,0];#x=null;#w=null;#N=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){let e=l.prototype,u=T=>{let{activeElement:S}=document;return S&&T.#w.contains(S)&&T.hasSomethingToControl()},f=this.TRANSLATE_SMALL,_=this.TRANSLATE_BIG;return(0,r.shadow)(this,"_keyboardManager",new n([[["ctrl+a","mac+meta+a"],e.selectAll],[["ctrl+z","mac+meta+z"],e.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-f,0],checker:u}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-_,0],checker:u}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[f,0],checker:u}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[_,0],checker:u}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-f],checker:u}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-_],checker:u}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,f],checker:u}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,_],checker:u}]]))}constructor(e,u,f,_,T,S){this.#w=e,this.#N=u,this.#s=f,this._eventBus=_,this._eventBus._on("editingaction",this.#O),this._eventBus._on("pagechanging",this.#A),this._eventBus._on("scalechanging",this.#D),this._eventBus._on("rotationchanging",this.#k),this.#o=T.annotationStorage,this.#d=T.filterFactory,this.#b=S,this.viewParameters={realScale:g.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#R(),this.#U(),this._eventBus._off("editingaction",this.#O),this._eventBus._off("pagechanging",this.#A),this._eventBus._off("scalechanging",this.#D),this._eventBus._off("rotationchanging",this.#k);for(let e of this.#i.values())e.destroy();this.#i.clear(),this.#e.clear(),this.#f.clear(),this.#t=null,this.#h.clear(),this.#a.destroy(),this.#s.destroy()}get hcmFilter(){return(0,r.shadow)(this,"hcmFilter",this.#b?this.#d.addHCMFilter(this.#b.foreground,this.#b.background):"none")}get direction(){return(0,r.shadow)(this,"direction",getComputedStyle(this.#w).direction)}editAltText(e){this.#s?.editAltText(this,e)}onPageChanging({pageNumber:e}){this.#r=e-1}focusMainContainer(){this.#w.focus()}findParent(e,u){for(let f of this.#i.values()){let{x:_,y:T,width:S,height:p}=f.div.getBoundingClientRect();if(e>=_&&e<=_+S&&u>=T&&u<=T+p)return f}return null}disableUserSelect(e=!1){this.#N.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#f.add(e)}removeShouldRescale(e){this.#f.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*g.PixelsPerInch.PDF_TO_CSS_UNITS;for(let u of this.#f)u.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}addToAnnotationStorage(e){!e.isEmpty()&&this.#o&&!this.#o.has(e.id)&&this.#o.setValue(e.id,e)}#B(){window.addEventListener("focus",this.#S),window.addEventListener("blur",this.#E)}#U(){window.removeEventListener("focus",this.#S),window.removeEventListener("blur",this.#E)}blur(){if(!this.hasSelection)return;let{activeElement:e}=document;for(let u of this.#h)if(u.div.contains(e)){this.#m=[u,e],u._focusEventsAllowed=!1;break}}focus(){if(!this.#m)return;let[e,u]=this.#m;this.#m=null,u.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0}),u.focus()}#j(){window.addEventListener("keydown",this.#L,{capture:!0})}#R(){window.removeEventListener("keydown",this.#L,{capture:!0})}#F(){document.addEventListener("copy",this.#T),document.addEventListener("cut",this.#P),document.addEventListener("paste",this.#I)}#C(){document.removeEventListener("copy",this.#T),document.removeEventListener("cut",this.#P),document.removeEventListener("paste",this.#I)}addEditListeners(){this.#j(),this.#F()}removeEditListeners(){this.#R(),this.#C()}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;let u=[];for(let f of this.#h){let _=f.serialize(!0);_&&u.push(_)}u.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(u))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();let{clipboardData:u}=e;for(let T of u.items)for(let S of this.#n)if(S.isHandlingMimeForPasting(T.type)){S.paste(T,this.currentLayer);return}let f=u.getData("application/pdfjs");if(!f)return;try{f=JSON.parse(f)}catch(T){(0,r.warn)(`paste: "${T.message}".`);return}if(!Array.isArray(f))return;this.unselectAll();let _=this.currentLayer;try{let T=[];for(let y of f){let O=_.deserialize(y);if(!O)return;T.push(O)}let S=()=>{for(let y of T)this.#z(y);this.#G(T)},p=()=>{for(let y of T)y.remove()};this.addCommands({cmd:S,undo:p,mustExec:!0})}catch(T){(0,r.warn)(`paste: "${T.message}".`)}}keydown(e){this.getActive()?.shouldGetKeyboardEvents()||l._keyboardManager.exec(this,e)}onEditingAction(e){["undo","redo","delete","selectAll"].includes(e.name)&&this[e.name]()}#v(e){Object.entries(e).some(([f,_])=>this.#M[f]!==_)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#M,e)})}#W(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#B(),this.#j(),this.#F(),this.#v({isEditing:this.#g!==r.AnnotationEditorType.NONE,isEmpty:this.#H(),hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:this.#a.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#U(),this.#R(),this.#C(),this.#v({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#n){this.#n=e;for(let u of this.#n)this.#W(u.defaultPropertiesToUpdate)}}getId(){return this.#u.getId()}get currentLayer(){return this.#i.get(this.#r)}getLayer(e){return this.#i.get(e)}get currentPageIndex(){return this.#r}addLayer(e){this.#i.set(e.pageIndex,e),this.#p?e.enable():e.disable()}removeLayer(e){this.#i.delete(e.pageIndex)}updateMode(e,u=null){if(this.#g!==e){if(this.#g=e,e===r.AnnotationEditorType.NONE){this.setEditingState(!1),this.#V();return}this.setEditingState(!0),this.#X(),this.unselectAll();for(let f of this.#i.values())f.updateMode(e);if(u){for(let f of this.#e.values())if(f.annotationElementId===u){this.setSelected(f),f.enterInEditMode();break}}}}updateToolbar(e){e!==this.#g&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,u){if(this.#n){if(e===r.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(e);return}for(let f of this.#h)f.updateParams(e,u);for(let f of this.#n)f.updateDefaultParams(e,u)}}enableWaiting(e=!1){if(this.#_!==e){this.#_=e;for(let u of this.#i.values())e?u.disableClick():u.enableClick(),u.div.classList.toggle("waiting",e)}}#X(){if(!this.#p){this.#p=!0;for(let e of this.#i.values())e.enable()}}#V(){if(this.unselectAll(),this.#p){this.#p=!1;for(let e of this.#i.values())e.disable()}}getEditors(e){let u=[];for(let f of this.#e.values())f.pageIndex===e&&u.push(f);return u}getEditor(e){return this.#e.get(e)}addEditor(e){this.#e.set(e.id,e)}removeEditor(e){this.#e.delete(e.id),this.unselect(e),(!e.annotationElementId||!this.#l.has(e.annotationElementId))&&this.#o?.remove(e.id)}addDeletedAnnotationElement(e){this.#l.add(e.annotationElementId),e.deleted=!0}isDeletedAnnotationElement(e){return this.#l.has(e)}removeDeletedAnnotationElement(e){this.#l.delete(e.annotationElementId),e.deleted=!1}#z(e){let u=this.#i.get(e.pageIndex);u?u.addOrRebuild(e):this.addEditor(e)}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#W(e.propertiesToUpdate))}toggleSelected(e){if(this.#h.has(e)){this.#h.delete(e),e.unselect(),this.#v({hasSelectedEditor:this.hasSelection});return}this.#h.add(e),e.select(),this.#W(e.propertiesToUpdate),this.#v({hasSelectedEditor:!0})}setSelected(e){for(let u of this.#h)u!==e&&u.unselect();this.#h.clear(),this.#h.add(e),e.select(),this.#W(e.propertiesToUpdate),this.#v({hasSelectedEditor:!0})}isSelected(e){return this.#h.has(e)}unselect(e){e.unselect(),this.#h.delete(e),this.#v({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#h.size!==0}undo(){this.#a.undo(),this.#v({hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#H()})}redo(){this.#a.redo(),this.#v({hasSomethingToUndo:!0,hasSomethingToRedo:this.#a.hasSomethingToRedo(),isEmpty:this.#H()})}addCommands(e){this.#a.add(e),this.#v({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#H()})}#H(){if(this.#e.size===0)return!0;if(this.#e.size===1)for(let e of this.#e.values())return e.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;let e=[...this.#h],u=()=>{for(let _ of e)_.remove()},f=()=>{for(let _ of e)this.#z(_)};this.addCommands({cmd:u,undo:f,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#G(e){this.#h.clear();for(let u of e)u.isEmpty()||(this.#h.add(u),u.select());this.#v({hasSelectedEditor:!0})}selectAll(){for(let e of this.#h)e.commit();this.#G(this.#e.values())}unselectAll(){if(this.#t){this.#t.commitOrRemove();return}if(this.hasSelection){for(let e of this.#h)e.unselect();this.#h.clear(),this.#v({hasSelectedEditor:!1})}}translateSelectedEditors(e,u,f=!1){if(f||this.commitOrRemove(),!this.hasSelection)return;this.#y[0]+=e,this.#y[1]+=u;let[_,T]=this.#y,S=[...this.#h],p=1e3;this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.#x=null,this.#y[0]=this.#y[1]=0,this.addCommands({cmd:()=>{for(let y of S)this.#e.has(y.id)&&y.translateInPage(_,T)},undo:()=>{for(let y of S)this.#e.has(y.id)&&y.translateInPage(-_,-T)},mustExec:!1})},p);for(let y of S)y.translateInPage(e,u)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#c=new Map;for(let e of this.#h)this.#c.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#c)return!1;this.disableUserSelect(!1);let e=this.#c;this.#c=null;let u=!1;for(let[{x:_,y:T,pageIndex:S},p]of e)p.newX=_,p.newY=T,p.newPageIndex=S,u||=_!==p.savedX||T!==p.savedY||S!==p.savedPageIndex;if(!u)return!1;let f=(_,T,S,p)=>{if(this.#e.has(_.id)){let y=this.#i.get(p);y?_._setParentAndPosition(y,T,S):(_.pageIndex=p,_.x=T,_.y=S)}};return this.addCommands({cmd:()=>{for(let[_,{newX:T,newY:S,newPageIndex:p}]of e)f(_,T,S,p)},undo:()=>{for(let[_,{savedX:T,savedY:S,savedPageIndex:p}]of e)f(_,T,S,p)},mustExec:!0}),!0}dragSelectedEditors(e,u){if(this.#c)for(let f of this.#c.keys())f.drag(e,u)}rebuild(e){if(e.parent===null){let u=this.getLayer(e.pageIndex);u?(u.changeParent(e),u.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#g}get imageManager(){return(0,r.shadow)(this,"imageManager",new B)}}return l})();i.AnnotationEditorUIManager=s},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.StatTimer=i.RenderingCancelledException=i.PixelsPerInch=i.PageViewport=i.PDFDateString=i.DOMStandardFontDataFactory=i.DOMSVGFactory=i.DOMFilterFactory=i.DOMCanvasFactory=i.DOMCMapReaderFactory=void 0,i.deprecated=O,i.getColorValues=it,i.getCurrentTransform=tt,i.getCurrentTransformInverse=Q,i.getFilenameFromUrl=f,i.getPdfFilenameFromUrl=_,i.getRGB=X,i.getXfaPageViewport=z,i.isDataScheme=e,i.isPdfFile=u,i.isValidFetchUrl=S,i.loadScript=y,i.noContextMenu=p,i.setLayerDimensions=nt;var r=E(7),g=E(1);let P="http://www.w3.org/2000/svg";class x{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}i.PixelsPerInch=x;class U extends r.BaseFilterFactory{#t;#e;#i;#s;#o;#a;#r;#l;#c;#n;#f=0;constructor({docId:D,ownerDocument:b=globalThis.document}={}){super(),this.#i=D,this.#s=b}get#d(){return this.#t||=new Map}get#u(){if(!this.#e){let D=this.#s.createElement("div"),{style:b}=D;b.visibility="hidden",b.contain="strict",b.width=b.height=0,b.position="absolute",b.top=b.left=0,b.zIndex=-1;let c=this.#s.createElementNS(P,"svg");c.setAttribute("width",0),c.setAttribute("height",0),this.#e=this.#s.createElementNS(P,"defs"),D.append(c),c.append(this.#e),this.#s.body.append(D)}return this.#e}addFilter(D){if(!D)return"none";let b=this.#d.get(D);if(b)return b;let c,d,A,M;if(D.length===1){let a=D[0],m=new Array(256);for(let v=0;v<256;v++)m[v]=a[v]/255;M=c=d=A=m.join(",")}else{let[a,m,v]=D,C=new Array(256),k=new Array(256),N=new Array(256);for(let W=0;W<256;W++)C[W]=a[W]/255,k[W]=m[W]/255,N[W]=v[W]/255;c=C.join(","),d=k.join(","),A=N.join(","),M=`${c}${d}${A}`}if(b=this.#d.get(M),b)return this.#d.set(D,b),b;let R=`g_${this.#i}_transfer_map_${this.#f++}`,L=`url(#${R})`;this.#d.set(D,L),this.#d.set(M,L);let w=this.#_(R);return this.#g(c,d,A,w),L}addHCMFilter(D,b){let c=`${D}-${b}`;if(this.#a===c)return this.#r;if(this.#a=c,this.#r="none",this.#o?.remove(),!D||!b)return this.#r;let d=this.#h(D);D=g.Util.makeHexColor(...d);let A=this.#h(b);if(b=g.Util.makeHexColor(...A),this.#u.style.color="",D==="#000000"&&b==="#ffffff"||D===b)return this.#r;let M=new Array(256);for(let m=0;m<=255;m++){let v=m/255;M[m]=v<=.03928?v/12.92:((v+.055)/1.055)**2.4}let R=M.join(","),L=`g_${this.#i}_hcm_filter`,w=this.#l=this.#_(L);this.#g(R,R,R,w),this.#p(w);let a=(m,v)=>{let C=d[m]/255,k=A[m]/255,N=new Array(v+1);for(let W=0;W<=v;W++)N[W]=C+W/v*(k-C);return N.join(",")};return this.#g(a(0,5),a(1,5),a(2,5),w),this.#r=`url(#${L})`,this.#r}addHighlightHCMFilter(D,b,c,d){let A=`${D}-${b}-${c}-${d}`;if(this.#c===A)return this.#n;if(this.#c=A,this.#n="none",this.#l?.remove(),!D||!b)return this.#n;let[M,R]=[D,b].map(this.#h.bind(this)),L=Math.round(.2126*M[0]+.7152*M[1]+.0722*M[2]),w=Math.round(.2126*R[0]+.7152*R[1]+.0722*R[2]),[a,m]=[c,d].map(this.#h.bind(this));w<L&&([L,w,a,m]=[w,L,m,a]),this.#u.style.color="";let v=(N,W,V)=>{let st=new Array(256),q=(w-L)/V,$=N/255,Y=(W-N)/(255*V),K=0;for(let Z=0;Z<=V;Z++){let rt=Math.round(L+Z*q),ot=$+Z*Y;for(let lt=K;lt<=rt;lt++)st[lt]=ot;K=rt+1}for(let Z=K;Z<256;Z++)st[Z]=st[K-1];return st.join(",")},C=`g_${this.#i}_hcm_highlight_filter`,k=this.#l=this.#_(C);return this.#p(k),this.#g(v(a[0],m[0],5),v(a[1],m[1],5),v(a[2],m[2],5),k),this.#n=`url(#${C})`,this.#n}destroy(D=!1){D&&(this.#r||this.#n)||(this.#e&&(this.#e.parentNode.parentNode.remove(),this.#e=null),this.#t&&(this.#t.clear(),this.#t=null),this.#f=0)}#p(D){let b=this.#s.createElementNS(P,"feColorMatrix");b.setAttribute("type","matrix"),b.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),D.append(b)}#_(D){let b=this.#s.createElementNS(P,"filter");return b.setAttribute("color-interpolation-filters","sRGB"),b.setAttribute("id",D),this.#u.append(b),b}#m(D,b,c){let d=this.#s.createElementNS(P,b);d.setAttribute("type","discrete"),d.setAttribute("tableValues",c),D.append(d)}#g(D,b,c,d){let A=this.#s.createElementNS(P,"feComponentTransfer");d.append(A),this.#m(A,"feFuncR",D),this.#m(A,"feFuncG",b),this.#m(A,"feFuncB",c)}#h(D){return this.#u.style.color=D,X(getComputedStyle(this.#u).getPropertyValue("color"))}}i.DOMFilterFactory=U;class B extends r.BaseCanvasFactory{constructor({ownerDocument:D=globalThis.document}={}){super(),this._document=D}_createCanvas(D,b){let c=this._document.createElement("canvas");return c.width=D,c.height=b,c}}i.DOMCanvasFactory=B;function h(J,D=!1){return ht(this,null,function*(){if(S(J,document.baseURI)){let b=yield fetch(J);if(!b.ok)throw new Error(b.statusText);return D?new Uint8Array(yield b.arrayBuffer()):(0,g.stringToBytes)(yield b.text())}return new Promise((b,c)=>{let d=new XMLHttpRequest;d.open("GET",J,!0),D&&(d.responseType="arraybuffer"),d.onreadystatechange=()=>{if(d.readyState===XMLHttpRequest.DONE){if(d.status===200||d.status===0){let A;if(D&&d.response?A=new Uint8Array(d.response):!D&&d.responseText&&(A=(0,g.stringToBytes)(d.responseText)),A){b(A);return}}c(new Error(d.statusText))}},d.send(null)})})}class n extends r.BaseCMapReaderFactory{_fetchData(D,b){return h(D,this.isCompressed).then(c=>({cMapData:c,compressionType:b}))}}i.DOMCMapReaderFactory=n;class t extends r.BaseStandardFontDataFactory{_fetchData(D){return h(D,!0)}}i.DOMStandardFontDataFactory=t;class s extends r.BaseSVGFactory{_createSVG(D){return document.createElementNS(P,D)}}i.DOMSVGFactory=s;class l{constructor({viewBox:D,scale:b,rotation:c,offsetX:d=0,offsetY:A=0,dontFlip:M=!1}){this.viewBox=D,this.scale=b,this.rotation=c,this.offsetX=d,this.offsetY=A;let R=(D[2]+D[0])/2,L=(D[3]+D[1])/2,w,a,m,v;switch(c%=360,c<0&&(c+=360),c){case 180:w=-1,a=0,m=0,v=1;break;case 90:w=0,a=1,m=1,v=0;break;case 270:w=0,a=-1,m=-1,v=0;break;case 0:w=1,a=0,m=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}M&&(m=-m,v=-v);let C,k,N,W;w===0?(C=Math.abs(L-D[1])*b+d,k=Math.abs(R-D[0])*b+A,N=(D[3]-D[1])*b,W=(D[2]-D[0])*b):(C=Math.abs(R-D[0])*b+d,k=Math.abs(L-D[1])*b+A,N=(D[2]-D[0])*b,W=(D[3]-D[1])*b),this.transform=[w*b,a*b,m*b,v*b,C-w*b*R-m*b*L,k-a*b*R-v*b*L],this.width=N,this.height=W}get rawDims(){let{viewBox:D}=this;return(0,g.shadow)(this,"rawDims",{pageWidth:D[2]-D[0],pageHeight:D[3]-D[1],pageX:D[0],pageY:D[1]})}clone({scale:D=this.scale,rotation:b=this.rotation,offsetX:c=this.offsetX,offsetY:d=this.offsetY,dontFlip:A=!1}={}){return new l({viewBox:this.viewBox.slice(),scale:D,rotation:b,offsetX:c,offsetY:d,dontFlip:A})}convertToViewportPoint(D,b){return g.Util.applyTransform([D,b],this.transform)}convertToViewportRectangle(D){let b=g.Util.applyTransform([D[0],D[1]],this.transform),c=g.Util.applyTransform([D[2],D[3]],this.transform);return[b[0],b[1],c[0],c[1]]}convertToPdfPoint(D,b){return g.Util.applyInverseTransform([D,b],this.transform)}}i.PageViewport=l;class o extends g.BaseException{constructor(D,b=0){super(D,"RenderingCancelledException"),this.extraDelay=b}}i.RenderingCancelledException=o;function e(J){let D=J.length,b=0;for(;b<D&&J[b].trim()==="";)b++;return J.substring(b,b+5).toLowerCase()==="data:"}function u(J){return typeof J=="string"&&/\.pdf$/i.test(J)}function f(J,D=!1){return D||([J]=J.split(/[#?]/,1)),J.substring(J.lastIndexOf("/")+1)}function _(J,D="document.pdf"){if(typeof J!="string")return D;if(e(J))return(0,g.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),D;let b=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,c=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,d=b.exec(J),A=c.exec(d[1])||c.exec(d[2])||c.exec(d[3]);if(A&&(A=A[0],A.includes("%")))try{A=c.exec(decodeURIComponent(A))[0]}catch{}return A||D}class T{started=Object.create(null);times=[];time(D){D in this.started&&(0,g.warn)(`Timer is already running for ${D}`),this.started[D]=Date.now()}timeEnd(D){D in this.started||(0,g.warn)(`Timer has not been started for ${D}`),this.times.push({name:D,start:this.started[D],end:Date.now()}),delete this.started[D]}toString(){let D=[],b=0;for(let{name:c}of this.times)b=Math.max(c.length,b);for(let{name:c,start:d,end:A}of this.times)D.push(`${c.padEnd(b)} ${A-d}ms
`);return D.join("")}}i.StatTimer=T;function S(J,D){try{let{protocol:b}=D?new URL(J,D):new URL(J);return b==="http:"||b==="https:"}catch{return!1}}function p(J){J.preventDefault()}function y(J,D=!1){return new Promise((b,c)=>{let d=document.createElement("script");d.src=J,d.onload=function(A){D&&d.remove(),b(A)},d.onerror=function(){c(new Error(`Cannot load script at: ${d.src}`))},(document.head||document.documentElement).append(d)})}function O(J){console.log("Deprecated API usage: "+J)}let j;class I{static toDateObject(D){if(!D||typeof D!="string")return null;j||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");let b=j.exec(D);if(!b)return null;let c=parseInt(b[1],10),d=parseInt(b[2],10);d=d>=1&&d<=12?d-1:0;let A=parseInt(b[3],10);A=A>=1&&A<=31?A:1;let M=parseInt(b[4],10);M=M>=0&&M<=23?M:0;let R=parseInt(b[5],10);R=R>=0&&R<=59?R:0;let L=parseInt(b[6],10);L=L>=0&&L<=59?L:0;let w=b[7]||"Z",a=parseInt(b[8],10);a=a>=0&&a<=23?a:0;let m=parseInt(b[9],10)||0;return m=m>=0&&m<=59?m:0,w==="-"?(M+=a,R+=m):w==="+"&&(M-=a,R-=m),new Date(Date.UTC(c,d,A,M,R,L))}}i.PDFDateString=I;function z(J,{scale:D=1,rotation:b=0}){let{width:c,height:d}=J.attributes.style,A=[0,0,parseInt(c),parseInt(d)];return new l({viewBox:A,scale:D,rotation:b})}function X(J){if(J.startsWith("#")){let D=parseInt(J.slice(1),16);return[(D&16711680)>>16,(D&65280)>>8,D&255]}return J.startsWith("rgb(")?J.slice(4,-1).split(",").map(D=>parseInt(D)):J.startsWith("rgba(")?J.slice(5,-1).split(",").map(D=>parseInt(D)).slice(0,3):((0,g.warn)(`Not a valid color format: "${J}"`),[0,0,0])}function it(J){let D=document.createElement("span");D.style.visibility="hidden",document.body.append(D);for(let b of J.keys()){D.style.color=b;let c=window.getComputedStyle(D).color;J.set(b,X(c))}D.remove()}function tt(J){let{a:D,b,c,d,e:A,f:M}=J.getTransform();return[D,b,c,d,A,M]}function Q(J){let{a:D,b,c,d,e:A,f:M}=J.getTransform().invertSelf();return[D,b,c,d,A,M]}function nt(J,D,b=!1,c=!0){if(D instanceof l){let{pageWidth:d,pageHeight:A}=D.rawDims,{style:M}=J,R=g.FeatureTest.isCSSRoundSupported,L=`var(--scale-factor) * ${d}px`,w=`var(--scale-factor) * ${A}px`,a=R?`round(${L}, 1px)`:`calc(${L})`,m=R?`round(${w}, 1px)`:`calc(${w})`;!b||D.rotation%180===0?(M.width=a,M.height=m):(M.width=m,M.height=a)}c&&J.setAttribute("data-main-rotation",D.rotation)}},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BaseStandardFontDataFactory=i.BaseSVGFactory=i.BaseFilterFactory=i.BaseCanvasFactory=i.BaseCMapReaderFactory=void 0;var r=E(1);class g{constructor(){this.constructor===g&&(0,r.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(n){return"none"}addHCMFilter(n,t){return"none"}addHighlightHCMFilter(n,t,s,l){return"none"}destroy(n=!1){}}i.BaseFilterFactory=g;class P{constructor(){this.constructor===P&&(0,r.unreachable)("Cannot initialize BaseCanvasFactory.")}create(n,t){if(n<=0||t<=0)throw new Error("Invalid canvas size");let s=this._createCanvas(n,t);return{canvas:s,context:s.getContext("2d")}}reset(n,t,s){if(!n.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");n.canvas.width=t,n.canvas.height=s}destroy(n){if(!n.canvas)throw new Error("Canvas is not specified");n.canvas.width=0,n.canvas.height=0,n.canvas=null,n.context=null}_createCanvas(n,t){(0,r.unreachable)("Abstract method `_createCanvas` called.")}}i.BaseCanvasFactory=P;class x{constructor({baseUrl:n=null,isCompressed:t=!0}){this.constructor===x&&(0,r.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=n,this.isCompressed=t}fetch(t){return ht(this,arguments,function*({name:n}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!n)throw new Error("CMap name must be specified.");let s=this.baseUrl+n+(this.isCompressed?".bcmap":""),l=this.isCompressed?r.CMapCompressionType.BINARY:r.CMapCompressionType.NONE;return this._fetchData(s,l).catch(o=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${s}`)})})}_fetchData(n,t){(0,r.unreachable)("Abstract method `_fetchData` called.")}}i.BaseCMapReaderFactory=x;class U{constructor({baseUrl:n=null}){this.constructor===U&&(0,r.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=n}fetch(t){return ht(this,arguments,function*({filename:n}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!n)throw new Error("Font filename must be specified.");let s=`${this.baseUrl}${n}`;return this._fetchData(s).catch(l=>{throw new Error(`Unable to load font data at: ${s}`)})})}_fetchData(n){(0,r.unreachable)("Abstract method `_fetchData` called.")}}i.BaseStandardFontDataFactory=U;class B{constructor(){this.constructor===B&&(0,r.unreachable)("Cannot initialize BaseSVGFactory.")}create(n,t,s=!1){if(n<=0||t<=0)throw new Error("Invalid SVG dimensions");let l=this._createSVG("svg:svg");return l.setAttribute("version","1.1"),s||(l.setAttribute("width",`${n}px`),l.setAttribute("height",`${t}px`)),l.setAttribute("preserveAspectRatio","none"),l.setAttribute("viewBox",`0 0 ${n} ${t}`),l}createElement(n){if(typeof n!="string")throw new Error("Invalid SVG element type");return this._createSVG(n)}_createSVG(n){(0,r.unreachable)("Abstract method `_createSVG` called.")}}i.BaseSVGFactory=B},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.MurmurHash3_64=void 0;var r=E(1);let g=3285377520,P=4294901760,x=65535;class U{constructor(h){this.h1=h?h&4294967295:g,this.h2=h?h&4294967295:g}update(h){let n,t;if(typeof h=="string"){n=new Uint8Array(h.length*2),t=0;for(let O=0,j=h.length;O<j;O++){let I=h.charCodeAt(O);I<=255?n[t++]=I:(n[t++]=I>>>8,n[t++]=I&255)}}else if((0,r.isArrayBuffer)(h))n=h.slice(),t=n.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");let s=t>>2,l=t-s*4,o=new Uint32Array(n.buffer,0,s),e=0,u=0,f=this.h1,_=this.h2,T=3432918353,S=461845907,p=T&x,y=S&x;for(let O=0;O<s;O++)O&1?(e=o[O],e=e*T&P|e*p&x,e=e<<15|e>>>17,e=e*S&P|e*y&x,f^=e,f=f<<13|f>>>19,f=f*5+3864292196):(u=o[O],u=u*T&P|u*p&x,u=u<<15|u>>>17,u=u*S&P|u*y&x,_^=u,_=_<<13|_>>>19,_=_*5+3864292196);switch(e=0,l){case 3:e^=n[s*4+2]<<16;case 2:e^=n[s*4+1]<<8;case 1:e^=n[s*4],e=e*T&P|e*p&x,e=e<<15|e>>>17,e=e*S&P|e*y&x,s&1?f^=e:_^=e}this.h1=f,this.h2=_}hexdigest(){let h=this.h1,n=this.h2;return h^=n>>>1,h=h*3981806797&P|h*36045&x,n=n*4283543511&P|((n<<16|h>>>16)*2950163797&P)>>>16,h^=n>>>1,h=h*444984403&P|h*60499&x,n=n*3301882366&P|((n<<16|h>>>16)*3120437893&P)>>>16,h^=n>>>1,(h>>>0).toString(16).padStart(8,"0")+(n>>>0).toString(16).padStart(8,"0")}}i.MurmurHash3_64=U},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.FontLoader=i.FontFaceObject=void 0;var r=E(1);class g{#t=new Set;constructor({ownerDocument:U=globalThis.document,styleElement:B=null}){this._document=U,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(U){this.nativeFontFaces.add(U),this._document.fonts.add(U)}removeNativeFontFace(U){this.nativeFontFaces.delete(U),this._document.fonts.delete(U)}insertRule(U){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));let B=this.styleElement.sheet;B.insertRule(U,B.cssRules.length)}clear(){for(let U of this.nativeFontFaces)this._document.fonts.delete(U);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}loadSystemFont(U){return ht(this,null,function*(){if(!(!U||this.#t.has(U.loadedName))){if((0,r.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){let{loadedName:B,src:h,style:n}=U,t=new FontFace(B,h,n);this.addNativeFontFace(t);try{yield t.load(),this.#t.add(B)}catch{(0,r.warn)(`Cannot load system font: ${U.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(t)}return}(0,r.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}})}bind(U){return ht(this,null,function*(){if(U.attached||U.missingFile&&!U.systemFontInfo)return;if(U.attached=!0,U.systemFontInfo){yield this.loadSystemFont(U.systemFontInfo);return}if(this.isFontLoadingAPISupported){let h=U.createNativeFontFace();if(h){this.addNativeFontFace(h);try{yield h.loaded}catch(n){throw(0,r.warn)(`Failed to load font '${h.family}': '${n}'.`),U.disableFontFace=!0,n}}return}let B=U.createFontFaceRule();if(B){if(this.insertRule(B),this.isSyncFontLoadingSupported)return;yield new Promise(h=>{let n=this._queueLoadingCallback(h);this._prepareFontLoadEvent(U,n)})}})}get isFontLoadingAPISupported(){let U=!!this._document?.fonts;return(0,r.shadow)(this,"isFontLoadingAPISupported",U)}get isSyncFontLoadingSupported(){let U=!1;return(r.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(U=!0),(0,r.shadow)(this,"isSyncFontLoadingSupported",U)}_queueLoadingCallback(U){function B(){for((0,r.assert)(!n.done,"completeRequest() cannot be called twice."),n.done=!0;h.length>0&&h[0].done;){let t=h.shift();setTimeout(t.callback,0)}}let{loadingRequests:h}=this,n={done:!1,complete:B,callback:U};return h.push(n),n}get _loadTestFont(){let U=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,r.shadow)(this,"_loadTestFont",U)}_prepareFontLoadEvent(U,B){function h(z,X){return z.charCodeAt(X)<<24|z.charCodeAt(X+1)<<16|z.charCodeAt(X+2)<<8|z.charCodeAt(X+3)&255}function n(z,X,it,tt){let Q=z.substring(0,X),nt=z.substring(X+it);return Q+tt+nt}let t,s,l=this._document.createElement("canvas");l.width=1,l.height=1;let o=l.getContext("2d"),e=0;function u(z,X){if(++e>30){(0,r.warn)("Load test font never loaded."),X();return}if(o.font="30px "+z,o.fillText(".",0,20),o.getImageData(0,0,1,1).data[3]>0){X();return}setTimeout(u.bind(null,z,X))}let f=`lt${Date.now()}${this.loadTestFontId++}`,_=this._loadTestFont;_=n(_,976,f.length,f);let S=16,p=1482184792,y=h(_,S);for(t=0,s=f.length-3;t<s;t+=4)y=y-p+h(f,t)|0;t<f.length&&(y=y-p+h(f+"XXX",t)|0),_=n(_,S,4,(0,r.string32)(y));let O=`url(data:font/opentype;base64,${btoa(_)});`,j=`@font-face {font-family:"${f}";src:${O}}`;this.insertRule(j);let I=this._document.createElement("div");I.style.visibility="hidden",I.style.width=I.style.height="10px",I.style.position="absolute",I.style.top=I.style.left="0px";for(let z of[U.loadedName,f]){let X=this._document.createElement("span");X.textContent="Hi",X.style.fontFamily=z,I.append(X)}this._document.body.append(I),u(f,()=>{I.remove(),B.complete()})}}i.FontLoader=g;class P{constructor(U,{isEvalSupported:B=!0,disableFontFace:h=!1,ignoreErrors:n=!1,inspectFont:t=null}){this.compiledGlyphs=Object.create(null);for(let s in U)this[s]=U[s];this.isEvalSupported=B!==!1,this.disableFontFace=h===!0,this.ignoreErrors=n===!0,this._inspectFont=t}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let U;if(!this.cssFontInfo)U=new FontFace(this.loadedName,this.data,{});else{let B={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(B.style=`oblique ${this.cssFontInfo.italicAngle}deg`),U=new FontFace(this.cssFontInfo.fontFamily,this.data,B)}return this._inspectFont?.(this),U}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;let U=(0,r.bytesToString)(this.data),B=`url(data:${this.mimetype};base64,${btoa(U)});`,h;if(!this.cssFontInfo)h=`@font-face {font-family:"${this.loadedName}";src:${B}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),h=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${B}}`}return this._inspectFont?.(this,B),h}getPathGenerator(U,B){if(this.compiledGlyphs[B]!==void 0)return this.compiledGlyphs[B];let h;try{h=U.get(this.loadedName+"_path_"+B)}catch(n){if(!this.ignoreErrors)throw n;return(0,r.warn)(`getPathGenerator - ignoring character: "${n}".`),this.compiledGlyphs[B]=function(t,s){}}if(this.isEvalSupported&&r.FeatureTest.isEvalSupported){let n=[];for(let t of h){let s=t.args!==void 0?t.args.join(","):"";n.push("c.",t.cmd,"(",s,`);
`)}return this.compiledGlyphs[B]=new Function("c","size",n.join(""))}return this.compiledGlyphs[B]=function(n,t){for(let s of h)s.cmd==="scale"&&(s.args=[t,-t]),n[s.cmd].apply(n,s.args)}}}i.FontFaceObject=P},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NodeStandardFontDataFactory=i.NodeFilterFactory=i.NodeCanvasFactory=i.NodeCMapReaderFactory=void 0;var r=E(7),g=E(1);let P=function(n){return new Promise((t,s)=>{ie().readFile(n,(o,e)=>{if(o||!e){s(new Error(o));return}t(new Uint8Array(e))})})};class x extends r.BaseFilterFactory{}i.NodeFilterFactory=x;class U extends r.BaseCanvasFactory{_createCanvas(t,s){return gi().createCanvas(t,s)}}i.NodeCanvasFactory=U;class B extends r.BaseCMapReaderFactory{_fetchData(t,s){return P(t).then(l=>({cMapData:l,compressionType:s}))}}i.NodeCMapReaderFactory=B;class h extends r.BaseStandardFontDataFactory{_fetchData(t){return P(t)}}i.NodeStandardFontDataFactory=h},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CanvasGraphics=void 0;var r=E(1),g=E(6),P=E(12),x=E(13);let U=16,B=100,h=4096,n=15,t=10,s=1e3,l=16;function o(b,c){if(b._removeMirroring)throw new Error("Context is already forwarding operations.");b.__originalSave=b.save,b.__originalRestore=b.restore,b.__originalRotate=b.rotate,b.__originalScale=b.scale,b.__originalTranslate=b.translate,b.__originalTransform=b.transform,b.__originalSetTransform=b.setTransform,b.__originalResetTransform=b.resetTransform,b.__originalClip=b.clip,b.__originalMoveTo=b.moveTo,b.__originalLineTo=b.lineTo,b.__originalBezierCurveTo=b.bezierCurveTo,b.__originalRect=b.rect,b.__originalClosePath=b.closePath,b.__originalBeginPath=b.beginPath,b._removeMirroring=()=>{b.save=b.__originalSave,b.restore=b.__originalRestore,b.rotate=b.__originalRotate,b.scale=b.__originalScale,b.translate=b.__originalTranslate,b.transform=b.__originalTransform,b.setTransform=b.__originalSetTransform,b.resetTransform=b.__originalResetTransform,b.clip=b.__originalClip,b.moveTo=b.__originalMoveTo,b.lineTo=b.__originalLineTo,b.bezierCurveTo=b.__originalBezierCurveTo,b.rect=b.__originalRect,b.closePath=b.__originalClosePath,b.beginPath=b.__originalBeginPath,delete b._removeMirroring},b.save=function(){c.save(),this.__originalSave()},b.restore=function(){c.restore(),this.__originalRestore()},b.translate=function(A,M){c.translate(A,M),this.__originalTranslate(A,M)},b.scale=function(A,M){c.scale(A,M),this.__originalScale(A,M)},b.transform=function(A,M,R,L,w,a){c.transform(A,M,R,L,w,a),this.__originalTransform(A,M,R,L,w,a)},b.setTransform=function(A,M,R,L,w,a){c.setTransform(A,M,R,L,w,a),this.__originalSetTransform(A,M,R,L,w,a)},b.resetTransform=function(){c.resetTransform(),this.__originalResetTransform()},b.rotate=function(A){c.rotate(A),this.__originalRotate(A)},b.clip=function(A){c.clip(A),this.__originalClip(A)},b.moveTo=function(d,A){c.moveTo(d,A),this.__originalMoveTo(d,A)},b.lineTo=function(d,A){c.lineTo(d,A),this.__originalLineTo(d,A)},b.bezierCurveTo=function(d,A,M,R,L,w){c.bezierCurveTo(d,A,M,R,L,w),this.__originalBezierCurveTo(d,A,M,R,L,w)},b.rect=function(d,A,M,R){c.rect(d,A,M,R),this.__originalRect(d,A,M,R)},b.closePath=function(){c.closePath(),this.__originalClosePath()},b.beginPath=function(){c.beginPath(),this.__originalBeginPath()}}class e{constructor(c){this.canvasFactory=c,this.cache=Object.create(null)}getCanvas(c,d,A){let M;return this.cache[c]!==void 0?(M=this.cache[c],this.canvasFactory.reset(M,d,A)):(M=this.canvasFactory.create(d,A),this.cache[c]=M),M}delete(c){delete this.cache[c]}clear(){for(let c in this.cache){let d=this.cache[c];this.canvasFactory.destroy(d),delete this.cache[c]}}}function u(b,c,d,A,M,R,L,w,a,m){let[v,C,k,N,W,V]=(0,g.getCurrentTransform)(b);if(C===0&&k===0){let $=L*v+W,Y=Math.round($),K=w*N+V,Z=Math.round(K),rt=(L+a)*v+W,ot=Math.abs(Math.round(rt)-Y)||1,lt=(w+m)*N+V,ct=Math.abs(Math.round(lt)-Z)||1;return b.setTransform(Math.sign(v),0,0,Math.sign(N),Y,Z),b.drawImage(c,d,A,M,R,0,0,ot,ct),b.setTransform(v,C,k,N,W,V),[ot,ct]}if(v===0&&N===0){let $=w*k+W,Y=Math.round($),K=L*C+V,Z=Math.round(K),rt=(w+m)*k+W,ot=Math.abs(Math.round(rt)-Y)||1,lt=(L+a)*C+V,ct=Math.abs(Math.round(lt)-Z)||1;return b.setTransform(0,Math.sign(C),Math.sign(k),0,Y,Z),b.drawImage(c,d,A,M,R,0,0,ct,ot),b.setTransform(v,C,k,N,W,V),[ct,ot]}b.drawImage(c,d,A,M,R,L,w,a,m);let st=Math.hypot(v,C),q=Math.hypot(k,N);return[st*a,q*m]}function f(b){let{width:c,height:d}=b;if(c>s||d>s)return null;let A=1e3,M=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),R=c+1,L=new Uint8Array(R*(d+1)),w,a,m,v=c+7&-8,C=new Uint8Array(v*d),k=0;for(let q of b.data){let $=128;for(;$>0;)C[k++]=q&$?0:255,$>>=1}let N=0;for(k=0,C[k]!==0&&(L[0]=1,++N),a=1;a<c;a++)C[k]!==C[k+1]&&(L[a]=C[k]?2:1,++N),k++;for(C[k]!==0&&(L[a]=2,++N),w=1;w<d;w++){k=w*v,m=w*R,C[k-v]!==C[k]&&(L[m]=C[k]?1:8,++N);let q=(C[k]?4:0)+(C[k-v]?8:0);for(a=1;a<c;a++)q=(q>>2)+(C[k+1]?4:0)+(C[k-v+1]?8:0),M[q]&&(L[m+a]=M[q],++N),k++;if(C[k-v]!==C[k]&&(L[m+a]=C[k]?2:4,++N),N>A)return null}for(k=v*(d-1),m=w*R,C[k]!==0&&(L[m]=8,++N),a=1;a<c;a++)C[k]!==C[k+1]&&(L[m+a]=C[k]?4:8,++N),k++;if(C[k]!==0&&(L[m+a]=4,++N),N>A)return null;let W=new Int32Array([0,R,-1,0,-R,0,0,0,1]),V=new Path2D;for(w=0;N&&w<=d;w++){let q=w*R,$=q+c;for(;q<$&&!L[q];)q++;if(q===$)continue;V.moveTo(q%R,w);let Y=q,K=L[q];do{let Z=W[K];do q+=Z;while(!L[q]);let rt=L[q];rt!==5&&rt!==10?(K=rt,L[q]=0):(K=rt&51*K>>4,L[q]&=K>>2|K<<2),V.lineTo(q%R,q/R|0),L[q]||--N}while(Y!==q);--w}return C=null,L=null,function(q){q.save(),q.scale(1/c,-1/d),q.translate(0,-d),q.fill(V),q.beginPath(),q.restore()}}class _{constructor(c,d){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=r.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=r.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,c,d])}clone(){let c=Object.create(this);return c.clipBox=this.clipBox.slice(),c}setCurrentPoint(c,d){this.x=c,this.y=d}updatePathMinMax(c,d,A){[d,A]=r.Util.applyTransform([d,A],c),this.minX=Math.min(this.minX,d),this.minY=Math.min(this.minY,A),this.maxX=Math.max(this.maxX,d),this.maxY=Math.max(this.maxY,A)}updateRectMinMax(c,d){let A=r.Util.applyTransform(d,c),M=r.Util.applyTransform(d.slice(2),c);this.minX=Math.min(this.minX,A[0],M[0]),this.minY=Math.min(this.minY,A[1],M[1]),this.maxX=Math.max(this.maxX,A[0],M[0]),this.maxY=Math.max(this.maxY,A[1],M[1])}updateScalingPathMinMax(c,d){r.Util.scaleMinMax(c,d),this.minX=Math.min(this.minX,d[0]),this.maxX=Math.max(this.maxX,d[1]),this.minY=Math.min(this.minY,d[2]),this.maxY=Math.max(this.maxY,d[3])}updateCurvePathMinMax(c,d,A,M,R,L,w,a,m,v){let C=r.Util.bezierBoundingBox(d,A,M,R,L,w,a,m);if(v){v[0]=Math.min(v[0],C[0],C[2]),v[1]=Math.max(v[1],C[0],C[2]),v[2]=Math.min(v[2],C[1],C[3]),v[3]=Math.max(v[3],C[1],C[3]);return}this.updateRectMinMax(c,C)}getPathBoundingBox(c=P.PathType.FILL,d=null){let A=[this.minX,this.minY,this.maxX,this.maxY];if(c===P.PathType.STROKE){d||(0,r.unreachable)("Stroke bounding box must include transform.");let M=r.Util.singularValueDecompose2dScale(d),R=M[0]*this.lineWidth/2,L=M[1]*this.lineWidth/2;A[0]-=R,A[1]-=L,A[2]+=R,A[3]+=L}return A}updateClipFromPath(){let c=r.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(c||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(c){this.clipBox=c,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(c=P.PathType.FILL,d=null){return r.Util.intersect(this.clipBox,this.getPathBoundingBox(c,d))}}function T(b,c){if(typeof ImageData<"u"&&c instanceof ImageData){b.putImageData(c,0,0);return}let d=c.height,A=c.width,M=d%l,R=(d-M)/l,L=M===0?R:R+1,w=b.createImageData(A,l),a=0,m,v=c.data,C=w.data,k,N,W,V;if(c.kind===r.ImageKind.GRAYSCALE_1BPP){let st=v.byteLength,q=new Uint32Array(C.buffer,0,C.byteLength>>2),$=q.length,Y=A+7>>3,K=4294967295,Z=r.FeatureTest.isLittleEndian?4278190080:255;for(k=0;k<L;k++){for(W=k<R?l:M,m=0,N=0;N<W;N++){let rt=st-a,ot=0,lt=rt>Y?A:rt*8-7,ct=lt&-8,dt=0,ft=0;for(;ot<ct;ot+=8)ft=v[a++],q[m++]=ft&128?K:Z,q[m++]=ft&64?K:Z,q[m++]=ft&32?K:Z,q[m++]=ft&16?K:Z,q[m++]=ft&8?K:Z,q[m++]=ft&4?K:Z,q[m++]=ft&2?K:Z,q[m++]=ft&1?K:Z;for(;ot<lt;ot++)dt===0&&(ft=v[a++],dt=128),q[m++]=ft&dt?K:Z,dt>>=1}for(;m<$;)q[m++]=0;b.putImageData(w,0,k*l)}}else if(c.kind===r.ImageKind.RGBA_32BPP){for(N=0,V=A*l*4,k=0;k<R;k++)C.set(v.subarray(a,a+V)),a+=V,b.putImageData(w,0,N),N+=l;k<L&&(V=A*M*4,C.set(v.subarray(a,a+V)),b.putImageData(w,0,N))}else if(c.kind===r.ImageKind.RGB_24BPP)for(W=l,V=A*W,k=0;k<L;k++){for(k>=R&&(W=M,V=A*W),m=0,N=V;N--;)C[m++]=v[a++],C[m++]=v[a++],C[m++]=v[a++],C[m++]=255;b.putImageData(w,0,k*l)}else throw new Error(`bad image kind: ${c.kind}`)}function S(b,c){if(c.bitmap){b.drawImage(c.bitmap,0,0);return}let d=c.height,A=c.width,M=d%l,R=(d-M)/l,L=M===0?R:R+1,w=b.createImageData(A,l),a=0,m=c.data,v=w.data;for(let C=0;C<L;C++){let k=C<R?l:M;({srcPos:a}=(0,x.convertBlackAndWhiteToRGBA)({src:m,srcPos:a,dest:v,width:A,height:k,nonBlackColor:0})),b.putImageData(w,0,C*l)}}function p(b,c){let d=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(let A of d)b[A]!==void 0&&(c[A]=b[A]);b.setLineDash!==void 0&&(c.setLineDash(b.getLineDash()),c.lineDashOffset=b.lineDashOffset)}function y(b){if(b.strokeStyle=b.fillStyle="#000000",b.fillRule="nonzero",b.globalAlpha=1,b.lineWidth=1,b.lineCap="butt",b.lineJoin="miter",b.miterLimit=10,b.globalCompositeOperation="source-over",b.font="10px sans-serif",b.setLineDash!==void 0&&(b.setLineDash([]),b.lineDashOffset=0),!r.isNodeJS){let{filter:c}=b;c!=="none"&&c!==""&&(b.filter="none")}}function O(b,c,d,A){let M=b.length;for(let R=3;R<M;R+=4){let L=b[R];if(L===0)b[R-3]=c,b[R-2]=d,b[R-1]=A;else if(L<255){let w=255-L;b[R-3]=b[R-3]*L+c*w>>8,b[R-2]=b[R-2]*L+d*w>>8,b[R-1]=b[R-1]*L+A*w>>8}}}function j(b,c,d){let A=b.length,M=1/255;for(let R=3;R<A;R+=4){let L=d?d[b[R]]:b[R];c[R]=c[R]*L*M|0}}function I(b,c,d){let A=b.length;for(let M=3;M<A;M+=4){let R=b[M-3]*77+b[M-2]*152+b[M-1]*28;c[M]=d?c[M]*d[R>>8]>>8:c[M]*R>>16}}function z(b,c,d,A,M,R,L,w,a,m,v){let C=!!R,k=C?R[0]:0,N=C?R[1]:0,W=C?R[2]:0,V=M==="Luminosity"?I:j,q=Math.min(A,Math.ceil(1048576/d));for(let $=0;$<A;$+=q){let Y=Math.min(q,A-$),K=b.getImageData(w-m,$+(a-v),d,Y),Z=c.getImageData(w,$+a,d,Y);C&&O(K.data,k,N,W),V(K.data,Z.data,L),c.putImageData(Z,w,$+a)}}function X(b,c,d,A){let M=A[0],R=A[1],L=A[2]-M,w=A[3]-R;L===0||w===0||(z(c.context,d,L,w,c.subtype,c.backdrop,c.transferMap,M,R,c.offsetX,c.offsetY),b.save(),b.globalAlpha=1,b.globalCompositeOperation="source-over",b.setTransform(1,0,0,1,0,0),b.drawImage(d.canvas,0,0),b.restore())}function it(b,c){let d=r.Util.singularValueDecompose2dScale(b);d[0]=Math.fround(d[0]),d[1]=Math.fround(d[1]);let A=Math.fround((globalThis.devicePixelRatio||1)*g.PixelsPerInch.PDF_TO_CSS_UNITS);return c!==void 0?c:d[0]<=A||d[1]<=A}let tt=["butt","round","square"],Q=["miter","round","bevel"],nt={},J={};class D{constructor(c,d,A,M,R,{optionalContentConfig:L,markedContentStack:w=null},a,m){this.ctx=c,this.current=new _(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=d,this.objs=A,this.canvasFactory=M,this.filterFactory=R,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=w||[],this.optionalContentConfig=L,this.cachedCanvases=new e(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=a,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=m,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(c,d=null){return typeof c=="string"?c.startsWith("g_")?this.commonObjs.get(c):this.objs.get(c):d}beginDrawing({transform:c,viewport:d,transparency:A=!1,background:M=null}){let R=this.ctx.canvas.width,L=this.ctx.canvas.height,w=this.ctx.fillStyle;if(this.ctx.fillStyle=M||"#ffffff",this.ctx.fillRect(0,0,R,L),this.ctx.fillStyle=w,A){let a=this.cachedCanvases.getCanvas("transparent",R,L);this.compositeCtx=this.ctx,this.transparentCanvas=a.canvas,this.ctx=a.context,this.ctx.save(),this.ctx.transform(...(0,g.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),y(this.ctx),c&&(this.ctx.transform(...c),this.outputScaleX=c[0],this.outputScaleY=c[0]),this.ctx.transform(...d.transform),this.viewportScale=d.scale,this.baseTransform=(0,g.getCurrentTransform)(this.ctx)}executeOperatorList(c,d,A,M){let R=c.argsArray,L=c.fnArray,w=d||0,a=R.length;if(a===w)return w;let m=a-w>t&&typeof A=="function",v=m?Date.now()+n:0,C=0,k=this.commonObjs,N=this.objs,W;for(;;){if(M!==void 0&&w===M.nextBreakPoint)return M.breakIt(w,A),w;if(W=L[w],W!==r.OPS.dependency)this[W].apply(this,R[w]);else for(let V of R[w]){let st=V.startsWith("g_")?k:N;if(!st.has(V))return st.get(V,A),w}if(w++,w===a)return w;if(m&&++C>t){if(Date.now()>v)return A(),w;C=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(let c of this._cachedBitmapsMap.values()){for(let d of c.values())typeof HTMLCanvasElement<"u"&&d instanceof HTMLCanvasElement&&(d.width=d.height=0);c.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){let c=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(c!=="none"){let d=this.ctx.filter;this.ctx.filter=c,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=d}}}_scaleImage(c,d){let A=c.width,M=c.height,R=Math.max(Math.hypot(d[0],d[1]),1),L=Math.max(Math.hypot(d[2],d[3]),1),w=A,a=M,m="prescale1",v,C;for(;R>2&&w>1||L>2&&a>1;){let k=w,N=a;R>2&&w>1&&(k=w>=16384?Math.floor(w/2)-1||1:Math.ceil(w/2),R/=w/k),L>2&&a>1&&(N=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a)/2,L/=a/N),v=this.cachedCanvases.getCanvas(m,k,N),C=v.context,C.clearRect(0,0,k,N),C.drawImage(c,0,0,w,a,0,0,k,N),c=v.canvas,w=k,a=N,m=m==="prescale1"?"prescale2":"prescale1"}return{img:c,paintWidth:w,paintHeight:a}}_createMaskCanvas(c){let d=this.ctx,{width:A,height:M}=c,R=this.current.fillColor,L=this.current.patternFill,w=(0,g.getCurrentTransform)(d),a,m,v,C;if((c.bitmap||c.data)&&c.count>1){let ot=c.bitmap||c.data.buffer;m=JSON.stringify(L?w:[w.slice(0,4),R]),a=this._cachedBitmapsMap.get(ot),a||(a=new Map,this._cachedBitmapsMap.set(ot,a));let lt=a.get(m);if(lt&&!L){let ct=Math.round(Math.min(w[0],w[2])+w[4]),dt=Math.round(Math.min(w[1],w[3])+w[5]);return{canvas:lt,offsetX:ct,offsetY:dt}}v=lt}v||(C=this.cachedCanvases.getCanvas("maskCanvas",A,M),S(C.context,c));let k=r.Util.transform(w,[1/A,0,0,-1/M,0,0]);k=r.Util.transform(k,[1,0,0,1,0,-M]);let N=r.Util.applyTransform([0,0],k),W=r.Util.applyTransform([A,M],k),V=r.Util.normalizeRect([N[0],N[1],W[0],W[1]]),st=Math.round(V[2]-V[0])||1,q=Math.round(V[3]-V[1])||1,$=this.cachedCanvases.getCanvas("fillCanvas",st,q),Y=$.context,K=Math.min(N[0],W[0]),Z=Math.min(N[1],W[1]);Y.translate(-K,-Z),Y.transform(...k),v||(v=this._scaleImage(C.canvas,(0,g.getCurrentTransformInverse)(Y)),v=v.img,a&&L&&a.set(m,v)),Y.imageSmoothingEnabled=it((0,g.getCurrentTransform)(Y),c.interpolate),u(Y,v,0,0,v.width,v.height,0,0,A,M),Y.globalCompositeOperation="source-in";let rt=r.Util.transform((0,g.getCurrentTransformInverse)(Y),[1,0,0,1,-K,-Z]);return Y.fillStyle=L?R.getPattern(d,this,rt,P.PathType.FILL):R,Y.fillRect(0,0,A,M),a&&!L&&(this.cachedCanvases.delete("fillCanvas"),a.set(m,$.canvas)),{canvas:$.canvas,offsetX:Math.round(K),offsetY:Math.round(Z)}}setLineWidth(c){c!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=c,this.ctx.lineWidth=c}setLineCap(c){this.ctx.lineCap=tt[c]}setLineJoin(c){this.ctx.lineJoin=Q[c]}setMiterLimit(c){this.ctx.miterLimit=c}setDash(c,d){let A=this.ctx;A.setLineDash!==void 0&&(A.setLineDash(c),A.lineDashOffset=d)}setRenderingIntent(c){}setFlatness(c){}setGState(c){for(let[d,A]of c)switch(d){case"LW":this.setLineWidth(A);break;case"LC":this.setLineCap(A);break;case"LJ":this.setLineJoin(A);break;case"ML":this.setMiterLimit(A);break;case"D":this.setDash(A[0],A[1]);break;case"RI":this.setRenderingIntent(A);break;case"FL":this.setFlatness(A);break;case"Font":this.setFont(A[0],A[1]);break;case"CA":this.current.strokeAlpha=A;break;case"ca":this.current.fillAlpha=A,this.ctx.globalAlpha=A;break;case"BM":this.ctx.globalCompositeOperation=A;break;case"SMask":this.current.activeSMask=A?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(A);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){let c=this.inSMaskMode;this.current.activeSMask&&!c?this.beginSMaskMode():!this.current.activeSMask&&c&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");let c=this.ctx.canvas.width,d=this.ctx.canvas.height,A="smaskGroupAt"+this.groupLevel,M=this.cachedCanvases.getCanvas(A,c,d);this.suspendedCtx=this.ctx,this.ctx=M.context;let R=this.ctx;R.setTransform(...(0,g.getCurrentTransform)(this.suspendedCtx)),p(this.suspendedCtx,R),o(R,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),p(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(c){if(!this.current.activeSMask)return;c?(c[0]=Math.floor(c[0]),c[1]=Math.floor(c[1]),c[2]=Math.ceil(c[2]),c[3]=Math.ceil(c[3])):c=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];let d=this.current.activeSMask,A=this.suspendedCtx;X(A,d,this.ctx,c),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(p(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();let c=this.current;this.stateStack.push(c),this.current=c.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),p(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(c,d,A,M,R,L){this.ctx.transform(c,d,A,M,R,L),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(c,d,A){let M=this.ctx,R=this.current,L=R.x,w=R.y,a,m,v=(0,g.getCurrentTransform)(M),C=v[0]===0&&v[3]===0||v[1]===0&&v[2]===0,k=C?A.slice(0):null;for(let N=0,W=0,V=c.length;N<V;N++)switch(c[N]|0){case r.OPS.rectangle:L=d[W++],w=d[W++];let st=d[W++],q=d[W++],$=L+st,Y=w+q;M.moveTo(L,w),st===0||q===0?M.lineTo($,Y):(M.lineTo($,w),M.lineTo($,Y),M.lineTo(L,Y)),C||R.updateRectMinMax(v,[L,w,$,Y]),M.closePath();break;case r.OPS.moveTo:L=d[W++],w=d[W++],M.moveTo(L,w),C||R.updatePathMinMax(v,L,w);break;case r.OPS.lineTo:L=d[W++],w=d[W++],M.lineTo(L,w),C||R.updatePathMinMax(v,L,w);break;case r.OPS.curveTo:a=L,m=w,L=d[W+4],w=d[W+5],M.bezierCurveTo(d[W],d[W+1],d[W+2],d[W+3],L,w),R.updateCurvePathMinMax(v,a,m,d[W],d[W+1],d[W+2],d[W+3],L,w,k),W+=6;break;case r.OPS.curveTo2:a=L,m=w,M.bezierCurveTo(L,w,d[W],d[W+1],d[W+2],d[W+3]),R.updateCurvePathMinMax(v,a,m,L,w,d[W],d[W+1],d[W+2],d[W+3],k),L=d[W+2],w=d[W+3],W+=4;break;case r.OPS.curveTo3:a=L,m=w,L=d[W+2],w=d[W+3],M.bezierCurveTo(d[W],d[W+1],L,w,L,w),R.updateCurvePathMinMax(v,a,m,d[W],d[W+1],L,w,L,w,k),W+=4;break;case r.OPS.closePath:M.closePath();break}C&&R.updateScalingPathMinMax(v,k),R.setCurrentPoint(L,w)}closePath(){this.ctx.closePath()}stroke(c=!0){let d=this.ctx,A=this.current.strokeColor;d.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof A=="object"&&A?.getPattern?(d.save(),d.strokeStyle=A.getPattern(d,this,(0,g.getCurrentTransformInverse)(d),P.PathType.STROKE),this.rescaleAndStroke(!1),d.restore()):this.rescaleAndStroke(!0)),c&&this.consumePath(this.current.getClippedPathBoundingBox()),d.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(c=!0){let d=this.ctx,A=this.current.fillColor,M=this.current.patternFill,R=!1;M&&(d.save(),d.fillStyle=A.getPattern(d,this,(0,g.getCurrentTransformInverse)(d),P.PathType.FILL),R=!0);let L=this.current.getClippedPathBoundingBox();this.contentVisible&&L!==null&&(this.pendingEOFill?(d.fill("evenodd"),this.pendingEOFill=!1):d.fill()),R&&d.restore(),c&&this.consumePath(L)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=nt}eoClip(){this.pendingClip=J}beginText(){this.current.textMatrix=r.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){let c=this.pendingTextPaths,d=this.ctx;if(c===void 0){d.beginPath();return}d.save(),d.beginPath();for(let A of c)d.setTransform(...A.transform),d.translate(A.x,A.y),A.addToPath(d,A.fontSize);d.restore(),d.clip(),d.beginPath(),delete this.pendingTextPaths}setCharSpacing(c){this.current.charSpacing=c}setWordSpacing(c){this.current.wordSpacing=c}setHScale(c){this.current.textHScale=c/100}setLeading(c){this.current.leading=-c}setFont(c,d){let A=this.commonObjs.get(c),M=this.current;if(!A)throw new Error(`Can't find font for ${c}`);if(M.fontMatrix=A.fontMatrix||r.FONT_IDENTITY_MATRIX,(M.fontMatrix[0]===0||M.fontMatrix[3]===0)&&(0,r.warn)("Invalid font matrix for font "+c),d<0?(d=-d,M.fontDirection=-1):M.fontDirection=1,this.current.font=A,this.current.fontSize=d,A.isType3Font)return;let R=A.loadedName||"sans-serif",L=A.systemFontInfo?.css||`"${R}", ${A.fallbackName}`,w="normal";A.black?w="900":A.bold&&(w="bold");let a=A.italic?"italic":"normal",m=d;d<U?m=U:d>B&&(m=B),this.current.fontSizeScale=d/m,this.ctx.font=`${a} ${w} ${m}px ${L}`}setTextRenderingMode(c){this.current.textRenderingMode=c}setTextRise(c){this.current.textRise=c}moveText(c,d){this.current.x=this.current.lineX+=c,this.current.y=this.current.lineY+=d}setLeadingMoveText(c,d){this.setLeading(-d),this.moveText(c,d)}setTextMatrix(c,d,A,M,R,L){this.current.textMatrix=[c,d,A,M,R,L],this.current.textMatrixScale=Math.hypot(c,d),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(c,d,A,M){let R=this.ctx,L=this.current,w=L.font,a=L.textRenderingMode,m=L.fontSize/L.fontSizeScale,v=a&r.TextRenderingMode.FILL_STROKE_MASK,C=!!(a&r.TextRenderingMode.ADD_TO_PATH_FLAG),k=L.patternFill&&!w.missingFile,N;(w.disableFontFace||C||k)&&(N=w.getPathGenerator(this.commonObjs,c)),w.disableFontFace||k?(R.save(),R.translate(d,A),R.beginPath(),N(R,m),M&&R.setTransform(...M),(v===r.TextRenderingMode.FILL||v===r.TextRenderingMode.FILL_STROKE)&&R.fill(),(v===r.TextRenderingMode.STROKE||v===r.TextRenderingMode.FILL_STROKE)&&R.stroke(),R.restore()):((v===r.TextRenderingMode.FILL||v===r.TextRenderingMode.FILL_STROKE)&&R.fillText(c,d,A),(v===r.TextRenderingMode.STROKE||v===r.TextRenderingMode.FILL_STROKE)&&R.strokeText(c,d,A)),C&&(this.pendingTextPaths||=[]).push({transform:(0,g.getCurrentTransform)(R),x:d,y:A,fontSize:m,addToPath:N})}get isFontSubpixelAAEnabled(){let{context:c}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);c.scale(1.5,1),c.fillText("I",0,10);let d=c.getImageData(0,0,10,10).data,A=!1;for(let M=3;M<d.length;M+=4)if(d[M]>0&&d[M]<255){A=!0;break}return(0,r.shadow)(this,"isFontSubpixelAAEnabled",A)}showText(c){let d=this.current,A=d.font;if(A.isType3Font)return this.showType3Text(c);let M=d.fontSize;if(M===0)return;let R=this.ctx,L=d.fontSizeScale,w=d.charSpacing,a=d.wordSpacing,m=d.fontDirection,v=d.textHScale*m,C=c.length,k=A.vertical,N=k?1:-1,W=A.defaultVMetrics,V=M*d.fontMatrix[0],st=d.textRenderingMode===r.TextRenderingMode.FILL&&!A.disableFontFace&&!d.patternFill;R.save(),R.transform(...d.textMatrix),R.translate(d.x,d.y+d.textRise),m>0?R.scale(v,-1):R.scale(v,1);let q;if(d.patternFill){R.save();let rt=d.fillColor.getPattern(R,this,(0,g.getCurrentTransformInverse)(R),P.PathType.FILL);q=(0,g.getCurrentTransform)(R),R.restore(),R.fillStyle=rt}let $=d.lineWidth,Y=d.textMatrixScale;if(Y===0||$===0){let rt=d.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;(rt===r.TextRenderingMode.STROKE||rt===r.TextRenderingMode.FILL_STROKE)&&($=this.getSinglePixelWidth())}else $/=Y;if(L!==1&&(R.scale(L,L),$/=L),R.lineWidth=$,A.isInvalidPDFjsFont){let rt=[],ot=0;for(let lt of c)rt.push(lt.unicode),ot+=lt.width;R.fillText(rt.join(""),0,0),d.x+=ot*V*v,R.restore(),this.compose();return}let K=0,Z;for(Z=0;Z<C;++Z){let rt=c[Z];if(typeof rt=="number"){K+=N*rt*M/1e3;continue}let ot=!1,lt=(rt.isSpace?a:0)+w,ct=rt.fontChar,dt=rt.accent,ft,yt,_t=rt.width;if(k){let bt=rt.vmetric||W,wt=-(rt.vmetric?bt[1]:_t*.5)*V,se=bt[2]*V;_t=bt?-bt[0]:_t,ft=wt/L,yt=(K+se)/L}else ft=K/L,yt=0;if(A.remeasure&&_t>0){let bt=R.measureText(ct).width*1e3/M*L;if(_t<bt&&this.isFontSubpixelAAEnabled){let wt=_t/bt;ot=!0,R.save(),R.scale(wt,1),ft/=wt}else _t!==bt&&(ft+=(_t-bt)/2e3*M/L)}if(this.contentVisible&&(rt.isInFont||A.missingFile)){if(st&&!dt)R.fillText(ct,ft,yt);else if(this.paintChar(ct,ft,yt,q),dt){let bt=ft+M*dt.offset.x/L,wt=yt-M*dt.offset.y/L;this.paintChar(dt.fontChar,bt,wt,q)}}let Ft=k?_t*V-lt*m:_t*V+lt*m;K+=Ft,ot&&R.restore()}k?d.y-=K:d.x+=K*v,R.restore(),this.compose()}showType3Text(c){let d=this.ctx,A=this.current,M=A.font,R=A.fontSize,L=A.fontDirection,w=M.vertical?1:-1,a=A.charSpacing,m=A.wordSpacing,v=A.textHScale*L,C=A.fontMatrix||r.FONT_IDENTITY_MATRIX,k=c.length,N=A.textRenderingMode===r.TextRenderingMode.INVISIBLE,W,V,st,q;if(!(N||R===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,d.save(),d.transform(...A.textMatrix),d.translate(A.x,A.y),d.scale(v,L),W=0;W<k;++W){if(V=c[W],typeof V=="number"){q=w*V*R/1e3,this.ctx.translate(q,0),A.x+=q*v;continue}let $=(V.isSpace?m:0)+a,Y=M.charProcOperatorList[V.operatorListId];if(!Y){(0,r.warn)(`Type3 character "${V.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=V,this.save(),d.scale(R,R),d.transform(...C),this.executeOperatorList(Y),this.restore()),st=r.Util.applyTransform([V.width,0],C)[0]*R+$,d.translate(st,0),A.x+=st*v}d.restore(),this.processingType3=null}}setCharWidth(c,d){}setCharWidthAndBounds(c,d,A,M,R,L){this.ctx.rect(A,M,R-A,L-M),this.ctx.clip(),this.endPath()}getColorN_Pattern(c){let d;if(c[0]==="TilingPattern"){let A=c[1],M=this.baseTransform||(0,g.getCurrentTransform)(this.ctx),R={createCanvasGraphics:L=>new D(L,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};d=new P.TilingPattern(c,A,this.ctx,R,M)}else d=this._getPattern(c[1],c[2]);return d}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(c,d,A){let M=r.Util.makeHexColor(c,d,A);this.ctx.strokeStyle=M,this.current.strokeColor=M}setFillRGBColor(c,d,A){let M=r.Util.makeHexColor(c,d,A);this.ctx.fillStyle=M,this.current.fillColor=M,this.current.patternFill=!1}_getPattern(c,d=null){let A;return this.cachedPatterns.has(c)?A=this.cachedPatterns.get(c):(A=(0,P.getShadingPattern)(this.getObject(c)),this.cachedPatterns.set(c,A)),d&&(A.matrix=d),A}shadingFill(c){if(!this.contentVisible)return;let d=this.ctx;this.save();let A=this._getPattern(c);d.fillStyle=A.getPattern(d,this,(0,g.getCurrentTransformInverse)(d),P.PathType.SHADING);let M=(0,g.getCurrentTransformInverse)(d);if(M){let{width:R,height:L}=d.canvas,[w,a,m,v]=r.Util.getAxialAlignedBoundingBox([0,0,R,L],M);this.ctx.fillRect(w,a,m-w,v-a)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,r.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,r.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(c,d){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(c)&&c.length===6&&this.transform(...c),this.baseTransform=(0,g.getCurrentTransform)(this.ctx),d)){let A=d[2]-d[0],M=d[3]-d[1];this.ctx.rect(d[0],d[1],A,M),this.current.updateRectMinMax((0,g.getCurrentTransform)(this.ctx),d),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(c){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);let d=this.ctx;c.isolated||(0,r.info)("TODO: Support non-isolated groups."),c.knockout&&(0,r.warn)("Knockout groups not supported.");let A=(0,g.getCurrentTransform)(d);if(c.matrix&&d.transform(...c.matrix),!c.bbox)throw new Error("Bounding box is required.");let M=r.Util.getAxialAlignedBoundingBox(c.bbox,(0,g.getCurrentTransform)(d)),R=[0,0,d.canvas.width,d.canvas.height];M=r.Util.intersect(M,R)||[0,0,0,0];let L=Math.floor(M[0]),w=Math.floor(M[1]),a=Math.max(Math.ceil(M[2])-L,1),m=Math.max(Math.ceil(M[3])-w,1),v=1,C=1;a>h&&(v=a/h,a=h),m>h&&(C=m/h,m=h),this.current.startNewPathAndClipBox([0,0,a,m]);let k="groupAt"+this.groupLevel;c.smask&&(k+="_smask_"+this.smaskCounter++%2);let N=this.cachedCanvases.getCanvas(k,a,m),W=N.context;W.scale(1/v,1/C),W.translate(-L,-w),W.transform(...A),c.smask?this.smaskStack.push({canvas:N.canvas,context:W,offsetX:L,offsetY:w,scaleX:v,scaleY:C,subtype:c.smask.subtype,backdrop:c.smask.backdrop,transferMap:c.smask.transferMap||null,startTransformInverse:null}):(d.setTransform(1,0,0,1,0,0),d.translate(L,w),d.scale(v,C),d.save()),p(d,W),this.ctx=W,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(d),this.groupLevel++}endGroup(c){if(!this.contentVisible)return;this.groupLevel--;let d=this.ctx,A=this.groupStack.pop();if(this.ctx=A,this.ctx.imageSmoothingEnabled=!1,c.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();let M=(0,g.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...M);let R=r.Util.getAxialAlignedBoundingBox([0,0,d.canvas.width,d.canvas.height],M);this.ctx.drawImage(d.canvas,0,0),this.ctx.restore(),this.compose(R)}}beginAnnotation(c,d,A,M,R){if(this.#t(),y(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(d)&&d.length===4){let L=d[2]-d[0],w=d[3]-d[1];if(R&&this.annotationCanvasMap){A=A.slice(),A[4]-=d[0],A[5]-=d[1],d=d.slice(),d[0]=d[1]=0,d[2]=L,d[3]=w;let[a,m]=r.Util.singularValueDecompose2dScale((0,g.getCurrentTransform)(this.ctx)),{viewportScale:v}=this,C=Math.ceil(L*this.outputScaleX*v),k=Math.ceil(w*this.outputScaleY*v);this.annotationCanvas=this.canvasFactory.create(C,k);let{canvas:N,context:W}=this.annotationCanvas;this.annotationCanvasMap.set(c,N),this.annotationCanvas.savedCtx=this.ctx,this.ctx=W,this.ctx.save(),this.ctx.setTransform(a,0,0,-m,0,w*m),y(this.ctx)}else y(this.ctx),this.ctx.rect(d[0],d[1],L,w),this.ctx.clip(),this.endPath()}this.current=new _(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...A),this.transform(...M)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(c){if(!this.contentVisible)return;let d=c.count;c=this.getObject(c.data,c),c.count=d;let A=this.ctx,M=this.processingType3;if(M&&(M.compiled===void 0&&(M.compiled=f(c)),M.compiled)){M.compiled(A);return}let R=this._createMaskCanvas(c),L=R.canvas;A.save(),A.setTransform(1,0,0,1,0,0),A.drawImage(L,R.offsetX,R.offsetY),A.restore(),this.compose()}paintImageMaskXObjectRepeat(c,d,A=0,M=0,R,L){if(!this.contentVisible)return;c=this.getObject(c.data,c);let w=this.ctx;w.save();let a=(0,g.getCurrentTransform)(w);w.transform(d,A,M,R,0,0);let m=this._createMaskCanvas(c);w.setTransform(1,0,0,1,m.offsetX-a[4],m.offsetY-a[5]);for(let v=0,C=L.length;v<C;v+=2){let k=r.Util.transform(a,[d,A,M,R,L[v],L[v+1]]),[N,W]=r.Util.applyTransform([0,0],k);w.drawImage(m.canvas,N,W)}w.restore(),this.compose()}paintImageMaskXObjectGroup(c){if(!this.contentVisible)return;let d=this.ctx,A=this.current.fillColor,M=this.current.patternFill;for(let R of c){let{data:L,width:w,height:a,transform:m}=R,v=this.cachedCanvases.getCanvas("maskCanvas",w,a),C=v.context;C.save();let k=this.getObject(L,R);S(C,k),C.globalCompositeOperation="source-in",C.fillStyle=M?A.getPattern(C,this,(0,g.getCurrentTransformInverse)(d),P.PathType.FILL):A,C.fillRect(0,0,w,a),C.restore(),d.save(),d.transform(...m),d.scale(1,-1),u(d,v.canvas,0,0,w,a,0,-1,1,1),d.restore()}this.compose()}paintImageXObject(c){if(!this.contentVisible)return;let d=this.getObject(c);if(!d){(0,r.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(d)}paintImageXObjectRepeat(c,d,A,M){if(!this.contentVisible)return;let R=this.getObject(c);if(!R){(0,r.warn)("Dependent image isn't ready yet");return}let L=R.width,w=R.height,a=[];for(let m=0,v=M.length;m<v;m+=2)a.push({transform:[d,0,0,A,M[m],M[m+1]],x:0,y:0,w:L,h:w});this.paintInlineImageXObjectGroup(R,a)}applyTransferMapsToCanvas(c){return this.current.transferMaps!=="none"&&(c.filter=this.current.transferMaps,c.drawImage(c.canvas,0,0),c.filter="none"),c.canvas}applyTransferMapsToBitmap(c){if(this.current.transferMaps==="none")return c.bitmap;let{bitmap:d,width:A,height:M}=c,R=this.cachedCanvases.getCanvas("inlineImage",A,M),L=R.context;return L.filter=this.current.transferMaps,L.drawImage(d,0,0),L.filter="none",R.canvas}paintInlineImageXObject(c){if(!this.contentVisible)return;let d=c.width,A=c.height,M=this.ctx;if(this.save(),!r.isNodeJS){let{filter:w}=M;w!=="none"&&w!==""&&(M.filter="none")}M.scale(1/d,-1/A);let R;if(c.bitmap)R=this.applyTransferMapsToBitmap(c);else if(typeof HTMLElement=="function"&&c instanceof HTMLElement||!c.data)R=c;else{let a=this.cachedCanvases.getCanvas("inlineImage",d,A).context;T(a,c),R=this.applyTransferMapsToCanvas(a)}let L=this._scaleImage(R,(0,g.getCurrentTransformInverse)(M));M.imageSmoothingEnabled=it((0,g.getCurrentTransform)(M),c.interpolate),u(M,L.img,0,0,L.paintWidth,L.paintHeight,0,-A,d,A),this.compose(),this.restore()}paintInlineImageXObjectGroup(c,d){if(!this.contentVisible)return;let A=this.ctx,M;if(c.bitmap)M=c.bitmap;else{let R=c.width,L=c.height,a=this.cachedCanvases.getCanvas("inlineImage",R,L).context;T(a,c),M=this.applyTransferMapsToCanvas(a)}for(let R of d)A.save(),A.transform(...R.transform),A.scale(1,-1),u(A,M,R.x,R.y,R.w,R.h,0,-1,1,1),A.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(c){}markPointProps(c,d){}beginMarkedContent(c){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(c,d){c==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(d)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(c){let d=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(c);let A=this.ctx;this.pendingClip&&(d||(this.pendingClip===J?A.clip("evenodd"):A.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),A.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){let c=(0,g.getCurrentTransform)(this.ctx);if(c[1]===0&&c[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(c[0]),Math.abs(c[3]));else{let d=Math.abs(c[0]*c[3]-c[2]*c[1]),A=Math.hypot(c[0],c[2]),M=Math.hypot(c[1],c[3]);this._cachedGetSinglePixelWidth=Math.max(A,M)/d}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){let{lineWidth:c}=this.current,{a:d,b:A,c:M,d:R}=this.ctx.getTransform(),L,w;if(A===0&&M===0){let a=Math.abs(d),m=Math.abs(R);if(a===m)if(c===0)L=w=1/a;else{let v=a*c;L=w=v<1?1/v:1}else if(c===0)L=1/a,w=1/m;else{let v=a*c,C=m*c;L=v<1?1/v:1,w=C<1?1/C:1}}else{let a=Math.abs(d*R-A*M),m=Math.hypot(d,A),v=Math.hypot(M,R);if(c===0)L=v/a,w=m/a;else{let C=c*a;L=v>C?v/C:1,w=m>C?m/C:1}}this._cachedScaleForStroking[0]=L,this._cachedScaleForStroking[1]=w}return this._cachedScaleForStroking}rescaleAndStroke(c){let{ctx:d}=this,{lineWidth:A}=this.current,[M,R]=this.getScaleForStroking();if(d.lineWidth=A||1,M===1&&R===1){d.stroke();return}let L=d.getLineDash();if(c&&d.save(),d.scale(M,R),L.length>0){let w=Math.max(M,R);d.setLineDash(L.map(a=>a/w)),d.lineDashOffset/=w}d.stroke(),c&&d.restore()}isContentVisible(){for(let c=this.markedContentStack.length-1;c>=0;c--)if(!this.markedContentStack[c].visible)return!1;return!0}}i.CanvasGraphics=D;for(let b in r.OPS)D.prototype[b]!==void 0&&(D.prototype[r.OPS[b]]=D.prototype[b])},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TilingPattern=i.PathType=void 0,i.getShadingPattern=l;var r=E(1),g=E(6);let P={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};i.PathType=P;function x(u,f){if(!f)return;let _=f[2]-f[0],T=f[3]-f[1],S=new Path2D;S.rect(f[0],f[1],_,T),u.clip(S)}class U{constructor(){this.constructor===U&&(0,r.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,r.unreachable)("Abstract method `getPattern` called.")}}class B extends U{constructor(f){super(),this._type=f[1],this._bbox=f[2],this._colorStops=f[3],this._p0=f[4],this._p1=f[5],this._r0=f[6],this._r1=f[7],this.matrix=null}_createGradient(f){let _;this._type==="axial"?_=f.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(_=f.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(let T of this._colorStops)_.addColorStop(T[0],T[1]);return _}getPattern(f,_,T,S){let p;if(S===P.STROKE||S===P.FILL){let y=_.current.getClippedPathBoundingBox(S,(0,g.getCurrentTransform)(f))||[0,0,0,0],O=Math.ceil(y[2]-y[0])||1,j=Math.ceil(y[3]-y[1])||1,I=_.cachedCanvases.getCanvas("pattern",O,j,!0),z=I.context;z.clearRect(0,0,z.canvas.width,z.canvas.height),z.beginPath(),z.rect(0,0,z.canvas.width,z.canvas.height),z.translate(-y[0],-y[1]),T=r.Util.transform(T,[1,0,0,1,y[0],y[1]]),z.transform(..._.baseTransform),this.matrix&&z.transform(...this.matrix),x(z,this._bbox),z.fillStyle=this._createGradient(z),z.fill(),p=f.createPattern(I.canvas,"no-repeat");let X=new DOMMatrix(T);p.setTransform(X)}else x(f,this._bbox),p=this._createGradient(f);return p}}function h(u,f,_,T,S,p,y,O){let j=f.coords,I=f.colors,z=u.data,X=u.width*4,it;j[_+1]>j[T+1]&&(it=_,_=T,T=it,it=p,p=y,y=it),j[T+1]>j[S+1]&&(it=T,T=S,S=it,it=y,y=O,O=it),j[_+1]>j[T+1]&&(it=_,_=T,T=it,it=p,p=y,y=it);let tt=(j[_]+f.offsetX)*f.scaleX,Q=(j[_+1]+f.offsetY)*f.scaleY,nt=(j[T]+f.offsetX)*f.scaleX,J=(j[T+1]+f.offsetY)*f.scaleY,D=(j[S]+f.offsetX)*f.scaleX,b=(j[S+1]+f.offsetY)*f.scaleY;if(Q>=b)return;let c=I[p],d=I[p+1],A=I[p+2],M=I[y],R=I[y+1],L=I[y+2],w=I[O],a=I[O+1],m=I[O+2],v=Math.round(Q),C=Math.round(b),k,N,W,V,st,q,$,Y;for(let K=v;K<=C;K++){if(K<J){let ct=K<Q?0:(Q-K)/(Q-J);k=tt-(tt-nt)*ct,N=c-(c-M)*ct,W=d-(d-R)*ct,V=A-(A-L)*ct}else{let ct;K>b?ct=1:J===b?ct=0:ct=(J-K)/(J-b),k=nt-(nt-D)*ct,N=M-(M-w)*ct,W=R-(R-a)*ct,V=L-(L-m)*ct}let Z;K<Q?Z=0:K>b?Z=1:Z=(Q-K)/(Q-b),st=tt-(tt-D)*Z,q=c-(c-w)*Z,$=d-(d-a)*Z,Y=A-(A-m)*Z;let rt=Math.round(Math.min(k,st)),ot=Math.round(Math.max(k,st)),lt=X*K+rt*4;for(let ct=rt;ct<=ot;ct++)Z=(k-ct)/(k-st),Z<0?Z=0:Z>1&&(Z=1),z[lt++]=N-(N-q)*Z|0,z[lt++]=W-(W-$)*Z|0,z[lt++]=V-(V-Y)*Z|0,z[lt++]=255}}function n(u,f,_){let T=f.coords,S=f.colors,p,y;switch(f.type){case"lattice":let O=f.verticesPerRow,j=Math.floor(T.length/O)-1,I=O-1;for(p=0;p<j;p++){let z=p*O;for(let X=0;X<I;X++,z++)h(u,_,T[z],T[z+1],T[z+O],S[z],S[z+1],S[z+O]),h(u,_,T[z+O+1],T[z+1],T[z+O],S[z+O+1],S[z+1],S[z+O])}break;case"triangles":for(p=0,y=T.length;p<y;p+=3)h(u,_,T[p],T[p+1],T[p+2],S[p],S[p+1],S[p+2]);break;default:throw new Error("illegal figure")}}class t extends U{constructor(f){super(),this._coords=f[2],this._colors=f[3],this._figures=f[4],this._bounds=f[5],this._bbox=f[7],this._background=f[8],this.matrix=null}_createMeshCanvas(f,_,T){let O=Math.floor(this._bounds[0]),j=Math.floor(this._bounds[1]),I=Math.ceil(this._bounds[2])-O,z=Math.ceil(this._bounds[3])-j,X=Math.min(Math.ceil(Math.abs(I*f[0]*1.1)),3e3),it=Math.min(Math.ceil(Math.abs(z*f[1]*1.1)),3e3),tt=I/X,Q=z/it,nt={coords:this._coords,colors:this._colors,offsetX:-O,offsetY:-j,scaleX:1/tt,scaleY:1/Q},J=X+2*2,D=it+2*2,b=T.getCanvas("mesh",J,D,!1),c=b.context,d=c.createImageData(X,it);if(_){let M=d.data;for(let R=0,L=M.length;R<L;R+=4)M[R]=_[0],M[R+1]=_[1],M[R+2]=_[2],M[R+3]=255}for(let M of this._figures)n(d,M,nt);return c.putImageData(d,2,2),{canvas:b.canvas,offsetX:O-2*tt,offsetY:j-2*Q,scaleX:tt,scaleY:Q}}getPattern(f,_,T,S){x(f,this._bbox);let p;if(S===P.SHADING)p=r.Util.singularValueDecompose2dScale((0,g.getCurrentTransform)(f));else if(p=r.Util.singularValueDecompose2dScale(_.baseTransform),this.matrix){let O=r.Util.singularValueDecompose2dScale(this.matrix);p=[p[0]*O[0],p[1]*O[1]]}let y=this._createMeshCanvas(p,S===P.SHADING?null:this._background,_.cachedCanvases);return S!==P.SHADING&&(f.setTransform(..._.baseTransform),this.matrix&&f.transform(...this.matrix)),f.translate(y.offsetX,y.offsetY),f.scale(y.scaleX,y.scaleY),f.createPattern(y.canvas,"no-repeat")}}class s extends U{getPattern(){return"hotpink"}}function l(u){switch(u[0]){case"RadialAxial":return new B(u);case"Mesh":return new t(u);case"Dummy":return new s}throw new Error(`Unknown IR type: ${u[0]}`)}let o={COLORED:1,UNCOLORED:2},e=(()=>{class u{static MAX_PATTERN_SIZE=3e3;constructor(_,T,S,p,y){this.operatorList=_[2],this.matrix=_[3]||[1,0,0,1,0,0],this.bbox=_[4],this.xstep=_[5],this.ystep=_[6],this.paintType=_[7],this.tilingType=_[8],this.color=T,this.ctx=S,this.canvasGraphicsFactory=p,this.baseTransform=y}createPatternCanvas(_){let T=this.operatorList,S=this.bbox,p=this.xstep,y=this.ystep,O=this.paintType,j=this.tilingType,I=this.color,z=this.canvasGraphicsFactory;(0,r.info)("TilingType: "+j);let X=S[0],it=S[1],tt=S[2],Q=S[3],nt=r.Util.singularValueDecompose2dScale(this.matrix),J=r.Util.singularValueDecompose2dScale(this.baseTransform),D=[nt[0]*J[0],nt[1]*J[1]],b=this.getSizeAndScale(p,this.ctx.canvas.width,D[0]),c=this.getSizeAndScale(y,this.ctx.canvas.height,D[1]),d=_.cachedCanvases.getCanvas("pattern",b.size,c.size,!0),A=d.context,M=z.createCanvasGraphics(A);M.groupLevel=_.groupLevel,this.setFillAndStrokeStyleToContext(M,O,I);let R=X,L=it,w=tt,a=Q;return X<0&&(R=0,w+=Math.abs(X)),it<0&&(L=0,a+=Math.abs(it)),A.translate(-(b.scale*R),-(c.scale*L)),M.transform(b.scale,0,0,c.scale,0,0),A.save(),this.clipBbox(M,R,L,w,a),M.baseTransform=(0,g.getCurrentTransform)(M.ctx),M.executeOperatorList(T),M.endDrawing(),{canvas:d.canvas,scaleX:b.scale,scaleY:c.scale,offsetX:R,offsetY:L}}getSizeAndScale(_,T,S){_=Math.abs(_);let p=Math.max(u.MAX_PATTERN_SIZE,T),y=Math.ceil(_*S);return y>=p?y=p:S=y/_,{scale:S,size:y}}clipBbox(_,T,S,p,y){let O=p-T,j=y-S;_.ctx.rect(T,S,O,j),_.current.updateRectMinMax((0,g.getCurrentTransform)(_.ctx),[T,S,p,y]),_.clip(),_.endPath()}setFillAndStrokeStyleToContext(_,T,S){let p=_.ctx,y=_.current;switch(T){case o.COLORED:let O=this.ctx;p.fillStyle=O.fillStyle,p.strokeStyle=O.strokeStyle,y.fillColor=O.fillStyle,y.strokeColor=O.strokeStyle;break;case o.UNCOLORED:let j=r.Util.makeHexColor(S[0],S[1],S[2]);p.fillStyle=j,p.strokeStyle=j,y.fillColor=j,y.strokeColor=j;break;default:throw new r.FormatError(`Unsupported paint type: ${T}`)}}getPattern(_,T,S,p){let y=S;p!==P.SHADING&&(y=r.Util.transform(y,T.baseTransform),this.matrix&&(y=r.Util.transform(y,this.matrix)));let O=this.createPatternCanvas(T),j=new DOMMatrix(y);j=j.translate(O.offsetX,O.offsetY),j=j.scale(1/O.scaleX,1/O.scaleY);let I=_.createPattern(O.canvas,"repeat");return I.setTransform(j),I}}return u})();i.TilingPattern=e},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.convertBlackAndWhiteToRGBA=P,i.convertToRGBA=g,i.grayToRGBA=U;var r=E(1);function g(B){switch(B.kind){case r.ImageKind.GRAYSCALE_1BPP:return P(B);case r.ImageKind.RGB_24BPP:return x(B)}return null}function P({src:B,srcPos:h=0,dest:n,width:t,height:s,nonBlackColor:l=4294967295,inverseDecode:o=!1}){let e=r.FeatureTest.isLittleEndian?4278190080:255,[u,f]=o?[l,e]:[e,l],_=t>>3,T=t&7,S=B.length;n=new Uint32Array(n.buffer);let p=0;for(let y=0;y<s;y++){for(let j=h+_;h<j;h++){let I=h<S?B[h]:255;n[p++]=I&128?f:u,n[p++]=I&64?f:u,n[p++]=I&32?f:u,n[p++]=I&16?f:u,n[p++]=I&8?f:u,n[p++]=I&4?f:u,n[p++]=I&2?f:u,n[p++]=I&1?f:u}if(T===0)continue;let O=h<S?B[h++]:255;for(let j=0;j<T;j++)n[p++]=O&1<<7-j?f:u}return{srcPos:h,destPos:p}}function x({src:B,srcPos:h=0,dest:n,destPos:t=0,width:s,height:l}){let o=0,e=B.length>>2,u=new Uint32Array(B.buffer,h,e);if(r.FeatureTest.isLittleEndian){for(;o<e-2;o+=3,t+=4){let f=u[o],_=u[o+1],T=u[o+2];n[t]=f|4278190080,n[t+1]=f>>>24|_<<8|4278190080,n[t+2]=_>>>16|T<<16|4278190080,n[t+3]=T>>>8|4278190080}for(let f=o*4,_=B.length;f<_;f+=3)n[t++]=B[f]|B[f+1]<<8|B[f+2]<<16|4278190080}else{for(;o<e-2;o+=3,t+=4){let f=u[o],_=u[o+1],T=u[o+2];n[t]=f|255,n[t+1]=f<<24|_>>>8|255,n[t+2]=_<<16|T>>>16|255,n[t+3]=T<<8|255}for(let f=o*4,_=B.length;f<_;f+=3)n[t++]=B[f]<<24|B[f+1]<<16|B[f+2]<<8|255}return{srcPos:h,destPos:t}}function U(B,h){if(r.FeatureTest.isLittleEndian)for(let n=0,t=B.length;n<t;n++)h[n]=B[n]*65793|4278190080;else for(let n=0,t=B.length;n<t;n++)h[n]=B[n]*16843008|255}},(F,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.GlobalWorkerOptions=void 0;let E=Object.create(null);i.GlobalWorkerOptions=E,E.workerPort=null,E.workerSrc=""},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.MessageHandler=void 0;var r=E(1);let g={UNKNOWN:0,DATA:1,ERROR:2},P={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function x(B){switch(B instanceof Error||typeof B=="object"&&B!==null||(0,r.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),B.name){case"AbortException":return new r.AbortException(B.message);case"MissingPDFException":return new r.MissingPDFException(B.message);case"PasswordException":return new r.PasswordException(B.message,B.code);case"UnexpectedResponseException":return new r.UnexpectedResponseException(B.message,B.status);case"UnknownErrorException":return new r.UnknownErrorException(B.message,B.details);default:return new r.UnknownErrorException(B.message,B.toString())}}class U{constructor(h,n,t){this.sourceName=h,this.targetName=n,this.comObj=t,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=s=>{let l=s.data;if(l.targetName!==this.sourceName)return;if(l.stream){this.#e(l);return}if(l.callback){let e=l.callbackId,u=this.callbackCapabilities[e];if(!u)throw new Error(`Cannot resolve callback ${e}`);if(delete this.callbackCapabilities[e],l.callback===g.DATA)u.resolve(l.data);else if(l.callback===g.ERROR)u.reject(x(l.reason));else throw new Error("Unexpected callback case");return}let o=this.actionHandler[l.action];if(!o)throw new Error(`Unknown action from worker: ${l.action}`);if(l.callbackId){let e=this.sourceName,u=l.sourceName;new Promise(function(f){f(o(l.data))}).then(function(f){t.postMessage({sourceName:e,targetName:u,callback:g.DATA,callbackId:l.callbackId,data:f})},function(f){t.postMessage({sourceName:e,targetName:u,callback:g.ERROR,callbackId:l.callbackId,reason:x(f)})});return}if(l.streamId){this.#t(l);return}o(l.data)},t.addEventListener("message",this._onComObjOnMessage)}on(h,n){let t=this.actionHandler;if(t[h])throw new Error(`There is already an actionName called "${h}"`);t[h]=n}send(h,n,t){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,data:n},t)}sendWithPromise(h,n,t){let s=this.callbackId++,l=new r.PromiseCapability;this.callbackCapabilities[s]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,callbackId:s,data:n},t)}catch(o){l.reject(o)}return l.promise}sendWithStream(h,n,t,s){let l=this.streamId++,o=this.sourceName,e=this.targetName,u=this.comObj;return new ReadableStream({start:f=>{let _=new r.PromiseCapability;return this.streamControllers[l]={controller:f,startCall:_,pullCall:null,cancelCall:null,isClosed:!1},u.postMessage({sourceName:o,targetName:e,action:h,streamId:l,data:n,desiredSize:f.desiredSize},s),_.promise},pull:f=>{let _=new r.PromiseCapability;return this.streamControllers[l].pullCall=_,u.postMessage({sourceName:o,targetName:e,stream:P.PULL,streamId:l,desiredSize:f.desiredSize}),_.promise},cancel:f=>{(0,r.assert)(f instanceof Error,"cancel must have a valid reason");let _=new r.PromiseCapability;return this.streamControllers[l].cancelCall=_,this.streamControllers[l].isClosed=!0,u.postMessage({sourceName:o,targetName:e,stream:P.CANCEL,streamId:l,reason:x(f)}),_.promise}},t)}#t(h){let n=h.streamId,t=this.sourceName,s=h.sourceName,l=this.comObj,o=this,e=this.actionHandler[h.action],u={enqueue(f,_=1,T){if(this.isCancelled)return;let S=this.desiredSize;this.desiredSize-=_,S>0&&this.desiredSize<=0&&(this.sinkCapability=new r.PromiseCapability,this.ready=this.sinkCapability.promise),l.postMessage({sourceName:t,targetName:s,stream:P.ENQUEUE,streamId:n,chunk:f},T)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:t,targetName:s,stream:P.CLOSE,streamId:n}),delete o.streamSinks[n])},error(f){(0,r.assert)(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:t,targetName:s,stream:P.ERROR,streamId:n,reason:x(f)}))},sinkCapability:new r.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:h.desiredSize,ready:null};u.sinkCapability.resolve(),u.ready=u.sinkCapability.promise,this.streamSinks[n]=u,new Promise(function(f){f(e(h.data,u))}).then(function(){l.postMessage({sourceName:t,targetName:s,stream:P.START_COMPLETE,streamId:n,success:!0})},function(f){l.postMessage({sourceName:t,targetName:s,stream:P.START_COMPLETE,streamId:n,reason:x(f)})})}#e(h){let n=h.streamId,t=this.sourceName,s=h.sourceName,l=this.comObj,o=this.streamControllers[n],e=this.streamSinks[n];switch(h.stream){case P.START_COMPLETE:h.success?o.startCall.resolve():o.startCall.reject(x(h.reason));break;case P.PULL_COMPLETE:h.success?o.pullCall.resolve():o.pullCall.reject(x(h.reason));break;case P.PULL:if(!e){l.postMessage({sourceName:t,targetName:s,stream:P.PULL_COMPLETE,streamId:n,success:!0});break}e.desiredSize<=0&&h.desiredSize>0&&e.sinkCapability.resolve(),e.desiredSize=h.desiredSize,new Promise(function(u){u(e.onPull?.())}).then(function(){l.postMessage({sourceName:t,targetName:s,stream:P.PULL_COMPLETE,streamId:n,success:!0})},function(u){l.postMessage({sourceName:t,targetName:s,stream:P.PULL_COMPLETE,streamId:n,reason:x(u)})});break;case P.ENQUEUE:if((0,r.assert)(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(h.chunk);break;case P.CLOSE:if((0,r.assert)(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#i(o,n);break;case P.ERROR:(0,r.assert)(o,"error should have stream controller"),o.controller.error(x(h.reason)),this.#i(o,n);break;case P.CANCEL_COMPLETE:h.success?o.cancelCall.resolve():o.cancelCall.reject(x(h.reason)),this.#i(o,n);break;case P.CANCEL:if(!e)break;new Promise(function(u){u(e.onCancel?.(x(h.reason)))}).then(function(){l.postMessage({sourceName:t,targetName:s,stream:P.CANCEL_COMPLETE,streamId:n,success:!0})},function(u){l.postMessage({sourceName:t,targetName:s,stream:P.CANCEL_COMPLETE,streamId:n,reason:x(u)})}),e.sinkCapability.reject(x(h.reason)),e.isCancelled=!0,delete this.streamSinks[n];break;default:throw new Error("Unexpected stream case")}}#i(h,n){return ht(this,null,function*(){yield Promise.allSettled([h.startCall?.promise,h.pullCall?.promise,h.cancelCall?.promise]),delete this.streamControllers[n]})}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}i.MessageHandler=U},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Metadata=void 0;var r=E(1);class g{#t;#e;constructor({parsedData:x,rawData:U}){this.#t=x,this.#e=U}getRaw(){return this.#e}get(x){return this.#t.get(x)??null}getAll(){return(0,r.objectFromMap)(this.#t)}has(x){return this.#t.has(x)}}i.Metadata=g},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.OptionalContentConfig=void 0;var r=E(1),g=E(8);let P=Symbol("INTERNAL");class x{#t=!0;constructor(h,n){this.name=h,this.intent=n}get visible(){return this.#t}_setVisible(h,n){h!==P&&(0,r.unreachable)("Internal method `_setVisible` called."),this.#t=n}}class U{#t=null;#e=new Map;#i=null;#s=null;constructor(h){if(this.name=null,this.creator=null,h!==null){this.name=h.name,this.creator=h.creator,this.#s=h.order;for(let n of h.groups)this.#e.set(n.id,new x(n.name,n.intent));if(h.baseState==="OFF")for(let n of this.#e.values())n._setVisible(P,!1);for(let n of h.on)this.#e.get(n)._setVisible(P,!0);for(let n of h.off)this.#e.get(n)._setVisible(P,!1);this.#i=this.getHash()}}#o(h){let n=h.length;if(n<2)return!0;let t=h[0];for(let s=1;s<n;s++){let l=h[s],o;if(Array.isArray(l))o=this.#o(l);else if(this.#e.has(l))o=this.#e.get(l).visible;else return(0,r.warn)(`Optional content group not found: ${l}`),!0;switch(t){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return t==="And"}isVisible(h){if(this.#e.size===0)return!0;if(!h)return(0,r.warn)("Optional content group not defined."),!0;if(h.type==="OCG")return this.#e.has(h.id)?this.#e.get(h.id).visible:((0,r.warn)(`Optional content group not found: ${h.id}`),!0);if(h.type==="OCMD"){if(h.expression)return this.#o(h.expression);if(!h.policy||h.policy==="AnyOn"){for(let n of h.ids){if(!this.#e.has(n))return(0,r.warn)(`Optional content group not found: ${n}`),!0;if(this.#e.get(n).visible)return!0}return!1}else if(h.policy==="AllOn"){for(let n of h.ids){if(!this.#e.has(n))return(0,r.warn)(`Optional content group not found: ${n}`),!0;if(!this.#e.get(n).visible)return!1}return!0}else if(h.policy==="AnyOff"){for(let n of h.ids){if(!this.#e.has(n))return(0,r.warn)(`Optional content group not found: ${n}`),!0;if(!this.#e.get(n).visible)return!0}return!1}else if(h.policy==="AllOff"){for(let n of h.ids){if(!this.#e.has(n))return(0,r.warn)(`Optional content group not found: ${n}`),!0;if(this.#e.get(n).visible)return!1}return!0}return(0,r.warn)(`Unknown optional content policy ${h.policy}.`),!0}return(0,r.warn)(`Unknown group type ${h.type}.`),!0}setVisibility(h,n=!0){if(!this.#e.has(h)){(0,r.warn)(`Optional content group not found: ${h}`);return}this.#e.get(h)._setVisible(P,!!n),this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#s?this.#s.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?(0,r.objectFromMap)(this.#e):null}getGroup(h){return this.#e.get(h)||null}getHash(){if(this.#t!==null)return this.#t;let h=new g.MurmurHash3_64;for(let[n,t]of this.#e)h.update(`${n}:${t.visible}`);return this.#t=h.hexdigest()}}i.OptionalContentConfig=U},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFDataTransportStream=void 0;var r=E(1),g=E(6);class P{constructor({length:h,initialData:n,progressiveDone:t=!1,contentDispositionFilename:s=null,disableRange:l=!1,disableStream:o=!1},e){if((0,r.assert)(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=t,this._contentDispositionFilename=s,n?.length>0){let u=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!o,this._isRangeSupported=!l,this._contentLength=h,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((u,f)=>{this._onReceiveData({begin:u,chunk:f})}),this._pdfDataRangeTransport.addProgressListener((u,f)=>{this._onProgress({loaded:u,total:f})}),this._pdfDataRangeTransport.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:h,chunk:n}){let t=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;if(h===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(t):this._queuedChunks.push(t);else{let s=this._rangeReaders.some(function(l){return l._begin!==h?!1:(l._enqueue(t),!0)});(0,r.assert)(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(h){h.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:h.loaded}):this._fullRequestReader?.onProgress?.({loaded:h.loaded,total:h.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(h){let n=this._rangeReaders.indexOf(h);n>=0&&this._rangeReaders.splice(n,1)}getFullReader(){(0,r.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");let h=this._queuedChunks;return this._queuedChunks=null,new x(this,h,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(h,n){if(n<=this._progressiveDataLength)return null;let t=new U(this,h,n);return this._pdfDataRangeTransport.requestDataRange(h,n),this._rangeReaders.push(t),t}cancelAllRequests(h){this._fullRequestReader?.cancel(h);for(let n of this._rangeReaders.slice(0))n.cancel(h);this._pdfDataRangeTransport.abort()}}i.PDFDataTransportStream=P;class x{constructor(h,n,t=!1,s=null){this._stream=h,this._done=t||!1,this._filename=(0,g.isPdfFile)(s)?s:null,this._queuedChunks=n||[],this._loaded=0;for(let l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),h._fullRequestReader=this,this.onProgress=null}_enqueue(h){this._done||(this._requests.length>0?this._requests.shift().resolve({value:h,done:!1}):this._queuedChunks.push(h),this._loaded+=h.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}read(){return ht(this,null,function*(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let h=new r.PromiseCapability;return this._requests.push(h),h.promise})}cancel(h){this._done=!0;for(let n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class U{constructor(h,n,t){this._stream=h,this._begin=n,this._end=t,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(h){if(!this._done){if(this._requests.length===0)this._queuedChunk=h;else{this._requests.shift().resolve({value:h,done:!1});for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}read(){return ht(this,null,function*(){if(this._queuedChunk){let n=this._queuedChunk;return this._queuedChunk=null,{value:n,done:!1}}if(this._done)return{value:void 0,done:!0};let h=new r.PromiseCapability;return this._requests.push(h),h.promise})}cancel(h){this._done=!0;for(let n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFFetchStream=void 0;var r=E(1),g=E(20);function P(t,s,l){return{method:"GET",headers:t,signal:l.signal,mode:"cors",credentials:s?"include":"same-origin",redirect:"follow"}}function x(t){let s=new Headers;for(let l in t){let o=t[l];o!==void 0&&s.append(l,o)}return s}function U(t){return t instanceof Uint8Array?t.buffer:t instanceof ArrayBuffer?t:((0,r.warn)(`getArrayBuffer - unexpected data format: ${t}`),new Uint8Array(t).buffer)}class B{constructor(s){this.source=s,this.isHttp=/^https?:/i.test(s.url),this.httpHeaders=this.isHttp&&s.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new h(this),this._fullRequestReader}getRangeReader(s,l){if(l<=this._progressiveDataLength)return null;let o=new n(this,s,l);return this._rangeRequestReaders.push(o),o}cancelAllRequests(s){this._fullRequestReader?.cancel(s);for(let l of this._rangeRequestReaders.slice(0))l.cancel(s)}}i.PDFFetchStream=B;class h{constructor(s){this._stream=s,this._reader=null,this._loaded=0,this._filename=null;let l=s.source;this._withCredentials=l.withCredentials||!1,this._contentLength=l.length,this._headersCapability=new r.PromiseCapability,this._disableRange=l.disableRange||!1,this._rangeChunkSize=l.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!l.disableStream,this._isRangeSupported=!l.disableRange,this._headers=x(this._stream.httpHeaders);let o=l.url;fetch(o,P(this._headers,this._withCredentials,this._abortController)).then(e=>{if(!(0,g.validateResponseStatus)(e.status))throw(0,g.createResponseStatusError)(e.status,o);this._reader=e.body.getReader(),this._headersCapability.resolve();let u=T=>e.headers.get(T),{allowRangeRequests:f,suggestedLength:_}=(0,g.validateRangeRequestCapabilities)({getResponseHeader:u,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=f,this._contentLength=_||this._contentLength,this._filename=(0,g.extractFilenameFromHeader)(u),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new r.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return ht(this,null,function*(){yield this._headersCapability.promise;let{value:s,done:l}=yield this._reader.read();return l?{value:s,done:l}:(this._loaded+=s.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:U(s),done:!1})})}cancel(s){this._reader?.cancel(s),this._abortController.abort()}}class n{constructor(s,l,o){this._stream=s,this._reader=null,this._loaded=0;let e=s.source;this._withCredentials=e.withCredentials||!1,this._readCapability=new r.PromiseCapability,this._isStreamingSupported=!e.disableStream,this._abortController=new AbortController,this._headers=x(this._stream.httpHeaders),this._headers.append("Range",`bytes=${l}-${o-1}`);let u=e.url;fetch(u,P(this._headers,this._withCredentials,this._abortController)).then(f=>{if(!(0,g.validateResponseStatus)(f.status))throw(0,g.createResponseStatusError)(f.status,u);this._readCapability.resolve(),this._reader=f.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}read(){return ht(this,null,function*(){yield this._readCapability.promise;let{value:s,done:l}=yield this._reader.read();return l?{value:s,done:l}:(this._loaded+=s.byteLength,this.onProgress?.({loaded:this._loaded}),{value:U(s),done:!1})})}cancel(s){this._reader?.cancel(s),this._abortController.abort()}}},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.createResponseStatusError=B,i.extractFilenameFromHeader=U,i.validateRangeRequestCapabilities=x,i.validateResponseStatus=h;var r=E(1),g=E(21),P=E(6);function x({getResponseHeader:n,isHttp:t,rangeChunkSize:s,disableRange:l}){let o={allowRangeRequests:!1,suggestedLength:void 0},e=parseInt(n("Content-Length"),10);return!Number.isInteger(e)||(o.suggestedLength=e,e<=2*s)||l||!t||n("Accept-Ranges")!=="bytes"||(n("Content-Encoding")||"identity")!=="identity"||(o.allowRangeRequests=!0),o}function U(n){let t=n("Content-Disposition");if(t){let s=(0,g.getFilenameFromContentDispositionHeader)(t);if(s.includes("%"))try{s=decodeURIComponent(s)}catch{}if((0,P.isPdfFile)(s))return s}return null}function B(n,t){return n===404||n===0&&t.startsWith("file:")?new r.MissingPDFException('Missing PDF "'+t+'".'):new r.UnexpectedResponseException(`Unexpected server response (${n}) while retrieving PDF "${t}".`,n)}function h(n){return n===200||n===206}},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.getFilenameFromContentDispositionHeader=g;var r=E(1);function g(P){let x=!0,U=B("filename\\*","i").exec(P);if(U){U=U[1];let e=s(U);return e=unescape(e),e=l(e),e=o(e),n(e)}if(U=t(P),U){let e=o(U);return n(e)}if(U=B("filename","i").exec(P),U){U=U[1];let e=s(U);return e=o(e),n(e)}function B(e,u){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function h(e,u){if(e){if(!/^[\x00-\xFF]+$/.test(u))return u;try{let f=new TextDecoder(e,{fatal:!0}),_=(0,r.stringToBytes)(u);u=f.decode(_),x=!1}catch{}}return u}function n(e){return x&&/[\x80-\xff]/.test(e)&&(e=h("utf-8",e),x&&(e=h("iso-8859-1",e))),e}function t(e){let u=[],f,_=B("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=_.exec(e))!==null;){let[,S,p,y]=f;if(S=parseInt(S,10),S in u){if(S===0)break;continue}u[S]=[p,y]}let T=[];for(let S=0;S<u.length&&S in u;++S){let[p,y]=u[S];y=s(y),p&&(y=unescape(y),S===0&&(y=l(y))),T.push(y)}return T.join("")}function s(e){if(e.startsWith('"')){let u=e.slice(1).split('\\"');for(let f=0;f<u.length;++f){let _=u[f].indexOf('"');_!==-1&&(u[f]=u[f].slice(0,_),u.length=f+1),u[f]=u[f].replaceAll(/\\(.)/g,"$1")}e=u.join('"')}return e}function l(e){let u=e.indexOf("'");if(u===-1)return e;let f=e.slice(0,u),T=e.slice(u+1).replace(/^[^']*'/,"");return h(f,T)}function o(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,f,_,T){if(_==="q"||_==="Q")return T=T.replaceAll("_"," "),T=T.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,p){return String.fromCharCode(parseInt(p,16))}),h(f,T);try{T=atob(T)}catch{}return h(f,T)})}return""}},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNetworkStream=void 0;var r=E(1),g=E(20);let P=200,x=206;function U(s){let l=s.response;return typeof l!="string"?l:(0,r.stringToBytes)(l).buffer}class B{constructor(l,o={}){this.url=l,this.isHttp=/^https?:/i.test(l),this.httpHeaders=this.isHttp&&o.httpHeaders||Object.create(null),this.withCredentials=o.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(l,o,e){let u={begin:l,end:o};for(let f in e)u[f]=e[f];return this.request(u)}requestFull(l){return this.request(l)}request(l){let o=new XMLHttpRequest,e=this.currXhrId++,u=this.pendingRequests[e]={xhr:o};o.open("GET",this.url),o.withCredentials=this.withCredentials;for(let f in this.httpHeaders){let _=this.httpHeaders[f];_!==void 0&&o.setRequestHeader(f,_)}return this.isHttp&&"begin"in l&&"end"in l?(o.setRequestHeader("Range",`bytes=${l.begin}-${l.end-1}`),u.expectedStatus=x):u.expectedStatus=P,o.responseType="arraybuffer",l.onError&&(o.onerror=function(f){l.onError(o.status)}),o.onreadystatechange=this.onStateChange.bind(this,e),o.onprogress=this.onProgress.bind(this,e),u.onHeadersReceived=l.onHeadersReceived,u.onDone=l.onDone,u.onError=l.onError,u.onProgress=l.onProgress,o.send(null),e}onProgress(l,o){let e=this.pendingRequests[l];e&&e.onProgress?.(o)}onStateChange(l,o){let e=this.pendingRequests[l];if(!e)return;let u=e.xhr;if(u.readyState>=2&&e.onHeadersReceived&&(e.onHeadersReceived(),delete e.onHeadersReceived),u.readyState!==4||!(l in this.pendingRequests))return;if(delete this.pendingRequests[l],u.status===0&&this.isHttp){e.onError?.(u.status);return}let f=u.status||P;if(!(f===P&&e.expectedStatus===x)&&f!==e.expectedStatus){e.onError?.(u.status);return}let T=U(u);if(f===x){let S=u.getResponseHeader("Content-Range"),p=/bytes (\d+)-(\d+)\/(\d+)/.exec(S);e.onDone({begin:parseInt(p[1],10),chunk:T})}else T?e.onDone({begin:0,chunk:T}):e.onError?.(u.status)}getRequestXhr(l){return this.pendingRequests[l].xhr}isPendingRequest(l){return l in this.pendingRequests}abortRequest(l){let o=this.pendingRequests[l].xhr;delete this.pendingRequests[l],o.abort()}}class h{constructor(l){this._source=l,this._manager=new B(l.url,{httpHeaders:l.httpHeaders,withCredentials:l.withCredentials}),this._rangeChunkSize=l.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(l){let o=this._rangeRequestReaders.indexOf(l);o>=0&&this._rangeRequestReaders.splice(o,1)}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new n(this._manager,this._source),this._fullRequestReader}getRangeReader(l,o){let e=new t(this._manager,l,o);return e.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(e),e}cancelAllRequests(l){this._fullRequestReader?.cancel(l);for(let o of this._rangeRequestReaders.slice(0))o.cancel(l)}}i.PDFNetworkStream=h;class n{constructor(l,o){this._manager=l;let e={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=o.url,this._fullRequestId=l.requestFull(e),this._headersReceivedCapability=new r.PromiseCapability,this._disableRange=o.disableRange||!1,this._contentLength=o.length,this._rangeChunkSize=o.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){let l=this._fullRequestId,o=this._manager.getRequestXhr(l),e=_=>o.getResponseHeader(_),{allowRangeRequests:u,suggestedLength:f}=(0,g.validateRangeRequestCapabilities)({getResponseHeader:e,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});u&&(this._isRangeSupported=!0),this._contentLength=f||this._contentLength,this._filename=(0,g.extractFilenameFromHeader)(e),this._isRangeSupported&&this._manager.abortRequest(l),this._headersReceivedCapability.resolve()}_onDone(l){if(l&&(this._requests.length>0?this._requests.shift().resolve({value:l.chunk,done:!1}):this._cachedChunks.push(l.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(let o of this._requests)o.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(l){this._storedError=(0,g.createResponseStatusError)(l,this._url),this._headersReceivedCapability.reject(this._storedError);for(let o of this._requests)o.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(l){this.onProgress?.({loaded:l.loaded,total:l.lengthComputable?l.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}read(){return ht(this,null,function*(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let l=new r.PromiseCapability;return this._requests.push(l),l.promise})}cancel(l){this._done=!0,this._headersReceivedCapability.reject(l);for(let o of this._requests)o.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class t{constructor(l,o,e){this._manager=l;let u={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=l.url,this._requestId=l.requestRange(o,e,u),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(l){let o=l.chunk;this._requests.length>0?this._requests.shift().resolve({value:o,done:!1}):this._queuedChunk=o,this._done=!0;for(let e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(l){this._storedError=(0,g.createResponseStatusError)(l,this._url);for(let o of this._requests)o.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(l){this.isStreamingSupported||this.onProgress?.({loaded:l.loaded})}get isStreamingSupported(){return!1}read(){return ht(this,null,function*(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){let o=this._queuedChunk;return this._queuedChunk=null,{value:o,done:!1}}if(this._done)return{value:void 0,done:!0};let l=new r.PromiseCapability;return this._requests.push(l),l.promise})}cancel(l){this._done=!0;for(let o of this._requests)o.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNodeStream=void 0;var r=E(1),g=E(20);let P=/^file:\/\/\/[a-zA-Z]:\//;function x(e){let u=mi(),f=u.parse(e);return f.protocol==="file:"||f.host?f:/^[a-z]:[/\\]/i.test(e)?u.parse(`file:///${e}`):(f.host||(f.protocol="file:"),f)}class U{constructor(u){this.source=u,this.url=x(u.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&u.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new l(this):new t(this),this._fullRequestReader}getRangeReader(u,f){if(f<=this._progressiveDataLength)return null;let _=this.isFsUrl?new o(this,u,f):new s(this,u,f);return this._rangeRequestReaders.push(_),_}cancelAllRequests(u){this._fullRequestReader?.cancel(u);for(let f of this._rangeRequestReaders.slice(0))f.cancel(u)}}i.PDFNodeStream=U;class B{constructor(u){this._url=u.url,this._done=!1,this._storedError=null,this.onProgress=null;let f=u.source;this._contentLength=f.length,this._loaded=0,this._filename=null,this._disableRange=f.disableRange||!1,this._rangeChunkSize=f.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!f.disableStream,this._isRangeSupported=!f.disableRange,this._readableStream=null,this._readCapability=new r.PromiseCapability,this._headersCapability=new r.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return ht(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let u=this._readableStream.read();return u===null?(this._readCapability=new r.PromiseCapability,this.read()):(this._loaded+=u.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(u).buffer,done:!1})})}cancel(u){if(!this._readableStream){this._error(u);return}this._readableStream.destroy(u)}_error(u){this._storedError=u,this._readCapability.resolve()}_setReadableStream(u){this._readableStream=u,u.on("readable",()=>{this._readCapability.resolve()}),u.on("end",()=>{u.destroy(),this._done=!0,this._readCapability.resolve()}),u.on("error",f=>{this._error(f)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new r.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class h{constructor(u){this._url=u.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new r.PromiseCapability;let f=u.source;this._isStreamingSupported=!f.disableStream}get isStreamingSupported(){return this._isStreamingSupported}read(){return ht(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let u=this._readableStream.read();return u===null?(this._readCapability=new r.PromiseCapability,this.read()):(this._loaded+=u.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(u).buffer,done:!1})})}cancel(u){if(!this._readableStream){this._error(u);return}this._readableStream.destroy(u)}_error(u){this._storedError=u,this._readCapability.resolve()}_setReadableStream(u){this._readableStream=u,u.on("readable",()=>{this._readCapability.resolve()}),u.on("end",()=>{u.destroy(),this._done=!0,this._readCapability.resolve()}),u.on("error",f=>{this._error(f)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function n(e,u){return{protocol:e.protocol,auth:e.auth,host:e.hostname,port:e.port,path:e.path,method:"GET",headers:u}}class t extends B{constructor(u){super(u);let f=_=>{if(_.statusCode===404){let y=new r.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=y,this._headersCapability.reject(y);return}this._headersCapability.resolve(),this._setReadableStream(_);let T=y=>this._readableStream.headers[y.toLowerCase()],{allowRangeRequests:S,suggestedLength:p}=(0,g.validateRangeRequestCapabilities)({getResponseHeader:T,isHttp:u.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=S,this._contentLength=p||this._contentLength,this._filename=(0,g.extractFilenameFromHeader)(T)};if(this._request=null,this._url.protocol==="http:"){let _=ge();this._request=_.request(n(this._url,u.httpHeaders),f)}else{let _=me();this._request=_.request(n(this._url,u.httpHeaders),f)}this._request.on("error",_=>{this._storedError=_,this._headersCapability.reject(_)}),this._request.end()}}class s extends h{constructor(u,f,_){super(u),this._httpHeaders={};for(let S in u.httpHeaders){let p=u.httpHeaders[S];p!==void 0&&(this._httpHeaders[S]=p)}this._httpHeaders.Range=`bytes=${f}-${_-1}`;let T=S=>{if(S.statusCode===404){let p=new r.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=p;return}this._setReadableStream(S)};if(this._request=null,this._url.protocol==="http:"){let S=ge();this._request=S.request(n(this._url,this._httpHeaders),T)}else{let S=me();this._request=S.request(n(this._url,this._httpHeaders),T)}this._request.on("error",S=>{this._storedError=S}),this._request.end()}}class l extends B{constructor(u){super(u);let f=decodeURIComponent(this._url.path);P.test(this._url.href)&&(f=f.replace(/^\//,""));let _=ie();_.lstat(f,(T,S)=>{if(T){T.code==="ENOENT"&&(T=new r.MissingPDFException(`Missing PDF "${f}".`)),this._storedError=T,this._headersCapability.reject(T);return}this._contentLength=S.size,this._setReadableStream(_.createReadStream(f)),this._headersCapability.resolve()})}}class o extends h{constructor(u,f,_){super(u);let T=decodeURIComponent(this._url.path);P.test(this._url.href)&&(T=T.replace(/^\//,""));let S=ie();this._setReadableStream(S.createReadStream(T,{start:f,end:_-1}))}}},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.SVGGraphics=void 0;var r=E(6),g=E(1);let P={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},x="http://www.w3.org/XML/1998/namespace",U="http://www.w3.org/1999/xlink",B=["butt","round","square"],h=["miter","round","bevel"],n=function(S,p="",y=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!y)return URL.createObjectURL(new Blob([S],{type:p}));let O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",j=`data:${p};base64,`;for(let I=0,z=S.length;I<z;I+=3){let X=S[I]&255,it=S[I+1]&255,tt=S[I+2]&255,Q=X>>2,nt=(X&3)<<4|it>>4,J=I+1<z?(it&15)<<2|tt>>6:64,D=I+2<z?tt&63:64;j+=O[Q]+O[nt]+O[J]+O[D]}return j},t=function(){let S=new Uint8Array([137,80,78,71,13,10,26,10]),p=12,y=new Int32Array(256);for(let tt=0;tt<256;tt++){let Q=tt;for(let nt=0;nt<8;nt++)Q=Q&1?3988292384^Q>>1&2147483647:Q>>1&2147483647;y[tt]=Q}function O(tt,Q,nt){let J=-1;for(let D=Q;D<nt;D++){let b=(J^tt[D])&255,c=y[b];J=J>>>8^c}return J^-1}function j(tt,Q,nt,J){let D=J,b=Q.length;nt[D]=b>>24&255,nt[D+1]=b>>16&255,nt[D+2]=b>>8&255,nt[D+3]=b&255,D+=4,nt[D]=tt.charCodeAt(0)&255,nt[D+1]=tt.charCodeAt(1)&255,nt[D+2]=tt.charCodeAt(2)&255,nt[D+3]=tt.charCodeAt(3)&255,D+=4,nt.set(Q,D),D+=Q.length;let c=O(nt,J+4,D);nt[D]=c>>24&255,nt[D+1]=c>>16&255,nt[D+2]=c>>8&255,nt[D+3]=c&255}function I(tt,Q,nt){let J=1,D=0;for(let b=Q;b<nt;++b)J=(J+(tt[b]&255))%65521,D=(D+J)%65521;return D<<16|J}function z(tt){if(!g.isNodeJS)return X(tt);try{let Q=parseInt(process.versions.node)>=8?tt:Buffer.from(tt),nt=_i().deflateSync(Q,{level:9});return nt instanceof Uint8Array?nt:new Uint8Array(nt)}catch(Q){(0,g.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Q)}return X(tt)}function X(tt){let Q=tt.length,nt=65535,J=Math.ceil(Q/nt),D=new Uint8Array(2+Q+J*5+4),b=0;D[b++]=120,D[b++]=156;let c=0;for(;Q>nt;)D[b++]=0,D[b++]=255,D[b++]=255,D[b++]=0,D[b++]=0,D.set(tt.subarray(c,c+nt),b),b+=nt,c+=nt,Q-=nt;D[b++]=1,D[b++]=Q&255,D[b++]=Q>>8&255,D[b++]=~Q&65535&255,D[b++]=(~Q&65535)>>8&255,D.set(tt.subarray(c),b),b+=tt.length-c;let d=I(tt,0,tt.length);return D[b++]=d>>24&255,D[b++]=d>>16&255,D[b++]=d>>8&255,D[b++]=d&255,D}function it(tt,Q,nt,J){let D=tt.width,b=tt.height,c,d,A,M=tt.data;switch(Q){case g.ImageKind.GRAYSCALE_1BPP:d=0,c=1,A=D+7>>3;break;case g.ImageKind.RGB_24BPP:d=2,c=8,A=D*3;break;case g.ImageKind.RGBA_32BPP:d=6,c=8,A=D*4;break;default:throw new Error("invalid format")}let R=new Uint8Array((1+A)*b),L=0,w=0;for(let N=0;N<b;++N)R[L++]=0,R.set(M.subarray(w,w+A),L),w+=A,L+=A;if(Q===g.ImageKind.GRAYSCALE_1BPP&&J){L=0;for(let N=0;N<b;N++){L++;for(let W=0;W<A;W++)R[L++]^=255}}let a=new Uint8Array([D>>24&255,D>>16&255,D>>8&255,D&255,b>>24&255,b>>16&255,b>>8&255,b&255,c,d,0,0,0]),m=z(R),v=S.length+p*3+a.length+m.length,C=new Uint8Array(v),k=0;return C.set(S,k),k+=S.length,j("IHDR",a,C,k),k+=p+a.length,j("IDATA",m,C,k),k+=p+m.length,j("IEND",new Uint8Array(0),C,k),n(C,"image/png",nt)}return function(Q,nt,J){let D=Q.kind===void 0?g.ImageKind.GRAYSCALE_1BPP:Q.kind;return it(Q,D,nt,J)}}();class s{constructor(){this.fontSizeScale=1,this.fontWeight=P.fontWeight,this.fontSize=0,this.textMatrix=g.IDENTITY_MATRIX,this.fontMatrix=g.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=g.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=P.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(p,y){this.x=p,this.y=y}}function l(S){let p=[],y=[];for(let O of S){if(O.fn==="save"){p.push({fnId:92,fn:"group",items:[]}),y.push(p),p=p.at(-1).items;continue}O.fn==="restore"?p=y.pop():p.push(O)}return p}function o(S){if(Number.isInteger(S))return S.toString();let p=S.toFixed(10),y=p.length-1;if(p[y]!=="0")return p;do y--;while(p[y]==="0");return p.substring(0,p[y]==="."?y:y+1)}function e(S){if(S[4]===0&&S[5]===0){if(S[1]===0&&S[2]===0)return S[0]===1&&S[3]===1?"":`scale(${o(S[0])} ${o(S[3])})`;if(S[0]===S[3]&&S[1]===-S[2]){let p=Math.acos(S[0])*180/Math.PI;return`rotate(${o(p)})`}}else if(S[0]===1&&S[1]===0&&S[2]===0&&S[3]===1)return`translate(${o(S[4])} ${o(S[5])})`;return`matrix(${o(S[0])} ${o(S[1])} ${o(S[2])} ${o(S[3])} ${o(S[4])} ${o(S[5])})`}let u=0,f=0,_=0;class T{constructor(p,y,O=!1){(0,r.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new r.DOMSVGFactory,this.current=new s,this.transformMatrix=g.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=p,this.objs=y,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!O,this._operatorIdMapping=[];for(let j in g.OPS)this._operatorIdMapping[g.OPS[j]]=j}getObject(p,y=null){return typeof p=="string"?p.startsWith("g_")?this.commonObjs.get(p):this.objs.get(p):y}save(){this.transformStack.push(this.transformMatrix);let p=this.current;this.extraStack.push(p),this.current=p.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(p){this.save(),this.executeOpTree(p),this.restore()}loadDependencies(p){let y=p.fnArray,O=p.argsArray;for(let j=0,I=y.length;j<I;j++)if(y[j]===g.OPS.dependency)for(let z of O[j]){let X=z.startsWith("g_")?this.commonObjs:this.objs,it=new Promise(tt=>{X.get(z,tt)});this.current.dependencies.push(it)}return Promise.all(this.current.dependencies)}transform(p,y,O,j,I,z){let X=[p,y,O,j,I,z];this.transformMatrix=g.Util.transform(this.transformMatrix,X),this.tgrp=null}getSVG(p,y){this.viewport=y;let O=this._initialize(y);return this.loadDependencies(p).then(()=>(this.transformMatrix=g.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(p)),O))}convertOpList(p){let y=this._operatorIdMapping,O=p.argsArray,j=p.fnArray,I=[];for(let z=0,X=j.length;z<X;z++){let it=j[z];I.push({fnId:it,fn:y[it],args:O[z]})}return l(I)}executeOpTree(p){for(let y of p){let O=y.fn,j=y.fnId,I=y.args;switch(j|0){case g.OPS.beginText:this.beginText();break;case g.OPS.dependency:break;case g.OPS.setLeading:this.setLeading(I);break;case g.OPS.setLeadingMoveText:this.setLeadingMoveText(I[0],I[1]);break;case g.OPS.setFont:this.setFont(I);break;case g.OPS.showText:this.showText(I[0]);break;case g.OPS.showSpacedText:this.showText(I[0]);break;case g.OPS.endText:this.endText();break;case g.OPS.moveText:this.moveText(I[0],I[1]);break;case g.OPS.setCharSpacing:this.setCharSpacing(I[0]);break;case g.OPS.setWordSpacing:this.setWordSpacing(I[0]);break;case g.OPS.setHScale:this.setHScale(I[0]);break;case g.OPS.setTextMatrix:this.setTextMatrix(I[0],I[1],I[2],I[3],I[4],I[5]);break;case g.OPS.setTextRise:this.setTextRise(I[0]);break;case g.OPS.setTextRenderingMode:this.setTextRenderingMode(I[0]);break;case g.OPS.setLineWidth:this.setLineWidth(I[0]);break;case g.OPS.setLineJoin:this.setLineJoin(I[0]);break;case g.OPS.setLineCap:this.setLineCap(I[0]);break;case g.OPS.setMiterLimit:this.setMiterLimit(I[0]);break;case g.OPS.setFillRGBColor:this.setFillRGBColor(I[0],I[1],I[2]);break;case g.OPS.setStrokeRGBColor:this.setStrokeRGBColor(I[0],I[1],I[2]);break;case g.OPS.setStrokeColorN:this.setStrokeColorN(I);break;case g.OPS.setFillColorN:this.setFillColorN(I);break;case g.OPS.shadingFill:this.shadingFill(I[0]);break;case g.OPS.setDash:this.setDash(I[0],I[1]);break;case g.OPS.setRenderingIntent:this.setRenderingIntent(I[0]);break;case g.OPS.setFlatness:this.setFlatness(I[0]);break;case g.OPS.setGState:this.setGState(I[0]);break;case g.OPS.fill:this.fill();break;case g.OPS.eoFill:this.eoFill();break;case g.OPS.stroke:this.stroke();break;case g.OPS.fillStroke:this.fillStroke();break;case g.OPS.eoFillStroke:this.eoFillStroke();break;case g.OPS.clip:this.clip("nonzero");break;case g.OPS.eoClip:this.clip("evenodd");break;case g.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case g.OPS.paintImageXObject:this.paintImageXObject(I[0]);break;case g.OPS.paintInlineImageXObject:this.paintInlineImageXObject(I[0]);break;case g.OPS.paintImageMaskXObject:this.paintImageMaskXObject(I[0]);break;case g.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(I[0],I[1]);break;case g.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case g.OPS.closePath:this.closePath();break;case g.OPS.closeStroke:this.closeStroke();break;case g.OPS.closeFillStroke:this.closeFillStroke();break;case g.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case g.OPS.nextLine:this.nextLine();break;case g.OPS.transform:this.transform(I[0],I[1],I[2],I[3],I[4],I[5]);break;case g.OPS.constructPath:this.constructPath(I[0],I[1]);break;case g.OPS.endPath:this.endPath();break;case 92:this.group(y.items);break;default:(0,g.warn)(`Unimplemented operator ${O}`);break}}}setWordSpacing(p){this.current.wordSpacing=p}setCharSpacing(p){this.current.charSpacing=p}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(p,y,O,j,I,z){let X=this.current;X.textMatrix=X.lineMatrix=[p,y,O,j,I,z],X.textMatrixScale=Math.hypot(p,y),X.x=X.lineX=0,X.y=X.lineY=0,X.xcoords=[],X.ycoords=[],X.tspan=this.svgFactory.createElement("svg:tspan"),X.tspan.setAttributeNS(null,"font-family",X.fontFamily),X.tspan.setAttributeNS(null,"font-size",`${o(X.fontSize)}px`),X.tspan.setAttributeNS(null,"y",o(-X.y)),X.txtElement=this.svgFactory.createElement("svg:text"),X.txtElement.append(X.tspan)}beginText(){let p=this.current;p.x=p.lineX=0,p.y=p.lineY=0,p.textMatrix=g.IDENTITY_MATRIX,p.lineMatrix=g.IDENTITY_MATRIX,p.textMatrixScale=1,p.tspan=this.svgFactory.createElement("svg:tspan"),p.txtElement=this.svgFactory.createElement("svg:text"),p.txtgrp=this.svgFactory.createElement("svg:g"),p.xcoords=[],p.ycoords=[]}moveText(p,y){let O=this.current;O.x=O.lineX+=p,O.y=O.lineY+=y,O.xcoords=[],O.ycoords=[],O.tspan=this.svgFactory.createElement("svg:tspan"),O.tspan.setAttributeNS(null,"font-family",O.fontFamily),O.tspan.setAttributeNS(null,"font-size",`${o(O.fontSize)}px`),O.tspan.setAttributeNS(null,"y",o(-O.y))}showText(p){let y=this.current,O=y.font,j=y.fontSize;if(j===0)return;let I=y.fontSizeScale,z=y.charSpacing,X=y.wordSpacing,it=y.fontDirection,tt=y.textHScale*it,Q=O.vertical,nt=Q?1:-1,J=O.defaultVMetrics,D=j*y.fontMatrix[0],b=0;for(let A of p){if(A===null){b+=it*X;continue}else if(typeof A=="number"){b+=nt*A*j/1e3;continue}let M=(A.isSpace?X:0)+z,R=A.fontChar,L,w,a=A.width;if(Q){let v,C=A.vmetric||J;v=A.vmetric?C[1]:a*.5,v=-v*D;let k=C[2]*D;a=C?-C[0]:a,L=v/I,w=(b+k)/I}else L=b/I,w=0;(A.isInFont||O.missingFile)&&(y.xcoords.push(y.x+L),Q&&y.ycoords.push(-y.y+w),y.tspan.textContent+=R);let m=Q?a*D-M*it:a*D+M*it;b+=m}y.tspan.setAttributeNS(null,"x",y.xcoords.map(o).join(" ")),Q?y.tspan.setAttributeNS(null,"y",y.ycoords.map(o).join(" ")):y.tspan.setAttributeNS(null,"y",o(-y.y)),Q?y.y-=b:y.x+=b*tt,y.tspan.setAttributeNS(null,"font-family",y.fontFamily),y.tspan.setAttributeNS(null,"font-size",`${o(y.fontSize)}px`),y.fontStyle!==P.fontStyle&&y.tspan.setAttributeNS(null,"font-style",y.fontStyle),y.fontWeight!==P.fontWeight&&y.tspan.setAttributeNS(null,"font-weight",y.fontWeight);let c=y.textRenderingMode&g.TextRenderingMode.FILL_STROKE_MASK;if(c===g.TextRenderingMode.FILL||c===g.TextRenderingMode.FILL_STROKE?(y.fillColor!==P.fillColor&&y.tspan.setAttributeNS(null,"fill",y.fillColor),y.fillAlpha<1&&y.tspan.setAttributeNS(null,"fill-opacity",y.fillAlpha)):y.textRenderingMode===g.TextRenderingMode.ADD_TO_PATH?y.tspan.setAttributeNS(null,"fill","transparent"):y.tspan.setAttributeNS(null,"fill","none"),c===g.TextRenderingMode.STROKE||c===g.TextRenderingMode.FILL_STROKE){let A=1/(y.textMatrixScale||1);this._setStrokeAttributes(y.tspan,A)}let d=y.textMatrix;y.textRise!==0&&(d=d.slice(),d[5]+=y.textRise),y.txtElement.setAttributeNS(null,"transform",`${e(d)} scale(${o(tt)}, -1)`),y.txtElement.setAttributeNS(x,"xml:space","preserve"),y.txtElement.append(y.tspan),y.txtgrp.append(y.txtElement),this._ensureTransformGroup().append(y.txtElement)}setLeadingMoveText(p,y){this.setLeading(-y),this.moveText(p,y)}addFontStyle(p){if(!p.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));let y=n(p.data,p.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${p.loadedName}"; src: url(${y}); }
`}setFont(p){let y=this.current,O=this.commonObjs.get(p[0]),j=p[1];y.font=O,this.embedFonts&&!O.missingFile&&!this.embeddedFonts[O.loadedName]&&(this.addFontStyle(O),this.embeddedFonts[O.loadedName]=O),y.fontMatrix=O.fontMatrix||g.FONT_IDENTITY_MATRIX;let I="normal";O.black?I="900":O.bold&&(I="bold");let z=O.italic?"italic":"normal";j<0?(j=-j,y.fontDirection=-1):y.fontDirection=1,y.fontSize=j,y.fontFamily=O.loadedName,y.fontWeight=I,y.fontStyle=z,y.tspan=this.svgFactory.createElement("svg:tspan"),y.tspan.setAttributeNS(null,"y",o(-y.y)),y.xcoords=[],y.ycoords=[]}endText(){let p=this.current;p.textRenderingMode&g.TextRenderingMode.ADD_TO_PATH_FLAG&&p.txtElement?.hasChildNodes()&&(p.element=p.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(p){p>0&&(this.current.lineWidth=p)}setLineCap(p){this.current.lineCap=B[p]}setLineJoin(p){this.current.lineJoin=h[p]}setMiterLimit(p){this.current.miterLimit=p}setStrokeAlpha(p){this.current.strokeAlpha=p}setStrokeRGBColor(p,y,O){this.current.strokeColor=g.Util.makeHexColor(p,y,O)}setFillAlpha(p){this.current.fillAlpha=p}setFillRGBColor(p,y,O){this.current.fillColor=g.Util.makeHexColor(p,y,O),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(p){this.current.strokeColor=this._makeColorN_Pattern(p)}setFillColorN(p){this.current.fillColor=this._makeColorN_Pattern(p)}shadingFill(p){let{width:y,height:O}=this.viewport,j=g.Util.inverseTransform(this.transformMatrix),[I,z,X,it]=g.Util.getAxialAlignedBoundingBox([0,0,y,O],j),tt=this.svgFactory.createElement("svg:rect");tt.setAttributeNS(null,"x",I),tt.setAttributeNS(null,"y",z),tt.setAttributeNS(null,"width",X-I),tt.setAttributeNS(null,"height",it-z),tt.setAttributeNS(null,"fill",this._makeShadingPattern(p)),this.current.fillAlpha<1&&tt.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(tt)}_makeColorN_Pattern(p){return p[0]==="TilingPattern"?this._makeTilingPattern(p):this._makeShadingPattern(p)}_makeTilingPattern(p){let y=p[1],O=p[2],j=p[3]||g.IDENTITY_MATRIX,[I,z,X,it]=p[4],tt=p[5],Q=p[6],nt=p[7],J=`shading${_++}`,[D,b,c,d]=g.Util.normalizeRect([...g.Util.applyTransform([I,z],j),...g.Util.applyTransform([X,it],j)]),[A,M]=g.Util.singularValueDecompose2dScale(j),R=tt*A,L=Q*M,w=this.svgFactory.createElement("svg:pattern");w.setAttributeNS(null,"id",J),w.setAttributeNS(null,"patternUnits","userSpaceOnUse"),w.setAttributeNS(null,"width",R),w.setAttributeNS(null,"height",L),w.setAttributeNS(null,"x",`${D}`),w.setAttributeNS(null,"y",`${b}`);let a=this.svg,m=this.transformMatrix,v=this.current.fillColor,C=this.current.strokeColor,k=this.svgFactory.create(c-D,d-b);if(this.svg=k,this.transformMatrix=j,nt===2){let N=g.Util.makeHexColor(...y);this.current.fillColor=N,this.current.strokeColor=N}return this.executeOpTree(this.convertOpList(O)),this.svg=a,this.transformMatrix=m,this.current.fillColor=v,this.current.strokeColor=C,w.append(k.childNodes[0]),this.defs.append(w),`url(#${J})`}_makeShadingPattern(p){switch(typeof p=="string"&&(p=this.objs.get(p)),p[0]){case"RadialAxial":let y=`shading${_++}`,O=p[3],j;switch(p[1]){case"axial":let I=p[4],z=p[5];j=this.svgFactory.createElement("svg:linearGradient"),j.setAttributeNS(null,"id",y),j.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),j.setAttributeNS(null,"x1",I[0]),j.setAttributeNS(null,"y1",I[1]),j.setAttributeNS(null,"x2",z[0]),j.setAttributeNS(null,"y2",z[1]);break;case"radial":let X=p[4],it=p[5],tt=p[6],Q=p[7];j=this.svgFactory.createElement("svg:radialGradient"),j.setAttributeNS(null,"id",y),j.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),j.setAttributeNS(null,"cx",it[0]),j.setAttributeNS(null,"cy",it[1]),j.setAttributeNS(null,"r",Q),j.setAttributeNS(null,"fx",X[0]),j.setAttributeNS(null,"fy",X[1]),j.setAttributeNS(null,"fr",tt);break;default:throw new Error(`Unknown RadialAxial type: ${p[1]}`)}for(let I of O){let z=this.svgFactory.createElement("svg:stop");z.setAttributeNS(null,"offset",I[0]),z.setAttributeNS(null,"stop-color",I[1]),j.append(z)}return this.defs.append(j),`url(#${y})`;case"Mesh":return(0,g.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${p[0]}`)}}setDash(p,y){this.current.dashArray=p,this.current.dashPhase=y}constructPath(p,y){let O=this.current,j=O.x,I=O.y,z=[],X=0;for(let it of p)switch(it|0){case g.OPS.rectangle:j=y[X++],I=y[X++];let tt=y[X++],Q=y[X++],nt=j+tt,J=I+Q;z.push("M",o(j),o(I),"L",o(nt),o(I),"L",o(nt),o(J),"L",o(j),o(J),"Z");break;case g.OPS.moveTo:j=y[X++],I=y[X++],z.push("M",o(j),o(I));break;case g.OPS.lineTo:j=y[X++],I=y[X++],z.push("L",o(j),o(I));break;case g.OPS.curveTo:j=y[X+4],I=y[X+5],z.push("C",o(y[X]),o(y[X+1]),o(y[X+2]),o(y[X+3]),o(j),o(I)),X+=6;break;case g.OPS.curveTo2:z.push("C",o(j),o(I),o(y[X]),o(y[X+1]),o(y[X+2]),o(y[X+3])),j=y[X+2],I=y[X+3],X+=4;break;case g.OPS.curveTo3:j=y[X+2],I=y[X+3],z.push("C",o(y[X]),o(y[X+1]),o(j),o(I),o(j),o(I)),X+=4;break;case g.OPS.closePath:z.push("Z");break}z=z.join(" "),O.path&&p.length>0&&p[0]!==g.OPS.rectangle&&p[0]!==g.OPS.moveTo?z=O.path.getAttributeNS(null,"d")+z:(O.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(O.path)),O.path.setAttributeNS(null,"d",z),O.path.setAttributeNS(null,"fill","none"),O.element=O.path,O.setCurrentPoint(j,I)}endPath(){let p=this.current;if(p.path=null,!this.pendingClip)return;if(!p.element){this.pendingClip=null;return}let y=`clippath${u++}`,O=this.svgFactory.createElement("svg:clipPath");O.setAttributeNS(null,"id",y),O.setAttributeNS(null,"transform",e(this.transformMatrix));let j=p.element.cloneNode(!0);if(this.pendingClip==="evenodd"?j.setAttributeNS(null,"clip-rule","evenodd"):j.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,O.append(j),this.defs.append(O),p.activeClipUrl){p.clipGroup=null;for(let I of this.extraStack)I.clipGroup=null;O.setAttributeNS(null,"clip-path",p.activeClipUrl)}p.activeClipUrl=`url(#${y})`,this.tgrp=null}clip(p){this.pendingClip=p}closePath(){let p=this.current;if(p.path){let y=`${p.path.getAttributeNS(null,"d")}Z`;p.path.setAttributeNS(null,"d",y)}}setLeading(p){this.current.leading=-p}setTextRise(p){this.current.textRise=p}setTextRenderingMode(p){this.current.textRenderingMode=p}setHScale(p){this.current.textHScale=p/100}setRenderingIntent(p){}setFlatness(p){}setGState(p){for(let[y,O]of p)switch(y){case"LW":this.setLineWidth(O);break;case"LC":this.setLineCap(O);break;case"LJ":this.setLineJoin(O);break;case"ML":this.setMiterLimit(O);break;case"D":this.setDash(O[0],O[1]);break;case"RI":this.setRenderingIntent(O);break;case"FL":this.setFlatness(O);break;case"Font":this.setFont(O);break;case"CA":this.setStrokeAlpha(O);break;case"ca":this.setFillAlpha(O);break;default:(0,g.warn)(`Unimplemented graphic state operator ${y}`);break}}fill(){let p=this.current;p.element&&(p.element.setAttributeNS(null,"fill",p.fillColor),p.element.setAttributeNS(null,"fill-opacity",p.fillAlpha),this.endPath())}stroke(){let p=this.current;p.element&&(this._setStrokeAttributes(p.element),p.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(p,y=1){let O=this.current,j=O.dashArray;y!==1&&j.length>0&&(j=j.map(function(I){return y*I})),p.setAttributeNS(null,"stroke",O.strokeColor),p.setAttributeNS(null,"stroke-opacity",O.strokeAlpha),p.setAttributeNS(null,"stroke-miterlimit",o(O.miterLimit)),p.setAttributeNS(null,"stroke-linecap",O.lineCap),p.setAttributeNS(null,"stroke-linejoin",O.lineJoin),p.setAttributeNS(null,"stroke-width",o(y*O.lineWidth)+"px"),p.setAttributeNS(null,"stroke-dasharray",j.map(o).join(" ")),p.setAttributeNS(null,"stroke-dashoffset",o(y*O.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){let p=this.svgFactory.createElement("svg:rect");p.setAttributeNS(null,"x","0"),p.setAttributeNS(null,"y","0"),p.setAttributeNS(null,"width","1px"),p.setAttributeNS(null,"height","1px"),p.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(p)}paintImageXObject(p){let y=this.getObject(p);if(!y){(0,g.warn)(`Dependent image with object ID ${p} is not ready yet`);return}this.paintInlineImageXObject(y)}paintInlineImageXObject(p,y){let O=p.width,j=p.height,I=t(p,this.forceDataSchema,!!y),z=this.svgFactory.createElement("svg:rect");z.setAttributeNS(null,"x","0"),z.setAttributeNS(null,"y","0"),z.setAttributeNS(null,"width",o(O)),z.setAttributeNS(null,"height",o(j)),this.current.element=z,this.clip("nonzero");let X=this.svgFactory.createElement("svg:image");X.setAttributeNS(U,"xlink:href",I),X.setAttributeNS(null,"x","0"),X.setAttributeNS(null,"y",o(-j)),X.setAttributeNS(null,"width",o(O)+"px"),X.setAttributeNS(null,"height",o(j)+"px"),X.setAttributeNS(null,"transform",`scale(${o(1/O)} ${o(-1/j)})`),y?y.append(X):this._ensureTransformGroup().append(X)}paintImageMaskXObject(p){let y=this.getObject(p.data,p);if(y.bitmap){(0,g.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}let O=this.current,j=y.width,I=y.height,z=O.fillColor;O.maskId=`mask${f++}`;let X=this.svgFactory.createElement("svg:mask");X.setAttributeNS(null,"id",O.maskId);let it=this.svgFactory.createElement("svg:rect");it.setAttributeNS(null,"x","0"),it.setAttributeNS(null,"y","0"),it.setAttributeNS(null,"width",o(j)),it.setAttributeNS(null,"height",o(I)),it.setAttributeNS(null,"fill",z),it.setAttributeNS(null,"mask",`url(#${O.maskId})`),this.defs.append(X),this._ensureTransformGroup().append(it),this.paintInlineImageXObject(y,X)}paintFormXObjectBegin(p,y){if(Array.isArray(p)&&p.length===6&&this.transform(p[0],p[1],p[2],p[3],p[4],p[5]),y){let O=y[2]-y[0],j=y[3]-y[1],I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x",y[0]),I.setAttributeNS(null,"y",y[1]),I.setAttributeNS(null,"width",o(O)),I.setAttributeNS(null,"height",o(j)),this.current.element=I,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(p){let y=this.svgFactory.create(p.width,p.height),O=this.svgFactory.createElement("svg:defs");y.append(O),this.defs=O;let j=this.svgFactory.createElement("svg:g");return j.setAttributeNS(null,"transform",e(p.transform)),y.append(j),this.svg=j,y}_ensureClipGroup(){if(!this.current.clipGroup){let p=this.svgFactory.createElement("svg:g");p.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(p),this.current.clipGroup=p}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",e(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}i.SVGGraphics=T},(F,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.XfaText=void 0;class E{static textContent(g){let P=[],x={items:P,styles:Object.create(null)};function U(B){if(!B)return;let h=null,n=B.name;if(n==="#text")h=B.value;else if(E.shouldBuildText(n))B?.attributes?.textContent?h=B.attributes.textContent:B.value&&(h=B.value);else return;if(h!==null&&P.push({str:h}),!!B.children)for(let t of B.children)U(t)}return U(g),x}static shouldBuildText(g){return!(g==="textarea"||g==="input"||g==="option"||g==="select")}}i.XfaText=E},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TextLayerRenderTask=void 0,i.renderTextLayer=e,i.updateTextLayer=u;var r=E(1),g=E(6);let P=1e5,x=30,U=.8,B=new Map;function h(f,_){let T;if(_&&r.FeatureTest.isOffscreenCanvasSupported)T=new OffscreenCanvas(f,f).getContext("2d",{alpha:!1});else{let S=document.createElement("canvas");S.width=S.height=f,T=S.getContext("2d",{alpha:!1})}return T}function n(f,_){let T=B.get(f);if(T)return T;let S=h(x,_);S.font=`${x}px ${f}`;let p=S.measureText(""),y=p.fontBoundingBoxAscent,O=Math.abs(p.fontBoundingBoxDescent);if(y){let I=y/(y+O);return B.set(f,I),S.canvas.width=S.canvas.height=0,I}S.strokeStyle="red",S.clearRect(0,0,x,x),S.strokeText("g",0,0);let j=S.getImageData(0,0,x,x).data;O=0;for(let I=j.length-1-3;I>=0;I-=4)if(j[I]>0){O=Math.ceil(I/4/x);break}S.clearRect(0,0,x,x),S.strokeText("A",0,x),j=S.getImageData(0,0,x,x).data,y=0;for(let I=0,z=j.length;I<z;I+=4)if(j[I]>0){y=x-Math.floor(I/4/x);break}if(S.canvas.width=S.canvas.height=0,y){let I=y/(y+O);return B.set(f,I),I}return B.set(f,U),U}function t(f,_,T){let S=document.createElement("span"),p={angle:0,canvasWidth:0,hasText:_.str!=="",hasEOL:_.hasEOL,fontSize:0};f._textDivs.push(S);let y=r.Util.transform(f._transform,_.transform),O=Math.atan2(y[1],y[0]),j=T[_.fontName];j.vertical&&(O+=Math.PI/2);let I=Math.hypot(y[2],y[3]),z=I*n(j.fontFamily,f._isOffscreenCanvasSupported),X,it;O===0?(X=y[4],it=y[5]-z):(X=y[4]+z*Math.sin(O),it=y[5]-z*Math.cos(O));let tt="calc(var(--scale-factor)*",Q=S.style;f._container===f._rootContainer?(Q.left=`${(100*X/f._pageWidth).toFixed(2)}%`,Q.top=`${(100*it/f._pageHeight).toFixed(2)}%`):(Q.left=`${tt}${X.toFixed(2)}px)`,Q.top=`${tt}${it.toFixed(2)}px)`),Q.fontSize=`${tt}${I.toFixed(2)}px)`,Q.fontFamily=j.fontFamily,p.fontSize=I,S.setAttribute("role","presentation"),S.textContent=_.str,S.dir=_.dir,f._fontInspectorEnabled&&(S.dataset.fontName=_.fontName),O!==0&&(p.angle=O*(180/Math.PI));let nt=!1;if(_.str.length>1)nt=!0;else if(_.str!==" "&&_.transform[0]!==_.transform[3]){let J=Math.abs(_.transform[0]),D=Math.abs(_.transform[3]);J!==D&&Math.max(J,D)/Math.min(J,D)>1.5&&(nt=!0)}nt&&(p.canvasWidth=j.vertical?_.height:_.width),f._textDivProperties.set(S,p),f._isReadableStream&&f._layoutText(S)}function s(f){let{div:_,scale:T,properties:S,ctx:p,prevFontSize:y,prevFontFamily:O}=f,{style:j}=_,I="";if(S.canvasWidth!==0&&S.hasText){let{fontFamily:z}=j,{canvasWidth:X,fontSize:it}=S;(y!==it||O!==z)&&(p.font=`${it*T}px ${z}`,f.prevFontSize=it,f.prevFontFamily=z);let{width:tt}=p.measureText(_.textContent);tt>0&&(I=`scaleX(${X*T/tt})`)}S.angle!==0&&(I=`rotate(${S.angle}deg) ${I}`),I.length>0&&(j.transform=I)}function l(f){if(f._canceled)return;let _=f._textDivs,T=f._capability;if(_.length>P){T.resolve();return}if(!f._isReadableStream)for(let p of _)f._layoutText(p);T.resolve()}class o{constructor({textContentSource:_,container:T,viewport:S,textDivs:p,textDivProperties:y,textContentItemsStr:O,isOffscreenCanvasSupported:j}){this._textContentSource=_,this._isReadableStream=_ instanceof ReadableStream,this._container=this._rootContainer=T,this._textDivs=p||[],this._textContentItemsStr=O||[],this._isOffscreenCanvasSupported=j,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=y||new WeakMap,this._canceled=!1,this._capability=new r.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:S.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:h(0,j)};let{pageWidth:I,pageHeight:z,pageX:X,pageY:it}=S.rawDims;this._transform=[1,0,0,-1,-X,it+z],this._pageWidth=I,this._pageHeight=z,(0,g.setLayerDimensions)(T,S),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new r.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new r.AbortException("TextLayer task cancelled."))}_processItems(_,T){for(let S of _){if(S.str===void 0){if(S.type==="beginMarkedContentProps"||S.type==="beginMarkedContent"){let p=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),S.id!==null&&this._container.setAttribute("id",`${S.id}`),p.append(this._container)}else S.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(S.str),t(this,S,T)}}_layoutText(_){let T=this._layoutTextParams.properties=this._textDivProperties.get(_);if(this._layoutTextParams.div=_,s(this._layoutTextParams),T.hasText&&this._container.append(_),T.hasEOL){let S=document.createElement("br");S.setAttribute("role","presentation"),this._container.append(S)}}_render(){let _=new r.PromiseCapability,T=Object.create(null);if(this._isReadableStream){let S=()=>{this._reader.read().then(({value:p,done:y})=>{if(y){_.resolve();return}Object.assign(T,p.styles),this._processItems(p.items,T),S()},_.reject)};this._reader=this._textContentSource.getReader(),S()}else if(this._textContentSource){let{items:S,styles:p}=this._textContentSource;this._processItems(S,p),_.resolve()}else throw new Error('No "textContentSource" parameter specified.');_.promise.then(()=>{T=null,l(this)},this._capability.reject)}}i.TextLayerRenderTask=o;function e(f){!f.textContentSource&&(f.textContent||f.textContentStream)&&((0,g.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),f.textContentSource=f.textContent||f.textContentStream);let{container:_,viewport:T}=f,S=getComputedStyle(_),p=S.getPropertyValue("visibility"),y=parseFloat(S.getPropertyValue("--scale-factor"));p==="visible"&&(!y||Math.abs(y-T.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");let O=new o(f);return O._render(),O}function u({container:f,viewport:_,textDivs:T,textDivProperties:S,isOffscreenCanvasSupported:p,mustRotate:y=!0,mustRescale:O=!0}){if(y&&(0,g.setLayerDimensions)(f,{rotation:_.rotation}),O){let j=h(0,p),z={prevFontSize:null,prevFontFamily:null,div:null,scale:_.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:j};for(let X of T)z.properties=S.get(X),z.div=X,s(z)}}},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationEditorLayer=void 0;var r=E(1),g=E(4),P=E(28),x=E(33),U=E(6),B=E(34);let h=(()=>{class n{#t;#e=!1;#i=null;#s=this.pointerup.bind(this);#o=this.pointerdown.bind(this);#a=new Map;#r=!1;#l=!1;#c=!1;#n;static _initialized=!1;constructor({uiManager:s,pageIndex:l,div:o,accessibilityManager:e,annotationLayer:u,viewport:f,l10n:_}){let T=[P.FreeTextEditor,x.InkEditor,B.StampEditor];if(!n._initialized){n._initialized=!0;for(let S of T)S.initialize(_)}s.registerEditorTypes(T),this.#n=s,this.pageIndex=l,this.div=o,this.#t=e,this.#i=u,this.viewport=f,this.#n.addLayer(this)}get isEmpty(){return this.#a.size===0}updateToolbar(s){this.#n.updateToolbar(s)}updateMode(s=this.#n.getMode()){this.#p(),s===r.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),s!==r.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",s===r.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",s===r.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",s===r.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(s){if(!s&&this.#n.getMode()!==r.AnnotationEditorType.INK)return;if(!s){for(let o of this.#a.values())if(o.isEmpty()){o.setInBackground();return}}this.#d({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(s){this.#n.setEditingState(s)}addCommands(s){this.#n.addCommands(s)}enable(){this.div.style.pointerEvents="auto";let s=new Set;for(let o of this.#a.values())o.enableEditing(),o.annotationElementId&&s.add(o.annotationElementId);if(!this.#i)return;let l=this.#i.getEditableAnnotations();for(let o of l){if(o.hide(),this.#n.isDeletedAnnotationElement(o.data.id)||s.has(o.data.id))continue;let e=this.deserialize(o);e&&(this.addOrRebuild(e),e.enableEditing())}}disable(){this.#c=!0,this.div.style.pointerEvents="none";let s=new Set;for(let l of this.#a.values()){if(l.disableEditing(),!l.annotationElementId||l.serialize()!==null){s.add(l.annotationElementId);continue}this.getEditableAnnotation(l.annotationElementId)?.show(),l.remove()}if(this.#i){let l=this.#i.getEditableAnnotations();for(let o of l){let{id:e}=o.data;s.has(e)||this.#n.isDeletedAnnotationElement(e)||o.show()}}this.#p(),this.isEmpty&&(this.div.hidden=!0),this.#c=!1}getEditableAnnotation(s){return this.#i?.getEditableAnnotation(s)||null}setActiveEditor(s){this.#n.getActive()!==s&&this.#n.setActiveEditor(s)}enableClick(){this.div.addEventListener("pointerdown",this.#o),this.div.addEventListener("pointerup",this.#s)}disableClick(){this.div.removeEventListener("pointerdown",this.#o),this.div.removeEventListener("pointerup",this.#s)}attach(s){this.#a.set(s.id,s);let{annotationElementId:l}=s;l&&this.#n.isDeletedAnnotationElement(l)&&this.#n.removeDeletedAnnotationElement(s)}detach(s){this.#a.delete(s.id),this.#t?.removePointerInTextLayer(s.contentDiv),!this.#c&&s.annotationElementId&&this.#n.addDeletedAnnotationElement(s)}remove(s){this.detach(s),this.#n.removeEditor(s),s.div.contains(document.activeElement)&&setTimeout(()=>{this.#n.focusMainContainer()},0),s.div.remove(),s.isAttachedToDOM=!1,this.#l||this.addInkEditorIfNeeded(!1)}changeParent(s){s.parent!==this&&(s.annotationElementId&&(this.#n.addDeletedAnnotationElement(s.annotationElementId),g.AnnotationEditor.deleteAnnotationElement(s),s.annotationElementId=null),this.attach(s),s.parent?.detach(s),s.setParent(this),s.div&&s.isAttachedToDOM&&(s.div.remove(),this.div.append(s.div)))}add(s){if(this.changeParent(s),this.#n.addEditor(s),this.attach(s),!s.isAttachedToDOM){let l=s.render();this.div.append(l),s.isAttachedToDOM=!0}s.fixAndSetPosition(),s.onceAdded(),this.#n.addToAnnotationStorage(s)}moveEditorInDOM(s){if(!s.isAttachedToDOM)return;let{activeElement:l}=document;s.div.contains(l)&&(s._focusEventsAllowed=!1,setTimeout(()=>{s.div.contains(document.activeElement)?s._focusEventsAllowed=!0:(s.div.addEventListener("focusin",()=>{s._focusEventsAllowed=!0},{once:!0}),l.focus())},0)),s._structTreeParentId=this.#t?.moveElementInDOM(this.div,s.div,s.contentDiv,!0)}addOrRebuild(s){s.needsToBeRebuilt()?s.rebuild():this.add(s)}addUndoableEditor(s){let l=()=>s._uiManager.rebuild(s),o=()=>{s.remove()};this.addCommands({cmd:l,undo:o,mustExec:!1})}getNextId(){return this.#n.getId()}#f(s){switch(this.#n.getMode()){case r.AnnotationEditorType.FREETEXT:return new P.FreeTextEditor(s);case r.AnnotationEditorType.INK:return new x.InkEditor(s);case r.AnnotationEditorType.STAMP:return new B.StampEditor(s)}return null}pasteEditor(s,l){this.#n.updateToolbar(s),this.#n.updateMode(s);let{offsetX:o,offsetY:e}=this.#u(),u=this.getNextId(),f=this.#f(Ht({parent:this,id:u,x:o,y:e,uiManager:this.#n,isCentered:!0},l));f&&this.add(f)}deserialize(s){switch(s.annotationType??s.annotationEditorType){case r.AnnotationEditorType.FREETEXT:return P.FreeTextEditor.deserialize(s,this,this.#n);case r.AnnotationEditorType.INK:return x.InkEditor.deserialize(s,this,this.#n);case r.AnnotationEditorType.STAMP:return B.StampEditor.deserialize(s,this,this.#n)}return null}#d(s,l){let o=this.getNextId(),e=this.#f({parent:this,id:o,x:s.offsetX,y:s.offsetY,uiManager:this.#n,isCentered:l});return e&&this.add(e),e}#u(){let{x:s,y:l,width:o,height:e}=this.div.getBoundingClientRect(),u=Math.max(0,s),f=Math.max(0,l),_=Math.min(window.innerWidth,s+o),T=Math.min(window.innerHeight,l+e),S=(u+_)/2-s,p=(f+T)/2-l,[y,O]=this.viewport.rotation%180===0?[S,p]:[p,S];return{offsetX:y,offsetY:O}}addNewEditor(){this.#d(this.#u(),!0)}setSelected(s){this.#n.setSelected(s)}toggleSelected(s){this.#n.toggleSelected(s)}isSelected(s){return this.#n.isSelected(s)}unselect(s){this.#n.unselect(s)}pointerup(s){let{isMac:l}=r.FeatureTest.platform;if(!(s.button!==0||s.ctrlKey&&l)&&s.target===this.div&&this.#r){if(this.#r=!1,!this.#e){this.#e=!0;return}if(this.#n.getMode()===r.AnnotationEditorType.STAMP){this.#n.unselectAll();return}this.#d(s,!1)}}pointerdown(s){if(this.#r){this.#r=!1;return}let{isMac:l}=r.FeatureTest.platform;if(s.button!==0||s.ctrlKey&&l||s.target!==this.div)return;this.#r=!0;let o=this.#n.getActive();this.#e=!o||o.isEmpty()}findNewParent(s,l,o){let e=this.#n.findParent(l,o);return e===null||e===this?!1:(e.changeParent(s),!0)}destroy(){this.#n.getActive()?.parent===this&&(this.#n.commitOrRemove(),this.#n.setActiveEditor(null));for(let s of this.#a.values())this.#t?.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,this.#a.clear(),this.#n.removeLayer(this)}#p(){this.#l=!0;for(let s of this.#a.values())s.isEmpty()&&s.remove();this.#l=!1}render({viewport:s}){this.viewport=s,(0,U.setLayerDimensions)(this.div,s);for(let l of this.#n.getEditors(this.pageIndex))this.add(l);this.updateMode()}update({viewport:s}){this.#n.commitOrRemove(),this.viewport=s,(0,U.setLayerDimensions)(this.div,{rotation:s.rotation}),this.updateMode()}get pageDimensions(){let{pageWidth:s,pageHeight:l}=this.viewport.rawDims;return[s,l]}}return n})();i.AnnotationEditorLayer=h},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.FreeTextEditor=void 0;var r=E(1),g=E(5),P=E(4),x=E(29);let U=(()=>{class B extends P.AnnotationEditor{#t=this.editorDivBlur.bind(this);#e=this.editorDivFocus.bind(this);#i=this.editorDivInput.bind(this);#s=this.editorDivKeydown.bind(this);#o;#a="";#r=`${this.id}-editor`;#l;#c=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){let n=B.prototype,t=o=>o.isEmpty(),s=g.AnnotationEditorUIManager.TRANSLATE_SMALL,l=g.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,r.shadow)(this,"_keyboardManager",new g.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],n.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],n.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],n._translateEmpty,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],n._translateEmpty,{args:[-l,0],checker:t}],[["ArrowRight","mac+ArrowRight"],n._translateEmpty,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],n._translateEmpty,{args:[l,0],checker:t}],[["ArrowUp","mac+ArrowUp"],n._translateEmpty,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],n._translateEmpty,{args:[0,-l],checker:t}],[["ArrowDown","mac+ArrowDown"],n._translateEmpty,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],n._translateEmpty,{args:[0,l],checker:t}]]))}static _type="freetext";constructor(n){super(Yt(Ht({},n),{name:"freeTextEditor"})),this.#o=n.color||B._defaultColor||P.AnnotationEditor._defaultLineColor,this.#l=n.fontSize||B._defaultFontSize}static initialize(n){P.AnnotationEditor.initialize(n,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});let t=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(t.getPropertyValue("--freetext-padding"))}static updateDefaultParams(n,t){switch(n){case r.AnnotationEditorParamsType.FREETEXT_SIZE:B._defaultFontSize=t;break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:B._defaultColor=t;break}}updateParams(n,t){switch(n){case r.AnnotationEditorParamsType.FREETEXT_SIZE:this.#n(t);break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:this.#f(t);break}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,B._defaultFontSize],[r.AnnotationEditorParamsType.FREETEXT_COLOR,B._defaultColor||P.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,this.#l],[r.AnnotationEditorParamsType.FREETEXT_COLOR,this.#o]]}#n(n){let t=l=>{this.editorDiv.style.fontSize=`calc(${l}px * var(--scale-factor))`,this.translate(0,-(l-this.#l)*this.parentScale),this.#l=l,this.#u()},s=this.#l;this.addCommands({cmd:()=>{t(n)},undo:()=>{t(s)},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#f(n){let t=this.#o;this.addCommands({cmd:()=>{this.#o=this.editorDiv.style.color=n},undo:()=>{this.#o=this.editorDiv.style.color=t},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(n,t){this._uiManager.translateSelectedEditors(n,t,!0)}getInitialTranslation(){let n=this.parentScale;return[-B._internalPadding*n,-(B._internalPadding+this.#l)*n]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(r.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#s),this.editorDiv.addEventListener("focus",this.#e),this.editorDiv.addEventListener("blur",this.#t),this.editorDiv.addEventListener("input",this.#i))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#r),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#s),this.editorDiv.removeEventListener("focus",this.#e),this.editorDiv.removeEventListener("blur",this.#t),this.editorDiv.removeEventListener("input",this.#i),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(n){this._focusEventsAllowed&&(super.focusin(n),n.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){if(this.width){this.#m();return}this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}#d(){let n=this.editorDiv.getElementsByTagName("div");if(n.length===0)return this.editorDiv.innerText;let t=[];for(let s of n)t.push(s.innerText.replace(/\r\n?|\n/,""));return t.join(`
`)}#u(){let[n,t]=this.parentDimensions,s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{let{currentLayer:l,div:o}=this,e=o.style.display;o.style.display="hidden",l.div.append(this.div),s=o.getBoundingClientRect(),o.remove(),o.style.display=e}this.rotation%180===this.parentRotation%180?(this.width=s.width/n,this.height=s.height/t):(this.width=s.height/n,this.height=s.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();let n=this.#a,t=this.#a=this.#d().trimEnd();if(n===t)return;let s=l=>{if(this.#a=l,!l){this.remove();return}this.#p(),this._uiManager.rebuild(this),this.#u()};this.addCommands({cmd:()=>{s(t)},undo:()=>{s(n)},mustExec:!1}),this.#u()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(n){this.enterInEditMode()}keydown(n){n.target===this.div&&n.key==="Enter"&&(this.enterInEditMode(),n.preventDefault())}editorDivKeydown(n){B._keyboardManager.exec(this,n)}editorDivFocus(n){this.isEditing=!0}editorDivBlur(n){this.isEditing=!1}editorDivInput(n){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let n,t;this.width&&(n=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#r),this.enableEditing(),P.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(l=>this.editorDiv?.setAttribute("aria-label",l)),P.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(l=>this.editorDiv?.setAttribute("default-content",l)),this.editorDiv.contentEditable=!0;let{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#l}px * var(--scale-factor))`,s.color=this.#o,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,g.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){let[l,o]=this.parentDimensions;if(this.annotationElementId){let{position:e}=this.#c,[u,f]=this.getInitialTranslation();[u,f]=this.pageTranslationToScreen(u,f);let[_,T]=this.pageDimensions,[S,p]=this.pageTranslation,y,O;switch(this.rotation){case 0:y=n+(e[0]-S)/_,O=t+this.height-(e[1]-p)/T;break;case 90:y=n+(e[0]-S)/_,O=t-(e[1]-p)/T,[u,f]=[f,-u];break;case 180:y=n-this.width+(e[0]-S)/_,O=t-(e[1]-p)/T,[u,f]=[-u,-f];break;case 270:y=n+(e[0]-S-this.height*T)/_,O=t+(e[1]-p-this.width*_)/T,[u,f]=[-f,u];break}this.setAt(y*l,O*o,u,f)}else this.setAt(n*l,t*o,this.width*l,this.height*o);this.#p(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}#p(){if(this.editorDiv.replaceChildren(),!!this.#a)for(let n of this.#a.split(`
`)){let t=document.createElement("div");t.append(n?document.createTextNode(n):document.createElement("br")),this.editorDiv.append(t)}}get contentDiv(){return this.editorDiv}static deserialize(n,t,s){let l=null;if(n instanceof x.FreeTextAnnotationElement){let{data:{defaultAppearanceData:{fontSize:e,fontColor:u},rect:f,rotation:_,id:T},textContent:S,textPosition:p,parent:{page:{pageNumber:y}}}=n;if(!S||S.length===0)return null;l=n={annotationType:r.AnnotationEditorType.FREETEXT,color:Array.from(u),fontSize:e,value:S.join(`
`),position:p,pageIndex:y-1,rect:f,rotation:_,id:T,deleted:!1}}let o=super.deserialize(n,t,s);return o.#l=n.fontSize,o.#o=r.Util.makeHexColor(...n.color),o.#a=n.value,o.annotationElementId=n.id||null,o.#c=l,o}serialize(n=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};let t=B._internalPadding*this.parentScale,s=this.getRect(t,t),l=P.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#o),o={annotationType:r.AnnotationEditorType.FREETEXT,color:l,fontSize:this.#l,value:this.#a,pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return n?o:this.annotationElementId&&!this.#_(o)?null:(o.id=this.annotationElementId,o)}#_(n){let{value:t,fontSize:s,color:l,rect:o,pageIndex:e}=this.#c;return n.value!==t||n.fontSize!==s||n.rect.some((u,f)=>Math.abs(u-o[f])>=1)||n.color.some((u,f)=>u!==l[f])||n.pageIndex!==e}#m(n=!1){if(!this.annotationElementId)return;if(this.#u(),!n&&(this.width===0||this.height===0)){setTimeout(()=>this.#m(!0),0);return}let t=B._internalPadding*this.parentScale;this.#c.rect=this.getRect(t,t)}}return B})();i.FreeTextEditor=U},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.StampAnnotationElement=i.InkAnnotationElement=i.FreeTextAnnotationElement=i.AnnotationLayer=void 0;var r=E(1),g=E(6),P=E(3),x=E(30),U=E(31),B=E(32);let h=1e3,n=9,t=new WeakSet;function s(w){return{width:w[2]-w[0],height:w[3]-w[1]}}class l{static create(a){switch(a.data.annotationType){case r.AnnotationType.LINK:return new e(a);case r.AnnotationType.TEXT:return new u(a);case r.AnnotationType.WIDGET:switch(a.data.fieldType){case"Tx":return new _(a);case"Btn":return a.data.radioButton?new p(a):a.data.checkBox?new S(a):new y(a);case"Ch":return new O(a);case"Sig":return new T(a)}return new f(a);case r.AnnotationType.POPUP:return new j(a);case r.AnnotationType.FREETEXT:return new z(a);case r.AnnotationType.LINE:return new X(a);case r.AnnotationType.SQUARE:return new it(a);case r.AnnotationType.CIRCLE:return new tt(a);case r.AnnotationType.POLYLINE:return new Q(a);case r.AnnotationType.CARET:return new J(a);case r.AnnotationType.INK:return new D(a);case r.AnnotationType.POLYGON:return new nt(a);case r.AnnotationType.HIGHLIGHT:return new b(a);case r.AnnotationType.UNDERLINE:return new c(a);case r.AnnotationType.SQUIGGLY:return new d(a);case r.AnnotationType.STRIKEOUT:return new A(a);case r.AnnotationType.STAMP:return new M(a);case r.AnnotationType.FILEATTACHMENT:return new R(a);default:return new o(a)}}}class o{#t=!1;constructor(a,{isRenderable:m=!1,ignoreBorder:v=!1,createQuadrilaterals:C=!1}={}){this.isRenderable=m,this.data=a.data,this.layer=a.layer,this.linkService=a.linkService,this.downloadManager=a.downloadManager,this.imageResourcesPath=a.imageResourcesPath,this.renderForms=a.renderForms,this.svgFactory=a.svgFactory,this.annotationStorage=a.annotationStorage,this.enableScripting=a.enableScripting,this.hasJSActions=a.hasJSActions,this._fieldObjects=a.fieldObjects,this.parent=a.parent,m&&(this.container=this._createContainer(v)),C&&this._createQuadrilaterals()}static _hasPopupData({titleObj:a,contentsObj:m,richText:v}){return!!(a?.str||m?.str||v?.str)}get hasPopupData(){return o._hasPopupData(this.data)}_createContainer(a){let{data:m,parent:{page:v,viewport:C}}=this,k=document.createElement("section");k.setAttribute("data-annotation-id",m.id),this instanceof f||(k.tabIndex=h),k.style.zIndex=this.parent.zIndex++,this.data.popupRef&&k.setAttribute("aria-haspopup","dialog"),m.noRotate&&k.classList.add("norotate");let{pageWidth:N,pageHeight:W,pageX:V,pageY:st}=C.rawDims;if(!m.rect||this instanceof j){let{rotation:Z}=m;return!m.hasOwnCanvas&&Z!==0&&this.setRotation(Z,k),k}let{width:q,height:$}=s(m.rect),Y=r.Util.normalizeRect([m.rect[0],v.view[3]-m.rect[1]+v.view[1],m.rect[2],v.view[3]-m.rect[3]+v.view[1]]);if(!a&&m.borderStyle.width>0){k.style.borderWidth=`${m.borderStyle.width}px`;let Z=m.borderStyle.horizontalCornerRadius,rt=m.borderStyle.verticalCornerRadius;if(Z>0||rt>0){let lt=`calc(${Z}px * var(--scale-factor)) / calc(${rt}px * var(--scale-factor))`;k.style.borderRadius=lt}else if(this instanceof p){let lt=`calc(${q}px * var(--scale-factor)) / calc(${$}px * var(--scale-factor))`;k.style.borderRadius=lt}switch(m.borderStyle.style){case r.AnnotationBorderStyleType.SOLID:k.style.borderStyle="solid";break;case r.AnnotationBorderStyleType.DASHED:k.style.borderStyle="dashed";break;case r.AnnotationBorderStyleType.BEVELED:(0,r.warn)("Unimplemented border style: beveled");break;case r.AnnotationBorderStyleType.INSET:(0,r.warn)("Unimplemented border style: inset");break;case r.AnnotationBorderStyleType.UNDERLINE:k.style.borderBottomStyle="solid";break;default:break}let ot=m.borderColor||null;ot?(this.#t=!0,k.style.borderColor=r.Util.makeHexColor(ot[0]|0,ot[1]|0,ot[2]|0)):k.style.borderWidth=0}k.style.left=`${100*(Y[0]-V)/N}%`,k.style.top=`${100*(Y[1]-st)/W}%`;let{rotation:K}=m;return m.hasOwnCanvas||K===0?(k.style.width=`${100*q/N}%`,k.style.height=`${100*$/W}%`):this.setRotation(K,k),k}setRotation(a,m=this.container){if(!this.data.rect)return;let{pageWidth:v,pageHeight:C}=this.parent.viewport.rawDims,{width:k,height:N}=s(this.data.rect),W,V;a%180===0?(W=100*k/v,V=100*N/C):(W=100*N/v,V=100*k/C),m.style.width=`${W}%`,m.style.height=`${V}%`,m.setAttribute("data-main-rotation",(360-a)%360)}get _commonActions(){let a=(m,v,C)=>{let k=C.detail[m],N=k[0],W=k.slice(1);C.target.style[v]=x.ColorConverters[`${N}_HTML`](W),this.annotationStorage.setValue(this.data.id,{[v]:x.ColorConverters[`${N}_rgb`](W)})};return(0,r.shadow)(this,"_commonActions",{display:m=>{let{display:v}=m.detail,C=v%2===1;this.container.style.visibility=C?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:C,noPrint:v===1||v===2})},print:m=>{this.annotationStorage.setValue(this.data.id,{noPrint:!m.detail.print})},hidden:m=>{let{hidden:v}=m.detail;this.container.style.visibility=v?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:v,noView:v})},focus:m=>{setTimeout(()=>m.target.focus({preventScroll:!1}),0)},userName:m=>{m.target.title=m.detail.userName},readonly:m=>{m.target.disabled=m.detail.readonly},required:m=>{this._setRequired(m.target,m.detail.required)},bgColor:m=>{a("bgColor","backgroundColor",m)},fillColor:m=>{a("fillColor","backgroundColor",m)},fgColor:m=>{a("fgColor","color",m)},textColor:m=>{a("textColor","color",m)},borderColor:m=>{a("borderColor","borderColor",m)},strokeColor:m=>{a("strokeColor","borderColor",m)},rotation:m=>{let v=m.detail.rotation;this.setRotation(v),this.annotationStorage.setValue(this.data.id,{rotation:v})}})}_dispatchEventFromSandbox(a,m){let v=this._commonActions;for(let C of Object.keys(m.detail))(a[C]||v[C])?.(m)}_setDefaultPropertiesFromJS(a){if(!this.enableScripting)return;let m=this.annotationStorage.getRawValue(this.data.id);if(!m)return;let v=this._commonActions;for(let[C,k]of Object.entries(m)){let N=v[C];if(N){let W={detail:{[C]:k},target:a};N(W),delete m[C]}}}_createQuadrilaterals(){if(!this.container)return;let{quadPoints:a}=this.data;if(!a)return;let[m,v,C,k]=this.data.rect;if(a.length===1){let[,{x:rt,y:ot},{x:lt,y:ct}]=a[0];if(C===rt&&k===ot&&m===lt&&v===ct)return}let{style:N}=this.container,W;if(this.#t){let{borderColor:rt,borderWidth:ot}=N;N.borderWidth=0,W=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${rt}" stroke-width="${ot}">`],this.container.classList.add("hasBorder")}let V=C-m,st=k-v,{svgFactory:q}=this,$=q.createElement("svg");$.classList.add("quadrilateralsContainer"),$.setAttribute("width",0),$.setAttribute("height",0);let Y=q.createElement("defs");$.append(Y);let K=q.createElement("clipPath"),Z=`clippath_${this.data.id}`;K.setAttribute("id",Z),K.setAttribute("clipPathUnits","objectBoundingBox"),Y.append(K);for(let[,{x:rt,y:ot},{x:lt,y:ct}]of a){let dt=q.createElement("rect"),ft=(lt-m)/V,yt=(k-ot)/st,_t=(rt-lt)/V,Ft=(ot-ct)/st;dt.setAttribute("x",ft),dt.setAttribute("y",yt),dt.setAttribute("width",_t),dt.setAttribute("height",Ft),K.append(dt),W?.push(`<rect vector-effect="non-scaling-stroke" x="${ft}" y="${yt}" width="${_t}" height="${Ft}"/>`)}this.#t&&(W.push("</g></svg>')"),N.backgroundImage=W.join("")),this.container.append($),this.container.style.clipPath=`url(#${Z})`}_createPopup(){let{container:a,data:m}=this;a.setAttribute("aria-haspopup","dialog");let v=new j({data:{color:m.color,titleObj:m.titleObj,modificationDate:m.modificationDate,contentsObj:m.contentsObj,richText:m.richText,parentRect:m.rect,borderStyle:0,id:`popup_${m.id}`,rotation:m.rotation},parent:this.parent,elements:[this]});this.parent.div.append(v.render())}render(){(0,r.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(a,m=null){let v=[];if(this._fieldObjects){let C=this._fieldObjects[a];if(C)for(let{page:k,id:N,exportValues:W}of C){if(k===-1||N===m)continue;let V=typeof W=="string"?W:null,st=document.querySelector(`[data-element-id="${N}"]`);if(st&&!t.has(st)){(0,r.warn)(`_getElementsByName - element not allowed: ${N}`);continue}v.push({id:N,exportValue:V,domElement:st})}return v}for(let C of document.getElementsByName(a)){let{exportValue:k}=C,N=C.getAttribute("data-element-id");N!==m&&t.has(C)&&v.push({id:N,exportValue:k,domElement:C})}return v}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){let a=this.getElementsToTriggerPopup();if(Array.isArray(a))for(let m of a)m.classList.add("highlightArea");else a.classList.add("highlightArea")}_editOnDoubleClick(){let{annotationEditorType:a,data:{id:m}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:a,editId:m})})}}class e extends o{constructor(a,m=null){super(a,{isRenderable:!0,ignoreBorder:!!m?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=a.data.isTooltipOnly}render(){let{data:a,linkService:m}=this,v=document.createElement("a");v.setAttribute("data-element-id",a.id);let C=!1;return a.url?(m.addLinkAttributes(v,a.url,a.newWindow),C=!0):a.action?(this._bindNamedAction(v,a.action),C=!0):a.attachment?(this._bindAttachment(v,a.attachment),C=!0):a.setOCGState?(this.#e(v,a.setOCGState),C=!0):a.dest?(this._bindLink(v,a.dest),C=!0):(a.actions&&(a.actions.Action||a.actions["Mouse Up"]||a.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(v,a),C=!0),a.resetForm?(this._bindResetFormAction(v,a.resetForm),C=!0):this.isTooltipOnly&&!C&&(this._bindLink(v,""),C=!0)),this.container.classList.add("linkAnnotation"),C&&this.container.append(v),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(a,m){a.href=this.linkService.getDestinationHash(m),a.onclick=()=>(m&&this.linkService.goToDestination(m),!1),(m||m==="")&&this.#t()}_bindNamedAction(a,m){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeNamedAction(m),!1),this.#t()}_bindAttachment(a,m){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,m.content,m.filename),!1),this.#t()}#e(a,m){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeSetOCGState(m),!1),this.#t()}_bindJSAction(a,m){a.href=this.linkService.getAnchorUrl("");let v=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(let C of Object.keys(m.actions)){let k=v.get(C);k&&(a[k]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m.id,name:C}}),!1))}a.onclick||(a.onclick=()=>!1),this.#t()}_bindResetFormAction(a,m){let v=a.onclick;if(v||(a.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){(0,r.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),v||(a.onclick=()=>!1);return}a.onclick=()=>{v?.();let{fields:C,refs:k,include:N}=m,W=[];if(C.length!==0||k.length!==0){let q=new Set(k);for(let $ of C){let Y=this._fieldObjects[$]||[];for(let{id:K}of Y)q.add(K)}for(let $ of Object.values(this._fieldObjects))for(let Y of $)q.has(Y.id)===N&&W.push(Y)}else for(let q of Object.values(this._fieldObjects))W.push(...q);let V=this.annotationStorage,st=[];for(let q of W){let{id:$}=q;switch(st.push($),q.type){case"text":{let K=q.defaultValue||"";V.setValue($,{value:K});break}case"checkbox":case"radiobutton":{let K=q.defaultValue===q.exportValues;V.setValue($,{value:K});break}case"combobox":case"listbox":{let K=q.defaultValue||"";V.setValue($,{value:K});break}default:continue}let Y=document.querySelector(`[data-element-id="${$}"]`);if(Y){if(!t.has(Y)){(0,r.warn)(`_bindResetFormAction - element not allowed: ${$}`);continue}}else continue;Y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:st,name:"ResetForm"}}),!1}}}class u extends o{constructor(a){super(a,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");let a=document.createElement("img");return a.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",a.alt="[{{type}} Annotation]",a.dataset.l10nId="text_annotation_type",a.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(a),this.container}}class f extends o{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(a){this.data.hasOwnCanvas&&(a.previousSibling?.nodeName==="CANVAS"&&(a.previousSibling.hidden=!0),a.hidden=!1)}_getKeyModifier(a){let{isWin:m,isMac:v}=r.FeatureTest.platform;return m&&a.ctrlKey||v&&a.metaKey}_setEventListener(a,m,v,C,k){v.includes("mouse")?a.addEventListener(v,N=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:C,value:k(N),shift:N.shiftKey,modifier:this._getKeyModifier(N)}})}):a.addEventListener(v,N=>{if(v==="blur"){if(!m.focused||!N.relatedTarget)return;m.focused=!1}else if(v==="focus"){if(m.focused)return;m.focused=!0}k&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:C,value:k(N)}})})}_setEventListeners(a,m,v,C){for(let[k,N]of v)(N==="Action"||this.data.actions?.[N])&&((N==="Focus"||N==="Blur")&&(m||={focused:!1}),this._setEventListener(a,m,k,N,C),N==="Focus"&&!this.data.actions?.Blur?this._setEventListener(a,m,"blur","Blur",null):N==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(a,m,"focus","Focus",null))}_setBackgroundColor(a){let m=this.data.backgroundColor||null;a.style.backgroundColor=m===null?"transparent":r.Util.makeHexColor(m[0],m[1],m[2])}_setTextStyle(a){let m=["left","center","right"],{fontColor:v}=this.data.defaultAppearanceData,C=this.data.defaultAppearanceData.fontSize||n,k=a.style,N,W=2,V=st=>Math.round(10*st)/10;if(this.data.multiLine){let st=Math.abs(this.data.rect[3]-this.data.rect[1]-W),q=Math.round(st/(r.LINE_FACTOR*C))||1,$=st/q;N=Math.min(C,V($/r.LINE_FACTOR))}else{let st=Math.abs(this.data.rect[3]-this.data.rect[1]-W);N=Math.min(C,V(st/r.LINE_FACTOR))}k.fontSize=`calc(${N}px * var(--scale-factor))`,k.color=r.Util.makeHexColor(v[0],v[1],v[2]),this.data.textAlignment!==null&&(k.textAlign=m[this.data.textAlignment])}_setRequired(a,m){m?a.setAttribute("required",!0):a.removeAttribute("required"),a.setAttribute("aria-required",m)}}class _ extends f{constructor(a){let m=a.renderForms||!a.data.hasAppearance&&!!a.data.fieldValue;super(a,{isRenderable:m})}setPropertyOnSiblings(a,m,v,C){let k=this.annotationStorage;for(let N of this._getElementsByName(a.name,a.id))N.domElement&&(N.domElement[m]=v),k.setValue(N.id,{[C]:v})}render(){let a=this.annotationStorage,m=this.data.id;this.container.classList.add("textWidgetAnnotation");let v=null;if(this.renderForms){let C=a.getValue(m,{value:this.data.fieldValue}),k=C.value||"",N=a.getValue(m,{charLimit:this.data.maxLen}).charLimit;N&&k.length>N&&(k=k.slice(0,N));let W=C.formattedValue||this.data.textContent?.join(`
`)||null;W&&this.data.comb&&(W=W.replaceAll(/\s+/g,""));let V={userValue:k,formattedValue:W,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(v=document.createElement("textarea"),v.textContent=W??k,this.data.doNotScroll&&(v.style.overflowY="hidden")):(v=document.createElement("input"),v.type="text",v.setAttribute("value",W??k),this.data.doNotScroll&&(v.style.overflowX="hidden")),this.data.hasOwnCanvas&&(v.hidden=!0),t.add(v),v.setAttribute("data-element-id",m),v.disabled=this.data.readOnly,v.name=this.data.fieldName,v.tabIndex=h,this._setRequired(v,this.data.required),N&&(v.maxLength=N),v.addEventListener("input",q=>{a.setValue(m,{value:q.target.value}),this.setPropertyOnSiblings(v,"value",q.target.value,"value"),V.formattedValue=null}),v.addEventListener("resetform",q=>{let $=this.data.defaultFieldValue??"";v.value=V.userValue=$,V.formattedValue=null});let st=q=>{let{formattedValue:$}=V;$!=null&&(q.target.value=$),q.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){v.addEventListener("focus",$=>{if(V.focused)return;let{target:Y}=$;V.userValue&&(Y.value=V.userValue),V.lastCommittedValue=Y.value,V.commitKey=1,V.focused=!0}),v.addEventListener("updatefromsandbox",$=>{this.showElementAndHideCanvas($.target);let Y={value(K){V.userValue=K.detail.value??"",a.setValue(m,{value:V.userValue.toString()}),K.target.value=V.userValue},formattedValue(K){let{formattedValue:Z}=K.detail;V.formattedValue=Z,Z!=null&&K.target!==document.activeElement&&(K.target.value=Z),a.setValue(m,{formattedValue:Z})},selRange(K){K.target.setSelectionRange(...K.detail.selRange)},charLimit:K=>{let{charLimit:Z}=K.detail,{target:rt}=K;if(Z===0){rt.removeAttribute("maxLength");return}rt.setAttribute("maxLength",Z);let ot=V.userValue;!ot||ot.length<=Z||(ot=ot.slice(0,Z),rt.value=V.userValue=ot,a.setValue(m,{value:ot}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m,name:"Keystroke",value:ot,willCommit:!0,commitKey:1,selStart:rt.selectionStart,selEnd:rt.selectionEnd}}))}};this._dispatchEventFromSandbox(Y,$)}),v.addEventListener("keydown",$=>{V.commitKey=1;let Y=-1;if($.key==="Escape"?Y=0:$.key==="Enter"&&!this.data.multiLine?Y=2:$.key==="Tab"&&(V.commitKey=3),Y===-1)return;let{value:K}=$.target;V.lastCommittedValue!==K&&(V.lastCommittedValue=K,V.userValue=K,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m,name:"Keystroke",value:K,willCommit:!0,commitKey:Y,selStart:$.target.selectionStart,selEnd:$.target.selectionEnd}}))});let q=st;st=null,v.addEventListener("blur",$=>{if(!V.focused||!$.relatedTarget)return;V.focused=!1;let{value:Y}=$.target;V.userValue=Y,V.lastCommittedValue!==Y&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m,name:"Keystroke",value:Y,willCommit:!0,commitKey:V.commitKey,selStart:$.target.selectionStart,selEnd:$.target.selectionEnd}}),q($)}),this.data.actions?.Keystroke&&v.addEventListener("beforeinput",$=>{V.lastCommittedValue=null;let{data:Y,target:K}=$,{value:Z,selectionStart:rt,selectionEnd:ot}=K,lt=rt,ct=ot;switch($.inputType){case"deleteWordBackward":{let dt=Z.substring(0,rt).match(/\w*[^\w]*$/);dt&&(lt-=dt[0].length);break}case"deleteWordForward":{let dt=Z.substring(rt).match(/^[^\w]*\w*/);dt&&(ct+=dt[0].length);break}case"deleteContentBackward":rt===ot&&(lt-=1);break;case"deleteContentForward":rt===ot&&(ct+=1);break}$.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m,name:"Keystroke",value:Z,change:Y||"",willCommit:!1,selStart:lt,selEnd:ct}})}),this._setEventListeners(v,V,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],$=>$.target.value)}if(st&&v.addEventListener("blur",st),this.data.comb){let $=(this.data.rect[2]-this.data.rect[0])/N;v.classList.add("comb"),v.style.letterSpacing=`calc(${$}px * var(--scale-factor) - 1ch)`}}else v=document.createElement("div"),v.textContent=this.data.fieldValue,v.style.verticalAlign="middle",v.style.display="table-cell";return this._setTextStyle(v),this._setBackgroundColor(v),this._setDefaultPropertiesFromJS(v),this.container.append(v),this.container}}class T extends f{constructor(a){super(a,{isRenderable:!!a.data.hasOwnCanvas})}}class S extends f{constructor(a){super(a,{isRenderable:a.renderForms})}render(){let a=this.annotationStorage,m=this.data,v=m.id,C=a.getValue(v,{value:m.exportValue===m.fieldValue}).value;typeof C=="string"&&(C=C!=="Off",a.setValue(v,{value:C})),this.container.classList.add("buttonWidgetAnnotation","checkBox");let k=document.createElement("input");return t.add(k),k.setAttribute("data-element-id",v),k.disabled=m.readOnly,this._setRequired(k,this.data.required),k.type="checkbox",k.name=m.fieldName,C&&k.setAttribute("checked",!0),k.setAttribute("exportValue",m.exportValue),k.tabIndex=h,k.addEventListener("change",N=>{let{name:W,checked:V}=N.target;for(let st of this._getElementsByName(W,v)){let q=V&&st.exportValue===m.exportValue;st.domElement&&(st.domElement.checked=q),a.setValue(st.id,{value:q})}a.setValue(v,{value:V})}),k.addEventListener("resetform",N=>{let W=m.defaultFieldValue||"Off";N.target.checked=W===m.exportValue}),this.enableScripting&&this.hasJSActions&&(k.addEventListener("updatefromsandbox",N=>{let W={value(V){V.target.checked=V.detail.value!=="Off",a.setValue(v,{value:V.target.checked})}};this._dispatchEventFromSandbox(W,N)}),this._setEventListeners(k,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],N=>N.target.checked)),this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class p extends f{constructor(a){super(a,{isRenderable:a.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");let a=this.annotationStorage,m=this.data,v=m.id,C=a.getValue(v,{value:m.fieldValue===m.buttonValue}).value;typeof C=="string"&&(C=C!==m.buttonValue,a.setValue(v,{value:C}));let k=document.createElement("input");if(t.add(k),k.setAttribute("data-element-id",v),k.disabled=m.readOnly,this._setRequired(k,this.data.required),k.type="radio",k.name=m.fieldName,C&&k.setAttribute("checked",!0),k.tabIndex=h,k.addEventListener("change",N=>{let{name:W,checked:V}=N.target;for(let st of this._getElementsByName(W,v))a.setValue(st.id,{value:!1});a.setValue(v,{value:V})}),k.addEventListener("resetform",N=>{let W=m.defaultFieldValue;N.target.checked=W!=null&&W===m.buttonValue}),this.enableScripting&&this.hasJSActions){let N=m.buttonValue;k.addEventListener("updatefromsandbox",W=>{let V={value:st=>{let q=N===st.detail.value;for(let $ of this._getElementsByName(st.target.name)){let Y=q&&$.id===v;$.domElement&&($.domElement.checked=Y),a.setValue($.id,{value:Y})}}};this._dispatchEventFromSandbox(V,W)}),this._setEventListeners(k,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],W=>W.target.checked)}return this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class y extends e{constructor(a){super(a,{ignoreBorder:a.data.hasAppearance})}render(){let a=super.render();a.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(a.title=this.data.alternativeText);let m=a.lastChild;return this.enableScripting&&this.hasJSActions&&m&&(this._setDefaultPropertiesFromJS(m),m.addEventListener("updatefromsandbox",v=>{this._dispatchEventFromSandbox({},v)})),a}}class O extends f{constructor(a){super(a,{isRenderable:a.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");let a=this.annotationStorage,m=this.data.id,v=a.getValue(m,{value:this.data.fieldValue}),C=document.createElement("select");t.add(C),C.setAttribute("data-element-id",m),C.disabled=this.data.readOnly,this._setRequired(C,this.data.required),C.name=this.data.fieldName,C.tabIndex=h;let k=this.data.combo&&this.data.options.length>0;this.data.combo||(C.size=this.data.options.length,this.data.multiSelect&&(C.multiple=!0)),C.addEventListener("resetform",q=>{let $=this.data.defaultFieldValue;for(let Y of C.options)Y.selected=Y.value===$});for(let q of this.data.options){let $=document.createElement("option");$.textContent=q.displayValue,$.value=q.exportValue,v.value.includes(q.exportValue)&&($.setAttribute("selected",!0),k=!1),C.append($)}let N=null;if(k){let q=document.createElement("option");q.value=" ",q.setAttribute("hidden",!0),q.setAttribute("selected",!0),C.prepend(q),N=()=>{q.remove(),C.removeEventListener("input",N),N=null},C.addEventListener("input",N)}let W=q=>{let $=q?"value":"textContent",{options:Y,multiple:K}=C;return K?Array.prototype.filter.call(Y,Z=>Z.selected).map(Z=>Z[$]):Y.selectedIndex===-1?null:Y[Y.selectedIndex][$]},V=W(!1),st=q=>{let $=q.target.options;return Array.prototype.map.call($,Y=>({displayValue:Y.textContent,exportValue:Y.value}))};return this.enableScripting&&this.hasJSActions?(C.addEventListener("updatefromsandbox",q=>{let $={value(Y){N?.();let K=Y.detail.value,Z=new Set(Array.isArray(K)?K:[K]);for(let rt of C.options)rt.selected=Z.has(rt.value);a.setValue(m,{value:W(!0)}),V=W(!1)},multipleSelection(Y){C.multiple=!0},remove(Y){let K=C.options,Z=Y.detail.remove;K[Z].selected=!1,C.remove(Z),K.length>0&&Array.prototype.findIndex.call(K,ot=>ot.selected)===-1&&(K[0].selected=!0),a.setValue(m,{value:W(!0),items:st(Y)}),V=W(!1)},clear(Y){for(;C.length!==0;)C.remove(0);a.setValue(m,{value:null,items:[]}),V=W(!1)},insert(Y){let{index:K,displayValue:Z,exportValue:rt}=Y.detail.insert,ot=C.children[K],lt=document.createElement("option");lt.textContent=Z,lt.value=rt,ot?ot.before(lt):C.append(lt),a.setValue(m,{value:W(!0),items:st(Y)}),V=W(!1)},items(Y){let{items:K}=Y.detail;for(;C.length!==0;)C.remove(0);for(let Z of K){let{displayValue:rt,exportValue:ot}=Z,lt=document.createElement("option");lt.textContent=rt,lt.value=ot,C.append(lt)}C.options.length>0&&(C.options[0].selected=!0),a.setValue(m,{value:W(!0),items:st(Y)}),V=W(!1)},indices(Y){let K=new Set(Y.detail.indices);for(let Z of Y.target.options)Z.selected=K.has(Z.index);a.setValue(m,{value:W(!0)}),V=W(!1)},editable(Y){Y.target.disabled=!Y.detail.editable}};this._dispatchEventFromSandbox($,q)}),C.addEventListener("input",q=>{let $=W(!0);a.setValue(m,{value:$}),q.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m,name:"Keystroke",value:V,changeEx:$,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(C,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],q=>q.target.value)):C.addEventListener("input",function(q){a.setValue(m,{value:W(!0)})}),this.data.combo&&this._setTextStyle(C),this._setBackgroundColor(C),this._setDefaultPropertiesFromJS(C),this.container.append(C),this.container}}class j extends o{constructor(a){let{data:m,elements:v}=a;super(a,{isRenderable:o._hasPopupData(m)}),this.elements=v}render(){this.container.classList.add("popupAnnotation");let a=new I({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),m=[];for(let v of this.elements)v.popup=a,m.push(v.data.id),v.addHighlightArea();return this.container.setAttribute("aria-controls",m.map(v=>`${r.AnnotationPrefix}${v}`).join(",")),this.container}}class I{#t=null;#e=this.#h.bind(this);#i=this.#S.bind(this);#s=this.#E.bind(this);#o=this.#b.bind(this);#a=null;#r=null;#l=null;#c=null;#n=null;#f=null;#d=!1;#u=null;#p=null;#_=null;#m=null;#g=!1;constructor({container:a,color:m,elements:v,titleObj:C,modificationDate:k,contentsObj:N,richText:W,parent:V,rect:st,parentRect:q,open:$}){this.#r=a,this.#m=C,this.#l=N,this.#_=W,this.#n=V,this.#a=m,this.#p=st,this.#f=q,this.#c=v;let Y=g.PDFDateString.toDateObject(k);Y&&(this.#t=V.l10n.get("annotation_date_string",{date:Y.toLocaleDateString(),time:Y.toLocaleTimeString()})),this.trigger=v.flatMap(K=>K.getElementsToTriggerPopup());for(let K of this.trigger)K.addEventListener("click",this.#o),K.addEventListener("mouseenter",this.#s),K.addEventListener("mouseleave",this.#i),K.classList.add("popupTriggerArea");for(let K of v)K.container?.addEventListener("keydown",this.#e);this.#r.hidden=!0,$&&this.#b()}render(){if(this.#u)return;let{page:{view:a},viewport:{rawDims:{pageWidth:m,pageHeight:v,pageX:C,pageY:k}}}=this.#n,N=this.#u=document.createElement("div");if(N.className="popup",this.#a){let dt=N.style.outlineColor=r.Util.makeHexColor(...this.#a);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?N.style.backgroundColor=`color-mix(in srgb, ${dt} 30%, white)`:N.style.backgroundColor=r.Util.makeHexColor(...this.#a.map(yt=>Math.floor(.7*(255-yt)+yt)))}let W=document.createElement("span");W.className="header";let V=document.createElement("h1");if(W.append(V),{dir:V.dir,str:V.textContent}=this.#m,N.append(W),this.#t){let dt=document.createElement("span");dt.classList.add("popupDate"),this.#t.then(ft=>{dt.textContent=ft}),W.append(dt)}let st=this.#l,q=this.#_;if(q?.str&&(!st?.str||st.str===q.str))B.XfaLayer.render({xfaHtml:q.html,intent:"richText",div:N}),N.lastChild.classList.add("richText","popupContent");else{let dt=this._formatContents(st);N.append(dt)}let $=!!this.#f,Y=$?this.#f:this.#p;for(let dt of this.#c)if(!Y||r.Util.intersect(dt.data.rect,Y)!==null){Y=dt.data.rect,$=!0;break}let K=r.Util.normalizeRect([Y[0],a[3]-Y[1]+a[1],Y[2],a[3]-Y[3]+a[1]]),Z=5,rt=$?Y[2]-Y[0]+Z:0,ot=K[0]+rt,lt=K[1],{style:ct}=this.#r;ct.left=`${100*(ot-C)/m}%`,ct.top=`${100*(lt-k)/v}%`,this.#r.append(N)}_formatContents({str:a,dir:m}){let v=document.createElement("p");v.classList.add("popupContent"),v.dir=m;let C=a.split(/(?:\r\n?|\n)/);for(let k=0,N=C.length;k<N;++k){let W=C[k];v.append(document.createTextNode(W)),k<N-1&&v.append(document.createElement("br"))}return v}#h(a){a.altKey||a.shiftKey||a.ctrlKey||a.metaKey||(a.key==="Enter"||a.key==="Escape"&&this.#d)&&this.#b()}#b(){this.#d=!this.#d,this.#d?(this.#E(),this.#r.addEventListener("click",this.#o),this.#r.addEventListener("keydown",this.#e)):(this.#S(),this.#r.removeEventListener("click",this.#o),this.#r.removeEventListener("keydown",this.#e))}#E(){this.#u||this.render(),this.isVisible?this.#d&&this.#r.classList.add("focused"):(this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#S(){this.#r.classList.remove("focused"),!(this.#d||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#g=this.isVisible,this.#g&&(this.#r.hidden=!0)}maybeShow(){this.#g&&(this.#g=!1,this.#r.hidden=!1)}get isVisible(){return this.#r.hidden===!1}}class z extends o{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0}),this.textContent=a.data.textContent,this.textPosition=a.data.textPosition,this.annotationEditorType=r.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){let a=document.createElement("div");a.classList.add("annotationTextContent"),a.setAttribute("role","comment");for(let m of this.textContent){let v=document.createElement("span");v.textContent=m,a.append(v)}this.container.append(a)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}i.FreeTextAnnotationElement=z;class X extends o{#t=null;constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");let a=this.data,{width:m,height:v}=s(a.rect),C=this.svgFactory.create(m,v,!0),k=this.#t=this.svgFactory.createElement("svg:line");return k.setAttribute("x1",a.rect[2]-a.lineCoordinates[0]),k.setAttribute("y1",a.rect[3]-a.lineCoordinates[1]),k.setAttribute("x2",a.rect[2]-a.lineCoordinates[2]),k.setAttribute("y2",a.rect[3]-a.lineCoordinates[3]),k.setAttribute("stroke-width",a.borderStyle.width||1),k.setAttribute("stroke","transparent"),k.setAttribute("fill","transparent"),C.append(k),this.container.append(C),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class it extends o{#t=null;constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");let a=this.data,{width:m,height:v}=s(a.rect),C=this.svgFactory.create(m,v,!0),k=a.borderStyle.width,N=this.#t=this.svgFactory.createElement("svg:rect");return N.setAttribute("x",k/2),N.setAttribute("y",k/2),N.setAttribute("width",m-k),N.setAttribute("height",v-k),N.setAttribute("stroke-width",k||1),N.setAttribute("stroke","transparent"),N.setAttribute("fill","transparent"),C.append(N),this.container.append(C),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class tt extends o{#t=null;constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");let a=this.data,{width:m,height:v}=s(a.rect),C=this.svgFactory.create(m,v,!0),k=a.borderStyle.width,N=this.#t=this.svgFactory.createElement("svg:ellipse");return N.setAttribute("cx",m/2),N.setAttribute("cy",v/2),N.setAttribute("rx",m/2-k/2),N.setAttribute("ry",v/2-k/2),N.setAttribute("stroke-width",k||1),N.setAttribute("stroke","transparent"),N.setAttribute("fill","transparent"),C.append(N),this.container.append(C),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Q extends o{#t=null;constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);let a=this.data,{width:m,height:v}=s(a.rect),C=this.svgFactory.create(m,v,!0),k=[];for(let W of a.vertices){let V=W.x-a.rect[0],st=a.rect[3]-W.y;k.push(V+","+st)}k=k.join(" ");let N=this.#t=this.svgFactory.createElement(this.svgElementName);return N.setAttribute("points",k),N.setAttribute("stroke-width",a.borderStyle.width||1),N.setAttribute("stroke","transparent"),N.setAttribute("fill","transparent"),C.append(N),this.container.append(C),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class nt extends Q{constructor(a){super(a),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class J extends o{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class D extends o{#t=[];constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=r.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);let a=this.data,{width:m,height:v}=s(a.rect),C=this.svgFactory.create(m,v,!0);for(let k of a.inkLists){let N=[];for(let V of k){let st=V.x-a.rect[0],q=a.rect[3]-V.y;N.push(`${st},${q}`)}N=N.join(" ");let W=this.svgFactory.createElement(this.svgElementName);this.#t.push(W),W.setAttribute("points",N),W.setAttribute("stroke-width",a.borderStyle.width||1),W.setAttribute("stroke","transparent"),W.setAttribute("fill","transparent"),!a.popupRef&&this.hasPopupData&&this._createPopup(),C.append(W)}return this.container.append(C),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}i.InkAnnotationElement=D;class b extends o{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class c extends o{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class d extends o{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class A extends o{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class M extends o{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}i.StampAnnotationElement=M;class R extends o{#t=null;constructor(a){super(a,{isRenderable:!0});let{filename:m,content:v}=this.data.file;this.filename=(0,g.getFilenameFromUrl)(m,!0),this.content=v,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:m,content:v})}render(){this.container.classList.add("fileAttachmentAnnotation");let{container:a,data:m}=this,v;m.hasAppearance||m.fillAlpha===0?v=document.createElement("div"):(v=document.createElement("img"),v.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(m.name)?"paperclip":"pushpin"}.svg`,m.fillAlpha&&m.fillAlpha<1&&(v.style=`filter: opacity(${Math.round(m.fillAlpha*100)}%);`)),v.addEventListener("dblclick",this.#e.bind(this)),this.#t=v;let{isMac:C}=r.FeatureTest.platform;return a.addEventListener("keydown",k=>{k.key==="Enter"&&(C?k.metaKey:k.ctrlKey)&&this.#e()}),!m.popupRef&&this.hasPopupData?this._createPopup():v.classList.add("popupTriggerArea"),a.append(v),a}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class L{#t=null;#e=null;#i=new Map;constructor({div:a,accessibilityManager:m,annotationCanvasMap:v,l10n:C,page:k,viewport:N}){this.div=a,this.#t=m,this.#e=v,this.l10n=C,this.page=k,this.viewport=N,this.zIndex=0,this.l10n||=U.NullL10n}#s(a,m){let v=a.firstChild||a;v.id=`${r.AnnotationPrefix}${m}`,this.div.append(a),this.#t?.moveElementInDOM(this.div,a,v,!1)}render(a){return ht(this,null,function*(){let{annotations:m}=a,v=this.div;(0,g.setLayerDimensions)(v,this.viewport);let C=new Map,k={data:null,layer:v,linkService:a.linkService,downloadManager:a.downloadManager,imageResourcesPath:a.imageResourcesPath||"",renderForms:a.renderForms!==!1,svgFactory:new g.DOMSVGFactory,annotationStorage:a.annotationStorage||new P.AnnotationStorage,enableScripting:a.enableScripting===!0,hasJSActions:a.hasJSActions,fieldObjects:a.fieldObjects,parent:this,elements:null};for(let N of m){if(N.noHTML)continue;let W=N.annotationType===r.AnnotationType.POPUP;if(W){let q=C.get(N.id);if(!q)continue;k.elements=q}else{let{width:q,height:$}=s(N.rect);if(q<=0||$<=0)continue}k.data=N;let V=l.create(k);if(!V.isRenderable)continue;if(!W&&N.popupRef){let q=C.get(N.popupRef);q?q.push(V):C.set(N.popupRef,[V])}V.annotationEditorType>0&&this.#i.set(V.data.id,V);let st=V.render();N.hidden&&(st.style.visibility="hidden"),this.#s(st,N.id)}this.#o(),yield this.l10n.translate(v)})}update({viewport:a}){let m=this.div;this.viewport=a,(0,g.setLayerDimensions)(m,{rotation:a.rotation}),this.#o(),m.hidden=!1}#o(){if(!this.#e)return;let a=this.div;for(let[m,v]of this.#e){let C=a.querySelector(`[data-annotation-id="${m}"]`);if(!C)continue;let{firstChild:k}=C;k?k.nodeName==="CANVAS"?k.replaceWith(v):k.before(v):C.append(v)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(a){return this.#i.get(a)}}i.AnnotationLayer=L},(F,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ColorConverters=void 0;function E(P){return Math.floor(Math.max(0,Math.min(1,P))*255).toString(16).padStart(2,"0")}function r(P){return Math.max(0,Math.min(255,255*P))}class g{static CMYK_G([x,U,B,h]){return["G",1-Math.min(1,.3*x+.59*B+.11*U+h)]}static G_CMYK([x]){return["CMYK",0,0,0,1-x]}static G_RGB([x]){return["RGB",x,x,x]}static G_rgb([x]){return x=r(x),[x,x,x]}static G_HTML([x]){let U=E(x);return`#${U}${U}${U}`}static RGB_G([x,U,B]){return["G",.3*x+.59*U+.11*B]}static RGB_rgb(x){return x.map(r)}static RGB_HTML(x){return`#${x.map(E).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([x,U,B,h]){return["RGB",1-Math.min(1,x+h),1-Math.min(1,B+h),1-Math.min(1,U+h)]}static CMYK_rgb([x,U,B,h]){return[r(1-Math.min(1,x+h)),r(1-Math.min(1,B+h)),r(1-Math.min(1,U+h))]}static CMYK_HTML(x){let U=this.CMYK_RGB(x).slice(1);return this.RGB_HTML(U)}static RGB_CMYK([x,U,B]){let h=1-x,n=1-U,t=1-B,s=Math.min(h,n,t);return["CMYK",h,n,t,s]}}i.ColorConverters=g},(F,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NullL10n=void 0,i.getL10nFallback=r;let E={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} \xD7 {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} \xD7 {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing\u2026",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};E.print_progress_percent="{{progress}}%";function r(U,B){switch(U){case"find_match_count":U=`find_match_count[${B.total===1?"one":"other"}]`;break;case"find_match_count_limit":U=`find_match_count_limit[${B.limit===1?"one":"other"}]`;break}return E[U]||""}function g(U,B){return B?U.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(h,n)=>n in B?B[n]:"{{"+n+"}}"):U}let P={getLanguage(){return ht(this,null,function*(){return"en-us"})},getDirection(){return ht(this,null,function*(){return"ltr"})},get(n){return ht(this,arguments,function*(U,B=null,h=r(U,B)){return g(h,B)})},translate(U){return ht(this,null,function*(){})}};i.NullL10n=P},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.XfaLayer=void 0;var r=E(25);class g{static setupStorage(x,U,B,h,n){let t=h.getValue(U,{value:null});switch(B.name){case"textarea":if(t.value!==null&&(x.textContent=t.value),n==="print")break;x.addEventListener("input",s=>{h.setValue(U,{value:s.target.value})});break;case"input":if(B.attributes.type==="radio"||B.attributes.type==="checkbox"){if(t.value===B.attributes.xfaOn?x.setAttribute("checked",!0):t.value===B.attributes.xfaOff&&x.removeAttribute("checked"),n==="print")break;x.addEventListener("change",s=>{h.setValue(U,{value:s.target.checked?s.target.getAttribute("xfaOn"):s.target.getAttribute("xfaOff")})})}else{if(t.value!==null&&x.setAttribute("value",t.value),n==="print")break;x.addEventListener("input",s=>{h.setValue(U,{value:s.target.value})})}break;case"select":if(t.value!==null){x.setAttribute("value",t.value);for(let s of B.children)s.attributes.value===t.value?s.attributes.selected=!0:s.attributes.hasOwnProperty("selected")&&delete s.attributes.selected}x.addEventListener("input",s=>{let l=s.target.options,o=l.selectedIndex===-1?"":l[l.selectedIndex].value;h.setValue(U,{value:o})});break}}static setAttributes({html:x,element:U,storage:B=null,intent:h,linkService:n}){let{attributes:t}=U,s=x instanceof HTMLAnchorElement;t.type==="radio"&&(t.name=`${t.name}-${h}`);for(let[l,o]of Object.entries(t))if(o!=null)switch(l){case"class":o.length&&x.setAttribute(l,o.join(" "));break;case"dataId":break;case"id":x.setAttribute("data-element-id",o);break;case"style":Object.assign(x.style,o);break;case"textContent":x.textContent=o;break;default:(!s||l!=="href"&&l!=="newWindow")&&x.setAttribute(l,o)}s&&n.addLinkAttributes(x,t.href,t.newWindow),B&&t.dataId&&this.setupStorage(x,t.dataId,U,B)}static render(x){let U=x.annotationStorage,B=x.linkService,h=x.xfaHtml,n=x.intent||"display",t=document.createElement(h.name);h.attributes&&this.setAttributes({html:t,element:h,intent:n,linkService:B});let s=[[h,-1,t]],l=x.div;if(l.append(t),x.viewport){let e=`matrix(${x.viewport.transform.join(",")})`;l.style.transform=e}n!=="richText"&&l.setAttribute("class","xfaLayer xfaFont");let o=[];for(;s.length>0;){let[e,u,f]=s.at(-1);if(u+1===e.children.length){s.pop();continue}let _=e.children[++s.at(-1)[1]];if(_===null)continue;let{name:T}=_;if(T==="#text"){let p=document.createTextNode(_.value);o.push(p),f.append(p);continue}let S=_?.attributes?.xmlns?document.createElementNS(_.attributes.xmlns,T):document.createElement(T);if(f.append(S),_.attributes&&this.setAttributes({html:S,element:_,storage:U,intent:n,linkService:B}),_.children&&_.children.length>0)s.push([_,-1,S]);else if(_.value){let p=document.createTextNode(_.value);r.XfaText.shouldBuildText(T)&&o.push(p),S.append(p)}}for(let e of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))e.setAttribute("readOnly",!0);return{textDivs:o}}static update(x){let U=`matrix(${x.viewport.transform.join(",")})`;x.div.style.transform=U,x.div.hidden=!1}}i.XfaLayer=g},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.InkEditor=void 0;var r=E(1),g=E(4),P=E(29),x=E(6),U=E(5);let B=(()=>{class h extends g.AnnotationEditor{#t=0;#e=0;#i=this.canvasPointermove.bind(this);#s=this.canvasPointerleave.bind(this);#o=this.canvasPointerup.bind(this);#a=this.canvasPointerdown.bind(this);#r=new Path2D;#l=!1;#c=!1;#n=!1;#f=null;#d=0;#u=0;#p=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";constructor(t){super(Yt(Ht({},t),{name:"inkEditor"})),this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(t){g.AnnotationEditor.initialize(t,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(t,s){switch(t){case r.AnnotationEditorParamsType.INK_THICKNESS:h._defaultThickness=s;break;case r.AnnotationEditorParamsType.INK_COLOR:h._defaultColor=s;break;case r.AnnotationEditorParamsType.INK_OPACITY:h._defaultOpacity=s/100;break}}updateParams(t,s){switch(t){case r.AnnotationEditorParamsType.INK_THICKNESS:this.#_(s);break;case r.AnnotationEditorParamsType.INK_COLOR:this.#m(s);break;case r.AnnotationEditorParamsType.INK_OPACITY:this.#g(s);break}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,h._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,h._defaultColor||g.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(h._defaultOpacity*100)]]}get propertiesToUpdate(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||h._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,this.color||h._defaultColor||g.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??h._defaultOpacity))]]}#_(t){let s=this.thickness;this.addCommands({cmd:()=>{this.thickness=t,this.#C()},undo:()=>{this.thickness=s,this.#C()},mustExec:!0,type:r.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#m(t){let s=this.color;this.addCommands({cmd:()=>{this.color=t,this.#A()},undo:()=>{this.color=s,this.#A()},mustExec:!0,type:r.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#g(t){t/=100;let s=this.opacity;this.addCommands({cmd:()=>{this.opacity=t,this.#A()},undo:()=>{this.opacity=s,this.#A()},mustExec:!0,type:r.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#k(),this.#M()),this.isAttachedToDOM||(this.parent.add(this),this.#y()),this.#C()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#f.disconnect(),this.#f=null,super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&t===null&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){let[t,s]=this.parentDimensions,l=this.width*t,o=this.height*s;this.setDimensions(l,o)}enableEditMode(){this.#l||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#a))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#a))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#h(){let{parentRotation:t,parentDimensions:[s,l]}=this;switch(t){case 90:return[0,l,l,s];case 180:return[s,l,s,l];case 270:return[s,0,l,s];default:return[0,0,s,l]}}#b(){let{ctx:t,color:s,opacity:l,thickness:o,parentScale:e,scaleFactor:u}=this;t.lineWidth=o*e/u,t.lineCap="round",t.lineJoin="round",t.miterLimit=10,t.strokeStyle=`${s}${(0,U.opacityToHex)(l)}`}#E(t,s){this.canvas.addEventListener("contextmenu",x.noContextMenu),this.canvas.addEventListener("pointerleave",this.#s),this.canvas.addEventListener("pointermove",this.#i),this.canvas.addEventListener("pointerup",this.#o),this.canvas.removeEventListener("pointerdown",this.#a),this.isEditing=!0,this.#n||(this.#n=!0,this.#y(),this.thickness||=h._defaultThickness,this.color||=h._defaultColor||g.AnnotationEditor._defaultLineColor,this.opacity??=h._defaultOpacity),this.currentPath.push([t,s]),this.#c=!1,this.#b(),this.#p=()=>{this.#I(),this.#p&&window.requestAnimationFrame(this.#p)},window.requestAnimationFrame(this.#p)}#S(t,s){let[l,o]=this.currentPath.at(-1);if(this.currentPath.length>1&&t===l&&s===o)return;let e=this.currentPath,u=this.#r;if(e.push([t,s]),this.#c=!0,e.length<=2){u.moveTo(...e[0]),u.lineTo(t,s);return}e.length===3&&(this.#r=u=new Path2D,u.moveTo(...e[0])),this.#L(u,...e.at(-3),...e.at(-2),t,s)}#T(){if(this.currentPath.length===0)return;let t=this.currentPath.at(-1);this.#r.lineTo(...t)}#P(t,s){this.#p=null,t=Math.min(Math.max(t,0),this.canvas.width),s=Math.min(Math.max(s,0),this.canvas.height),this.#S(t,s),this.#T();let l;if(this.currentPath.length!==1)l=this.#O();else{let _=[t,s];l=[[_,_.slice(),_.slice(),_]]}let o=this.#r,e=this.currentPath;this.currentPath=[],this.#r=new Path2D;let u=()=>{this.allRawPaths.push(e),this.paths.push(l),this.bezierPath2D.push(o),this.rebuild()},f=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#k(),this.#M()),this.#C())};this.addCommands({cmd:u,undo:f,mustExec:!0})}#I(){if(!this.#c)return;this.#c=!1;let t=Math.ceil(this.thickness*this.parentScale),s=this.currentPath.slice(-3),l=s.map(S=>S[0]),o=s.map(S=>S[1]),e=Math.min(...l)-t,u=Math.max(...l)+t,f=Math.min(...o)-t,_=Math.max(...o)+t,{ctx:T}=this;T.save(),T.clearRect(0,0,this.canvas.width,this.canvas.height);for(let S of this.bezierPath2D)T.stroke(S);T.stroke(this.#r),T.restore()}#L(t,s,l,o,e,u,f){let _=(s+o)/2,T=(l+e)/2,S=(o+u)/2,p=(e+f)/2;t.bezierCurveTo(_+2*(o-_)/3,T+2*(e-T)/3,S+2*(o-S)/3,p+2*(e-p)/3,S,p)}#O(){let t=this.currentPath;if(t.length<=2)return[[t[0],t[0],t.at(-1),t.at(-1)]];let s=[],l,[o,e]=t[0];for(l=1;l<t.length-2;l++){let[y,O]=t[l],[j,I]=t[l+1],z=(y+j)/2,X=(O+I)/2,it=[o+2*(y-o)/3,e+2*(O-e)/3],tt=[z+2*(y-z)/3,X+2*(O-X)/3];s.push([[o,e],it,tt,[z,X]]),[o,e]=[z,X]}let[u,f]=t[l],[_,T]=t[l+1],S=[o+2*(u-o)/3,e+2*(f-e)/3],p=[_+2*(u-_)/3,T+2*(f-T)/3];return s.push([[o,e],S,p,[_,T]]),s}#A(){if(this.isEmpty()){this.#w();return}this.#b();let{canvas:t,ctx:s}=this;s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,t.width,t.height),this.#w();for(let l of this.bezierPath2D)s.stroke(l)}commit(){this.#l||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#l=!0,this.div.classList.add("disabled"),this.#C(!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),this.enableEditMode())}canvasPointerdown(t){t.button!==0||!this.isInEditMode()||this.#l||(this.setInForeground(),t.preventDefault(),t.type!=="mouse"&&this.div.focus(),this.#E(t.offsetX,t.offsetY))}canvasPointermove(t){t.preventDefault(),this.#S(t.offsetX,t.offsetY)}canvasPointerup(t){t.preventDefault(),this.#D(t)}canvasPointerleave(t){this.#D(t)}#D(t){this.canvas.removeEventListener("pointerleave",this.#s),this.canvas.removeEventListener("pointermove",this.#i),this.canvas.removeEventListener("pointerup",this.#o),this.canvas.addEventListener("pointerdown",this.#a),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",x.noContextMenu)},10),this.#P(t.offsetX,t.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#k(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",g.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(t=>this.canvas?.setAttribute("aria-label",t)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#M(){this.#f=new ResizeObserver(t=>{let s=t[0].contentRect;s.width&&s.height&&this.setDimensions(s.width,s.height)}),this.#f.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#l}render(){if(this.div)return this.div;let t,s;this.width&&(t=this.x,s=this.y),super.render(),g.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(f=>this.div?.setAttribute("aria-label",f));let[l,o,e,u]=this.#h();if(this.setAt(l,o,0,0),this.setDims(e,u),this.#k(),this.width){let[f,_]=this.parentDimensions;this.setAspectRatio(this.width*f,this.height*_),this.setAt(t*f,s*_,this.width*f,this.height*_),this.#n=!0,this.#y(),this.setDims(this.width*f,this.height*_),this.#A(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#M(),this.div}#y(){if(!this.#n)return;let[t,s]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t),this.canvas.height=Math.ceil(this.height*s),this.#w()}setDimensions(t,s){let l=Math.round(t),o=Math.round(s);if(this.#d===l&&this.#u===o)return;this.#d=l,this.#u=o,this.canvas.style.visibility="hidden";let[e,u]=this.parentDimensions;this.width=t/e,this.height=s/u,this.fixAndSetPosition(),this.#l&&this.#x(t,s),this.#y(),this.#A(),this.canvas.style.visibility="visible",this.fixDims()}#x(t,s){let l=this.#F(),o=(t-l)/this.#e,e=(s-l)/this.#t;this.scaleFactor=Math.min(o,e)}#w(){let t=this.#F()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)}static#N(t){let s=new Path2D;for(let l=0,o=t.length;l<o;l++){let[e,u,f,_]=t[l];l===0&&s.moveTo(...e),s.bezierCurveTo(u[0],u[1],f[0],f[1],_[0],_[1])}return s}static#B(t,s,l){let[o,e,u,f]=s;switch(l){case 0:for(let _=0,T=t.length;_<T;_+=2)t[_]+=o,t[_+1]=f-t[_+1];break;case 90:for(let _=0,T=t.length;_<T;_+=2){let S=t[_];t[_]=t[_+1]+o,t[_+1]=S+e}break;case 180:for(let _=0,T=t.length;_<T;_+=2)t[_]=u-t[_],t[_+1]+=e;break;case 270:for(let _=0,T=t.length;_<T;_+=2){let S=t[_];t[_]=u-t[_+1],t[_+1]=f-S}break;default:throw new Error("Invalid rotation")}return t}static#U(t,s,l){let[o,e,u,f]=s;switch(l){case 0:for(let _=0,T=t.length;_<T;_+=2)t[_]-=o,t[_+1]=f-t[_+1];break;case 90:for(let _=0,T=t.length;_<T;_+=2){let S=t[_];t[_]=t[_+1]-e,t[_+1]=S-o}break;case 180:for(let _=0,T=t.length;_<T;_+=2)t[_]=u-t[_],t[_+1]-=e;break;case 270:for(let _=0,T=t.length;_<T;_+=2){let S=t[_];t[_]=f-t[_+1],t[_+1]=u-S}break;default:throw new Error("Invalid rotation")}return t}#j(t,s,l,o){let e=[],u=this.thickness/2,f=t*s+u,_=t*l+u;for(let T of this.paths){let S=[],p=[];for(let y=0,O=T.length;y<O;y++){let[j,I,z,X]=T[y],it=t*j[0]+f,tt=t*j[1]+_,Q=t*I[0]+f,nt=t*I[1]+_,J=t*z[0]+f,D=t*z[1]+_,b=t*X[0]+f,c=t*X[1]+_;y===0&&(S.push(it,tt),p.push(it,tt)),S.push(Q,nt,J,D,b,c),p.push(Q,nt),y===O-1&&p.push(b,c)}e.push({bezier:h.#B(S,o,this.rotation),points:h.#B(p,o,this.rotation)})}return e}#R(){let t=1/0,s=-1/0,l=1/0,o=-1/0;for(let e of this.paths)for(let[u,f,_,T]of e){let S=r.Util.bezierBoundingBox(...u,...f,..._,...T);t=Math.min(t,S[0]),l=Math.min(l,S[1]),s=Math.max(s,S[2]),o=Math.max(o,S[3])}return[t,l,s,o]}#F(){return this.#l?Math.ceil(this.thickness*this.parentScale):0}#C(t=!1){if(this.isEmpty())return;if(!this.#l){this.#A();return}let s=this.#R(),l=this.#F();this.#e=Math.max(g.AnnotationEditor.MIN_SIZE,s[2]-s[0]),this.#t=Math.max(g.AnnotationEditor.MIN_SIZE,s[3]-s[1]);let o=Math.ceil(l+this.#e*this.scaleFactor),e=Math.ceil(l+this.#t*this.scaleFactor),[u,f]=this.parentDimensions;this.width=o/u,this.height=e/f,this.setAspectRatio(o,e);let _=this.translationX,T=this.translationY;this.translationX=-s[0],this.translationY=-s[1],this.#y(),this.#A(),this.#d=o,this.#u=e,this.setDims(o,e);let S=t?l/this.scaleFactor/2:0;this.translate(_-this.translationX-S,T-this.translationY-S)}static deserialize(t,s,l){if(t instanceof P.InkAnnotationElement)return null;let o=super.deserialize(t,s,l);o.thickness=t.thickness,o.color=r.Util.makeHexColor(...t.color),o.opacity=t.opacity;let[e,u]=o.pageDimensions,f=o.width*e,_=o.height*u,T=o.parentScale,S=t.thickness/2;o.#l=!0,o.#d=Math.round(f),o.#u=Math.round(_);let{paths:p,rect:y,rotation:O}=t;for(let{bezier:I}of p){I=h.#U(I,y,O);let z=[];o.paths.push(z);let X=T*(I[0]-S),it=T*(I[1]-S);for(let Q=2,nt=I.length;Q<nt;Q+=6){let J=T*(I[Q]-S),D=T*(I[Q+1]-S),b=T*(I[Q+2]-S),c=T*(I[Q+3]-S),d=T*(I[Q+4]-S),A=T*(I[Q+5]-S);z.push([[X,it],[J,D],[b,c],[d,A]]),X=d,it=A}let tt=this.#N(z);o.bezierPath2D.push(tt)}let j=o.#R();return o.#e=Math.max(g.AnnotationEditor.MIN_SIZE,j[2]-j[0]),o.#t=Math.max(g.AnnotationEditor.MIN_SIZE,j[3]-j[1]),o.#x(f,_),o}serialize(){if(this.isEmpty())return null;let t=this.getRect(0,0),s=g.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:r.AnnotationEditorType.INK,color:s,thickness:this.thickness,opacity:this.opacity,paths:this.#j(this.scaleFactor/this.parentScale,this.translationX,this.translationY,t),pageIndex:this.pageIndex,rect:t,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}return h})();i.InkEditor=B},(F,i,E)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.StampEditor=void 0;var r=E(1),g=E(4),P=E(6),x=E(29);let U=(()=>{class B extends g.AnnotationEditor{#t=null;#e=null;#i=null;#s=null;#o=null;#a=null;#r=null;#l=null;#c=!1;#n=!1;static _type="stamp";constructor(n){super(Yt(Ht({},n),{name:"stampEditor"})),this.#s=n.bitmapUrl,this.#o=n.bitmapFile}static initialize(n){g.AnnotationEditor.initialize(n)}static get supportedTypes(){let n=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,r.shadow)(this,"supportedTypes",n.map(t=>`image/${t}`))}static get supportedTypesStr(){return(0,r.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(n){return this.supportedTypes.includes(n)}static paste(n,t){t.pasteEditor(r.AnnotationEditorType.STAMP,{bitmapFile:n.getAsFile()})}#f(n,t=!1){if(!n){this.remove();return}this.#t=n.bitmap,t||(this.#e=n.id,this.#c=n.isSvg),this.#p()}#d(){this.#i=null,this._uiManager.enableWaiting(!1),this.#a&&this.div.focus()}#u(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(t=>this.#f(t,!0)).finally(()=>this.#d());return}if(this.#s){let t=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(t).then(s=>this.#f(s)).finally(()=>this.#d());return}if(this.#o){let t=this.#o;this.#o=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(t).then(s=>this.#f(s)).finally(()=>this.#d());return}let n=document.createElement("input");n.type="file",n.accept=B.supportedTypesStr,this.#i=new Promise(t=>{n.addEventListener("change",()=>ht(this,null,function*(){if(!n.files||n.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);let s=yield this._uiManager.imageManager.getFromFile(n.files[0]);this.#f(s)}t()})),n.addEventListener("cancel",()=>{this.remove(),t()})}).finally(()=>this.#d()),n.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#r?.disconnect(),this.#r=null),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#u();return}super.rebuild(),this.div!==null&&(this.#e&&this.#u(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#s||this.#o)}get isResizable(){return!0}render(){if(this.div)return this.div;let n,t;if(this.width&&(n=this.x,t=this.y),super.render(),this.div.hidden=!0,this.#t?this.#p():this.#u(),this.width){let[s,l]=this.parentDimensions;this.setAt(n*s,t*l,this.width*s,this.height*l)}return this.div}#p(){let{div:n}=this,{width:t,height:s}=this.#t,[l,o]=this.pageDimensions,e=.75;if(this.width)t=this.width*l,s=this.height*o;else if(t>e*l||s>e*o){let T=Math.min(e*l/t,e*o/s);t*=T,s*=T}let[u,f]=this.parentDimensions;this.setDims(t*u/l,s*f/o),this._uiManager.enableWaiting(!1);let _=this.#a=document.createElement("canvas");n.append(_),n.hidden=!1,this.#g(t,s),this.#b(),this.#n||(this.parent.addUndoableEditor(this),this.#n=!0),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()}#_(n,t){let[s,l]=this.parentDimensions;this.width=n/s,this.height=t/l,this.setDims(n,t),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#l!==null&&clearTimeout(this.#l);let o=200;this.#l=setTimeout(()=>{this.#l=null,this.#g(n,t)},o)}#m(n,t){let{width:s,height:l}=this.#t,o=s,e=l,u=this.#t;for(;o>2*n||e>2*t;){let f=o,_=e;o>2*n&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),e>2*t&&(e=e>=16384?Math.floor(e/2)-1:Math.ceil(e/2));let T=new OffscreenCanvas(o,e);T.getContext("2d").drawImage(u,0,0,f,_,0,0,o,e),u=T.transferToImageBitmap()}return u}#g(n,t){n=Math.ceil(n),t=Math.ceil(t);let s=this.#a;if(!s||s.width===n&&s.height===t)return;s.width=n,s.height=t;let l=this.#c?this.#t:this.#m(n,t),o=s.getContext("2d");o.filter=this._uiManager.hcmFilter,o.drawImage(l,0,0,l.width,l.height,0,0,n,t)}#h(n){if(n){if(this.#c){let l=this._uiManager.imageManager.getSvgUrl(this.#e);if(l)return l}let t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#t,t.getContext("2d").drawImage(this.#t,0,0),t.toDataURL()}if(this.#c){let[t,s]=this.pageDimensions,l=Math.round(this.width*t*P.PixelsPerInch.PDF_TO_CSS_UNITS),o=Math.round(this.height*s*P.PixelsPerInch.PDF_TO_CSS_UNITS),e=new OffscreenCanvas(l,o);return e.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,l,o),e.transferToImageBitmap()}return structuredClone(this.#t)}#b(){this.#r=new ResizeObserver(n=>{let t=n[0].contentRect;t.width&&t.height&&this.#_(t.width,t.height)}),this.#r.observe(this.div)}static deserialize(n,t,s){if(n instanceof x.StampAnnotationElement)return null;let l=super.deserialize(n,t,s),{rect:o,bitmapUrl:e,bitmapId:u,isSvg:f,accessibilityData:_}=n;u&&s.imageManager.isValidId(u)?l.#e=u:l.#s=e,l.#c=f;let[T,S]=l.pageDimensions;return l.width=(o[2]-o[0])/T,l.height=(o[3]-o[1])/S,_&&(l.altTextData=_),l}serialize(n=!1,t=null){if(this.isEmpty())return null;let s={annotationType:r.AnnotationEditorType.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(n)return s.bitmapUrl=this.#h(!0),s.accessibilityData=this.altTextData,s;let{decorative:l,altText:o}=this.altTextData;if(!l&&o&&(s.accessibilityData={type:"Figure",alt:o}),t===null)return s;t.stamps||=new Map;let e=this.#c?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!t.stamps.has(this.#e))t.stamps.set(this.#e,{area:e,serialized:s}),s.bitmap=this.#h(!1);else if(this.#c){let u=t.stamps.get(this.#e);e>u.area&&(u.area=e,u.serialized.bitmap.close(),u.serialized.bitmap=this.#h(!1))}return s}}return B})();i.StampEditor=U}],__webpack_module_cache__={};function __w_pdfjs_require__(F){var i=__webpack_module_cache__[F];if(i!==void 0)return i.exports;var E=__webpack_module_cache__[F]={exports:{}};return __webpack_modules__[F](E,E.exports,__w_pdfjs_require__),E.exports}var __webpack_exports__={};return(()=>{var F=__webpack_exports__;Object.defineProperty(F,"__esModule",{value:!0}),Object.defineProperty(F,"AbortException",{enumerable:!0,get:function(){return i.AbortException}}),Object.defineProperty(F,"AnnotationEditorLayer",{enumerable:!0,get:function(){return P.AnnotationEditorLayer}}),Object.defineProperty(F,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return i.AnnotationEditorParamsType}}),Object.defineProperty(F,"AnnotationEditorType",{enumerable:!0,get:function(){return i.AnnotationEditorType}}),Object.defineProperty(F,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return x.AnnotationEditorUIManager}}),Object.defineProperty(F,"AnnotationLayer",{enumerable:!0,get:function(){return U.AnnotationLayer}}),Object.defineProperty(F,"AnnotationMode",{enumerable:!0,get:function(){return i.AnnotationMode}}),Object.defineProperty(F,"CMapCompressionType",{enumerable:!0,get:function(){return i.CMapCompressionType}}),Object.defineProperty(F,"DOMSVGFactory",{enumerable:!0,get:function(){return r.DOMSVGFactory}}),Object.defineProperty(F,"FeatureTest",{enumerable:!0,get:function(){return i.FeatureTest}}),Object.defineProperty(F,"GlobalWorkerOptions",{enumerable:!0,get:function(){return B.GlobalWorkerOptions}}),Object.defineProperty(F,"ImageKind",{enumerable:!0,get:function(){return i.ImageKind}}),Object.defineProperty(F,"InvalidPDFException",{enumerable:!0,get:function(){return i.InvalidPDFException}}),Object.defineProperty(F,"MissingPDFException",{enumerable:!0,get:function(){return i.MissingPDFException}}),Object.defineProperty(F,"OPS",{enumerable:!0,get:function(){return i.OPS}}),Object.defineProperty(F,"PDFDataRangeTransport",{enumerable:!0,get:function(){return E.PDFDataRangeTransport}}),Object.defineProperty(F,"PDFDateString",{enumerable:!0,get:function(){return r.PDFDateString}}),Object.defineProperty(F,"PDFWorker",{enumerable:!0,get:function(){return E.PDFWorker}}),Object.defineProperty(F,"PasswordResponses",{enumerable:!0,get:function(){return i.PasswordResponses}}),Object.defineProperty(F,"PermissionFlag",{enumerable:!0,get:function(){return i.PermissionFlag}}),Object.defineProperty(F,"PixelsPerInch",{enumerable:!0,get:function(){return r.PixelsPerInch}}),Object.defineProperty(F,"PromiseCapability",{enumerable:!0,get:function(){return i.PromiseCapability}}),Object.defineProperty(F,"RenderingCancelledException",{enumerable:!0,get:function(){return r.RenderingCancelledException}}),Object.defineProperty(F,"SVGGraphics",{enumerable:!0,get:function(){return E.SVGGraphics}}),Object.defineProperty(F,"UnexpectedResponseException",{enumerable:!0,get:function(){return i.UnexpectedResponseException}}),Object.defineProperty(F,"Util",{enumerable:!0,get:function(){return i.Util}}),Object.defineProperty(F,"VerbosityLevel",{enumerable:!0,get:function(){return i.VerbosityLevel}}),Object.defineProperty(F,"XfaLayer",{enumerable:!0,get:function(){return h.XfaLayer}}),Object.defineProperty(F,"build",{enumerable:!0,get:function(){return E.build}}),Object.defineProperty(F,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return i.createValidAbsoluteUrl}}),Object.defineProperty(F,"getDocument",{enumerable:!0,get:function(){return E.getDocument}}),Object.defineProperty(F,"getFilenameFromUrl",{enumerable:!0,get:function(){return r.getFilenameFromUrl}}),Object.defineProperty(F,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return r.getPdfFilenameFromUrl}}),Object.defineProperty(F,"getXfaPageViewport",{enumerable:!0,get:function(){return r.getXfaPageViewport}}),Object.defineProperty(F,"isDataScheme",{enumerable:!0,get:function(){return r.isDataScheme}}),Object.defineProperty(F,"isPdfFile",{enumerable:!0,get:function(){return r.isPdfFile}}),Object.defineProperty(F,"loadScript",{enumerable:!0,get:function(){return r.loadScript}}),Object.defineProperty(F,"noContextMenu",{enumerable:!0,get:function(){return r.noContextMenu}}),Object.defineProperty(F,"normalizeUnicode",{enumerable:!0,get:function(){return i.normalizeUnicode}}),Object.defineProperty(F,"renderTextLayer",{enumerable:!0,get:function(){return g.renderTextLayer}}),Object.defineProperty(F,"setLayerDimensions",{enumerable:!0,get:function(){return r.setLayerDimensions}}),Object.defineProperty(F,"shadow",{enumerable:!0,get:function(){return i.shadow}}),Object.defineProperty(F,"updateTextLayer",{enumerable:!0,get:function(){return g.updateTextLayer}}),Object.defineProperty(F,"version",{enumerable:!0,get:function(){return E.version}});var i=__w_pdfjs_require__(1),E=__w_pdfjs_require__(2),r=__w_pdfjs_require__(6),g=__w_pdfjs_require__(26),P=__w_pdfjs_require__(27),x=__w_pdfjs_require__(5),U=__w_pdfjs_require__(29),B=__w_pdfjs_require__(14),h=__w_pdfjs_require__(32);let n="3.11.174",t="ce8716743"})(),__webpack_exports__})())});var wi=["determinateSpinner"];function Ci(F,i){if(F&1&&(ce(),St(0,"svg",11),Mt(1,"circle",12),Et()),F&2){let E=Bt();Nt("viewBox",E._viewBox()),Ct(1),Jt("stroke-dasharray",E._strokeCircumference(),"px")("stroke-dashoffset",E._strokeCircumference()/2,"px")("stroke-width",E._circleStrokeWidth(),"%"),Nt("r",E._circleRadius())}}var Ti=ni(class{constructor(F){this._elementRef=F}},"primary"),xi=new ve("mat-progress-spinner-default-options",{providedIn:"root",factory:Pi});function Pi(){return{diameter:ci}}var ci=100,ki=10,hi=(()=>{let i=class i extends Ti{constructor(r,g,P){super(r),this.mode=this._elementRef.nativeElement.nodeName.toLowerCase()==="mat-spinner"?"indeterminate":"determinate",this._value=0,this._diameter=ci,this._noopAnimations=g==="NoopAnimations"&&!!P&&!P._forceAnimations,P&&(P.color&&(this.color=this.defaultColor=P.color),P.diameter&&(this.diameter=P.diameter),P.strokeWidth&&(this.strokeWidth=P.strokeWidth))}get value(){return this.mode==="determinate"?this._value:0}set value(r){this._value=Math.max(0,Math.min(100,ee(r)))}get diameter(){return this._diameter}set diameter(r){this._diameter=ee(r)}get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(r){this._strokeWidth=ee(r)}_circleRadius(){return(this.diameter-ki)/2}_viewBox(){let r=this._circleRadius()*2+this.strokeWidth;return`0 0 ${r} ${r}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return this.mode==="determinate"?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}};i.\u0275fac=function(g){return new(g||i)(Kt(Me),Kt(Pe,8),Kt(xi))},i.\u0275cmp=Ot({type:i,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(g,P){if(g&1&&ze(wi,5),g&2){let x;He(x=Ge())&&(P._determinateCircle=x.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:16,hostBindings:function(g,P){g&2&&(Nt("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow",P.mode==="determinate"?P.value:null)("mode",P.mode),Jt("width",P.diameter,"px")("height",P.diameter,"px")("--mdc-circular-progress-size",P.diameter+"px")("--mdc-circular-progress-active-indicator-width",P.diameter+"px"),Ie("_mat-animation-noopable",P._noopAnimations)("mdc-circular-progress--indeterminate",P.mode==="indeterminate"))},inputs:{color:"color",mode:"mode",value:"value",diameter:"diameter",strokeWidth:"strokeWidth"},exportAs:["matProgressSpinner"],features:[De],decls:14,vars:11,consts:[["circle",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["determinateSpinner",""],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(g,P){if(g&1&&(Qt(0,Ci,2,8,"ng-template",null,0,Xe),St(2,"div",1,2),ce(),St(4,"svg",3),Mt(5,"circle",4),Et()(),Ce(),St(6,"div",5)(7,"div",6)(8,"div",7),Zt(9,8),Et(),St(10,"div",9),Zt(11,8),Et(),St(12,"div",10),Zt(13,8),Et()()()),g&2){let x=je(1);Ct(4),Nt("viewBox",P._viewBox()),Ct(1),Jt("stroke-dasharray",P._strokeCircumference(),"px")("stroke-dashoffset",P._strokeDashOffset(),"px")("stroke-width",P._circleStrokeWidth(),"%"),Nt("r",P._circleRadius()),Ct(4),kt("ngTemplateOutlet",x),Ct(2),kt("ngTemplateOutlet",x),Ct(2),kt("ngTemplateOutlet",x)}},dependencies:[Ve],styles:["@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-color-1-fade-in-out{from{opacity:.99}25%{opacity:.99}26%{opacity:0}89%{opacity:0}90%{opacity:.99}to{opacity:.99}}@keyframes mdc-circular-progress-color-2-fade-in-out{from{opacity:0}15%{opacity:0}25%{opacity:.99}50%{opacity:.99}51%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-3-fade-in-out{from{opacity:0}40%{opacity:0}50%{opacity:.99}75%{opacity:.99}76%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-4-fade-in-out{from{opacity:0}65%{opacity:0}75%{opacity:.99}90%{opacity:.99}to{opacity:0}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}.mdc-circular-progress{display:inline-flex;position:relative;direction:ltr;line-height:0;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-1{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-1-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-2{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-2-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-3{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-3-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-4{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-4-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--closed{opacity:0}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color)}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width)}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-1 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-2 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-3 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-4 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mat-mdc-progress-spinner .mdc-circular-progress{width:var(--mdc-circular-progress-size) !important;height:var(--mdc-circular-progress-size) !important}.mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}"],encapsulation:2,changeDetection:0});let F=i;return F})();var di=(()=>{let i=class i{};i.\u0275fac=function(g){return new(g||i)},i.\u0275mod=Se({type:i}),i.\u0275inj=ye({imports:[qe,si]});let F=i;return F})();function fe(F,i){!i?.injector&&Te(fe);let E=i?.injector??Pt(xe),r=new _e(1),g=Fe(()=>{let P;try{P=F()}catch(x){he(()=>r.error(x));return}he(()=>r.next(P))},{injector:E,manualCleanup:!0});return E.get(Re).onDestroy(()=>{g.destroy(),r.complete()}),r.asObservable()}var Ut=Ei(bi());var Ai=(()=>{let i=class i{constructor(){this.storeService=Pt(ei),this.pagesPreviews=Gt(null);let r=`https://cdn.jsdelivr.net/npm/pdfjs-dist@${Ut.version}/build/pdf.worker.min.js`;Ut.GlobalWorkerOptions.workerSrc=r,fe(this.storeService.documentBuffer).pipe(le(()=>this.storeService.pageRenderingProcessing.set(!0)),be(g=>this.generatePagePreviews(g)),le(()=>this.storeService.pageRenderingProcessing.set(!1))).subscribe()}generatePagePreviews(r){return ht(this,null,function*(){if(!r)return!1;let P=yield(0,Ut.getDocument)({data:r}).promise;return yield Promise.all(Array.from(Array(P.numPages).keys()).map(x=>this.renderPagePreview(P,x))),!0})}renderPagePreview(r,g){return ht(this,null,function*(){let P=yield r.getPage(g+1),x=P.getViewport({scale:.5}),U=document.createElement("canvas"),B=U.getContext("2d",{willReadFrequently:!0,alpha:!1});U.height=x.height,U.width=x.width,yield P.render({canvasContext:B,viewport:x}).promise;let n=U.toDataURL();P.cleanup();let t={pageIndex:g,base64:n};this.addOrReplacePreview(t)})}addOrReplacePreview(r){return ht(this,null,function*(){this.pagesPreviews.update(g=>g?[...g?.filter(x=>x.pageIndex!==r.pageIndex),r]:[r])})}};i.\u0275fac=function(g){return new(g||i)},i.\u0275prov=Ae({token:i,factory:i.\u0275fac,providedIn:"root"});let F=i;return F})();function zi(F,i){if(F&1&&Mt(0,"img",0),F&2){let E=Bt();kt("src",E.imageSrc(),ke)}}function Gi(F,i){F&1&&Mt(0,"mat-progress-spinner",1)}var yi=(()=>{let i=class i{constructor(){this.pagesPreviews=Pt(Ai).pagesPreviews,this.currentPageIndex=Gt(void 0),this.imageSrc=zt(()=>{let r=this.currentPageIndex();return this.pagesPreviews()?.find(P=>P.pageIndex===r)?.base64||void 0})}set pageIndex(r){this.currentPageIndex.set(r)}};i.\u0275fac=function(g){return new(g||i)},i.\u0275cmp=Ot({type:i,selectors:[["app-thumb"]],inputs:{pageIndex:"pageIndex"},standalone:!0,features:[te],decls:2,vars:1,consts:[[3,"src"],["mode","indeterminate"]],template:function(g,P){g&1&&Qt(0,zi,1,1,"img",0)(1,Gi,1,0),g&2&&Le(0,P.imageSrc()?0:1)},dependencies:[di,hi],styles:["[_nghost-%COMP%]{display:grid}mat-progress-spinner[_ngcontent-%COMP%]{margin:2rem}img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain;pointer-events:none}"],changeDetection:0});let F=i;return F})();function Xi(F,i){if(F&1){let E=Ue();St(0,"span",1)(1,"div",2)(2,"button",3),de("click",function(){let P=Ee(E).$implicit,x=Bt();return we(x.onRemovePage(P))}),St(3,"mat-icon"),We(4,"delete"),Et()(),Mt(5,"app-thumb",4),Et()()}if(F&2){let E=i.$implicit;Ct(5),kt("pageIndex",E)}}function Vi(F,i){}var sn=(()=>{let i=class i{constructor(){this.documentService=Pt(ii),this.pageCount=this.documentService.pageCount,this.pages=zt(()=>{let r=this.pageCount();if(r)return Array.from(Array(r).keys())})}onChangePosition(r){return ht(this,null,function*(){yield this.documentService.movePage(r.previousIndex,r.currentIndex)})}onRemovePage(r){return ht(this,null,function*(){yield this.documentService.removePage(r)})}};i.\u0275fac=function(g){return new(g||i)},i.\u0275cmp=Ot({type:i,selectors:[["app-pages"]],standalone:!0,features:[te],decls:4,vars:1,consts:[["cdkDropListGroup","","mixedCdkDragDrop","","orientation","horizontal",1,"list",3,"dropped"],["cdkDropList","","mixedCdkDropList","",1,"list"],["cdkDrag","",1,"item"],["mat-mini-fab","","color","warn",1,"remove",3,"click"],[3,"pageIndex"],["class","list","cdkDropList","","mixedCdkDropList",""]],template:function(g,P){g&1&&(St(0,"div",0),de("dropped",function(U){return P.onChangePosition(U)}),Ne(1,Xi,6,1,"span",5,Oe,!1,Vi,0,0),Et()),g&2&&Be(1,P.pages())},dependencies:[ai,ri,li,oi,Je,Ke,Ye,$e,ti,Qe,Ze,yi],styles:["[_nghost-%COMP%]{display:block;position:relative;text-align:center}.list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;flex-direction:row;box-sizing:border-box}.item[_ngcontent-%COMP%]{position:relative;border-radius:.25rem;border:grey solid 2px;display:flex;align-items:center;justify-content:center;box-sizing:border-box;margin:.5rem;max-width:200px}.item[_ngcontent-%COMP%]:hover{border-color:#3f51b5}button.remove[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"],changeDetection:0});let F=i;return F})();export{sn as PagesComponent};
